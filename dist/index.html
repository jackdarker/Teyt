<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta charset="utf-8">
		<title>DLCSeason</title>
		<style>
		/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}details,main,tw-passage{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}a{background-color:transparent;color:#222;text-decoration-color:#ccc}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:ButtonText dotted 1px}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}[hidden],template,tw-storydata{display:none}body{font:1.5em "Helvetica Neue",Helvetica,Arial,sans-serif;color:#222;margin:.5em}tw-story{max-width:35em;margin:0 auto;line-height:150%;display:block}a:hover{color:#cc8929;text-decoration-color:#cc8929}a:active{color:#ffb040;text-decoration-color:#cc8929}@media screen and (max-width:480px){#passage{font-size:70%}}
		</style>
	<script id="script-module-FileSaver" type="text/javascript">(function(a,b){if("function"==typeof define&&define.amd)define([],b);else if("undefined"!=typeof exports)b();else{b(),a.FileSaver={exports:{}}.exports}})(this,function(){"use strict";function b(a,b){return"undefined"==typeof b?b={autoBom:!1}:"object"!=typeof b&&(console.warn("Deprecated: Expected third argument to be a object"),b={autoBom:!b}),b.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}function c(a,b,c){var d=new XMLHttpRequest;d.open("GET",a),d.responseType="blob",d.onload=function(){g(d.response,b,c)},d.onerror=function(){console.error("could not download file")},d.send()}function d(a){var b=new XMLHttpRequest;b.open("HEAD",a,!1);try{b.send()}catch(a){}return 200<=b.status&&299>=b.status}function e(a){try{a.dispatchEvent(new MouseEvent("click"))}catch(c){var b=document.createEvent("MouseEvents");b.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(b)}}var f="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,a=/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),g=f.saveAs||("object"!=typeof window||window!==f?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(b,g,h){var i=f.URL||f.webkitURL,j=document.createElement("a");g=g||b.name||"download",j.download=g,j.rel="noopener","string"==typeof b?(j.href=b,j.origin===location.origin?e(j):d(j.href)?c(b,g,h):e(j,j.target="_blank")):(j.href=i.createObjectURL(b),setTimeout(function(){i.revokeObjectURL(j.href)},4E4),setTimeout(function(){e(j)},0))}:"msSaveOrOpenBlob"in navigator?function(f,g,h){if(g=g||f.name||"download","string"!=typeof f)navigator.msSaveOrOpenBlob(b(f,h),g);else if(d(f))c(f,g,h);else{var i=document.createElement("a");i.href=f,i.target="_blank",setTimeout(function(){e(i)})}}:function(b,d,e,g){if(g=g||open("","_blank"),g&&(g.document.title=g.document.body.innerText="downloading..."),"string"==typeof b)return c(b,d,e);var h="application/octet-stream"===b.type,i=/constructor/i.test(f.HTMLElement)||f.safari,j=/CriOS\/[\d]+/.test(navigator.userAgent);if((j||h&&i||a)&&"undefined"!=typeof FileReader){var k=new FileReader;k.onloadend=function(){var a=k.result;a=j?a:a.replace(/^data:[^;]*;/,"data:attachment/file;"),g?g.location.href=a:location=a,g=null},k.readAsDataURL(b)}else{var l=f.URL||f.webkitURL,m=l.createObjectURL(b);g?g.location=m:location.href=m,g=null,setTimeout(function(){l.revokeObjectURL(m)},4E4)}});f.saveAs=g.saveAs=g,"undefined"!=typeof module&&(module.exports=g)});

//# sourceMappingURL=FileSaver.min.js.map</script>
<link rel="icon" type="image/png" href="./assets/favicon.png" />
<link rel="stylesheet" href="./css/font-awesome.min.css">
<link rel="stylesheet" href="./css/regular.min.css">
<link rel="stylesheet" href="./css/solid.min.css">
<link rel="stylesheet" href="./css/toasty.css">
<link rel="stylesheet" href="./css/default.css" type="text/css" media="screen, projection">
<link rel="alternate stylesheet" href="./css/dark.css" title='dark' type="text/css" media="screen, projection" disabled="">
</head>
	<body>
		<tw-story tags></tw-story>
		<!-- UUID://90EFC306-4C57-4786-8CD3-9789B523C8AF// --><tw-storydata name="DLCSeason" startnode="137" creator="Tweego" creator-version="2.1.1+81d1d71" ifid="90EFC306-4C57-4786-8CD3-9789B523C8AF" zoom="1" format="snowman" format-version="2.0.3" options="" hidden><style role="stylesheet" id="twine-user-stylesheet" type="text/twine-css">/* twine-user-stylesheet #1: "user.min.css" */
carrots{color:red}carrots{color:#00f}
/* twine-user-stylesheet #2: "Story Stylesheet" */
.main {
  background: white;
  width: 250px;
  height: 345px;
/*   box-shadow: 3px 3px 3px 1px rgba(0,0,0,0.4); */
  margin: auto;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}

@media only screen and (min-width: 768px) {
  .main {
    width: 310px;
    height: 285px;
  }
}

@media only screen and (min-width: 1024px) {
  .main {
    width: 410px;
    height: 375px;
  }
}
.box {
  background: #6186aa;
/*   background-image: linear-gradient(to top left, #9b59b6, #1abc9c); */
  background-size: 250%;
  width: 50px;
  height: 50px;
  float: left;
  margin: 10px 0 0 10px;
}

@media only screen and (min-width: 1024px) {
  .box {
    width: 70px;
    height: 70px;
  }
}

.play:hover {
  opacity: 0.7;
  cursor: pointer;
}

img {
  width: 100%;
  display: block;
}

/* STATUS bar */
#state {
  background: #6186aa;
/*   background-image: linear-gradient(to top left, #9b59b6, #1abc9c); */
  background-size: 250%;
  width: 230px;
  line-height: 25px;
  float: left;
  margin: 10px 0 0 10px;
  padding: 0 10px;
  color: white;
  font-size: 16px;
}
@media only screen and (min-width: 768px) {
  #state {
    width: 290px;
  }
}
@media only screen and (min-width: 1024px) {
  #state {
    width: 390px;
    line-height: 35px;
  }
}
#time {
  float: left;
}
#time::after {
  content: " sec";
}
#score {
  float: right;
}
#score::after {
  content: " points";
}
.hidden {
  display: none !important;
}
.show {
  display: block;
}
.outlined {
  outline: solid 2px #34495e;
  background: #9b59b6;
}
.meter {
	position: relative;
	height: 1.5em;
	width: 90%;
	background-color: gray;
	text-align: center;
}
.bar {
	position: absolute;
	left: 0;
	top: 0;
	height: 1.5em;
	background-color: red;
}
/*hangman game*/
main .alphabet span {
  border: solid 1px;
  /*   padding: 2px 5px; */
  margin: 4px 2px;
  width: 40px;
  height: 40px;
  line-height: 40px;
  text-align: center;
  display: inline-block;
}
.green2 {
/*   background: #43a047; */
  background: white;
  color: black;
/*   border-color: #43a047 !important; */
}
.red2{
/*   background: #e53935; */
  background: black;
  color: black;
/*   border-color: #e53935 !important; */
}
main .alphabet span:not(.green):not(.red):hover {
  background: white;
  cursor: pointer;
}
main .word {
  margin-bottom: 20px;
  font-size: 28px;
  font-transform: capitalize;
}
.word > span {
  display: inline-block;
  margin: 10px;
  width: 30px;
  text-align: center;
  border-bottom: solid 2px black;
  color: transparent;
}
.word > span.found {
  color: black;
}</style><script role="script" id="twine-user-script" type="text/twine-javascript">/* twine-user-script #1: "user.min.js" */
"use strict";
/**
* a class to provide methods to work with PC & NPC
*/

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _get(target, property, receiver) { if (typeof Reflect !== "undefined" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }

function _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === "undefined" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

var Character = /*#__PURE__*/function () {
  _createClass(Character, null, [{
    key: "defaultData",
    value: function defaultData() {
      return {
        id: '',
        name: '',
        faction: 'Enemy',
        location: "Home",
        XP: 0,
        //this is the XP you have earned but not yet spent
        level: 0,
        unspentStat: 0,
        //on level up you get Stat-points to distribute
        inv: [],
        //inventory data, needs to be mapped to Inventory-Instance
        wardrobe: [],
        //separate wardobe data, needs to be mapped to outfit-Instance
        outfit: [],
        // needs to be mapped to outfit-Instance
        stats: [],
        effects: [],
        rel: [],
        skills: []
      };
    }
  }]);

  function Character(externlist) {
    _classCallCheck(this, Character);

    this._data = externlist ? externlist : Character.defaultData();
    this.Outfit = new Outfit(this._data.outfit);
    this.Outfit._parent = window.gm.util.refToParent(this);
    this.Inv = new Inventory(this._data.inv);
    this.Inv._parent = window.gm.util.refToParent(this);
    this.Wardrobe = new Inventory(this._data.wardrobe);
    this.Wardrobe._parent = window.gm.util.refToParent(this);
    this.Stats = new StatsDictionary(this._data.stats);
    this.Stats._parent = window.gm.util.refToParent(this);
    this.Effects = new Effects(this._data.effects);
    this.Effects._parent = window.gm.util.refToParent(this);
    this.Rel = new StatsDictionary(this._data.rel); //Todo Relation similiar to stats?

    this.Rel._parent = window.gm.util.refToParent(this);
    this.Skills = new Inventory(this._data.skills);
    this.Skills._parent = window.gm.util.refToParent(this); //create basic stats

    stHealth.setup(this.Stats, 10, 10), stEnergy.setup(this.Stats, 30, 30), stWill.setup(this.Stats, 0, 0);

    var _iterator = _createForOfIteratorHelper(window.gm.combat.TypesDamage),
        _step;

    try {
      for (_iterator.s(); !(_step = _iterator.n()).done;) {
        el = _step.value;
        stResistance.setup(this.Stats, 0, el.id);
        stArmor.setup(this.Stats, 0, el.id);
      }
    } catch (err) {
      _iterator.e(err);
    } finally {
      _iterator.f();
    }

    stAgility.setup(this.Stats, 10, 100), stIntelligence.setup(this.Stats, 10, 100), stLuck.setup(this.Stats, 10, 100);
    stCharisma.setup(this.Stats, 10, 100), stPerception.setup(this.Stats, 10, 100), stStrength.setup(this.Stats, 10, 100), stEndurance.setup(this.Stats, 10, 100);
    stCorruption.setup(this.Stats, 0, 50), stArousal.setup(this.Stats, 1, 100);

    var _iterator2 = _createForOfIteratorHelper(stFetish.listFetish()),
        _step2;

    try {
      for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {
        var name = _step2.value;
        stFetish.setup(this.Stats, 0, 10, name);
      }
    } catch (err) {
      _iterator2.e(err);
    } finally {
      _iterator2.f();
    }

    this.Skills.addItem(new SkillUseItem());
    this.Skills.addItem(new SkillStruggle());
    this.Skills.addItem(new SkillAttack());
    this.Skills.addItem(new SkillStun());
    this.Skills.addItem(new SkillHeal());
    this.Skills.addItem(new SkillTease());
    this.Skills.addItem(new SkillFlee()), this.Skills.addItem(new SkillSubmit());
    window.storage.registerConstructor(Character);
  }

  _createClass(Character, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("Character", this);
    }
  }, {
    key: "addXP",
    value: function addXP(XP) {
      this._data.XP += XP;
    }
    /*
     * upgrade level by 1;this will increase level even if not enough XP !
    */

  }, {
    key: "levelUp",
    value: function levelUp() {
      var add = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;
      if (add < 1) return;
      var reqXP = Character.calcLevelToXP(this._data.level + add) - Character.calcLevelToXP(this._data.level);
      this._data.XP -= reqXP; //calculate requires XP and subtract from already gained

      if (this._data.XP < 0) this._data.XP = 0;
      this._data.level += add;
      this._data.unspentStat += add * 5; //todo 5pt Stat per Level?
    } //overwrite this to define the wheighting for autoLeveling
    //returns an array of objects with "id" matching the statname and "wgt" as a number that defines the relativ wheight (f.e. if 1 stat should be 50% more then other set this to 20 and all other to 10)

  }, {
    key: "autolevelWheight",
    value: function autolevelWheight() {
      return [{
        id: "strength",
        wgt: 10
      }, {
        id: "agility",
        wgt: 11
      }, {
        id: "intelligence",
        wgt: 10
      }, {
        id: "luck",
        wgt: 8
      }, {
        id: "charisma",
        wgt: 8
      }, {
        id: "perception",
        wgt: 8
      }, {
        id: "endurance",
        wgt: 9
      }];
    } // this is called for NPC to automatically spent XP and distribute stat-points according to autolevelWheight-property

  }, {
    key: "autoLeveling",
    value: function autoLeveling() {
      var add = Character.calcXPToLevel(this._data.XP, this._data.level) - this._data.level;

      this.levelUp(add);
      var weight = this.autolevelWheight();

      var sort = function sort(a, b) {
        return b.new - a.new;
      };

      while (this._data.unspentStat > 0) {
        //get the actual stats; immagine wgt as the goal-shape how the values are set at a certain level 
        var sumC = 0,
            sumG = 0;

        var _iterator3 = _createForOfIteratorHelper(weight),
            _step3;

        try {
          for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {
            el = _step3.value;
            el.value = this.Stats.get(el.id).base;
            sumC += el.value, sumG += el.wgt;
          } //calculate the difference between current value and goal defined by playstyle

        } catch (err) {
          _iterator3.e(err);
        } finally {
          _iterator3.f();
        }

        var _iterator4 = _createForOfIteratorHelper(weight),
            _step4;

        try {
          for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {
            el = _step4.value;
            //new is the difference in points; +1 to force distribution if the current matches the goal
            el.new = Math.ceil((el.wgt / sumG - el.value / sumC) * sumC) + 1;
            if (el.new <= 0) el.new = 1;
          } //and distribute pt

        } catch (err) {
          _iterator4.e(err);
        } finally {
          _iterator4.f();
        }

        weight = weight.sort(sort);

        var _iterator5 = _createForOfIteratorHelper(weight),
            _step5;

        try {
          for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {
            el = _step5.value;
            var x = Math.floor(el.new);
            x = Math.min(this._data.unspentStat, 2, x);
            this.Stats.increment(el.id, x);
            this._data.unspentStat -= x;
          }
        } catch (err) {
          _iterator5.e(err);
        } finally {
          _iterator5.f();
        }
      }
    }
  }, {
    key: "isDead",
    value: function isDead() {
      return this.Stats.get('health').value <= 0;
    }
    /** 
    * "naked" - naked
    * "primal" - cover genitals 
    * "civil" - wears some trousers,footwear and torsocovers
    * "formal" - ...wears underwear too
    */

  }, {
    key: "clothLevel",
    value: function clothLevel() {
      //TODO
      var uwOK = false,
          civOK = false;

      if (this.Outfit.getItemId(window.gm.OutfitSlotLib.uHips) !== '' && this.Outfit.getItemId(window.gm.OutfitSlotLib.uBreast) !== '') {
        uwOK = true;
      }

      if (this.Outfit.getItemId(window.gm.OutfitSlotLib.Hips) !== '' && this.Outfit.getItemId(window.gm.OutfitSlotLib.Breast) !== '' && this.Outfit.getItemId(window.gm.OutfitSlotLib.Feet) !== '') {
        civOK = true;
      }

      if (uwOK && civOK) return "formal";
      if (civOK) return "civil";
      if (uwOK) return "primal";
      return 'naked';
    }
  }, {
    key: "health",
    value: function health() {
      return {
        value: this.Stats.get('health').value,
        max: this.Stats.get('healthMax').value,
        min: 0
      };
    }
  }, {
    key: "energy",
    value: function energy() {
      return {
        value: this.Stats.get('energy').value,
        max: this.Stats.get('energyMax').value,
        min: 0
      };
    }
  }, {
    key: "will",
    value: function will() {
      return {
        value: this.Stats.get('will').value,
        max: this.Stats.get('willMax').value,
        min: 0
      };
    }
  }, {
    key: "sleep",
    value: function sleep() {
      var until = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 700;

      var _window$gm$forwardTim = window.gm.forwardTime(until),
          msg = _window$gm$forwardTim.msg,
          delta = _window$gm$forwardTim.delta;

      var regen = delta >= 360 ? 9999 : parseInt(delta / 60 * 15); //todo scaling of regeneration

      this.Stats.increment('health', regen);
      this.Stats.increment('energy', regen);
      this.Stats.increment('will', regen);

      if (delta > 360) {
        this.Effects.addItem(effNotTired.name, new effNotTired());
      }
    }
  }, {
    key: "addEffect",
    value: function addEffect(id, effect) {
      this.Effects.addItem(id, effect);
    } //helper function to change Relation 

  }, {
    key: "gainRelation",
    value: function gainRelation(char, val) {
      var _idx = this.Rel.findItemSlot(char);

      if (_idx < 0) {
        var _rel = stRelation.setup(this.Rel, val, 100, char);
      } else {
        this.Rel.increment(char, val);
      }
    }
    /**
     * helper function to handle wardrobe (not outfit!)/inventory properly; 
     * if amount<0 remove itme, else add
     */

  }, {
    key: "changeInventory",
    value: function changeInventory(item, amount) {
      if (item.slotUse && !item.hasTag('weapon')) {
        //equipment goes into wardrobe except weapons
        if (amount < 0) this.Wardrobe.removeItem(item, true); //todo force?
        else this.Wardrobe.addItem(item.id, amount);
      } else {
        if (amount < 0) this.Inv.addItem(item, amount);else this.Inv.removeItem(item.id, -1 * amount);
      }
    } //combat related

  }, {
    key: "_canAct",
    value: function _canAct() {
      //todo even if stunned we should be able to struggle
      var result = {
        OK: true,
        msg: ''
      };

      if (this.Effects.findEffect("effStunned").length > 0) {
        //findItemSlot annot use since there might be different effect ids
        result.OK = false;
        result.msg = this.name + " is stunned and cannot react.";
        return result;
      }

      return result;
    } //combat related; return a msg describing the state of the character
    //"Wolf is currently entangled by vines."
    //"You have your towershield raised to guard against damage. Your mana is drained by an opponents spell."

  }, {
    key: "_stateDesc",
    value: function _stateDesc() {
      var result = {
        OK: true,
        msg: ''
      };
      var isPlayer = window.gm.player.id === this.id;

      for (var list = this.Effects.getAllIds(), i = list.length - 1; i >= 0; i -= 1) {
        if (list[i] === "effStunned") {
          result.msg = "$[I]$ $[am]$ stunned and cant do a thing.";
        }
      }

      result.msg = window.gm.util.descFixer(this)(result.msg);
      return result;
    }
  }, {
    key: "getPenis",
    value: function getPenis() {
      var penis = this.Outfit.getItemForSlot(window.gm.OutfitSlotLib.bPenis);
      return penis;
    }
  }, {
    key: "getVagina",
    value: function getVagina() {
      var vulva = this.Outfit.getItemForSlot(window.gm.OutfitSlotLib.bVulva);
      return vulva;
    }
  }, {
    key: "id",

    /**
     * id of char
     */
    get: function get() {
      return this._data.id;
    },
    set: function set(id) {
      this._data.id = id;
    }
  }, {
    key: "name",
    get: function get() {
      return this._data.name;
    },
    set: function set(name) {
      this._data.name = name;
    }
  }, {
    key: "faction",
    get: function get() {
      return this._data.faction;
    },
    set: function set(name) {
      this._data.faction = name;
    }
  }, {
    key: "location",
    get: function get() {
      return this._data.location;
    },
    set: function set(name) {
      this._data.location = name;
    }
  }, {
    key: "level",
    get: function get() {
      return this._data.level;
    }
  }, {
    key: "canLevelUp",
    get: function get() {
      var next = Character.calcXPToLevel(this._data.XP, this._data.level);
      return next !== this._data.level;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      var _x = window.storage.Generic_fromJSON(Character, value.data); //need to recreate parent links


      _x.Effects._relinkItems();

      _x.Stats._relinkItems();

      _x.Inv._relinkItems();

      _x.Outfit._relinkItems();

      _x.Wardrobe._relinkItems();

      _x.Rel._relinkItems();

      _x.Skills._relinkItems();

      return _x;
    }
  }, {
    key: "calcXPToLevel",

    /**
    * calculates how many levels you can upgrade
    * @param {int} XP available
    * @returns {inz} level from
    */
    value: function calcXPToLevel(XP) {
      var fromLvl = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
      var XP2 = Character.calcLevelToXP(fromLvl);
      return Math.floor((-1 + Math.sqrt(1 + (XP + XP2) * 4 / 50)) / 2);
    }
  }, {
    key: "calcLevelToXP",
    value: function calcLevelToXP(lvl) {
      return 100 * lvl * (lvl + 1) / 2; //Gauss-Sum
    }
  }]);

  return Character;
}();

"use strict";
/* bundles some operations related to combat */


window.gm = window.gm || {};
window.gm.combat = window.gm.combat || {};

var CombatSetup = /*#__PURE__*/function () {
  function CombatSetup() {
    _classCallCheck(this, CombatSetup);

    this.EnemyFirst = false;
    this.EnemyFunc = null; //a ctor of Mob

    this.Location = ''; //your actual location-name

    this.scenePic = ''; //bg-image to use
    //the following function should get reassigned; 
    //they should return a message what will happen next and provide a link to passage to follow f.e. return to window.gm.player.location

    this.onStart = function () {
      return 'A ' + window.story.state.combat.enemyParty[0].name + ' appears !' + window.gm.printPassageLink('Engage', 'EncounterStartTurn');
    };

    this.onDefeat = function () {
      return 'You are defeated.</br>' + window.gm.printLink('Next', 'window.gm.postDefeat()');
    }; //...dont forget to fetchLoot


    this.onVictory = function () {
      return 'You defeated the foe.</br> ' + this.fetchLoot() + '</br>' + window.gm.printLink('Next', 'window.gm.postVictory()');
    };

    this.onFlee = function () {
      return 'You retreat hastily.</br>' + window.gm.printLink('Next', 'window.gm.postVictory()');
    };

    this.onSubmit = function () {
      return 'You submit to the foe.</br>' + window.gm.printLink('Next', 'window.gm.postDefeat()');
    }; //if you override onMoveSelect (like the others), you can jump out of battle, show some scene and return to battle
    //- do not modify window.gm.player.location
    //- disable save
    //- jump back to EncounterStartTurn
    //- the function is called before every move and will jump back there; you need to make sure that the scene doesnt trigger again 
    //- if for some reason you want to leave battle, call window.gm.Encounter.endCombat() to cleanup


    this.onMoveSelect = null;
  } //setup encounter; this calls the Encounter-passage !


  _createClass(CombatSetup, [{
    key: "initCombat",
    value: function initCombat() {
      var s = window.story.state;
      s.combat.enemyParty = this.EnemyFunc();
      s.combat.playerParty = [];

      var _iterator6 = _createForOfIteratorHelper(s._gm.playerParty),
          _step6;

      try {
        for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {
          var _el2 = _step6.value;
          s.combat.playerParty.push(s[_el2]);
        }
      } catch (err) {
        _iterator6.e(err);
      } finally {
        _iterator6.f();
      }

      s.combat.turnStack = [];
      s.combat.actor = s.combat.target = s.combat.action = null;
      s.combat.location = this.location;
      s.combat.scenePic = this.scenePic;
      s.combat.playerFleeing = false;
      s.combat.playerSubmitting = false;
      s.combat.inCombat = true;
      s.combat.enemyFirst = this.EnemyFirst;
      s.combat.turnCount = 0;
      this.next = this.battleInit;
      this.msg = '';
      window.story.show("EncounterStartTurn");
    } //spawns additional enemys or friends
    //called by effCallHelp at begin of turn

  }, {
    key: "spawnChar",
    value: function spawnChar(item, party, amount) {
      var s = window.story.state;
      var mob = window.gm.Mobs[item]();
      mob.faction = party;
      var list = s.combat.enemyParty.concat(s.combat.playerParty);
      var uid = 1;

      var _iterator7 = _createForOfIteratorHelper(list),
          _step7;

      try {
        for (_iterator7.s(); !(_step7 = _iterator7.n()).done;) {
          el = _step7.value;

          if (mob.__proto__.isPrototypeOf(el)) {
            //expecting Mole#2
            uid = Math.max(uid, parseInt(el.name.split('#')[1], 10) + 1);
          }

          ;
        }
      } catch (err) {
        _iterator7.e(err);
      } finally {
        _iterator7.f();
      }

      mob.name = mob.name + "#" + uid.toString(); //TODO need unique name !!

      if (party === 'Player') {
        mob.calcCombatMove = null; //hack to disable AI  todo

        s.combat.playerParty.push(mob);
      } else {
        s.combat.enemyParty.push(mob);
      }
    }
  }, {
    key: "hideCombatOption",
    value: function hideCombatOption() {
      document.querySelector("#choice").remove();
    } //creates a list of active effects for combat display

  }, {
    key: "printCombatEffects",
    value: function printCombatEffects(char) {
      var list = [];

      if (char.isDead()) {
        //if char is dead print this instead other effects; effects also get not updated when dead??
        list.push('knocked out');
      } else {
        var effects = char.Effects.getAllIds();

        for (var i = 0; i < effects.length; i++) {
          var effect = char.Effects.get(effects[i]);

          if (effect.onCombatEnd !== null && effect.onCombatEnd !== undefined) {
            list.push(effect.shortDesc);
          }
        }
      }

      return list.reduce(function (sum, current) {
        return sum + current + ', ';
      }, '');
    }
  }, {
    key: "bargraph",
    value: function bargraph(value, max, color) {
      var msg = '';
      var rel = value / max * 100;
      msg = '<div class="progress-bar-striped"><div style="background-color:' + color + '; width: ' + rel.toString() + '%;"><p>' + value.toString() + '/' + max.toString() + '</p></div></div>';
      return msg; //todo bargraph animation doesnt work because the whole page is reloaded instead of just width change
    }
  }, {
    key: "statsline",
    value: function statsline(whom, mark) {
      var msg = '';
      if (mark) msg = "<td style=\"border-style:dotted;\">";else msg = "<td>";
      msg += whom.name + " Lv" + whom.level + "</td><td>" + this.bargraph(whom.health().value, whom.health().max, "lightcoral") + "</td><td>" + this.bargraph(whom.Stats.get("arousal").value, whom.Stats.get("arousalMax").value, "lightpink") + "</td><td>" + this.bargraph(whom.energy().value, whom.energy().max, "lightyellow") + "</td><td>" + this.bargraph(whom.Stats.get("will").value, whom.Stats.get("willMax").value, "lightblue") + "</td>";
      return msg;
    } //prints a table with all player/enemy data

  }, {
    key: "printStats",
    value: function printStats() {
      var s = window.story.state;
      var players = s.combat.playerParty;
      var enemys = s.combat.enemyParty;
      /*
                  Health  Arousal          Health  Arousal 
          player1 10/20   10/20      Ork1  10/10   10/10
                  Stunned
          player2 50/100  10/20      Ork2  20/20   10/100
      */

      var elmt = '<table id=\"combatstats\"><tbody>';
      elmt += "<tr><th>   </th><th>Player</th><th>Health</th><th>Arousal</th><th>Energy</th><th>Will</th><th>   </th><th>Enemys</th><th>Health</th><th>Arousal</th><th>Energy</th><th>Will</th></tr>";

      for (var i = 0; i < players.length || i < enemys.length; i++) {
        elmt += "<tr>";

        if (i < players.length) {
          elmt += "<td></td>" + this.statsline(players[i], s.combat.actor && s.combat.actor.name == players[i].name);
        } else {
          elmt += "<td></td><td></td><td></td><td></td><td></td><td></td>";
        }

        if (i < enemys.length) {
          elmt += "<td></td>" + this.statsline(enemys[i], s.combat.actor == enemys[i]);
        } else {
          elmt += "<tr><td></td><td></td><td></td><td></td><td></td><td></td>";
        }

        elmt += "</tr><tr>";

        if (i < players.length) {
          //effects as additional row
          elmt += "<td></td><td></td><td colspan='3' style=\"font-size:smaller\">" + window.gm.Encounter.printCombatEffects(players[i]) + "</td>";
        } else {
          elmt += "<td></td><td></td><td></td><td></td><td></td><td></td>";
        }

        if (i < enemys.length) {
          elmt += "<td></td><td></td><td colspan='3' style=\"font-size:smaller\">" + window.gm.Encounter.printCombatEffects(enemys[i]) + "</td>";
        } else {
          elmt += "<td></td><td></td><td></td><td></td><td></td><td></td>";
        }

        elmt += "</tr>";
      }

      elmt += '</tbody></table>';
      return elmt;
    } //creates buttons for skills of current actor

  }, {
    key: "printSkillList",
    value: function printSkillList() {
      var s = window.story.state;

      var canAct = s.combat.actor._canAct();

      if (canAct.OK === true) {
        var skillIds = s.combat.actor.Skills.getAllIds(); //todo how to sort the list in a useful manner?

        for (var i = 0; i < skillIds.length; i++) {
          var entry = document.createElement('button');
          var res; //entry.href='javascript:void(0)';

          entry.addEventListener("click", function (me, target) {
            return window.gm.Encounter._postSkillSelect.bind(me, target);
          }(this, skillIds[i]));
          entry.textContent = s.combat.actor.Skills.getItem(skillIds[i]).name;
          res = s.combat.actor.Skills.getItem(skillIds[i]).isEnabled();
          entry.disabled = !res.OK;
          entry.Title = res.msg; //Todo use pointevent+toasty?

          $("div#choice")[0].appendChild(entry); // <- requires this node in html
        }
      } else {
        //cannot do a thing
        var entry = document.createElement('p');
        entry.textContent = canAct.msg;
        $("div#choice")[0].appendChild(entry);
      }

      var entry = document.createElement('button'); //entry.href='javascript:void(0)';

      entry.addEventListener('click', function (me) {
        return window.gm.Encounter._postSkillAbort.bind(me);
      }(this));
      entry.textContent = "Do nothing";
      $("div#choice")[0].appendChild(entry);
    }
  }, {
    key: "_postSkillAbort",
    value: function _postSkillAbort() {
      window.story.state.combat.action = null;
      window.gm.Encounter.next = window.gm.Encounter.checkDefeat;
      window.story.show('EncounterStartTurn');
    }
  }, {
    key: "_postSkillSelect",
    value: function _postSkillSelect(id) {
      window.story.state.combat.action = id;

      if (id === 'UseItem') {
        window.gm.Encounter.next = window.gm.Encounter.selectItem;
      } else {
        window.gm.Encounter.next = window.gm.Encounter.selectTarget;
      }

      window.story.show('EncounterStartTurn');
    }
  }, {
    key: "printTargetList",
    value: function printTargetList() {
      var s = window.story.state;
      var skill = s.combat.actor.Skills.getItem(s.combat.action);
      var all = s.combat.playerParty.concat(s.combat.enemyParty);
      var targets = [];

      var _iterator8 = _createForOfIteratorHelper(all),
          _step8;

      try {
        for (_iterator8.s(); !(_step8 = _iterator8.n()).done;) {
          el = _step8.value;
          targets.push([el]); //need [[],[]]
        }
      } catch (err) {
        _iterator8.e(err);
      } finally {
        _iterator8.f();
      }

      var info = document.createElement('p');
      info.textContent = skill.desc;
      $("div#choice")[0].appendChild(info);
      targets = skill.targetFilter(targets);

      for (var i = 0; i < targets.length; i++) {
        var entry = document.createElement('a');
        entry.href = 'javascript:void(0)';
        entry.addEventListener("click", function (me, target) {
          return window.gm.Encounter._postTargetSelect.bind(me, target);
        }(this, targets[i])); //if single-target, use name from mob, for multitarget we expect a name attribute to the list

        entry.textContent = targets[i].length > 1 ? targets[i].name : targets[i][0].name; //entry.disabled=this.buttons[y*5+x].disabled;

        $("div#choice")[0].appendChild(entry); // <- requires this node in html
      }

      var entry = document.createElement('a');
      entry.href = 'javascript:void(0)';
      entry.addEventListener('click', function (me) {
        return window.gm.Encounter._postTargetAbort.bind(me);
      }(this));
      entry.textContent = "back";
      $("div#choice")[0].appendChild(entry);
    }
  }, {
    key: "_postTargetAbort",
    value: function _postTargetAbort() {
      window.story.state.combat.action = null;
      window.gm.Encounter.next = window.gm.Encounter.selectMove;
      window.story.show('EncounterStartTurn');
    }
  }, {
    key: "_postTargetSelect",
    value: function _postTargetSelect(target) {
      this.hideCombatOption();
      window.story.state.combat.target = target; //(target.length)? target : [target] ;

      window.gm.Encounter.next = window.gm.Encounter.execMove;
      window.story.show('EncounterStartTurn');
    }
  }, {
    key: "printItemList",
    value: function printItemList() {
      var s = window.story.state;
      var inv = s.combat.actor.Inv;
      var maxSlots = inv.count();

      for (var i = 0; i < maxSlots; i++) {
        var id = inv.getItemId(i);

        var _count = inv.countItem(id); //if(useOn===null) useOn=s.combat.actor;


        var useable = inv.usable(id);

        if (_count > 0 && useable.OK) {
          var _entry = document.createElement('a');

          _entry.href = 'javascript:void(0)';

          var foo = function (id, carrier) {
            this._postItemSelect(id); //let _res=carrier.Inv.use(id); window.gm.refreshAllPanel();window.gm.printOutput(_res.msg);

          }.bind(this, id);

          _entry.addEventListener("click", foo);

          _entry.textContent = id;
          $("div#choice")[0].appendChild(_entry); // <- requires this node in html
        }
      }

      var entry = document.createElement('a');
      entry.href = 'javascript:void(0)';
      entry.addEventListener('click', function (me) {
        return window.gm.Encounter._postTargetAbort.bind(me);
      }(this));
      entry.textContent = "back";
      $("div#choice")[0].appendChild(entry);
    }
  }, {
    key: "_postItemSelect",
    value: function _postItemSelect(id) {
      var s = window.story.state;
      this.hideCombatOption();
      s.combat.actor.Skills.getItem(s.combat.action).item = id;
      window.gm.Encounter.next = window.gm.Encounter.selectTarget;
      window.story.show('EncounterStartTurn');
    } //if switching to Status panel and back this will redraw screen and call this this.next; to avoid this set next only in clickhandler 

  }, {
    key: "printNextLink",
    value: function printNextLink(nextState) {
      var label = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : "Next";
      var entry = document.createElement('a');
      entry.href = 'javascript:void(0)';
      entry.addEventListener('click', function (me, nextState) {
        return function () {
          window.gm.Encounter.next = nextState;
          window.story.show('EncounterStartTurn');
        };
      }(this, nextState));
      entry.textContent = label;
      $("div#choice2")[0].appendChild(entry);
    } //executes a combat-cmd for player/enemy

  }, {
    key: "execCombatCmd",
    value: function execCombatCmd(move) {
      var s = window.story.state;
      var result = move(s.combat.actor, s.combat.target);
      /*s.combat.enemyTurn =!s.combat.enemyTurn;  //toggle whos turn
      if(!(s.combat.enemyTurn ^ s.combat.enemyFirst)) s.combat.newTurn = false;
      */

      return result;
    }
  }, {
    key: "startRound",
    value: function startRound() {
      var s = window.story.state;
      s.combat.turnCount += 1;
      var list = s.combat.allChars = s.combat.enemyParty.concat(s.combat.playerParty); //update combateffects

      for (var k = 0; k < list.length; k++) {
        var effects = list[k].Effects.getAllIds();

        for (var i = 0; i < effects.length; i++) {
          var effect = list[k].Effects.get(effects[i]);

          if (effect.onCombatEnd !== null && effect.onCombatEnd !== undefined) {
            //typeof effect === CombatEffect doesnt work? so we check presencse of attribut
            effect.onTurnStart();
          }
        }
      }
    }
  }, {
    key: "endCombat",
    value: function endCombat() {
      var s = window.story.state;
      s.combat.inCombat = false; //remove combateffects

      var list = s.combat.enemyParty.concat(s.combat.playerParty);

      for (var k = 0; k < list.length; k++) {
        var effects = list[k].Effects.getAllIds();

        for (var i = 0; i < effects.length; i++) {
          var effect = list[k].Effects.get(effects[i]);

          if (effect.onCombatEnd !== null && effect.onCombatEnd !== undefined) {
            effect.onCombatEnd();
          }
        }
      }
    }
    /**
     * call this onVictory to grab loot & XP from Mobs
     */

  }, {
    key: "fetchLoot",
    value: function fetchLoot() {
      //if you are victorious: grant XP & transfer Loot to player 
      var s = window.story.state;
      var msg = '';
      var XP = 0;
      var maxLevel = 0;

      var _iterator9 = _createForOfIteratorHelper(s.combat.playerParty),
          _step9;

      try {
        for (_iterator9.s(); !(_step9 = _iterator9.n()).done;) {
          el = _step9.value;
          maxLevel = Math.max(maxLevel, el.level);
        }
      } catch (err) {
        _iterator9.e(err);
      } finally {
        _iterator9.f();
      }

      var _iterator10 = _createForOfIteratorHelper(s.combat.enemyParty),
          _step10;

      try {
        for (_iterator10.s(); !(_step10 = _iterator10.n()).done;) {
          el = _step10.value;

          for (var i = el.loot.length - 1; i >= 0; i--) {
            msg += el.loot[i].amount + 'x ' + el.loot[i].id + ' ';
            window.gm.player.changeInventory(el.loot[i].id, el.loot[i].amount);
          }

          XP += Math.floor(el.baseXPReward * Math.min(3, Math.max(0, 1 + (el.level - maxLevel) * 0.25)));
        }
      } catch (err) {
        _iterator10.e(err);
      } finally {
        _iterator10.f();
      }

      msg = '</br>You got some loot: ' + window.gm.util.formatNumber(XP, 0) + 'XP ' + msg + '</br>';

      var _iterator11 = _createForOfIteratorHelper(s.combat.playerParty),
          _step11;

      try {
        for (_iterator11.s(); !(_step11 = _iterator11.n()).done;) {
          el = _step11.value;
          el.addXP(XP); //all get the same?
        }
      } catch (err) {
        _iterator11.e(err);
      } finally {
        _iterator11.f();
      }

      return msg;
    }
  }, {
    key: "isAllDefeated",
    value: function isAllDefeated(party) {
      for (var i = 0; i < party.length; i++) {
        if (!party[i].isDead()) return false;
      }

      return true;
    }
  }, {
    key: "calcTurnOrder",
    value: function calcTurnOrder() {
      var s = window.story.state; //todo sort by agility
      //todo turnorder can be intermixed?

      if (s.combat.enemyFirst) {
        s.combat.turnStack = s.combat.enemyParty.concat(s.combat.playerParty);
      } else {
        s.combat.turnStack = s.combat.playerParty.concat(s.combat.enemyParty);
      }
    } /////////////////////  State Machine /////////////////////
    //

  }, {
    key: "battleInit",
    value: function battleInit() {
      var result = {
        OK: false,
        msg: ''
      };
      result.OK = true, result.msg = this.onStart();
      this.next = this.preTurn;
      return result;
    }
  }, {
    key: "preTurn",
    value: function preTurn() {
      var result = {
        OK: false,
        msg: ''
      };
      var s = window.story.state;
      s.combat.turnCount += 1;
      var list = s.combat.enemyParty.concat(s.combat.playerParty); //update combateffects

      for (var k = list.length - 1; k >= 0; k--) {
        if (list[k].isDead()) {
          continue;
        }

        var effects = list[k].Effects.getAllIds();

        for (var i = 0; i < effects.length; i++) {
          var effect = list[k].Effects.get(effects[i]);

          if (effect.onCombatEnd !== null && effect.onCombatEnd !== undefined) {
            //typeof effect === CombatEffect doesnt work? so we check presense of attribut
            effect.onTurnStart();
          }
        }
      } //calculate turnorder


      this.calcTurnOrder();
      this.next = this.checkDefeat;
      return result;
    }
  }, {
    key: "checkDefeat",
    value: function checkDefeat() {
      //check if party is defeated
      var result = {
        OK: false,
        msg: ''
      };
      this.msg = '';
      var s = window.story.state;

      if (s.combat.playerFleeing === true) {
        this.next = this.postBattle;
        return result;
      } else if (s.combat.playerSubmitting === true) {
        this.next = this.postBattle;
        return result;
      } else if (this.isAllDefeated(s.combat.enemyParty)) {
        this.next = this.postBattle;
        return result;
      } else if (this.isAllDefeated(s.combat.playerParty)) {
        this.next = this.postBattle;
        return result;
      }

      this.next = this.selectChar;
      return result;
    } //select the next char to move

  }, {
    key: "selectChar",
    value: function selectChar() {
      var s = window.story.state;
      var result = {
        OK: false,
        msg: ''
      };

      if (s.combat.turnStack.length > 0) {
        //switch to next char
        s.combat.actor = s.combat.turnStack.shift(); //actual move = 0

        s.combat.action = null;
        this.next = this.selectMove;
      } else {
        //next turn after all done
        this.next = this.preTurn;
      }

      return result;
    }
  }, {
    key: "selectMove",
    value: function selectMove() {
      var s = window.story.state;
      var result = {
        OK: false,
        msg: ''
      };

      if (this.onMoveSelect != null) {
        result = this.onMoveSelect();
        if (result.OK) return result;
      }

      if (s.combat.actor.isDead()) {
        //skip char if already dead
        this.next = this.selectChar;
        return result;
      }

      var stateDesc = s.combat.actor._stateDesc();

      var canAct = s.combat.actor._canAct();

      if (canAct.OK === false) {
        //skip char if not dead but incapaciated and show msg
        result.OK = true, result.msg = stateDesc.msg + "</br>" + canAct.msg;
        this.next = this.checkDefeat;
        this.printNextLink(this.checkDefeat);
        return result;
      } else {
        if (s.combat.actor.isAIenabled && s.combat.actor.calcCombatMove) {
          //selected by AI
          result = s.combat.actor.calcCombatMove(window.story.state.combat.playerParty, window.story.state.combat.enemyParty);
          window.story.state.combat.action = result.action;
          window.story.state.combat.target = result.target; //continue with execMove but memorize the moveselection message for display
          //this.printNextLink(this.execMove) 

          this.next = this.execMove;
          this.msg = result.msg;
          result.OK = false;
        } else {
          this.printSkillList();
          result.OK = true, result.msg = stateDesc.msg + "</br>Choose your action !</br>";
        }
      }

      return result;
    }
  }, {
    key: "selectItem",
    value: function selectItem() {
      //select Item from Inventory
      var s = window.story.state;
      var result = {
        OK: false,
        msg: ''
      };
      this.printItemList();
      result.OK = true, result.msg = "Choose item";
      return result;
    }
  }, {
    key: "selectTarget",
    value: function selectTarget() {
      //select target for choosen action
      var s = window.story.state;
      var result = {
        OK: false,
        msg: ''
      };
      this.printTargetList();
      result.OK = true, result.msg = "Choose target";
      return result;
    }
  }, {
    key: "execMove",
    value: function execMove() {
      var result = {
        OK: false,
        msg: ''
      };
      var s = window.story.state; //apply move; AI might not found a possible action

      if (s.combat.action !== null && s.combat.action !== '') {
        result.msg = s.combat.actor.Skills.getItem(s.combat.action).cast(s.combat.target).msg;
      }

      result.OK = true;
      this.printNextLink(this.checkDefeat); //todo continue automatically if next actor is AI

      return result;
    }
  }, {
    key: "postBattle",
    value: function postBattle() {
      this.next = null; //terminate SM

      var s = window.story.state;
      var result = {
        OK: false,
        msg: ''
      }; //check if battle end reason...

      if (s.combat.playerFleeing === true) {
        result.OK = true, result.msg = this.onFlee();
      } else if (s.combat.playerSubmitting === true) {
        result.OK = true, result.msg = this.onSubmit();
      } else if (this.isAllDefeated(s.combat.enemyParty)) {
        result.OK = true, result.msg = this.onVictory();
      } else if (this.isAllDefeated(s.combat.playerParty)) {
        result.OK = true, result.msg = this.onDefeat();
      }

      this.endCombat();
      return result;
    } //this runs the statemachine and is triggered by user input

  }, {
    key: "battle",
    value: function battle() {
      var result = {
        OK: false,
        msg: ''
      };

      while (this.next !== null && !result.OK) {
        //if result =true; user input required
        result = this.next();

        if (result.OK) {
          result.msg = this.msg + result.msg;
          return result;
        }
      }

      return result;
    }
  }]);

  return CombatSetup;
}(); //returns true if in combat


window.gm.combat.inCombat = function () {
  return window.story.state.combat.inCombat;
}; //calculates if target can evade the attack 

/*requires minimum Poise
Evasion depends on Agility & Endurance:
- mallus for heavy armor & weapon
- mallus for Effects like Prone, Frozen
- bonus for Skills: Flying, Dancer
Stunned/Bound Chars can not evade */
// on evasion returns false and a message


window.gm.combat.calcEvasion = function (attacker, target, attack) {
  var result = {
    OK: true,
    msg: ''
  };
  var rnd = window.gm.roll(1, 100);

  if (target.Effects.findItemSlot(effStunned.name) >= 0) {
    //todo chance to miss 
    result.OK = true;
    result.msg = target.name + ' is stunned and cannot evade. ';
    attack.crit = true; //when stunned always critical hit

    return result;
  } //todo chance depends on ?


  var lvlDiff = target.level - attacker.level;
  var chance = target.Stats.get("agility").value + target.Stats.get("perception").value;
  chance += lvlDiff * 4;
  window.gm.pushLog("evasion roll: ".concat(chance, " vs ").concat(rnd, " "), window.story.state._gm.dbgShowCombatRoll);

  if (chance > rnd) {
    result.OK = false;
    result.msg += 'Using agility, ' + target.name + ' was able to dodge the attack. ';
  }

  return result;
};
/*If evasion-roll fails, their is a chance that parry is rolled:
- consumes some poise
- parry only works for weapon of similiar size: a Zweihänder is to slow to parry a saber, a dagger is to light to deflect a club
- requires minimum weapon-skill (f.e. projectile deflection )
otherwise continue chain
parry-result depends on agility+perception
- bonus for skills
- bonus for some weapons
on critical fail- full damage, poise damage
on fail - full damage
on success no damage is taken (might consume weapon-stability)
if a critical is rolled, 50% of the attackers damage is reflected to him*/


window.gm.combat.calcParry = function (attacker, target, attack) {
  var result = {
    OK: true,
    msg: '',
    foo: null
  };

  var rnd = _.random(1, 100);

  if (target.Effects.findItemSlot(effStunned.name) >= 0) {
    result.OK = true;
    result.msg = target.name + ' is stunned and cannot parry or block. ';
    attack.crit = true; //when stunned always critical hit

    return result;
  } //todo block if has shield, parry if has weapon


  var lvlDiff = target.level - attacker.level;
  var chance = target.Stats.get("agility").value + target.Stats.get("endurance").value;
  chance += lvlDiff * 4;
  window.gm.pushLog("parry roll: ".concat(chance, " vs ").concat(rnd, " "), window.story.state._gm.dbgShowCombatRoll);

  if (chance > rnd && rnd < 10) {
    result.OK = false;

    if (rnd < 10) {
      result.msg = target.name + ' parried the attack and was even able to land a hit.'; //todo how to add textual variation based on used weapon and skill?

      attack.effects.push({
        target: attacker,
        eff: [effDamage.setup(5, "blunt")]
      }); //todo how much damage? 
    } else {
      result.msg = target.name + ' parried the attack.';
    }
  } else {
    result.OK = true;
  }

  return result;
};
/*if all else failed you have to absorb the hit:
DR = sum of armor (with individual skill-bonus) + magic armor
attack = weapon damage formula + weakness-bonus
attack increases on critical
hp-dmg = attack -DR but min.1 */


window.gm.combat.calcAbsorbOld = function (attacker, defender, attack) {
  var result = {
    OK: true,
    msg: '',
    foo: null
  };

  var rnd = _.random(1, 100);

  var def = defender.Stats.get('pDefense').value; //todo weakness bonus

  var dmg = Math.max(1, attack.value * (attack.crit ? 4 : 1) - def);
  window.gm.pushLog("absorb roll: ".concat(dmg, " vs ").concat(def, " "), window.story.state._gm.dbgShowCombatRoll);
  result.msg = defender.name + ' got hit by ' + attacker.name + ' and suffered ' + dmg + (attack.crit ? ' critical ' : '') + 'damage. ';
  attack.total = dmg;
  attack.effects.push({
    target: defender,
    eff: [effDamage.setup(attack.total, "blunt")]
  });
  return result;
};

window.gm.combat.calcAbsorb = function (attacker, defender, attack) {
  var result = {
    OK: true,
    msg: ''
  };

  var rnd = _.random(1, 100);

  if (attack.mod.onCrit.length > 0 && rnd < attack.mod.critChance) {
    //is critical
    result.msg = defender.name + ' got critical hit by ' + attacker.name;

    var _iterator12 = _createForOfIteratorHelper(attack.mod.onCrit),
        _step12;

    try {
      for (_iterator12.s(); !(_step12 = _iterator12.n()).done;) {
        el = _step12.value;
        attack.effects.push({
          target: el.target,
          eff: el.eff
        }); //el.eff is []
      }
    } catch (err) {
      _iterator12.e(err);
    } finally {
      _iterator12.f();
    }
  } else {
    result.msg = defender.name + ' got hit by ' + attacker.name;

    var _iterator13 = _createForOfIteratorHelper(attack.mod.onHit),
        _step13;

    try {
      for (_iterator13.s(); !(_step13 = _iterator13.n()).done;) {
        el = _step13.value;
        attack.effects.push({
          target: el.target,
          eff: el.eff
        });
      }
    } catch (err) {
      _iterator13.e(err);
    } finally {
      _iterator13.f();
    }
  }

  return result;
};
/**
 * damage types
 */


window.gm.combat.TypesDamage = [{
  id: 'blunt'
}, {
  id: 'slash'
}, {
  id: 'pierce'
}, {
  id: 'tease'
}, {
  id: 'spark'
}, {
  id: 'ice'
}, {
  id: 'fire'
}, {
  id: 'poison'
}]; //object to store attack-data

window.gm.combat.defaultAttackData = function () {
  return {
    value: 0,
    total: 0,
    crit: false,
    effects: []
  };
}; // calculates the damage of an physical attack


window.gm.combat.calcAttack = function (attacker, defender, attack) {
  var result = {
    OK: false,
    msg: ''
  };
  window.gm.combat.scaleEffect(attack); //check if target can evade

  result = window.gm.combat.calcEvasion(attacker, defender, attack);

  if (result.OK === false) {
    return result;
  }

  var _tmp = result.msg; //check if target can block or parry

  result = window.gm.combat.calcParry(attacker, defender, attack);

  if (result.OK === false) {
    return result;
  }

  _tmp += result.msg; //deal damage

  result = window.gm.combat.calcAbsorb(attacker, defender, attack);
  _tmp += result.msg;
  result.msg = _tmp;
  return result;
};
/**
 * helper function to scale effective damage according to armor & resistance
 * @param {*} attack 
 */


window.gm.combat.scaleEffect = function (attack) {
  function _adapt(op) {
    var target,
        dmg,
        rst,
        arm = 0;

    for (var i = 0; i < op.length; i++) {
      target = op[i].target;

      var _iterator14 = _createForOfIteratorHelper(op[i].eff),
          _step14;

      try {
        for (_iterator14.s(); !(_step14 = _iterator14.n()).done;) {
          el = _step14.value;

          if (el.name === effDamage.name) {
            //dmg = (attack-armor)*(100%-resistance) but min. 1pt
            arm = target.Stats.getItem('arm' + el.type).value;
            rst = target.Stats.getItem('rst' + el.type).value;
            dmg = Math.max(1, (el.amount - arm) * (100 - rst) / 100);
            el.amount = dmg;
          }

          if (el.name === effTeaseDamage.name) {
            arm = target.Stats.getItem('armtease').value;
            rst = target.Stats.getItem('rsttease').value;
            dmg = Math.max(1, (el.amount - arm) * (100 - rst) / 100);
            el.amount = dmg;
          }
        }
      } catch (err) {
        _iterator14.e(err);
      } finally {
        _iterator14.f();
      }
    }
  }

  _adapt(attack.mod.onHit);

  _adapt(attack.mod.onCrit);
}; // todo calculate vulnerability of defender
//      sexcrafing
//      like/dislike of attacker
//      fetish
// dmg = vulnerability*sluttiness
// no dmg if blinded, stunned,
// self-dmg if exhibitionist/stripper


window.gm.combat.calcTeaseAttack = function (attacker, defender, attack) {
  var result = {
    OK: true,
    msg: ''
  };
  window.gm.combat.scaleEffect(attack); //deal damage

  result = window.gm.combat.calcAbsorb(attacker, defender, attack);
  var _tmp = result.msg;
  result.msg = _tmp;
  return result;
};

"use strict";
/* bundles some operations related to dungeon navigation */


window.gm = window.gm || {};
window.gm.dng = window.gm.dng || null; //{};
//represents a button the player can press for directions N,E,S,W; this will also be used to generate the map
//if you have to connect 2 rooms, you have to define direction in both of them

var DngDirection = /*#__PURE__*/function () {
  _createClass(DngDirection, null, [{
    key: "createDirection",
    //creates direction between 2 rooms and assigns them to them; you can then modify them
    value: function createDirection(DirEnum, RoomA, RoomB) {
      var onlyAtoB = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;
      var Label = DngDirection.DirEnumToString(DirEnum);
      var DirAtoB = new DngDirection(DirEnum, Label, "");
      var inverseDir = DngDirection.inverseDirection(DirEnum);
      var backLabel = DngDirection.DirEnumToString(inverseDir);
      var DirBtoA = new DngDirection(inverseDir, backLabel, "");
      DirBtoA.oneWay = onlyAtoB;
      DirAtoB.roomA = DirBtoA.roomB = RoomA;
      DirAtoB.roomB = DirBtoA.roomA = RoomB;
      if (RoomA != null) RoomA.setDirection(DirEnum, DirAtoB);
      if (RoomB != null) RoomB.setDirection(inverseDir, DirBtoA);
    } //returns the opposite direction f.e up-down

  }, {
    key: "inverseDirection",
    value: function inverseDirection(DirEnum) {
      switch (DirEnum) {
        case DngDirection.DirN:
          return DngDirection.DirS;
          break;

        case DngDirection.DirS:
          return DngDirection.DirN;
          break;

        case DngDirection.DirE:
          return DngDirection.DirW;

        case DngDirection.DirW:
          return DngDirection.DirE;
          break;

        case DngDirection.StairDown:
          return DngDirection.StairUp;
          break;

        case DngDirection.StairUp:
          return DngDirection.StairDown;
          break;

        default:
          break;
      }

      return 0;
    } //converts direction enum to label

  }, {
    key: "DirEnumToString",
    value: function DirEnumToString(DirEnum) {
      var backLabel = "";

      switch (DirEnum) {
        case DngDirection.DirN:
          backLabel = "N";
          break;

        case DngDirection.DirS:
          backLabel = "S";
          break;

        case DngDirection.DirE:
          backLabel = "E";
          break;

        case DngDirection.DirW:
          backLabel = "W";
          break;

        case DngDirection.StairUp:
          backLabel = "Stair up";
          break;

        case DngDirection.StairDown:
          backLabel = "Stair down";
          break;

        default:
          break;
      }

      return backLabel;
    } //Enum for possible directions  ??static DirS = 2; doesnt work ??

  }, {
    key: "FALSE",
    // default functions for callbacks
    value: function FALSE(Me) {
      return false;
    }
  }, {
    key: "TRUE",
    value: function TRUE(Me) {
      return true;
    }
  }, {
    key: "DirW",
    get: function get() {
      return 4;
    }
  }, {
    key: "DirE",
    get: function get() {
      return 3;
    }
  }, {
    key: "DirN",
    get: function get() {
      return 1;
    }
  }, {
    key: "DirS",
    get: function get() {
      return 2;
    }
  }, {
    key: "StairUp",
    get: function get() {
      return 6;
    }
  }, {
    key: "StairDown",
    get: function get() {
      return 5;
    }
  }]);

  function DngDirection(dirEnum, name, descr) {
    _classCallCheck(this, DngDirection);

    this.name = name, this.descr = descr === null ? function () {
      return name;
    } : descr;
    this.direction = dirEnum;
    this.oneWay = false;
    this.onExitFct = this.onEnterFct = null; //should return true if something is happening (aborts other fct-evaluation! )

    this.canExitFct = null;
    this.roomA; //DngRoom;	//source room

    this.roomB; //:DngRoom;	//target room

    this.tooltip = ""; //:String = "";	//tooltip of the button
  } //gets called when player enters from this direction


  _createClass(DngDirection, [{
    key: "onEnter",
    value: function onEnter() {
      if (this.onEnterFct == null) return false;
      return onEnterFct(this);
    } //gets called when player  exits into this direction

  }, {
    key: "onExit",
    value: function onExit() {
      if (this.onExitFct == null) return false;
      return this.onExitFct(this);
    }
  }, {
    key: "canExit",
    //function to check if player can use this direction; you should also set tooltip for display
    value: function canExit() {
      if (this.canExitFct == null) return !this.oneWay;
      return this.canExitFct(this);
    } //the direction is hidden if one of the connected rooms is hidden

  }, {
    key: "hidden",
    value: function hidden() {
      return this.roomA.isHidden || this.roomB.isHidden;
    }
  }]);

  return DngDirection;
}(); // a room connected by directions


var DngRoom = /*#__PURE__*/function () {
  function DngRoom(name, descr, hidden) {
    _classCallCheck(this, DngRoom);

    this.name = name, this.descr = descr === null ? function () {
      return name;
    } : descr;
    this.directions
    /*DngDirection*/
    = [null, null, null, null, null, null]; //list of directions

    this.isHidden = hidden; //those you can adjust

    this.isDungeonExit = false; // player can leave to camp with Leave-button

    this.isDungeonEntry = false; //when entering the dungeon player will be coming from here; there should only be one of this

    this.operations
    /*DngOperations*/
    = []; //list of additional operations (= buttons you can press)

    this.allowSave = false;
    this.onEnterFct = null; //should return true if something is happening, see also DngDirection.onEnterFct/onExitFct
    //internal

    this.origResumeFct = null;
    this.it;
    this.fromRoom;
  } //the floor where the room is assigned to


  _createClass(DngRoom, [{
    key: "setDirection",
    value: function setDirection(DirEnum, direction) {
      var invalid = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
      this.directions.splice(DirEnum - 1, 1, direction);
    }
  }, {
    key: "getDirections",
    value: function getDirections() {
      return this.directions;
    }
  }, {
    key: "getDirection",
    value: function getDirection(DirEnum) {
      return this.directions[DirEnum - 1];
    } //this is called after the direction onEnter-Event was called

  }, {
    key: "onEnter",
    value: function onEnter() {
      this.isHidden = false;
      if (this.onEnterFct == null) return false;
      return this.onEnterFct(this);
    }
  }, {
    key: "moveHere",
    value: function moveHere(from) {
      this.origResumeFct = this.floor.dungeon.inRoomedDungeonResume;
      this.fromRoom = from;
      this.it = 0;
      this.moveIterator();
    } // Whats that good for: onExit or onEnter might trigger an interaction/combat that we have to finish first befor displaying navigation buttons again.
    // iterator->onExit->startCombat->won->doNext(resume)->iterator

  }, {
    key: "moveIterator",
    value: function moveIterator() {
      var dir; //DngDirection;

      var _it = 0; //int = 0;
      //call Exit function from previous room

      var _dirs = this.fromRoom.getDirections();

      for (var i = 0; i < _dirs.length; i++) {
        var element = _dirs[i];
        _it = _it + 1;
        if (element == null) continue;
        if (_it <= this.it) continue;
        this.it = _it;
        dir = element; // as DngDirection;

        if (dir.roomA == this.fromRoom && dir.roomB == this) {
          if (dir.onExit()) {
            this.floor.dungeon.inRoomedDungeonResume = this.moveIterator;
            return;
          }
        }
      } //call Entry function of this room


      _dirs = this.getDirections();

      for (var i = 0; i < _dirs.length; i++) {
        var element1 = _dirs[i];
        _it = _it + 1;
        if (element1 == null) continue;
        if (_it <= this.it) continue;
        this.it = _it;
        dir = element1; // as DngDirection;

        if (dir.roomA == this && dir.roomB == this.fromRoom) {
          if (dir.onEnter()) {
            this.floor.dungeon.inRoomedDungeonResume = this.moveIterator;
            return;
          }
        }
      }

      _it = _it + 1;

      if (_it > this.it && this.onEnter()) {
        this.it = _it;
        this.floor.dungeon.inRoomedDungeonResume = this.moveIterator;
        return;
      }

      this.floor.dungeon.inRoomedDungeonResume = this.origResumeFct;
      this.floor.dungeon.inRoomedDungeonResume();
    } //gets called when entering the floor or room; override it to update the other properties

  }, {
    key: "updateRoom",
    value: function updateRoom() {}
  }, {
    key: "floor",
    get: function get() {
      return this._parent();
    }
  }]);

  return DngRoom;
}(); //a floor of the dungeon
//a floor consist of several rooms that are arranged in a xy-coordinate system
//every room is connected up to 4 surrounding rooms, + stairs to lower/higher floor; 


var DngFloor = /*#__PURE__*/function () {
  function DngFloor(name, descr) {
    _classCallCheck(this, DngFloor);

    this.rooms = []; //list of rooms

    this.descr = descr === null ? function () {
      return name;
    } : descr;
    this.name = name; //label of the floor 
  }
  /*addRoom(room) { 
      this.rooms.push(room);
  };*/


  _createClass(DngFloor, [{
    key: "setRooms",
    value: function setRooms(Rooms) {
      this.rooms = Rooms;
      var found = null;

      for (var i = 0; i < this.rooms.length; i++) {
        var element = this.rooms[i];
        if (element == null) continue;
        found = element;

        if (found != null) {
          //found.floor = this;
          found._parent = window.gm.util.refToParent(this);
        }
      }
    }
  }, {
    key: "allRooms",
    value: function allRooms() {
      return this.rooms;
    }
  }, {
    key: "getRoom",
    value: function getRoom(Name) {
      var found = null;

      for (var i = 0; i < this.rooms.length; i++) {
        var element = this.rooms[i];
        if (element == null) continue;
        found = element;

        if (found.name == Name) {
          break;
        }

        found = null;
      }

      return found;
    }
  }, {
    key: "dungeon",
    get: function get() {
      return this._parent();
    }
  }]);

  return DngFloor;
}(); // an additional operation that the player can trigger by pressing a button


var DngOperation = /*#__PURE__*/function () {
  function DngOperation(name) {
    _classCallCheck(this, DngOperation);

    this.name = name; //label of the button
  }

  _createClass(DngOperation, [{
    key: "canTrigger",
    //function to check if player can use this button
    value: function canTrigger() {
      return false;
    } //override this to do something;

    /* f.e set window.gm.dng.renderEvent to a function that creates a html-string (including links)
    then call window.story.show("DungeonGenericEvent") to render that event
    add a link that calls window.gm.dng.resumeRoom() to continue in dungeon
     */

  }, {
    key: "onTrigger",
    value: function onTrigger() {}
  }]);

  return DngOperation;
}();
/**
 * persistData should be a "pointer" to a location where to store dungeon data f.e. story.state.dng.myDungeon
 */


var DngDungeon = /*#__PURE__*/function () {
  function DngDungeon(name, descr) {
    _classCallCheck(this, DngDungeon);

    this.name = name; //name of the dungeon

    this.descr = descr; //text diplayed when entering the dungeon

    var persistData = window.story.state.dng[name];

    if (persistData === undefined || persistData === null) {
      persistData = window.story.state.dng[name] = this.persistentDngDataTemplate();
    }

    this.data = persistData;
    this.floors = []; //list of Dngfloors

    this.actualRoom = null;
    this.Mapper = {}; //DngMapper; 

    this.buttons = [];
    this.inRoomedDungeonResume = this.inRoomedDungeonDefeat = null;
  } //override this to return a data-object that will be used to store persistent data


  _createClass(DngDungeon, [{
    key: "persistentDngDataTemplate",
    value: function persistentDngDataTemplate() {
      return {};
    }
  }, {
    key: "setFloors",
    value: function setFloors(Floors) {
      this.floors = Floors;

      for (var i = 0; i < this.floors.length; i++) {
        this.floors[i]._parent = window.gm.util.refToParent(this);
      }
    }
  }, {
    key: "allFloors",
    value: function allFloors() {
      return this.floors;
    }
  }, {
    key: "getFloor",
    value: function getFloor(Name) {
      var found = null;

      for (var i = 0; i < this.floors.length; i++) {
        found = this.floors[i];
        if (found == null) continue;

        if (found.name == Name) {
          break;
        }

        found = null;
      }

      return found;
    } //enters the dungeon; also does some checks to verify that dungeon was properly setup

  }, {
    key: "enterDungeon",
    value: function enterDungeon() {
      this.Mapper = new DngMapper();
      this.actualRoom = null;
      var Entry = null;
      var Exit = null;
      var Room; //search the dungeon-Entry, has to be in first floor

      var rooms = this.floors[0].allRooms();

      for (var i = 0; i < rooms.length; i++) {
        Room = rooms[i];

        if (Room.isDungeonEntry) {
          Entry = Room;
        }

        if (Room.isDungeonExit) {
          Exit = Room;
        }
      }

      if (Entry == null || Exit == null) {
        throw new Error('Error: Dungeon-Exit or Entry missing');
      }

      this.inRoomedDungeonDefeat = this.exitDungeon;
      this.moveToRoom(Entry); // playerMenu();
    } //used to exit the dungeon via Leave-button or by battledefeat
    //You need to override this to return to a proper passage with window.story.show
    //You should also set window.gm.dng=null to release memory

  }, {
    key: "exitDungeon",
    value: function exitDungeon() {
      window.gm.dng = null;
      window.story.state.dng.id = ""; //clear or load would send you into dng again
    } //similiar to moveTo except no onenter/onexit processing

  }, {
    key: "teleport",
    value: function teleport(Floor, Room) {
      this.actualRoom = null;
      this.moveToRoom(Room);
    } //move to an ADJOINING room next to the actual one
    //this might trigger onenter/onexit scenes, those scenes should then call resumeRoom to finish room-swap

  }, {
    key: "moveToRoom",
    value: function moveToRoom(newRoom) {
      /*clearOutput();
      cheatTime(1 / 12);
      EngineCore.statScreenRefresh(true);
      //DungeonCore.setTopButtons();
      spriteSelect(-1);
      menu();*/
      var _actualRoom = this.actualRoom;
      this.actualRoom = newRoom;
      this.inRoomedDungeonResume = this.resumeRoom;

      if (_actualRoom != null) {
        newRoom.moveHere(_actualRoom); //this will trigger onExit/onEnter
      } else {
        this.inRoomedDungeonResume();
      }
    }
  }, {
    key: "clearButtons",
    value: function clearButtons() {
      this.buttons = [];

      for (var i = 0; i < 15; i++) {
        //up to 15 buttons
        this.buttons.push({
          name: "",
          disabled: true,
          func: null,
          data: null
        });
      }
    }
  }, {
    key: "addButton",
    value: function addButton(bt, name, func, arg) {
      this.buttons[bt] = {
        name: name,
        disabled: false,
        func: func,
        data: arg
      };
    }
  }, {
    key: "addButtonDisabled",
    value: function addButtonDisabled(bt, name, arg) {
      this.buttons[bt] = {
        name: "-",
        disabled: true,
        func: null,
        data: arg
      };
    } //render 5x3 grid of buttons

  }, {
    key: "printButtons",
    value: function printButtons() {
      //because click-event mapping this has to manipulate DOM-tree instead of just rendering html-code
      var table = document.createElement('table');
      var tbody = document.createElement('tbody');
      table.appendChild(tbody);

      for (var y = 0; y < 3; y++) {
        var tr = document.createElement('tr');
        tbody.appendChild(tr);

        for (var x = 0; x < 5; x++) {
          //<a0 onclick=getBanana(this,5)>Get more banana</a>
          var td = document.createElement('td');
          tr.appendChild(td);
          var entry = document.createElement('a');
          entry.href = 'javascript:void(0)';
          entry.addEventListener("click", this.buttons[y * 5 + x].func ? function (me, bt) {
            return bt.func.bind(me, bt.data);
          }(this, this.buttons[y * 5 + x]) : null);
          entry.textContent = this.buttons[y * 5 + x].name;
          entry.disabled = this.buttons[y * 5 + x].disabled;
          td.appendChild(entry); //$("div#panel")[0].appendChild(entry);
        }
      }

      $("div#panel")[0].appendChild(table);
    }
  }, {
    key: "resumeRoom",
    value: function resumeRoom() {
      /*		Menu Layout
          * 		[ Op1 ]	[ Op2 ]	[ Op3 ]	[ Op4 ]	[More ]
          * 		[ Up  ]	[  N  ]	[Down ]	[Mast ]	[     ]
          * 		[  W  ]	[  S  ]	[  E  ]	[ Inv ]	[ Map ]
          *  
          */
      this.clearButtons();
      this.actualRoom.updateRoom();
      var bt;
      var btMask = 0xE;
      this.actualRoom.getDirections().forEach(function (element, index, arr) {
        var Dir = element;
        if (Dir == null) return;
        bt = Dir.direction;
        if (bt == DngDirection.DirN) bt = 6;else if (bt == DngDirection.DirS) bt = 11;else if (bt == DngDirection.DirE) bt = 12;else if (bt == DngDirection.DirW) bt = 10;else if (bt == DngDirection.StairDown) bt = 7;else if (bt == DngDirection.StairUp) bt = 5;

        if (Dir.canExit()) {
          this.addButton(bt, Dir.name, this.moveToRoom, Dir.roomB);
        } else {
          this.addButtonDisabled(bt, Dir.name, Dir.tooltip);
        }

        btMask = btMask ^ 1 >>> bt;
      }, this); //if (player.lust >= 30) addButton(8, "Masturbate", SceneLib.masturbation.masturbateGo);
      //addButton(13, "Inventory", inventory.inventoryMenu).hint("The inventory allows you to use an item.  Be careful as this leaves you open to a counterattack when in combat.");

      this.addButton(14, "Map", this.displayMap); //.hint("View the map of this dungeon.");

      bt = 0;

      var _iterator15 = _createForOfIteratorHelper(this.actualRoom.operations),
          _step15;

      try {
        for (_iterator15.s(); !(_step15 = _iterator15.n()).done;) {
          el = _step15.value;
          if (bt > 4) break;
          if (el === null) continue;
          if (el.canTrigger()) this.addButton(bt, el.name, el.onTrigger);else this.addButton(bt, el.name, "");
          bt += 1;
        }
      } catch (err) {
        _iterator15.e(err);
      } finally {
        _iterator15.f();
      }

      if (this.actualRoom.isDungeonExit) {
        for (var i = 5; i < 15; i++) {
          //find an empty navigation button for leave
          bt = i;
          if ((btMask << i & 1) == 0) break;
        }

        this.addButton(bt, "Leave", this.exitDungeon, false);
      } //add _nosave_ tag except allowed


      var tags = window.story.passage("Dungeon").tags;

      for (var i = tags.length - 1; i >= 0; i--) {
        if (tags[i] === '_nosave_') tags.splice(i, 1);
      }

      if (!window.gm.dng.actualRoom.allowSave) {
        tags.push('_nosave_');
      }

      var _state = window.story.state.dng;
      _state.roomId = this.actualRoom.name; //Todo how to load dungeon ?

      _state.id = this.name;
      _state.floorId = this.actualRoom.floor.name;
      window.story.show("Dungeon"); //call the scene
    } //shows a map-screen

  }, {
    key: "displayMap",
    value: function displayMap() {
      //this.Mapper.createMap(this.actualRoom.floor);
      window.story.show("DungeonMap");
    }
  }]);

  return DngDungeon;
}(); // a helper class to store info for a room


var DngMapperInfo = function DngMapperInfo() {
  _classCallCheck(this, DngMapperInfo);

  this.X = this.Y = 0;
  this.Name = "";
  this.Hidden = false;
  this.Connect = 0; //bitwise encoding of directions
}; // builds the map from the dungeons info and actualRoom
// it is expected that all rooms in a floor are somehow connected with each other - no isolated rooms !


var DngMapper = /*#__PURE__*/function () {
  function DngMapper() {
    _classCallCheck(this, DngMapper);

    this.dungeon = this.floor = null;
    this.allInfo = [];
    this.maxX = this.maxY = this.minX = this.minY = 0;
  } //todo only show parts of the map the player already visited or knows off - but this would bloat save


  _createClass(DngMapper, [{
    key: "createMap",
    value: function createMap(Floor) {
      this.floor = Floor;
      var allrooms = Floor.allRooms();
      var roomIndexs = [];
      this.allinfo = new Array(allrooms.length);
      var dirs;
      var dir; //:DngDirection;

      var room, room2;
      var x, y, m;
      var roomInfo = new DngMapperInfo();
      var roomInfo2;
      roomInfo.X = x = this.maxX = this.minX = 0;
      roomInfo.Y = y = this.maxY = this.minY = 0;
      /*  put 1.room of actual floor to dictionary, set coord XY ={0,0]
          *  get next room from dictionary until no more
          *  	for every direction of room
          * 			get targt room and place into dictionary
          * 			depending of direction, add flags to source & target room
          * 			calculate coord of target room  (f.e. direction =E then X/Y = {+1 , +0})
          * 		...
          *  ...
          */

      this.allinfo[0] = roomInfo;
      roomIndexs[0] = 0;

      for (var i = 0; i < roomIndexs.length; i++) {
        //allrooms.length??
        m = roomIndexs[i];
        room = allrooms[m];
        roomInfo = this.allinfo[m];
        roomInfo.Name = room.name;
        roomInfo.Hidden = roomInfo.Hidden || room.isHidden;
        dirs = room.getDirections();

        for (var k = 0; k < dirs.length; k++) {
          if (dirs[k] == null) continue;
          dir = dirs[k];
          room2 = dir.roomB;
          roomInfo.Connect = roomInfo.Connect + (1 << dir.direction);
          m = allrooms.indexOf(room2);

          if (m >= 0) {
            //create new roominfo and set coordinate
            roomInfo2 = new DngMapperInfo();
            roomInfo2.Hidden = dir.hidden();
            roomInfo.Entry = room.isDungeonEntry || room.isDungeonExit;
            roomInfo.Save = room.allowSave;

            switch (dir.direction) {
              case DngDirection.DirN:
                roomInfo2.X = roomInfo.X;
                roomInfo2.Y = roomInfo.Y - 1;
                break;

              case DngDirection.DirS:
                roomInfo2.X = roomInfo.X;
                roomInfo2.Y = roomInfo.Y + 1;
                break;

              case DngDirection.DirE:
                roomInfo2.X = roomInfo.X + 1;
                roomInfo2.Y = roomInfo.Y;
                break;

              case DngDirection.DirW:
                roomInfo2.X = roomInfo.X - 1;
                roomInfo2.Y = roomInfo.Y;
                break;

              default:
                break;
            }

            if (roomInfo2.X < this.minX) this.minX = roomInfo2.X;
            if (roomInfo2.X > this.maxX) this.maxX = roomInfo2.X;
            if (roomInfo2.Y < this.minY) this.minY = roomInfo2.Y;
            if (roomInfo2.Y > this.maxY) this.maxY = roomInfo2.Y;

            if (roomIndexs.indexOf(m) < 0) {
              roomIndexs.push(m);
              this.allinfo[m] = roomInfo2;
            }
          }
        }
      }

      return;
    }
    /* now we have a dictonary of all rooms, their coordinate and flags
        * create 2DArray of size ( 2*(maxX-minX) , 2*(maxY-minY)) ; even indices store rooms "[ ]", uneven indices store directions " - "
        * for every room in dictionary
        * 		update Array[2*(X-minX)][2*(Y-minY)] with room-information
        * 		update Array[2*(X-1-minX)][2*(Y-0-minY)] with W-direction
        * 		update Array[2*(X-0-minX)][2*(Y-1-minY)] with N-direction
        * 		aso.
        * ...
        * now we can print something like this:
        * 	[ ]-[ ]-[ ]-[S]
        *   |	 |	 |   |	
        *  [ ]-[P]-[ ]-[ ]
    */

  }, {
    key: "printMap",
    value: function printMap(playerRoom, minimap) {
      //Todo use images or special font instead ascii?
      var _line = "";
      var map = [];
      var roomInfo;
      var i, j;
      var playerX = 0,
          playerY = 0;
      this.createMap(playerRoom.floor); //todo only recreate if necessary
      //create 2d-array to store textual representation of room and connection between them

      map = new Array(2 * (this.maxX - this.minX) + 1);

      for (i = 0; i < map.length; i++) {
        var submap = new Array(2 * (this.maxY - this.minY) + 1);

        for (j = 0; j < submap.length; j++) {
          submap[j] = "   ";
        }

        map[i] = submap;
      } //convert the MapperInfo to textual representation


      for (i = 0; i < this.allinfo.length; i++) {
        if (this.allinfo[i] == null) continue;
        roomInfo = this.allinfo[i];
        _line = " ";

        if (roomInfo.Connect & 1 << DngDirection.StairDown || roomInfo.Connect & 1 << DngDirection.StairUp) {
          _line = "&ang;";
        }

        if (playerRoom != null && playerRoom.name == roomInfo.Name) {
          _line = "P";
          playerX = roomInfo.X, playerY = roomInfo.Y;
        }

        if (roomInfo.Save && playerRoom.name != roomInfo.Name) {
          _line = "S";
        }

        if (roomInfo.Entry && playerRoom.name != roomInfo.Name) {
          _line = "E";
        } //each room/connection has to be 3 chars long or it will messup formatting !
        //todo format as table?


        if (!roomInfo.Hidden) {
          _line = "[" + _line + "]";
          map[2 * (roomInfo.X - this.minX)][2 * (roomInfo.Y - this.minY)] = _line;

          if (roomInfo.Connect & 1 << DngDirection.DirN) {
            _line = " | ";
            map[2 * (roomInfo.X - this.minX) + 0][2 * (roomInfo.Y - this.minY) - 1] = _line;
          }

          if (roomInfo.Connect & 1 << DngDirection.DirE) {
            _line = " - ";
            map[2 * (roomInfo.X - this.minX) + 1][2 * (roomInfo.Y - this.minY) + 0] = _line;
          }

          if (roomInfo.Connect & 1 << DngDirection.DirS) {
            _line = " | ";
            map[2 * (roomInfo.X - this.minX) + 0][2 * (roomInfo.Y - this.minY) + 1] = _line;
          }

          if (roomInfo.Connect & 1 << DngDirection.DirW) {
            _line = " - ";
            map[2 * (roomInfo.X - this.minX) - 1][2 * (roomInfo.Y - this.minY) - 0] = _line;
          }
        }
      } //print


      _line = "<pre>"; //pre-formatted or messup allignment of ascii-rows

      if (minimap) {
        //only print rooms 1 step around player
        _line += this.floor.name + "</br>";
        var x, y;

        for (j = -3; j <= 3; j++) {
          for (i = -3; i <= 3; i++) {
            x = i + (playerX - this.minX) * 2, y = j + (playerY - this.minY) * 2; //coord can be negative !
            //if(x>this.maxX || y>this.maxY || x<this.minX || y< this.minY) continue;    

            if (map.length - 1 < x || 0 > x) continue;
            if (map[x].length - 1 < y || 0 > y) continue;
            _line += (i == -3 ? "&nbsp;" : "") + map[x][y]; //todo hack:if line starts with -, snowman-markdown interprets this as <ul> ?!
          }

          _line += "\n";
        }
      } else {
        //full map of floor
        _line += this.floor.dungeon.name + " " + this.floor.name + "</br>";

        for (j = 0; j < 2 * (this.maxY - this.minY) + 1; j++) {
          for (i = 0; i < 2 * (this.maxX - this.minX) + 1; i++) {
            _line += map[i][j];
          }

          _line += "\n";
        }

        _line += "<pre>Legend: P=Player, &ang;=Stair, E=Entry/Exit S=Save</pre></br>";
      }

      _line += "</pre>";
      return _line;
    }
  }]);

  return DngMapper;
}();

"use strict";
/**
 * extends Function with the possibility to execute it multiple times with delay
 * var foo = function test(startTime, count) { alert(startTime + count);};
 * new foo.Timer(2000,3,null);
 * see https://wiki.selfhtml.org/wiki/JavaScript/Tutorials/komfortable_Timer-Funktion
 * @param {int} interval: in ms 
 * @param {*} calls : how many times or use Infinity
 * @param {*} onend : optional CB fired after #calls or if function returns false
 */


Function.prototype.Timer = function (interval, calls, onend) {
  var count = 0;
  var payloadFunction = this; //payloadFunction.abortTimer = false;

  var startTime = new Date();

  var callbackFunction = function callbackFunction() {
    return payloadFunction(startTime, count);
  };

  var endFunction = function endFunction() {
    if (onend) {
      onend(startTime, count, calls);
    }
  };

  var timerFunction = function timerFunction() {
    count++;
    if (payloadFunction.abortTimer) return;

    if (count < calls && callbackFunction() != false) {
      window.setTimeout(timerFunction, interval);
    } else {
      endFunction();
    }
  };

  timerFunction();
};
/*
core functionality
*/


window.gm = window.gm || {}; //game related operations

window.gm.util = window.gm.util || {}; //utility functions
// helper for publisher/subscriber-pattern; myObject.ps =PubSub(); myObject.ps.subscribe(...
// !! warning, dont use for objects that need to be loaded from savegame
// the reviver calls constructor of nested objects multiple times which lead to multiple registrations with partially incomplete objects in the PubSub;
// since there are no destructors, there is no easy way to cleanup

window.gm.util.PubSub = function () {
  return {
    events: {},
    subscribe: function subscribe(event, handler) {
      if (!this.events[event]) {
        this.events[event] = [];
      }

      this.events[event].push(handler);
    },
    unsubscribe: function unsubscribe(event, handler) {
      if (!this.events[event]) return;
      var i = this.events[event].indexOf(handler);
      if (i >= 0) this.events.splice(i, 1);
    },
    publish: function publish(event, data) {
      this.events[event] && this.events[event].forEach(publishData);

      function publishData(handler) {
        handler(data);
      }

      ;
    }
  };
}; //create pretty name for passage; requires a tag (replace space with _ !) [name:"My_Room"]


window.gm.util.printLocationName = function (passage) {
  var tags = window.story.passage(passage).tags;

  var _iterator16 = _createForOfIteratorHelper(tags),
      _step16;

  try {
    for (_iterator16.s(); !(_step16 = _iterator16.n()).done;) {
      el = _step16.value;
      var ar = el.split(":");

      if (ar.length > 1 && ar[0] === 'name') {
        return ar[1].split('_').join(' ');
      }
    }
  } catch (err) {
    _iterator16.e(err);
  } finally {
    _iterator16.f();
  }

  return passage;
}; //-------------------------------------------------
// reimplement to setup the game !


window.gm.initGame = function (forceReset) {
  var NGP = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
  window.gm.toasty = new Toasty();
  $(window).on('sm.passage.showing', function (event, eventObject) {
    // Current Passage object
    $("tw-passage").fadeIn(500); //fade in if was previously faded out
    //console.log('showing '+eventObject.passage.name);
  }); // Render the passage named HUD into the element todo replace with <%=%>??

  $(document).on('sm.passage.shown', function (ev, eventObject) {
    window.gm.refreshSidePanel();
  });
  var s = window.story.state; //s in template is window.story.state from snowman!

  if (!window.gm.timeEvent || forceReset) {
    window.gm.timeEvent = window.gm.util.PubSub(); //subscribe to "change" event to receive time updates
    // !! make sure to reregister after load !
  }

  if (!s.quests || forceReset) {
    s.quests = new QuestData();
    window.gm.quests = new QuestManager(window.gm.questDef);
    window.gm.quests.setQuestData(s.quests);
    window.gm.quests.pubSub.subscribe("change", function (data) {
      window.gm.toasty.info("Quest " + data.questId + " updated");
    });
  }

  if (!s._gm || forceReset) {
    s._gm = {
      version: window.gm.getSaveVersion(),
      style: 'default',
      //ss profile to use
      log: [],
      passageStack: [],
      //used for passage [back] functionality
      defferedStack: [],
      //used for deffered events
      onholdStack: [],
      //used for deffered events
      time: 700,
      //represented as hours*100 +minutes
      day: 1,
      //daycount
      activePlayer: '',
      //id of the character that the player controls currently
      nosave: false,
      playerParty: [],
      //names of NPC in playerParty 
      debug: false,
      //globally enables debug
      dbgShowCombatRoll: false,
      //log combat calculation details
      dbgShowQuestInfo: false,
      //show internal quest state
      dbgShowMoreInfo: false
    };
  }

  if (!s.dng || forceReset) {
    //stores the state of the current dungeon
    s.dng = {
      id: "",
      floorId: "",
      roomId: ""
    };
  }

  if (!s.tmp || forceReset) {
    // storage of temporary variables; dont use them in stacking passages or deffered events      
    s.tmp = {
      rnd: 0,
      // can be used as a random variable for use in CURRENT passage
      args: [],
      // can be used to set arguments before another passage is called (passage-arguments) 
      msg: '' // memorizes a message to display when returning from _back-passage; please clear it when leaving the passage

    };
  }

  if (!s.combat || forceReset) {
    //see encounter & combat.js
    s.combat = {
      enemyParty: [],
      //collection of enemy-chars involved 
      enemyIdx: 0,
      //index of actual enemy 
      playerParty: [],
      playerIdx: 0,
      enemyFirst: false,
      //if true, enemy moves first
      inCombat: false,
      //for query window.gm.combat.inCombat
      turnCount: 0,
      scenePic: 'assets/bg_park.png'
    };
  }
}; //reimplement for your game !


window.gm.newGamePlus = function () {
  var NGP = {
    //be mindful if adding complex objects to NGP, they might not work as expected ! simple types are ok 
    crowBarLeft: window.story.state.vars.crowBarLeft
  };
  window.gm.initGame(true, NGP);
  window.story.show('Home');
}; //reimplement this to handle version upgrades on load !


window.gm.rebuildObjects = function () {
  var s = window.story.state;
  window.styleSwitcher.loadStyle(); //since style is loaded from savegame

  window.gm.quests.setQuestData(s.quests); //necessary for load support

  window.gm.switchPlayer(s._gm.activePlayer);
}; //--------------- time management --------------
//returns timestamp since start of game


window.gm.getTime = function () {
  return window.story.state._gm.time + 2400 * window.story.state._gm.day;
};
/*
* calculates timedifference a-b for hhmm time format
*/


window.gm.getDeltaTime = function (a, b) {
  var m = a % 100;
  var h = (a - m) / 100;
  var m2 = b % 100;
  var h2 = (b - m2) / 100;
  return h * 60 + m - (h2 * 60 + m2);
}; //adds MINUTES to time


window.gm.addTime = function (min) {
  var v = window.story.state._gm;
  var m = v.time % 100;
  var h = parseInt((v.time - m) / 100);
  m = m + min;
  var m2 = m % 60;
  var h2 = h + parseInt((m - m2) / 60);
  window.story.state._gm.time = h2 * 100 + m2 % 60;

  while (window.story.state._gm.time >= 2400) {
    window.story.state._gm.time -= 2400;
    window.story.state._gm.day += 1;
  }

  window.gm.timeEvent.publish("change", min);
  window.gm.player.Effects.updateTime(); //todo not happy with that; see PubSub-comment

  window.gm.player.Outfit.updateTime(); // updating all existing chars might not be wise (some could be dead)
  // but what if I have to update other chars too?
  //
};

window.gm.getTimeString = function () {
  var c = window.gm.getTimeStruct();
  return (c.hour < 10 ? "0" : "") + c.hour.toString() + ":" + (c.min < 10 ? "0" : "") + c.min.toString() + "(" + c.daytime + ")";
}; // DoW = DayOfWeek  7 = Sunday, 1 = Monday,...6 = Saturday 


window.gm.getTimeStruct = function () {
  var v = window.story.state._gm;
  var m = v.time % 100;
  var h = (v.time - m) / 100;
  var daytime = '';

  if (v.time > 500 && v.time < 1000) {
    daytime = 'morning';
  } else if (v.time >= 1000 && v.time < 1400) {
    daytime = 'noon';
  } else if (v.time >= 1400 && v.time < 1800) {
    daytime = 'afternoon';
  } else if (v.time >= 1800 && v.time < 2200) {
    daytime = 'evening';
  } else {
    daytime = 'night';
  }

  var DoW = window.story.state._gm.day % 7;
  return {
    'hour': h,
    'min': m,
    'daytime': daytime,
    'DoW': DoW
  };
};

window.gm.DoWs = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];

window.gm.getDateString = function () {
  var v = window.story.state._gm;
  return v.day.toString() + ". day " + window.gm.DoWs[v.day % 8 - 1];
}; //forward time to until (1025 = 10:25), regenerate player
//warning dont write 0700 because this would be take as octal number


window.gm.forwardTime = function (until) {
  var v = window.story.state._gm;
  var msg = '';
  var m = v.time % 100;
  var h = parseInt((v.time - m) / 100);
  var m2 = until % 100;
  var h2 = parseInt((until - m2) / 100);
  var min = (h2 - h) * 60 + (m2 - m); //if now is 8:00 and until 10:00 we assume you want to sleep 2h and not 2+24h
  //if now is 10:00 and until is 9:00 we assume sleep for 23h

  if (until < v.time) {
    min = 24 * 60 - (h - h2) * 60 + (m - m2);
  }

  if (min === 0) {
    //if sleep from 700 to 700, its a day
    min = 24 * 60;
  }

  msg += "</br>" + min % 60 + " hours pass by.</br>";
  window.gm.addTime(min);
  window.gm.pushLog(msg);
  return {
    msg: msg,
    delta: min
  };
}; // use: child._parent = window.gm.util.refToParent(parent);


window.gm.util.refToParent = function (me) {
  return function () {
    return me;
  };
}; //todo causes problem with replaceState??
//since there is no builtin function to format numbers here is one: formatNumber(-1002.4353,2) -> 1,002.44  


window.gm.util.formatNumber = function (n, dp) {
  var s = '' + Math.floor(n),
      d = Math.abs(n % 1),
      i = s.length,
      r = '';

  while ((i -= 3) > 0) {
    r = ',' + s.substr(i, 3) + r;
  } //todo . & , is hardcoded


  return s.substr(0, i + 3) + r + (d ? '.' + Math.round(d * Math.pow(10, dp || 2)) : '');
}; //---------------------------------------------------------------------------------
//TODO 
//maybe you sometimes dont want to trigger an event immediatly, 
//f.e. if you send a email, it might take some time until you get a response-email 
//(you can receive email at anytime on your phone, so we would have to add checks on ALL passages)
//use this function to push a passage to a stack of deffered events; 
//the passage will trigger under the given condition: minimum time, location-tag, at a certain time-window
//the passage will show when a new passage is requested and will be removed from stack
//if this passage is already pushed, only its condition will be updated


window.gm.pushDeferredEvent = function (id, args) {
  var front = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;

  /*var cond1 = {waitTime: 6,
              locationTags: ['Home','City'],      //Never trigger in Combat
              dayTime: [1100,600]
            },
      cond2 = { waitTime: 60,
                locationTags: ['Letterbox'],
      };
    */
  var cond = []; //[cond1,cond2]; //passage is executed if any of the conds is met

  if (front) {
    window.story.state._gm.defferedStack.unshift({
      id: id,
      cond: cond,
      args: args
    });
  } else {
    window.story.state._gm.defferedStack.push({
      id: id,
      cond: cond,
      args: args
    });
  }
};

window.gm.popDeferredEvent = function () {
  var evt = window.story.state._gm.defferedStack.shift();

  window.story.state.tmp.args = evt.args;
  return evt.id;
};

window.gm.removeDefferedEvent = function () {
  var id = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : "";

  if (id !== "") {
    for (var i = window.story.state._gm.defferedStack.length - 1; i > 0; i--) {
      if (window.story.state._gm.defferedStack[i].id === id) window.story.state._gm.defferedStack.splice(i, 1);
    }
  } else {
    window.story.state._gm.defferedStack = [];
  }
};
/*window.gm.hasDeferredEvent = function(id="") {
  if(id!=="") {
    for(var i=0;i<window.story.state._gm.defferedStack.length;i++) {
      if(window.story.state._gm.defferedStack[i].id===id) return(true);
    }
    return(false);
  } else {
    return(window.story.state._gm.defferedStack.length>0);
  }
}
window.gm.showDeferredEvent= function() {
  var msg = '';

  var namenext = window.passage.name;
  //var tagsnext = window.story.passage(namenext).tags;
  var evt = window.story.state._gm.defferedStack.shift();
  if(evt!==null) {
    msg += window.gm.printPassageLink("Next",evt.id);
  }
  return msg;
}*/
//when show is called the previous passage is stored if the new has [_back_]-tag
//if the new has no back-tag, the stack gets cleared


window.gm.pushBackPassage = function (id) {
  if (!window.story.state.hasOwnProperty("_gm")) return; //exist only after initGame

  if (window.story.state._gm.passageStack.length > 0 && window.story.state._gm.passageStack[window.story.state._gm.passageStack.length - 1] === id) {//already pushed
  } else {
    window.story.state._gm.passageStack.push(id);
  }
}; //call on [_back_]-passages to get the previous passage


window.gm.popBackPassage = function () {
  var pass = window.story.state._gm.passageStack.pop();

  if (!pass) return 'nothing to pop from stack';
  return pass;
};

window.gm.pushOnHold = function (id) {
  if (!window.story.state.hasOwnProperty("_gm")) return; //exist only after initGame

  if (window.story.state._gm.onholdStack.length > 0) {
    // && window.story.state._gm.defferedStack[window.story.state._gm.defferedStack.length-1].id===id){
    throw new Error('passage allready onHold: ' + id); //already some pushed
  } else {
    window.story.state._gm.onholdStack.push({
      id: id,
      args: window.story.state.tmp.args
    });
  }
}; //


window.gm.popOnHold = function () {
  var pass = window.story.state._gm.onholdStack.pop();

  if (!pass) throw new Error('nothing on hold to pop.');
  window.story.state.tmp.args = pass.args;
  return pass.id;
}; //overriding show:
//- to enable back-link
//- todo to intercept with deffered events


var _origStoryShow = window.story.__proto__.show;

window.story.__proto__.show = function (idOrName) {
  var noHistory = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
  var next = idOrName;
  var inGame = window.story.state.hasOwnProperty("_gm"); //the logic doesnt work if initGame not already done

  var tagsnext, namenext, nextp, namenow;
  if (idOrName === '') tagsnext = [];else tagsnext = window.story.passage(idOrName).tags;

  if (idOrName === '_back_') {
    //going back
    next = window.gm.popBackPassage();
    tagsnext = window.story.passage(next).tags;
  } else if (inGame && window.story.state._gm.defferedStack.length > 0 && //deffered event if allowed and requested

  /*tagsnext.indexOf('_back_')<0 &&*/
  tagsnext.indexOf('_nosave_') < 0 && tagsnext.indexOf('_nodeffered_') < 0) {
    //before entering a new passage check if there is a defferedEvent that we should do first
    //if so, push the normal-passage onto stack, show deffered passage
    //after the deffered passage(s) finish, make sure to show the original passage
    //this is a problem?how do I know the deffered passage is done? 
    if (idOrName !== '') window.gm.pushOnHold(idOrName);
    next = window.gm.popDeferredEvent();
    nextp = window.story.passage(next);
    tagsnext = nextp.tags;
  } else if (inGame && idOrName === '' && window.story.state._gm.onholdStack.length > 0) {
    //continue event onhold
    next = window.gm.popOnHold();
    nextp = window.story.passage(next);
    tagsnext = nextp.tags;
  } else {
    //going forward
    nextp = window.story.passage(next);
    if (!nextp) throw new Error('no such passage: ' + next);
    tagsnext = nextp.tags;
    namenext = nextp.name;

    if (tagsnext.indexOf('_back_') >= 0) {
      //push on stack but only if not re-showing itself
      namenow = window.passage.name;
      if (namenext != namenow) window.gm.pushBackPassage(namenow);
    } else if (inGame) {
      //if not in _back_-passage, drop the _back_-stack
      window.story.state._gm.passageStack.splice(0, window.story.state._gm.passageStack.length);
    } //todo not sure about this: a deffered event should not link to normal passages because this would disentangle the original story-chain
    //this I think could cause issues and should be detected and throw an error
    //uncoment the following to bypass this 
    //    window.story.state._gm.onholdStack.splice(0,window.story.state._gm.onholdStack.length);

  }

  if (inGame) {
    //disable save-menu on _nosave_-tag 
    window.story.state._gm.nosave = tagsnext.indexOf('_nosave_') >= 0;
  }

  noHistory = true; //the engines object auses problems with history, namely refToParent

  _origStoryShow.call(window.story, next, noHistory);
}; //-----------------------------------------------------------------------------
//changes the active player and will add him to party!


window.gm.switchPlayer = function (playername) {
  var s = window.story.state;
  window.gm.player = s[playername];
  s._gm.activePlayer = playername;
  window.gm.addToParty(playername);
};

window.gm.removeFromParty = function (name) {
  var s = window.story.state;

  var i = s._gm.playerParty.indexOf(name);

  if (i >= 0) s._gm.playerParty.splice(i, 1);
}; //adds the character to the party
//there has to be a CharacterObject for window.story.state[name]


window.gm.addToParty = function (name) {
  var s = window.story.state;
  if (s._gm.playerParty.indexOf(name) < 0) s._gm.playerParty.push(name);
};

window.gm.isInParty = function (name) {
  return window.story.state._gm.playerParty.indexOf(name) >= 0;
}; //-----------------------------------------------------------------------------
//---------------------------------------------------------------------------------
//updates all panels


window.gm.refreshAllPanel = function () {
  window.story.show(window.passage.name);
}; //updates only sidepanle,logpanel


window.gm.refreshSidePanel = function () {
  renderToSelector("#sidebar", "sidebar");
  renderToSelector("#LogPanel", "LogPanel");
}; ///////////////////////////////////////////////////////////////////////


window.gm.pushLog = function (msg) {
  var Cond = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;
  if (!Cond || msg === '') return;
  var log = window.story.state._gm.log;
  log.unshift(msg + '</br>');

  if (log.length > 10) {
    log.splice(log.length - 1, 1);
  }
};

window.gm.getLog = function () {
  var log = window.story.state._gm.log;
  var msg = '';

  for (var i = 0; i < log.length; i++) {
    msg += log[i];
  }

  return msg;
};

window.gm.clearLog = function () {
  var log = window.story.state._gm.log;
  var msg = '';

  for (var i = 0; i < log.length; i++) {
    msg += log[i];
  }

  window.story.state._gm.log = [];
  return msg;
}; //////////////////////////////////////////////////////////////////////


window.gm.roll = function (n, sides) {
  //rolls n x dies with sides
  var rnd = 0;

  for (var i = 0; i < n; i++) {
    rnd += _.random(1, sides);
  }

  return rnd;
}; //expects DOM like <section><article>..<div id='output'></div>..</article></section>


window.gm.printOutput = function (text) {
  var where = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : "section article div#output";
  document.querySelector(where).innerHTML = text;
}; //connect to onclick to toggle selected-style for element + un-hiding related text
//the elmnt (f.e.<img>) needs to be inside a parentnode f.e. <div id="choice">
//ex_choice is jquery path to fetch all selectable elmnt
//for a table in a div this could be "div#choice table tbody tr td *"
//text-nodes needs to be inside a parent node f.e. <div id="info"> and have matching id of elmnt
//ex_info is jquery path to fetch all info elmnt
//for a <p> in div this could be "div#info  


window.gm.onSelect = function (elmnt, ex_choice, ex_info) {
  var all = $(ex_choice); //[0].children;

  for (var i = 0; i < all.length; i++) {
    if (all[i].id === elmnt.id) {
      all[i].classList.add("selected");
    } else all[i].classList.remove("selected");
  }

  all = $(ex_info)[0].children;

  for (var i = 0; i < all.length; i++) {
    if (all[i].id === elmnt.id) {
      all[i].hidden = false;
    } else all[i].hidden = true;
  }
}; //call this onclick to make the connected element vanish and to unhide another one (if the passage is revisited the initial state will be restored)
//unhidethis needs to be jquery-path to a div,span,.. that is initially set to hidden
//cb can be a function(elmt) that gets called


window.gm.printTalkLink = function (elmt, unhideThis) {
  var cb = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
  elmt.toggleAttribute("hidden");
  if (cb !== null) cb(elmt);
  $(unhideThis)[0].toggleAttribute("hidden");
  $(unhideThis)[0].scrollIntoView({
    behavior: "smooth"
  });
}; //prints the same kind of link like [[Next]] but can be called from code


window.gm.printPassageLink = function (label, target) {
  return "<a href=\"javascript:void(0)\" data-passage=\"" + target + "\">" + label + "</a></br>";
};

window.gm.printLink = function (label, target) {
  return "<a href=\"javascript:void(0)\" onclick=\"" + target + "\">" + label + "</a></br>";
}; //dynamically build a link representing a buy option including display of cost and restriction
//count specifys how any items you get for cost
//cbCanBuy points to a function fn(itemid) that returns if can buy {OK:false,msg:'too expensive'} 
//cbPostBuy points to a function fn(itemid) that is called after buying ; 


window.gm.printShopBuyEntry = function (itemid, count, cbCanBuy) {
  var cbPostBuy = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;
  var desc2 = itemid + 'out of stock</br>';
  var entry = document.createElement('a'); // entry is a link that will expand to item description

  entry.id = itemid;
  entry.href = 'javascript:void(0)';

  var showDesc = function showDesc($event) {
    var elmt = document.querySelector("div#" + $event.srcElement.id);
    elmt.innerHTML = window.gm.ItemsLib[$event.srcElement.id].desc + "</br>"; //?? new ...

    elmt.toggleAttribute("hidden");
  };

  entry.addEventListener("click", showDesc, false);
  var div = document.createElement('div');
  div.id = itemid;
  div.hidden = true;
  var entryBuy = document.createElement('a'); //entryBuy is a link that actual buys something or shows why not

  entryBuy.id = itemid;
  entryBuy.href = 'javascript:void(0)';
  entryBuy.textContent = "Buy";

  if (count > 0) {
    var result = cbCanBuy(itemid);
    desc2 = itemid + " (x" + count + ")";

    if (result.OK === false) {
      desc2 = desc2 + " " + result.msg;
    } else {
      desc2 += " " + result.msg;

      var foo = function foo($event) {
        window.gm.buyFromShop(itemid, count, cbPostBuy);
      };

      entryBuy.addEventListener("click", foo, false);
    }
  }

  entry.textContent = desc2;
  $("div#panel")[0].appendChild(entry);
  $("div#panel")[0].appendChild(entryBuy);
  $("div#panel")[0].appendChild(document.createElement('br'));
  $("div#panel")[0].appendChild(document.createElement('br'));
  $("div#panel")[0].appendChild(div);
}; //a callback function to check if you can buy something;
//should return {OK:true,msg:'',postBuy:null} where message will be displayed either as reason why you cannot buy or cost
//unused because makes it unoverridable ->postboy is {fn:foo, cost:x} where fn points to a function that is called after buying (fn(itemid,x));  
//this implementation checks: money


window.gm.defaultCanBuy = function (itemid, cost) {
  var result = {
    OK: true,
    msg: ''
  }; //, postBuy:null};

  var money = window.gm.player.Inv.countItem('Money');

  if (money >= cost) {
    result.msg = 'buy for ' + cost + '$'; //result.postBuy = function(x){ return (function(item,y=x){window.gm.defaultPostBuy(item,y);})}(cost);
    //result.postBuy = {fn:window.gm.defaultPostBuy, cost:cost};
  } else {
    result.OK = false;
    result.msg = 'requires ' + cost + '$';
  }

  ;
  return result;
};

window.gm.defaultCanSell = function (itemid, cost) {
  var result = {
    OK: true,
    msg: ''
  }; //todo check equipped item

  result.msg = 'sell for ' + cost + '$';
  return result;
}; //requires a <div id='choice'> </div> for displaying bought-message


window.gm.defaultPostSell = function (itemid, cost) {
  window.gm.player.Inv.addItem(new Money(), cost);
  $("div#choice")[0].innerHTML = 'You sold ' + itemid;
  $("div#choice")[0].classList.remove("div_alarm");
  $("div#choice")[0].offsetWidth; //this forces the browser to notice the class removal

  $("div#choice")[0].classList.add("div_alarm");
}; //requires a <div id='choice'> </div> for displaying bought-message


window.gm.defaultPostBuy = function (itemid, cost) {
  window.gm.player.Inv.removeItem('Money', cost);
  $("div#choice")[0].innerHTML = 'You bought ' + itemid;
  $("div#choice")[0].classList.remove("div_alarm");
  $("div#choice")[0].offsetWidth; //this forces the browser to notice the class removal

  $("div#choice")[0].classList.add("div_alarm");
};

window.gm.cbCanBuyPerverse = function (itemid, cost, pervcost) {
  var result = window.gm.defaultCanBuy(itemid, cost);

  if (window.gm.player.Stats.get('corruption').value < pervcost) {
    result.msg += ' ; requires corruption> ' + pervcost;
    result.OK = false;
  }

  return result;
}; //this will add item to player; money-deduct or other cost has to be done in cbPostBuy ! 


window.gm.buyFromShop = function (itemid, count, cbPostBuy) {
  window.gm.player.Inv.addItem(new window.storage.constructors[itemid](), count); //Todo item or wardrobe

  if (cbPostBuy) cbPostBuy(itemid); //window.gm.refreshAllPanel(); dont refresh fullscreen or might reset modified textoutput

  window.gm.refreshSidePanel(); //just update other panels

  renderToSelector("#panel", "listsell");
}; //this will remove item from player; money-deduct or other cost has to be done in cbPostSell ! 


window.gm.sellToShop = function (itemid, count, cbPostSell) {
  window.gm.player.Inv.removeItem(itemid, count);
  if (cbPostSell) cbPostSell(itemid); //window.gm.refreshAllPanel(); dont refresh fullscreen or might reset modified textoutput

  window.gm.refreshSidePanel(); //just update other panels

  renderToSelector("#panel", "listsell");
}; //dynamically build a link representing a sell option including display of cost
//count defines how many of this item you have to trade in


window.gm.printShopSellEntry = function (itemid, count, cbCanSell, cbPostSell) {
  var _available = window.gm.player.Inv.countItem(itemid); //only items the player has can be sold


  if (_available <= 0) return;
  var entry = document.createElement('a');
  entry.id = itemid;
  entry.href = 'javascript:void(0)';

  var showDesc = function showDesc($event) {
    var elmt = document.querySelector("div#" + $event.srcElement.id);
    elmt.innerHTML = window.gm.ItemsLib[$event.srcElement.id].desc + "</br>"; //?? new...

    elmt.toggleAttribute("hidden");
  };

  entry.addEventListener("click", showDesc, false);
  var div = document.createElement('div');
  div.id = itemid;
  div.hidden = true;
  var entrySell = document.createElement('a'); //a link where you can sell

  entrySell.id = itemid;
  entrySell.href = 'javascript:void(0)';
  entrySell.textContent = "Sell";
  var desc2 = itemid + " (x" + count + ")";

  if (_available >= count) {
    var result = cbCanSell(itemid);

    if (result.OK === false) {
      desc2 = desc2 + " " + result.msg;
    } else {
      desc2 += " " + result.msg;

      var foo = function foo($event) {
        window.gm.sellToShop(itemid, count, cbPostSell);
      };

      entrySell.addEventListener("click", foo, false);
    }
  } else desc2 = desc2 + " not enough items";

  entry.textContent = desc2;
  $("div#panel")[0].appendChild(entry);
  $("div#panel")[0].appendChild(entrySell);
  $("div#panel")[0].appendChild(document.createElement('br'));
  $("div#panel")[0].appendChild(document.createElement('br'));
  $("div#panel")[0].appendChild(div);
}; //prints a link that when clicked picksup an item and places it in the inventory, if itemleft is <0, no link appears


window.gm.printPickupAndClear = function (itemid, desc, itemleft) {
  var cbAfterPickup = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;
  var elmt = '';
  var s = window.story.state;
  if (!(itemleft > 0)) return elmt;
  var desc2 = desc + " (" + itemleft + " left)";
  var msg = 'took ' + itemid;
  elmt += "<a0 id='" + itemid + "' onclick='(function($event){window.gm.pickupAndClear(\"" + itemid + "\", \"" + desc + "\"," + itemleft + "," + cbAfterPickup + ")})(this);'>" + desc2 + "</a></br>";
  return elmt;
};

window.gm.pickupAndClear = function (itemid, desc, itemleft) {
  var cbAfterPickup = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;
  window.gm.player.Inv.addItem(new window.storage.constructors[itemid]());
  if (cbAfterPickup) cbAfterPickup();
  window.gm.refreshAllPanel();
}; //prints an item with description; used in inventory


window.gm.printItem = function (id, descr, carrier) {
  var useOn = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;
  var elmt = '';
  var s = window.story.state;
  var _inv = window.gm.player.Inv;

  var _count = _inv.countItem(id);

  if (useOn === null) useOn = carrier;
  elmt += "<a0 id='".concat(id, "' onclick='(function($event){document.querySelector(\"div#").concat(id, "\").toggleAttribute(\"hidden\");})(this);'>").concat(id, " (x").concat(_count, ")</a>");

  var useable = _inv.usable(id);

  if (_count > 0 && useable.OK) {
    elmt += "<a0 id='".concat(id, "' onclick='(function($event){var _res=window.gm.player.Inv.use(\"").concat(id, "\"); window.gm.refreshAllPanel();window.gm.printOutput(_res.msg);}(this))'>").concat(useable.msg, "</a>");
  }

  elmt += "</br><div hidden id='".concat(id, "'>").concat(descr, "</div>");
  if (window.story.passage(id)) elmt += ''.concat("    [[Info|" + id + "]]"); //Todo add comands: drink,eat, use

  elmt += ''.concat("</br>");
  return elmt;
};

window.gm.printItem2 = function (id, descr, carrier) {
  var useOn = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;
  var elmt = '';
  var s = window.story.state;
  var _inv = carrier.Inv;

  var _count = _inv.countItem(id);

  if (useOn === null) useOn = carrier;

  var useable = _inv.usable(id);

  if (_count > 0 && useable.OK) {
    var entry = document.createElement('a');
    entry.href = 'javascript:void(0)';

    var foo = function (id, carrier, useOn) {
      var _res = carrier.Inv.use(id);

      window.gm.refreshAllPanel();
      window.gm.printOutput(_res.msg);
    }.bind(null, id, carrier, useOn);

    entry.addEventListener("click", foo);
    entry.textContent = id;
    $("div#choice")[0].appendChild(entry); // <- requires this node in html
  }
}; //prints an equipment with description; used in wardrobe


window.gm.printEquipment = function (id, descr) {
  var elmt = '';
  var s = window.story.state;
  var res;
  elmt += "<a0 id='".concat(id, "' onclick='(function($event){document.querySelector(\"div#").concat(id, "\").toggleAttribute(\"hidden\");})(this);'>").concat(id, "</a>");

  if (window.gm.player.Outfit.countItem(id) <= 0) {
    //elmt +=`<a0 id='${id}' onclick='(function($event){window.gm.player.Outfit.addItem(new window.storage.constructors[\"${id}\"]()); window.gm.refreshAllPanel();}(this))'>Equip</a>`;
    elmt += "<a0 id='".concat(id, "' onclick='(function($event){window.gm.player.Outfit.addItem(window.gm.player.Wardrobe.getItem(\"").concat(id, "\")); window.gm.refreshAllPanel();}(this))'>Equip</a>");
  } else {
    res = window.gm.player.Outfit.canUnequipItem(id, false);

    if (res.OK) {
      elmt += "<a0 id='".concat(id, "' onclick='(function($event){window.gm.player.Outfit.removeItem(\"").concat(id, "\"); window.gm.refreshAllPanel();}(this))'>Unequip</a>");
    } else {
      elmt += '<div>' + res.msg + '</div>';
    }
  }

  elmt += "</br><div hidden id='".concat(id, "'>").concat(descr, "</div>");
  if (window.story.passage(id)) elmt += ''.concat("    [[Info|" + id + "]]"); //Todo add comands: drink,eat, use

  elmt += ''.concat("</br>");
  return elmt;
}; //prints a string listing equipped items


window.gm.printEquipmentSummary = function () {
  var elmt = '';
  var s = window.story.state;
  var result = '';
  var ids = [];

  for (var i = 0; i < window.gm.player.Outfit.count(); i++) {
    if (i < window.gm.OutfitSlotLib.Feet) continue; //skip bodyparts

    var id = window.gm.player.Outfit.getItemId(i);

    if (id != '' && ids.indexOf(id) < 0) {
      ids.push(id);
      result += id + ',';
    }
  }

  return result;
}; //prints a string listing equipped items


window.gm.printRelationSummary = function () {
  var elmt = '';
  var s = window.story.state;
  var result = '';
  var ids = [];
  result += '<table>';
  var ids = window.gm.player.Rel.getAllIds();
  ids.sort();

  for (var k = 0; k < ids.length; k++) {
    if (ids[k].split("_").length === 1) {
      //ignore _min/_max
      var data = window.gm.player.Rel.get(ids[k]);
      result += '<tr><td>' + data.id + ':</td><td>' + data.value + ' of ' + window.gm.player.Rel.get(ids[k] + "_Max").value + '</td></tr>';
    }
  } //todo print mom : 10 of 20


  result += '</table>';
  return result;
}; //prints achievements


window.gm.printAchievements = function () {
  var elmt = '';
  var result = '';
  var ids = [];
  result += '<table>';
  var ids = Object.keys(window.gm.achievements);
  ids.sort();

  for (var k = 0; k < ids.length; k++) {
    if (ids[k].split("_").length === 1) {
      //ignore _min/_max
      result += '<tr><td>' + ids[k] + ':</td><td>' + window.gm.achievements[ids[k]] + '</td></tr>';
    }
  } //todo print mom : 10 of 20


  result += '</table>';
  return result;
}; //prints a string listing stats and effects


window.gm.printEffectSummary = function () {
  var who = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'player';
  var showstats = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;
  var showfetish = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
  var showresistane = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;
  var elmt = '';
  var s = window.story.state;
  var result = '';
  var ids = [];
  result += '<table>';
  var ids = window.story.state[who].Stats.getAllIds();
  ids.sort(); //Todo better sort

  for (var k = 0; k < ids.length; k++) {
    var data = window.story.state[who].Stats.get(ids[k]);
    var isFetish = data.id.slice(0, 2) === 'ft'; //Fetish starts with ft

    var isResistance = data.id.slice(0, 3) === 'rst'; //

    if (data.hidden !== 4) {
      if (isFetish && showfetish && !(data.id.slice(-4, -2) === '_M')) {
        //expects names of fetish like ftXXX and limits ftXXX_Min ftXXX_Max
        var min = window.story.state[who].Stats.get(ids[k] + "_Min");
        var max = window.story.state[who].Stats.get(ids[k] + "_Max");
        result += '<tr><td>' + (data.hidden & 0x1 ? '???' : data.id) + ':</td><td>' + (data.hidden & 0x2 ? '???' : data.value) + '</td>';
        result += '<td>' + (data.hidden & 0x2 ? '???' : '(' + (min.value + ' to ' + max.value)) + ')</td></tr>';
      }

      if (!isFetish && !isResistance && showstats || !isFetish && isResistance && showresistane) {
        result += '<tr><td>' + (data.hidden & 0x1 ? '???' : data.id) + ':</td><td>' + (data.hidden & 0x2 ? '???' : data.value) + '</td></tr>';
      } //todo show modifier list for each stat  agility: BracerLeather +2

    }
  }

  result += '</table>';
  result += '</br>Active Effects:<table>';
  ids = window.story.state[who].Effects.getAllIds();
  ids.sort(); //Todo better sort

  for (var i = 0; i < ids.length; i++) {
    var data = window.story.state[who].Effects.get(ids[i]);
    result += '<tr><td>' + data.id + ':</td><td>' + data.desc + '</td></tr>';
  }

  result += '</table>';
  return result;
}; ///show/hides a dialog defined in body


window.gm.toggleDialog = function (id) {
  var _id = id;
  var dialog = document.querySelector(id),
      closebutton = document.getElementById('close-dialog'),
      pagebackground = document.querySelector('body');
  var div;

  if (!dialog.hasAttribute('open')) {
    // show the dialog 
    div = document.createElement('div');
    div.id = 'backdrop';
    document.body.appendChild(div);
    dialog.setAttribute('open', 'open'); // after displaying the dialog, focus the closebutton inside it

    closebutton.focus();
    closebutton.addEventListener('click', function () {
      window.gm.toggleDialog(_id);
    });
  } else {
    dialog.removeAttribute('open');
    div = document.querySelector('#backdrop');
    div.parentNode.removeChild(div); //??lastFocus.focus();
  }
};

"use strict";

var Item = /*#__PURE__*/function () {
  function Item(name) {
    _classCallCheck(this, Item);

    this.id = this.name = name;
    this.tags = [];
  }

  _createClass(Item, [{
    key: "_relinkItems",
    value: function _relinkItems(parent) {
      this._parent = window.gm.util.refToParent(parent);
    } //called by SkillUseItem

  }, {
    key: "targetFilter",
    value: function targetFilter(targets) {
      return []; //default unuseable in combat
    }
  }, {
    key: "hasTag",
    value: function hasTag(tag) {
      return this.tags.includes(tag) >= 0;
    } //implement this for description

  }, {
    key: "usable",
    //context is the owner of item (parent of inventory), on is target (character)
    value: function usable(context) {
      var on = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
      return {
        OK: false,
        msg: 'Cannot use.'
      };
    }
  }, {
    key: "use",
    value: function use(context) {
      var on = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
      return {
        OK: false,
        msg: 'Cannot use.'
      };
    }
  }, {
    key: "onTimeChange",
    value: function onTimeChange(now) {}
  }, {
    key: "parent",
    get: function get() {
      return this._parent ? this._parent() : null;
    }
  }, {
    key: "desc",
    get: function get() {
      return this.descShort;
    } //implement this for description

  }, {
    key: "descShort",
    get: function get() {
      return this.name;
    }
  }]);

  return Item;
}(); //an Inventory-Component to store items


var Inventory = /*#__PURE__*/function () {
  function Inventory(externlist) {
    _classCallCheck(this, Inventory);

    this.list = externlist ? externlist : [];
    window.storage.registerConstructor(Inventory);
  }

  _createClass(Inventory, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("Inventory", this);
    }
  }, {
    key: "_relinkItems",
    value: function _relinkItems() {
      //call this after loading save data the reparent
      for (var i = 0; i < this.list.length; i++) {
        if (this.list[i].item) this.list[i].item._relinkItems(this);
      }
    }
  }, {
    key: "postItemChange",
    value: function postItemChange(id, operation, msg) {
      window.gm.pushLog('Inventory: ' + operation + ' ' + id + ' ' + msg);
    }
  }, {
    key: "count",
    value: function count() {
      return this.list.length;
    }
  }, {
    key: "countItem",
    value: function countItem(id) {
      var _i = this.findItemSlot(id);

      if (_i < 0) return 0;
      return this.list[_i].count;
    }
  }, {
    key: "findItemSlot",
    value: function findItemSlot(id) {
      for (var i = 0; i < this.count(); i++) {
        if (this.list[i].id === id) return i;
      }

      return -1;
    }
  }, {
    key: "getItemId",
    value: function getItemId(slot) {
      return this.list[slot].id;
    }
  }, {
    key: "getItem",
    value: function getItem(id) {
      var _idx = this.findItemSlot(id);

      if (_idx < 0) throw new Error('no such item: ' + id);
      return this.list[_idx].item;
    } //returns all Ids in list

  }, {
    key: "getAllIds",
    value: function getAllIds() {
      var ids = [];

      for (var i = 0; i < this.list.length; i++) {
        ids.push(this.list[i].id);
      }

      return ids;
    }
  }, {
    key: "addItem",
    value: function addItem(item) {
      var count = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;

      var _i = this.findItemSlot(item.id);

      if (_i < 0) {
        item._parent = window.gm.util.refToParent(this);
        this.list.push({
          id: item.id,
          count: count,
          item: item
        });
      } else this.list[_i].count += count;

      this.postItemChange(item.id, "added", "");
    }
  }, {
    key: "removeItem",
    value: function removeItem(id) {
      var count = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;

      var _i = this.findItemSlot(id);

      if (_i < 0) return; //just skip if not found

      this.list[_i].count -= count;
      if (this.list[_i].count < 1) this.list.splice(_i, 1);
      this.postItemChange(id, "removed", "");
    } //convience method to check if item is usable

  }, {
    key: "usable",
    value: function usable(id) {
      var on = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;

      var _item = this.getItem(id);

      return _item.usable(this, on);
    } //uses an item by calling item.use

  }, {
    key: "use",
    value: function use(id) {
      var on = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;

      var _item = this.getItem(id);

      var result = _item.use(this, on);

      if (result.OK) {
        this.postItemChange(id, "used", result.msg);
      }

      return result;
    }
  }, {
    key: "parent",
    get: function get() {
      return this._parent ? this._parent() : null;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      var _x = window.storage.Generic_fromJSON(Inventory, value.data);

      return _x;
    }
  }]);

  return Inventory;
}();

"use strict";

var Mob = /*#__PURE__*/function (_Character) {
  _inherits(Mob, _Character);

  var _super = _createSuper(Mob);

  function Mob() {
    var _this;

    _classCallCheck(this, Mob);

    _this = _super.call(this);
    _this.level_min = 1;
    _this.baseXPReward = 0;
    _this.loot = []; //[{id:'healthpotion', amount:1}]

    _this.levelUp(1);

    _this.autoLeveling();

    return _this;
  } //override to return the next move to execute
  //OK = false if no action, else true
  //msg should contain a message formatted for view (move description )g 
  //this function should decide what actions the mob takes; 
  //query _canAct to check if stunned or otherwise incapaciated, then run execCombatCmd(moveNOP) 


  _createClass(Mob, [{
    key: "calcCombatMove",
    value: function calcCombatMove(enemys, friends) {
      var rnd = _.random(1, 100);

      var result = {
        OK: true,
        msg: ''
      };
      result.action = result.target = null;

      if (rnd > 20) {
        rnd = _.random(0, enemys.length - 1);
        result.action = "Attack";
        result.target = [enemys[rnd]];
        result.msg = this.name + " trys to attack you.</br>" + result.msg;
      } else {
        //result=window.gm.Encounter.execCombatCmd(window.gm.combat.moveGuard);
        result.msg = this.name + " takes a defensive stance.</br>" + result.msg;
      }

      return result;
    } //return false if skill should be manually selected

  }, {
    key: "scaleLevel",
    //override to adjust the mobs attributes to player level
    value: function scaleLevel(lvl) {
      var x = Math.max(this.level_min, _.random(lvl - 3, lvl + 3));
      x = x - this.level;

      if (x > 0) {
        this.levelUp(1);
        this.autoLeveling();
      }
    }
  }, {
    key: "levelUp",
    value: function levelUp(add) {
      _get(_getPrototypeOf(Mob.prototype), "levelUp", this).call(this, add);

      this.baseXPReward = this.level * 20; //todo baseXP = sum of statpoints + skills ?
    }
  }, {
    key: "isAIenabled",
    get: function get() {
      return true;
    }
  }]);

  return Mob;
}(Character);

"use strict";
/* a player has an outfit describing which Equipment (wardrobe,utilities,..) he has equiped
*/
//this is a lookuptable for the equipmentslots
//basially you could create your own slotdefinition, the string is used to lookup properties assigned to list 


window.gm.OutfitSlotLib = {
  //b.. = bodyparts  (separated for mutation-slots)
  bBase: "bBase",
  //defines overall bodyform
  bFeet: "bFeet",
  bLegs: "bLegs",
  bTorso: "bTorso",
  bWings: "bWings",
  bSkin: "bSkin",
  // or fur,scales,...
  bPubicHair: "bPubicHair",
  bHeadHair: "bHeadHair",
  bArms: "bArms",
  bHands: "bHands",
  bNeck: "bNeck",
  bFace: "bFace",
  bEyes: "bEyes",
  bEars: "bEars",
  bMouth: "bMouth",
  bTongue: "bTongue",
  bTailBase: "bTailBase",
  bBreast: "bBreast",
  bNipples: "bNipples",
  bPenis: "bPenis",
  bBalls: "bBalls",
  bVulva: "bVulva",
  bClit: "bClit",
  bWomb: "bWomb",
  bAnus: "bAnus",
  // slots for wearables
  Feet: "Feet",
  Ankles: "Ankles",
  Legs: "Legs",
  Thighs: "Thighs",
  //
  Hips: "Hips",
  //belt
  Torso: "Torso",
  //dont use !
  Breast: "Breast",
  Nipples: "Nipples",
  Penis: "Penis",
  Balls: "Balls",
  Vulva: "Vulva",
  Clit: "Clit",
  Womb: "Womb",
  //??
  Anus: "Anus",
  TailBase: "TailBase",
  TailTip: "TailTip",
  Stomach: "Stomach",
  Chest: "Chest",
  Shoulders: "Shoulders",
  Wings: "Wings",
  Neck: "Neck",
  Head: "Head",
  HeadHair: "HeadHair",
  //for Hats
  Face: "Face",
  //for facemask
  Mouth: "Mouth",
  Nose: "Nose",
  Eyes: "Eyes",
  Ears: "Ears",
  Arms: "Arms",
  Wrists: "Wrists",
  LHand: "LHand",
  RHand: "RHand",
  //U  = under wear    P = piercing  T = tattoo  A = Above
  uFeet: "uFeet",
  //socks,stockings
  uAnkles: "uAnkles",
  //stockings, cuffs
  uLegs: "uLegs",
  //stockings
  uThighs: "uThighs",
  uHips: "uHips",
  uTorso: "uTorso",
  //not used !
  uBreast: "uBreast",
  //bra
  pNipples: "pNipples",
  tStomach: "tStomach",
  uPenis: "uPenis",
  pPenis: "pPenis",
  uBalls: "uBalls",
  pBalls: "pBalls",
  uVulva: "uVulva",
  pVulva: "pVulva",
  pClit: "pClit",
  uAnus: "uAnus",
  uTailBase: "uTailBase",
  uTailTip: "uTailTip",
  uStomach: "uStomach",
  uChest: "uChest",
  //bra
  uShoulders: "uShoulders",
  uWings: "uWings",
  uNeck: "uNeck",
  uHead: "uHead",
  //
  uHeadHair: "uHeadHair",
  uFace: "uFace",
  uMouth: "uMouth",
  pNose: "pNose",
  pEyes: "pEyes",
  pEars: "pEars",
  uArms: "uArms",
  uWrists: "uWrists",
  uLHand: "uLHand",
  uRHand: "uRHand"
}; //Todo equip on other char:
//move from own inventory to chars, equip, if impossible undo 

var Equipment = /*#__PURE__*/function (_Item) {
  _inherits(Equipment, _Item);

  var _super2 = _createSuper(Equipment);

  function Equipment(name) {
    var _this2;

    _classCallCheck(this, Equipment);

    _this2 = _super2.call(this, name);
    _this2.slotUse = []; //which slot is used by the equip

    _this2.slotCover = []; //which other slots are invisible by this "uses Breast, covers bBreast,bNipples"

    _this2.bonus = []; //Curse or Bonus assigned to item

    _this2.lewd = {
      slut: 0,
      bondage: 0,
      sm: 0
    }; //slutiness-rating 

    return _this2;
  }

  _createClass(Equipment, [{
    key: "_relinkItems",
    value: function _relinkItems(parent) {
      //call this after loading save data to reparent
      _get(_getPrototypeOf(Equipment.prototype), "_relinkItems", this).call(this, parent);

      var _iterator17 = _createForOfIteratorHelper(this.bonus),
          _step17;

      try {
        for (_iterator17.s(); !(_step17 = _iterator17.n()).done;) {
          el = _step17.value;

          el._relinkItems(this);
        }
      } catch (err) {
        _iterator17.e(err);
      } finally {
        _iterator17.f();
      }
    } //for compatibility with item

  }, {
    key: "usable",
    value: function usable(context) {
      return {
        OK: false,
        msg: 'Useable in wardrobe'
      };
    }
  }, {
    key: "use",
    value: function use(context) {
      return {
        OK: false,
        msg: 'Cannot use.'
      };
    } //more detailed description that should reflet if the item is worn or not; 

  }, {
    key: "descLong",
    value: function descLong(fconv) {
      var msg = '';

      var rnd = _.random(0, 100);

      if (this.isEquipped()) {
        if (rnd > 50) msg = '$[I]$ $[wear]$ ' + this.name + '.';else msg = 'A ' + this.name + ' adorns $[me]$.';
      } else {
        if (rnd > 50) msg = '$[I]$ $[own]$ ' + this.name + ".";else msg = '$[I]$ $[have]$ ' + this.name + ".";
      }

      return fconv(msg);
    }
  }, {
    key: "bonusDesc",
    value: function bonusDesc() {
      var msg = '';

      var _iterator18 = _createForOfIteratorHelper(this.bonus),
          _step18;

      try {
        for (_iterator18.s(); !(_step18 = _iterator18.n()).done;) {
          el = _step18.value;
          msg += "</br>" + el.desc;
        }
      } catch (err) {
        _iterator18.e(err);
      } finally {
        _iterator18.f();
      }

      return msg;
    }
  }, {
    key: "isEquipped",
    value: function isEquipped() {
      return this.parent.parent.Outfit && this.parent.parent.Outfit.findItemSlot(this.id).length > 0;
    }
  }, {
    key: "canEquip",
    value: function canEquip(context) {
      if (this.parent && this.parent.parent.Outfit.findItemSlot(this.id).length > 0) return this.canUnequip(); //if you try to equip the same outfit another time it should unequip 
      else return {
          OK: true,
          msg: 'equipable'
        };
    }
  }, {
    key: "canUnequip",
    value: function canUnequip() {
      var res = {
        OK: true,
        msg: 'unequipable'
      };

      var _iterator19 = _createForOfIteratorHelper(this.bonus),
          _step19;

      try {
        for (_iterator19.s(); !(_step19 = _iterator19.n()).done;) {
          el = _step19.value;
          res = el.canUnequip();
          if (res.OK === false) return res;
        }
      } catch (err) {
        _iterator19.e(err);
      } finally {
        _iterator19.f();
      }

      return res;
    }
  }, {
    key: "onEquip",
    value: function onEquip(context) {
      var _iterator20 = _createForOfIteratorHelper(this.bonus),
          _step20;

      try {
        for (_iterator20.s(); !(_step20 = _iterator20.n()).done;) {
          el = _step20.value;
          el.onEquip();
        }
      } catch (err) {
        _iterator20.e(err);
      } finally {
        _iterator20.f();
      }

      return {
        OK: true,
        msg: 'equipped'
      };
    }
  }, {
    key: "onUnequip",
    value: function onUnequip() {
      var res = {
        OK: true,
        msg: ''
      };

      var _iterator21 = _createForOfIteratorHelper(this.bonus),
          _step21;

      try {
        for (_iterator21.s(); !(_step21 = _iterator21.n()).done;) {
          el = _step21.value;
          el.onUnequip();
        }
      } catch (err) {
        _iterator21.e(err);
      } finally {
        _iterator21.f();
      }

      return res;
    }
  }, {
    key: "onTimeChange",
    value: function onTimeChange(now) {
      var _iterator22 = _createForOfIteratorHelper(this.bonus),
          _step22;

      try {
        for (_iterator22.s(); !(_step22 = _iterator22.n()).done;) {
          el = _step22.value;
          el.onTimeChange(now);
        }
      } catch (err) {
        _iterator22.e(err);
      } finally {
        _iterator22.f();
      }
    }
  }, {
    key: "desc",
    get: function get() {
      return this.descShort + this.bonusDesc();
    }
  }]);

  return Equipment;
}(Item); //a kind of special inventory for worn equipment


var Outfit = /*#__PURE__*/function () {
  //extends Inventory{
  function Outfit() {
    _classCallCheck(this, Outfit);

    this.list = {}; //this.list.Legs = {id:'Leggings' item:x}

    this.list[Symbol.iterator] = function () {
      //need iterator for for..of
      var index = -1;
      var arr = this;
      var items = Object.keys(this);
      return {
        next: function next() {
          while (true) {
            index++;
            if (index >= items.length) return {
              done: true
            };
            if (arr[items[index]] !== undefined) break;
          }

          return {
            done: false,
            value: {
              index: items[index],
              value: arr[items[index]]
            }
          };
        }
      };
    };

    window.storage.registerConstructor(Outfit);
  }

  _createClass(Outfit, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("Outfit", this);
    }
  }, {
    key: "postItemChange",
    value: function postItemChange(id, operation, msg) {
      window.gm.pushLog('Outfit: ' + operation + ' ' + id + ' ' + msg);
    }
  }, {
    key: "_relinkItems",
    value: function _relinkItems() {
      //call this after loading save data to reparent
      var _iterator23 = _createForOfIteratorHelper(this.list),
          _step23;

      try {
        for (_iterator23.s(); !(_step23 = _iterator23.n()).done;) {
          el = _step23.value;

          if (el.value.item) {
            el.value.item._relinkItems(this);
          }
        }
      } catch (err) {
        _iterator23.e(err);
      } finally {
        _iterator23.f();
      }
    }
  }, {
    key: "postItemChange",
    value: function postItemChange(id, operation, msg) {
      window.gm.pushLog('Outfit: ' + operation + ' ' + id + ' ' + msg);
    }
  }, {
    key: "count",
    value: function count() {
      return Object.keys(this.list).length;
    } //count how many slots are used by an item

  }, {
    key: "countItem",
    value: function countItem(id) {
      var _i = this.findItemSlot(id);

      return _i.length;
    } //detect which slots are used by a item

  }, {
    key: "findItemSlot",
    value: function findItemSlot(id) {
      var _idx = [];

      var _iterator24 = _createForOfIteratorHelper(this.list),
          _step24;

      try {
        for (_iterator24.s(); !(_step24 = _iterator24.n()).done;) {
          el = _step24.value;
          if (el.value.id === id) _idx.push(el.index);
        }
      } catch (err) {
        _iterator24.e(err);
      } finally {
        _iterator24.f();
      }

      return _idx;
    }
  }, {
    key: "getItemId",
    value: function getItemId(slot) {
      var item = this.list[slot];
      return item ? item.id : "";
    } //override because findItemSlot returns array

  }, {
    key: "getItem",
    value: function getItem(id) {
      var _idx = this.findItemSlot(id);

      if (_idx.length < 0) throw new Error('no such item: ' + id);
      return this.list[_idx[0]].item;
    } //returns all Ids in list

  }, {
    key: "getAllIds",
    value: function getAllIds() {
      var ids = [];

      var _iterator25 = _createForOfIteratorHelper(this.list),
          _step25;

      try {
        for (_iterator25.s(); !(_step25 = _iterator25.n()).done;) {
          el = _step25.value;

          if (el.value.item && ids.indexOf(el.value.item.id) < 0) {
            //only unique items  
            ids.push(el.value.item.id);
          }
        }
      } catch (err) {
        _iterator25.e(err);
      } finally {
        _iterator25.f();
      }

      return ids;
    }
  }, {
    key: "getItemForSlot",
    value: function getItemForSlot(slot) {
      var item = this.list[slot];
      return item ? item.item : null;
    }
  }, {
    key: "canEquipSlot",
    value: function canEquipSlot(slot) {
      return {
        OK: true
      };
    }
  }, {
    key: "canUnequipSlot",
    value: function canUnequipSlot(slot) {
      return {
        OK: true
      };
    }
  }, {
    key: "canUnequipItem",
    value: function canUnequipItem(id, force) {
      var _idx = this.findItemSlot(id);

      var _item = this.getItem(id);

      var result = _item.canUnequip();

      for (var i = 0; i < _idx.length; i++) {
        var _tmp = this.canUnequipSlot(_idx[i]);

        if (!_tmp.OK) result.msg += _tmp.msg + " ";
        result.OK = result.OK && _tmp.OK;
      }

      return result;
    } //this will equip item if possible

  }, {
    key: "addItem",
    value: function addItem(item, force) {
      var _idx = this.findItemSlot(item.id);

      if (_idx.length > 0) return; //already equipped

      var _item = item;
      _idx = _item.slotUse;
      var _oldIDs = [];
      var _oldSlots = [];
      var result = {
        OK: true,
        msg: ''
      }; //check if equipment is equipable

      result = item.canEquip(this);

      if (result.OK) {
        for (var l = 0; l < _idx.length; l++) {
          //check if the current equip can be unequipped
          var oldId = this.getItemId(_idx[l]);
          if (oldId === '') continue;

          if (_oldIDs.indexOf(oldId) < 0) {
            _oldIDs.push(oldId);

            _oldSlots = _oldSlots.concat(this.getItem(oldId).slotUse);
          }

          var _tmp = this.canUnequipItem(oldId);

          if (!_tmp.OK) result.msg += _tmp.msg; //todo duplicated msg if item uses multiple slots

          result.OK = result.OK && _tmp.OK; //Todo  check if slot is available fo equip this canEquipSlot(_idx[l])
        }
      }

      if (!result.OK) {
        this.postItemChange(_item.name, "equip_fail:", result.msg);
        return;
      }

      for (var m = 0; m < _oldIDs.length; m++) {
        this.getItem(_oldIDs[m]).onUnequip(this);
      }

      for (var i = 0; i < _oldSlots.length; i++) {
        this.__clearSlot(_oldSlots[i]);
      }

      for (var k = 0; k < _idx.length; k++) {
        var _el = this.list[_idx[k]];

        if (!_el) {
          this.list[_idx[k]] = _el = {
            id: '',
            item: null
          };
        }

        this.list[_idx[k]].id = _item.id;
        this.list[_idx[k]].item = _item;
      }

      _item._parent = window.gm.util.refToParent(this); //Todo currently we have 2 copies of equipment - 1 for wardrobe 1 for outfit otherwise this will not work

      result = _item.onEquip(this);
      this.postItemChange(_item.name, "equipped", result.msg);
    } //assumme that it was checked before that unequip is allowed

  }, {
    key: "__clearSlot",
    value: function __clearSlot(slot, force) {
      var item = this.list[slot];

      if (item) {
        item.id = '', item.item = null;
      }
    }
  }, {
    key: "removeItem",
    value: function removeItem(id, force) {
      var _idx = this.findItemSlot(id);

      if (_idx.length === 0) return; //already unequipped

      var result = force ? {
        OK: true,
        msg: ''
      } : this.canUnequipItem(id);

      if (!result.OK) {
        this.postItemChange(id, "unequip_fail", result.msg);
        return;
      }

      var _item = this.getItem(id);

      result = _item.onUnequip(this);

      for (var i = 0; i < _idx.length; i++) {
        this.__clearSlot(_idx[i]);
      }

      this.postItemChange(id, "removed", result.msg); //Todo delete _item;    //un-parent
    }
  }, {
    key: "updateTime",
    value: function updateTime() {
      var now = window.gm.getTime();

      var _iterator26 = _createForOfIteratorHelper(this.list),
          _step26;

      try {
        for (_iterator26.s(); !(_step26 = _iterator26.n()).done;) {
          el = _step26.value;
          var _eff = el.value.item;
          if (_eff) _eff.onTimeChange(now);
        }
      } catch (err) {
        _iterator26.e(err);
      } finally {
        _iterator26.f();
      }
    }
    /**
     * returns all items that can be seen (Breast-armor hides breast-underwear hides breast)
     */

  }, {
    key: "getVisibleSlots",
    value: function getVisibleSlots() {
      var covered = [],
          seen = [];
      var lstIds = this.getAllIds();

      for (var i = lstIds.length - 1; i >= 0; i--) {
        var item = this.getItem(lstIds[i]);
        covered = covered.concat(item.slotCover);
        seen = seen.concat(item.slotUse);
      }

      function remCovered(elm) {
        return !covered.includes(elm);
      }

      seen = seen.filter(remCovered);
      return seen;
    }
  }, {
    key: "getLewdness",
    value: function getLewdness() {
      var total = {},
          lewd = {};
      var item,
          slots = this.getVisibleSlots();

      for (var i = 0; i < slots.length - 1; i++) {
        item = this.getItemForSlot(slots[i]);

        if (item && !lewd[item.id]) {
          //no double count items  
          lewd[item.id] = item.lewd;
        }
      }

      var _keys = Object.keys(lewd); // {slut:0,sm:2}


      for (var i = 0; i < _keys.length; i++) {
        item = lewd[_keys[i]];

        var _keys2 = Object.keys(item);

        for (var _i2 = 0, _keys3 = _keys2; _i2 < _keys3.length; _i2++) {
          el = _keys3[_i2];
          if (total.hasOwnProperty(el)) total[el] += item[el];else total[el] = item[el];
        }
      }

      return total;
    }
  }, {
    key: "parent",
    get: function get() {
      return this._parent ? this._parent() : null;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(Outfit, value.data);
    }
  }]);

  return Outfit;
}();

"use strict";
/* classes to manage a quest
 */
///////////////////////////////////////////////////////////////


var QuestMilestone = /*#__PURE__*/function () {
  function QuestMilestone(id, name, descr, CondCheckCB) {
    var HiddenCB = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : null;

    _classCallCheck(this, QuestMilestone);

    this.id = id, this.name = name;
    this.HiddenCB = HiddenCB === null ? function () {
      return false;
    } : HiddenCB;
    this.descr = descr;
    this.CondCheckCB = CondCheckCB;
    window.storage.registerConstructor(QuestMilestone);
  }

  _createClass(QuestMilestone, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("QuestMilestone", this);
    }
  }, {
    key: "evaluateCondition",
    //return value: 0 = condition nok, -1 = condition ok- quest finished, >0 condition ok & next MileID 
    value: function evaluateCondition() {
      return this.CondCheckCB();
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      var _x = window.storage.Generic_fromJSON(QuestMilestone, value.data);

      return _x;
    }
  }]);

  return QuestMilestone;
}(); // a Quest contains multiple milestones


var Quest = /*#__PURE__*/function () {
  function Quest(id, name, descr) {
    var HiddenCB = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;

    _classCallCheck(this, Quest);

    this.id = id, this.name = name, this.descr = descr;
    this.HiddenCB = HiddenCB === null ? function () {
      return false;
    } : HiddenCB;
    this.miles = new Map();
    window.storage.registerConstructor(Quest);
  }

  _createClass(Quest, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("Quest", this);
    }
  }, {
    key: "getMileById",

    /* those are not used - see questmanager
    getCurrMile() {
        return(this.mile);
    }
    questUpdated() {
        let nodeChangeEvent = new Event("change");
        nodeChangeEvent.id = this.id;
        this.pubSub.publish("change",nodeChangeEvent)
    }
     //returns the Quest & Milestone description for Quest-Log
    getLogDescription(){
        if (this.hidden()) return("");
    var log= this.descr+"</br>";
    if(this.getCurrMile()!=null && !this.getCurrMile().hidden) log+= this.getCurrMile().descr+"</br>";
    return(log);
    }
    activateMileByID(id){
        var _mile = this.getMileById(id);
        if (_mile !== null) {
            if (this.mile != null && this.mile.ExitMilestoneCB!==null) {
                this.mile.ExitMilestoneCB();
            }
            this.mile = _mile;
            if (this.mile != null && this.mile.EnterMilestoneCB !== null) {
                this.mile.EnterMilestoneCB();
            }
              if (!this.mile.hidden) {
                this.hidden=false;
                this.questUpdated();
            }
        }
    }
       // check here if progress to next milestone can be made (Condition of current MS met)
    // if there is no curent MS set, this quest is not started; 
    // the condition of the MS is the EXIT-condition
    evaluateCondition(){
        if (this.finished )  return;
        var Next = -1;
    if(this.mile !== null) {
    Next = this.mile.evaluateCondition();
    } 
    if (Next === -1) {
    this.finished = true;
    }else if (Next > 0) {
    this.activateMileByID(Next);
    }
    }*/
    value: function getMileById(ID) {
      if (this.miles.has(ID)) return this.miles.get(ID);
      return null;
    }
  }, {
    key: "addMileStone",
    value: function addMileStone(Mile) {
      if (Mile !== null) {
        this.miles.set(Mile.id, Mile);
      }
      /*if (this.mile === null) {
          this.mile = Mile; //automatical activate entry milestone
          this.hidden = Mile.hidden;
      }*/

    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      var _x = window.storage.Generic_fromJSON(Quest, value.data);

      return _x;
    }
  }]);

  return Quest;
}(); // QuestData only contains the state of the quests (finished, active milestone) but no function
// dont change the data manually - this is done by QuestManager ! 
// separation is necessary for save/reload issue


var QuestData = /*#__PURE__*/function () {
  function QuestData() {
    _classCallCheck(this, QuestData);

    this.activeQuests = []; //{id:"xyz",flags:0x0}

    this.activeQuestsMS = [];
    this.finishedQuests = [];
    this.finishedQuestsMS = [];
    window.storage.registerConstructor(QuestData);
  }

  _createClass(QuestData, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("QuestData", this);
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      var _x = window.storage.Generic_fromJSON(QuestData, value.data);

      return _x;
    }
  }]);

  return QuestData;
}(); // the Questmanager contains a list of all quests
// because of save/restore issues this contains only the IDs of the active quest and milestones; all other data is defined in questDef
// todo: this should be singleton
// todo rebuild old quest-milestone structure !!


var QuestManager = /*#__PURE__*/function () {
  //questDef is an object with properties that contain a quest-object and its milestones: questDef["myQuest"] = new Quest("myQuest") 
  function QuestManager(questDef) {
    _classCallCheck(this, QuestManager);

    this.pubSub = window.gm.util.PubSub();
    this.questDef = questDef;
  } // data is a QuestData-Object


  _createClass(QuestManager, [{
    key: "setQuestData",
    value: function setQuestData(data) {
      this.questData = data;
    }
  }, {
    key: "questUpdated",
    value: function questUpdated(questId) {
      var nodeChangeEvent = new Event("change");
      nodeChangeEvent.questId = questId;
      this.pubSub.publish("change", nodeChangeEvent); //alert(id);
    } //can be used to progress a active quest to next milestone if its at current milestone
    //tick will be called to check for finished or progress-condition

  }, {
    key: "forceQuestMilestone",
    value: function forceQuestMilestone(questId, mileId, reqMileId) {
      var needsUpdate = false;

      for (var i = 0; i < this.questData.activeQuests.length; i++) {
        var qID = this.questData.activeQuests[i].id;
        var msID = this.questData.activeQuestsMS[i].id;

        if (qID === questId && reqMileId === msID) {
          this.questData.activeQuestsMS[i].id = mileId;
          needsUpdate = true;
        }
      }

      if (needsUpdate) this.tick();else {
        window.gm.pushLog("cant force " + questId + " to " + mileId);
      }
    } //this will get called - sometimes - and will trigger the conditioncheck of the milestones

  }, {
    key: "tick",
    value: function tick() {
      var tickAgain = false;
      var tmpfinishedQuest = [];

      for (var i = 0; i < this.questData.activeQuests.length; i++) {
        var qID = this.questData.activeQuests[i].id;
        var msID = this.questData.activeQuestsMS[i].id;
        var quest = this.questDef[qID];
        var mile = quest.getMileById(msID); //if (quest.finished ) continue;

        var Next = -1;

        if (!mile) {
          throw new Error("cant find mileId " + msID + " in " + quest.id);
        }

        Next = mile.evaluateCondition();

        if (Next === -1) {
          tmpfinishedQuest.push(i);
        } else if (Next > 0) {
          this.questData.activeQuestsMS[i].id = Next;
          if (!quest.getMileById(Next).HiddenCB()) this.questUpdated(qID);
          tickAgain = true;
        }
      } //remove finished quests


      for (var k = tmpfinishedQuest.length - 1; k >= 0; k--) {
        this.questData.finishedQuests.push(this.questData.activeQuests[tmpfinishedQuest[k]]);
        this.questData.finishedQuestsMS.push(this.questData.activeQuestsMS[tmpfinishedQuest[k]]);
        this.questData.activeQuests.splice(tmpfinishedQuest[k], 1);
        this.questData.activeQuestsMS.splice(tmpfinishedQuest[k], 1); //if(!this.questDef[qID].getMileById(msId).HiddenCB()) this.questUpdated(qID);
      } // sometimes not only one milestone is fullfilled but several
      // so we need to recheck again until no more progressing milestone
      // also required to remove finished quests 


      if (tickAgain) this.tick();
    }
  }, {
    key: "getMilestoneState",
    value: function getMilestoneState(questId) {
      for (var i = 0; i < this.questData.activeQuests.length; i++) {
        if (questId === this.questData.activeQuests[i].id) return this.questData.activeQuestsMS[i];
      }

      for (var i = 0; i < this.questData.finishedQuests.length; i++) {
        if (questId === this.questData.finishedQuests[i].id) return this.questData.finishedQuestsMS[i];
      }

      return {};
    }
  }, {
    key: "getQuestState",
    value: function getQuestState(questId) {
      for (var i = 0; i < this.questData.activeQuests.length; i++) {
        if (questId === this.questData.activeQuests[i].id) return this.questData.activeQuests[i];
      }

      for (var i = 0; i < this.questData.finishedQuests.length; i++) {
        if (questId === this.questData.finishedQuests[i].id) return this.questData.finishedQuests[i];
      }

      return {};
    } // cchecks if the quest is active and, if given, has the certain milestone

  }, {
    key: "hasActiveQuest",
    value: function hasActiveQuest(questId) {
      var msId = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;

      for (var i = 0; i < this.questData.activeQuests.length; i++) {
        if (questId === this.questData.activeQuests[i].id && (msId === null || msId === this.questData.activeQuestsMS[i].id)) return true;
      }

      return false;
    }
  }, {
    key: "hasFinishedQuest",
    value: function hasFinishedQuest(questId) {
      var msId = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;

      for (var i = 0; i < this.questData.finishedQuests.length; i++) {
        if (questId === this.questData.finishedQuests[i].id && (msId === null || msId === this.questData.finishedQuestsMS[i].id)) return true;
      }

      return false;
    } //add & start a quest if not existent; if noRedo==false, finished quests will be restarted

  }, {
    key: "addQuest",
    value: function addQuest(questId, msID) {
      var noRedo = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;
      if (!noRedo) this.removeQuest(questId); //remove from finished if redoing a quest

      if (!(this.hasActiveQuest(questId) || this.hasFinishedQuest(questId))) {
        this.questData.activeQuests.push({
          id: questId,
          flags: 0
        });
        this.questData.activeQuestsMS.push({
          id: msID
        });
        if (!this.questDef[questId].getMileById(msID).HiddenCB()) this.questUpdated(questId);
      }
    } //removes quest from active&finished

  }, {
    key: "removeQuest",
    value: function removeQuest(Id) {
      for (var i = this.questData.activeQuests.length - 1; i >= 0; i--) {
        if (this.questData.activeQuests[i].id === Id) {
          this.questData.activeQuests.splice(i, 1);
          this.questData.activeQuestsMS.splice(i, 1);
        }
      }

      for (var i = this.questData.finishedQuests.length - 1; i >= 0; i--) {
        if (this.questData.finishedQuests[i].id === Id) {
          this.questData.finishedQuests.splice(i, 1);
          this.questData.finishedQuestsMS.splice(i, 1);
        }
      }
    }
    /*getQuestCount(){
    return(this.quests.length);
    }
      getQuestById(Id){
        if (this.quests.has(Id)) {
            return(this.quests.get(Id));
        }
        return(null);
    }
    tick() {
        for (let [key, value] of this.quests.entries( )) {
            value.evaluateCondition();
          }
    }
    addQuest(quest){
        quest.pubSub.subscribe("change", this.questUpdated)
        this.quests.set(quest.id, quest);    //Todo update 
    }
    removeQuest(Id) {
        if (this.quests.has(Id)) {
            //todo quest.removeEventListener("change",this.questUpdated)
            this.quests.delete(Id);
          }
    }*/

  }]);

  return QuestManager;
}();

"use strict"; //operations for save/reload
// ??window.onload = function() {};


window.storage = {
  // A list of constructors the smart reviver should know about  
  // you need to register the class of each object that you want to serialize to this list
  // and each class also has to have a method toJSON and static method fromJSON (calling Generic_-versions, see below )
  // the namme of ctor needs to be unique !
  constructors: {},
  registerConstructor: function registerConstructor(ctor) {
    window.storage.constructors[ctor.name] = ctor;
  },
  // A generic "smart reviver" function.
  // Looks for object values with a `ctor` property and
  // a `data` property. If it finds them, and finds a matching
  // constructor that has a `fromJSON` property on it, it hands
  // off to that `fromJSON` fuunction, passing in the value.
  Reviver: function Reviver(key, value) {
    //console.info( 'reviver with key =' + key )
    var ctor;

    if (value !== null && _typeof(value) === "object" && typeof value.ctor === "string" && typeof value.data !== "undefined") {
      ctor = window.storage.constructors[value.ctor] || window[value.ctor];

      if (typeof ctor === "function" && typeof ctor.fromJSON === "function") {
        return ctor.fromJSON(value);
      }
    }

    return value;
  },
  //this function works with Json.stringify to remove circular references
  // unused because Reviver has even more problems with that

  /*_replacerFunc: function(){
    const visited = new WeakSet();
    return (key, value) => {
      if (value !== null && typeof value === "object") {
        if (visited.has(value)) {  return;  }
        visited.add(value);
      }
      return value;
    };
  },*/
  // A generic "toJSON" function that creates the data expected by Reviver.
  // `ctorName`  The name of the constructor to use to revive it
  // `obj`       The object being serialized
  // `keys`      (Optional) Array of the properties to serialize,
  //             if not given then all of the objects "own" properties
  //             that don't have function values will be serialized.
  //             (Note: If you list a property in `keys`, it will be serialized
  //             regardless of whether it's an "own" property.)
  // Returns:    The structure (which will then be turned into a string
  //             as part of the JSON.stringify algorithm)
  // Stringify it with a replacer: var str = JSON.stringify(myObj);
  Generic_toJSON: function Generic_toJSON(ctorName, obj, keys) {
    var data, index, key;

    if (!keys) {
      keys = Object.keys(obj); // Only "own" properties are included
    }

    data = {};

    for (index = 0; index < keys.length; ++index) {
      key = keys[index];
      data[key] = obj[key]; //causes infinite loop on circular ref   Character->Inventory->Character
    }

    return {
      ctor: ctorName,
      data: data
    };
  },
  // A generic "fromJSON" function for use with Reviver: Just calls the
  // constructor function with no arguments, then applies all of the
  // key/value pairs from the raw data to the instance.
  // Only useful for constructors that can be reasonably called without arguments!
  // `ctor`      The constructor to call
  // `data`      The data to apply
  // Returns:    The object
  Generic_fromJSON: function Generic_fromJSON(ctor, data) {
    var obj, name, setter, setter2;
    obj = new ctor();

    for (name in data) {
      setter = "set" + name[0].toUpperCase() + name.substr(1); // we get the name of the setter for that property (e.g. : key=property => setter=setProperty
      // that kind of names cannot be found in obj??? setter2 = "set "+name.substr(1); // e.g. : key=_property => setter=set property   (javascript style setter)

      if (setter in obj) {
        // if the setter exists 
        obj[setter](data[name]); // we call the setter
        // } else if(setter2 in obj){ // ..or...
        //   obj[setter2](data[name]); 
      } else {
        // if not, we set it directly
        if (_typeof(obj[name]) === "object" && data[name] !== null) {
          //cannot assign(curse,null)
          if (obj[name] === null) obj[name] = data[name]; //obj[name]={};

          Object.assign(obj[name], data[name]);
        } else {
          obj[name] = data[name]; //todo ??? obj[name] is constructed properly but will be overwritten with data[name]; use assign ?!
        }
      }
    }

    return obj;
  },
  ok: function ok() {
    try {
      var storage = window["localStorage"],
          x = '__storage_test__';
      storage.setItem(x, x);
      storage.removeItem(x);
      return true;
    } catch (e) {
      return e instanceof DOMException && ( // everything except Firefox
      e.code === 22 || // Firefox
      e.code === 1014 || // test name field too, because code might not be present
      // everything except Firefox
      e.name === 'QuotaExceededError' || // Firefox
      e.name === 'NS_ERROR_DOM_QUOTA_REACHED') && // acknowledge QuotaExceededError only if there's something already stored
      storage.length !== 0;
    }
  },
  delete: function _delete(slot) {
    window.localStorage.removeItem(window.story.name + slot);
    window.localStorage.removeItem(window.story.name + slot.concat('info'));
  },
  getSaveInfo: function getSaveInfo(slot) {
    var info = null;

    if (window.storage.ok()) {
      info = window.localStorage.getItem(window.story.name + slot.concat('info'));
    }

    if (!info) {
      return '';
    }

    return info;
  },
  compressLocalSave: false,
  //this is for debugging (save file uncompressed)
  loadFile: function loadFile(input) {
    var file = input.files[0];
    var fileReader = new FileReader();

    fileReader.onload = function () {
      var _blobs = fileReader.result.split("!achievements!");

      window.storage.rebuildFromSave(_blobs[0], window.storage.compressLocalSave);
      window.storage.rebuildAchievements(_blobs[1], window.storage.compressLocalSave);
      var div = document.querySelector('#backdrop'); //see save/load dialog

      div.parentNode.removeChild(div);
    };

    fileReader.onerror = function () {
      alert(fileReader.error);
    };

    fileReader.readAsText(file);
    return true; //todo how to make async
  },
  saveFile: function saveFile() {
    var hash = JSON.stringify({
      state: window.story.state,
      history: window.story.history,
      checkpointName: window.story.checkpointName
    });
    var ahash = window.storage.getAchievements();

    if (window.storage.compressLocalSave) {
      hash = LZString.compressToBase64(hash);
      ahash = LZString.compressToBase64(ahash);
    }

    var filename = window.story.name + "_Save.dat";
    var blob = new Blob([hash, "!achievements!", ahash], {
      type: "text/plain;charset=utf-8"
    });
    saveAs(blob, filename);
  },
  saveBrowser: function saveBrowser(slot) {
    //var hash= window.story.save();    this call somehow messes up html and I had to copy the following from snowman script
    //always compress or storage could be full soon !
    var hash = LZString.compressToBase64(JSON.stringify({
      state: window.story.state,
      history: window.story.history,
      checkpointName: window.story.checkpointName
    }));
    var ahash = LZString.compressToBase64(window.storage.getAchievements());
    var options = {
      year: "numeric",
      month: "short",
      day: "numeric",
      hour: "numeric",
      minute: "numeric",
      second: "numeric"
    };
    var info = window.gm.player.location + ' - ' + new Intl.DateTimeFormat("default", options).format(new Date()); //add storyname to avoid conflict with other games on same host (see Document.origin)

    window.localStorage.setItem(window.story.name + slot.concat('info'), info);
    window.localStorage.setItem(window.story.name + slot, hash);
    window.localStorage.setItem(window.story.name + 'achievements', ahash);
    return info;
  },
  loadBrowser: function loadBrowser(slot) {
    var hash, info;

    if (window.storage.ok()) {
      //not possible to save object {info,hash} ??
      hash = window.localStorage.getItem(window.story.name + slot);
      info = window.storage.getSaveInfo(window.story.name + slot);
      window.storage.rebuildFromSave(hash, true);
      var ahash = window.localStorage.getItem(window.story.name + 'achievements');
      window.storage.loadAchivementsFromBrowser();
    }

    return info;
  },
  rebuildFromSave: function rebuildFromSave(hash, compressed) {
    if (!compressed) hash = LZString.compressToBase64(hash); //copied from window.story.restore because reviver  //window.story.restore(hash) ;

    var save = JSON.parse(LZString.decompressFromBase64(hash), window.storage.Reviver);
    window.story.state = save.state;
    window.story.history = save.history;
    window.story.checkpointName = save.checkpointName;
    window.gm.rebuildObjects(); // this is for handling version-upgrades

    window.gm.postVictory(); //teleport into dng or other location   
  },
  getAchievements: function getAchievements() {
    var ahash = JSON.stringify({
      achievements: window.gm.achievements
    });
    return ahash;
  },
  loadAchivementsFromBrowser: function loadAchivementsFromBrowser() {
    if (window.storage.ok()) {
      var ahash = window.localStorage.getItem(window.story.name + 'achievements');
      if (ahash !== null) window.storage.rebuildAchievements(ahash, true);
    }
  },
  rebuildAchievements: function rebuildAchievements(ahash, compressed) {
    if (!compressed) ahash = LZString.compressToBase64(ahash);
    var achievements = JSON.parse(LZString.decompressFromBase64(ahash)).achievements; //it might be necessary to adapt the achievements here if a newer game-version is started !

    var _keys = Object.keys(window.gm.achievements);

    for (var i = 0; i < _keys.length; i++) {
      if (achievements.hasOwnProperty(_keys[i])) {
        var _old = achievements[_keys[i]];
        var _now = window.gm.achievements[_keys[i]];
        if (_old > _now) window.gm.achievements[_keys[i]] = _old; //merge loaded achievements into present
      }
    }
  }
};
/*  //save demo
window.gm.testsaveReviver = function () {
  window.storage.registerConstructor(Bar);
  window.storage.registerConstructor(Foo);
  var before = {
    foo: new Foo(21, 44),foo2: new Foo(100, 111),
  };
  before.foo.print(); // Stringify it with a replacer:
  var str = JSON.stringify(before); // Show that
  console.log(str); // Re-create it with use of a "reviver" function
  var after = JSON.parse(str, window.storage.Reviver);
  after.foo.print();after.foo2.print();
};
class Bar {
  constructor(x) {
    this.__type="Bar";
    this._x = x;
  }
  get parent() {return this._parent();}
  print() {      console.log("parent="+this.parent.a.toString()+ this._x);    };
 toJSON() {return window.storage.Generic_toJSON("Bar", this); };
 static fromJSON(value) { return window.storage.Generic_fromJSON(Bar, value.data);};
}

class Foo {
  constructor(a=0, b=0) {
    this.__type = 'Foo';
    this.a = a, this.b = b;
    this._bar = new Bar('fooboo'+this.a.toString());
    this._bar2 = new Bar('ba2'+this.b.toString());
    //this._bar._parent = (function(me){ return function(){return me;}}(this));
    //this._bar2._parent = (function(me){ return function(){return me;}}(this));
  }
  toJSON() {return window.storage.Generic_toJSON("Foo", this); };
  static fromJSON(value) { return window.storage.Generic_fromJSON(Foo, value.data);};
  setA(a) {   this.a = -1 * a;  };
  print() {console.log(this.a.toString()); this._bar.print(); this._bar2.print();  };
}
*/

/* this should also work instead of reviver
window.gm.testsaveAssign = function () {
  var before = {
    foo: new Foo(21, 44)
  };
  before.foo.print(); // Stringify it with a replacer:
  var str = JSON.stringify(before); // Show that
  console.log(str); // Re-create it with use of a "reviver" function
  var after = window.storage.assignType(str);
  after.foo.print();
};*/

/*assignType: function(object){
    if(object && typeof(object) === 'object' && window[object.__type]) {
        object = window.storage.assignTypeRecursion(object.__type, object);
    }
    return object;
  },
  assignTypeRecursion: function(type, object){
    for (var key in object) {
        if (object.hasOwnProperty(key)) {
            var obj = object[key];
            if(Array.isArray(obj)){
                 for(var i = 0; i < obj.length; ++i){
                     var arrItem = obj[i];
                     if(arrItem && typeof(arrItem) === 'object' && window[arrItem.__type]) {
                         obj[i] = window.storage.assignTypeRecursion(arrItem.__type, arrItem);
                     }
                 }
            } else  if(obj && typeof(obj) === 'object' && window[obj.__type]) {
                object[key] = window.storage.assignTypeRecursion(obj.__type, obj);
            }
        }
    }
    return Object.assign(new window[type](), object);
  },*/

"use strict";

var SkillResult = function SkillResult() {
  _classCallCheck(this, SkillResult);

  this.OK = false, this.source = null, this.targets = [], this.skill = null, this.msg = "", this.effects = [];
};

var SkillCost = /*#__PURE__*/function () {
  function SkillCost() {
    _classCallCheck(this, SkillCost);

    this.will = 0, this.energy = 0, this.health = 0, this.items = []; //Todo
  }

  _createClass(SkillCost, [{
    key: "asText",
    value: function asText() {
      var msg = '';
      if (this.will > 0) msg += this.will.toString() + ' will';
      if (this.energy > 0) msg += this.energy.toString() + ' energy';
      if (this.health > 0) msg += this.health.toString() + ' health';
      if (msg === '') msg = 'without cost';else msg = 'requires ' + msg;
      return msg;
    }
  }, {
    key: "canPay",
    value: function canPay(Char) {
      var res = {
        OK: true,
        msg: ''
      };

      if (this.will > Char.Stats.get('will').value) {
        res.OK = false;
        res.msg += 'not enough will';
      }

      if (this.health + 1 > Char.Stats.get('health').value) {
        //+1 to not selfkill
        res.OK = false;
        res.msg += 'not enough health';
      }

      if (this.energy > Char.Stats.get('energy').value) {
        res.OK = false;
        res.msg += 'not enough energy';
      }

      return res;
    }
  }, {
    key: "pay",
    value: function pay(Char) {
      Char.Stats.increment('health', this.health * -1);
      Char.Stats.increment('will', this.will * -1);
      Char.Stats.increment('energy', this.energy * -1);
    }
  }]);

  return SkillCost;
}();

var SkillMod = function SkillMod() {
  _classCallCheck(this, SkillMod);

  this.hitChance = 100;
  this.critChance = 4;
  this.onHit = []; // [{ target: 'target', eff: 'damage_pierce', damage: '11'}]

  this.onCrit = [];
  this.onUse = [];
  this.onMiss = [];
};

var Skill = /*#__PURE__*/function () {
  function Skill(id) {
    _classCallCheck(this, Skill);

    this.id = this.name = id;
    this.cost = new SkillCost();
    this.level = 1;
  } //_parent will be added dynamical


  _createClass(Skill, [{
    key: "_relinkItems",
    value: function _relinkItems(parent) {
      this._parent = window.gm.util.refToParent(parent);
    }
  }, {
    key: "getMaxTargetCount",
    value: function getMaxTargetCount() {
      return 1;
    }
  }, {
    key: "isValidPhase",
    value: function isValidPhase() {
      //returns True if the skill can be used in tha actual game-phase (combatPhase,explorePhase)
      return true;
    }
    /**
     * returns false and text if the skill cannot be used because its temporary disabled (silenced mage, blinded)
     * the text should indicate why and how long it is disabled
     * call super to check cost !
     */

  }, {
    key: "isEnabled",
    value: function isEnabled() {
      var res = this.getCost().canPay(this.parent.parent);
      return res;
    } //this is used to filter possible targets for a skill
    //the function returns a array of arrays containing the targets  
    //f.e. [[dragon],[mole1,mole2]] to indicate that the skill can be used on dragon or both moles at same time

  }, {
    key: "targetFilter",
    value: function targetFilter(targets) {
      return this.targetFilterEnemy(targets);
    } //returns True if the skill can be used on the target(s)

  }, {
    key: "isValidTarget",
    value: function isValidTarget(target) {
      // filtered can be [[mole1,mole2]] or [[dragon],[mole1,mole2]]
      //target is [dragon] or [mole1,mole2]
      var filtered = this.targetFilter([target]); //[[]] !

      var _iterator27 = _createForOfIteratorHelper(target),
          _step27;

      try {
        for (_iterator27.s(); !(_step27 = _iterator27.n()).done;) {
          var targ = _step27.value;

          var _i = filtered.indexOf(target);

          if (_i < 0) return false;
        }
      } catch (err) {
        _iterator27.e(err);
      } finally {
        _iterator27.f();
      }

      return true;
    }
    /**
     * returns information about the cost to execute the skill
     */

  }, {
    key: "getCost",
    value: function getCost() {
      //Todo
      return this.cost;
    }
  }, {
    key: "getName",
    value: function getName() {
      //returns name of the skill for listboxes/labels"""
      return this.name;
    }
  }, {
    key: "getCastDescription",
    value: function getCastDescription(result) {
      //update msg after sucessful cast
      return this.caster.name + " uses " + this.name + " on " + result.targets[0].name + ".";
    }
  }, {
    key: "previewCast",
    value: function previewCast(target) {
      var result = new SkillResult();
      result.msg = this.caster.name + " will use " + this.name + " on " + targets.name;
      return result;
    }
  }, {
    key: "cast",
    value: function cast(target) {
      //execute the skill on the targets
      var result = this.previewCast(target);
      var cost = this.getCost();

      if (result.OK) {
        result.msg = "";

        var _iterator28 = _createForOfIteratorHelper(result.effects),
            _step28;

        try {
          for (_iterator28.s(); !(_step28 = _iterator28.n()).done;) {
            var X = _step28.value;

            // for each target
            var _iterator29 = _createForOfIteratorHelper(X.eff),
                _step29;

            try {
              for (_iterator29.s(); !(_step29 = _iterator29.n()).done;) {
                var Y = _step29.value;
                //...multiple effects
                X.target.addEffect(Y.id, Y);
              }
            } catch (err) {
              _iterator29.e(err);
            } finally {
              _iterator29.f();
            }
          }
        } catch (err) {
          _iterator28.e(err);
        } finally {
          _iterator28.f();
        }

        cost.pay(this.parent.parent);
        result.msg += this.getCastDescription(result);
      }

      return result;
    } //some predefined filter; chain them to narrow down the targets

  }, {
    key: "targetFilterSelf",
    value: function targetFilterSelf(targets) {
      var possibleTarget = [];

      var _iterator30 = _createForOfIteratorHelper(targets),
          _step30;

      try {
        for (_iterator30.s(); !(_step30 = _iterator30.n()).done;) {
          var target = _step30.value;
          var valid = true;

          var _iterator31 = _createForOfIteratorHelper(target),
              _step31;

          try {
            for (_iterator31.s(); !(_step31 = _iterator31.n()).done;) {
              var targ = _step31.value;
              if (this.caster != targ) valid = false;
            }
          } catch (err) {
            _iterator31.e(err);
          } finally {
            _iterator31.f();
          }

          if (valid) possibleTarget.push(target);
        }
      } catch (err) {
        _iterator30.e(err);
      } finally {
        _iterator30.f();
      }

      return possibleTarget;
    }
  }, {
    key: "targetFilterAlly",
    value: function targetFilterAlly(targets) {
      var possibleTarget = [];

      var _iterator32 = _createForOfIteratorHelper(targets),
          _step32;

      try {
        for (_iterator32.s(); !(_step32 = _iterator32.n()).done;) {
          var target = _step32.value;
          var valid = true;

          var _iterator33 = _createForOfIteratorHelper(target),
              _step33;

          try {
            for (_iterator33.s(); !(_step33 = _iterator33.n()).done;) {
              var targ = _step33.value;
              if (this.caster.faction != targ.faction) valid = false;
            }
          } catch (err) {
            _iterator33.e(err);
          } finally {
            _iterator33.f();
          }

          if (valid) possibleTarget.push(target);
        }
      } catch (err) {
        _iterator32.e(err);
      } finally {
        _iterator32.f();
      }

      return possibleTarget;
    }
  }, {
    key: "targetFilterEnemy",
    value: function targetFilterEnemy(targets) {
      var possibleTarget = [];

      var _iterator34 = _createForOfIteratorHelper(targets),
          _step34;

      try {
        for (_iterator34.s(); !(_step34 = _iterator34.n()).done;) {
          var target = _step34.value;
          var valid = true;

          var _iterator35 = _createForOfIteratorHelper(target),
              _step35;

          try {
            for (_iterator35.s(); !(_step35 = _iterator35.n()).done;) {
              var targ = _step35.value;
              if (this.caster.faction == targ.faction) valid = false;
              if (targ.isDead()) valid = false;
            }
          } catch (err) {
            _iterator35.e(err);
          } finally {
            _iterator35.f();
          }

          if (valid) possibleTarget.push(target);
        }
      } catch (err) {
        _iterator34.e(err);
      } finally {
        _iterator34.f();
      }

      return possibleTarget;
    }
  }, {
    key: "targetFilterFighting",
    value: function targetFilterFighting(targets) {
      //chars that are not inhibited
      var possibleTarget = [];

      var _iterator36 = _createForOfIteratorHelper(targets),
          _step36;

      try {
        for (_iterator36.s(); !(_step36 = _iterator36.n()).done;) {
          var target = _step36.value;
          var valid = true;

          var _iterator37 = _createForOfIteratorHelper(target),
              _step37;

          try {
            for (_iterator37.s(); !(_step37 = _iterator37.n()).done;) {
              var targ = _step37.value;
              if (!targ._canAct().OK) valid = false;
            }
          } catch (err) {
            _iterator37.e(err);
          } finally {
            _iterator37.f();
          }

          if (valid) possibleTarget.push(target);
        }
      } catch (err) {
        _iterator36.e(err);
      } finally {
        _iterator36.f();
      }

      return possibleTarget;
    }
  }, {
    key: "targetFilterAlive",
    value: function targetFilterAlive(targets) {
      //chars that are not dead
      var possibleTarget = [];

      var _iterator38 = _createForOfIteratorHelper(targets),
          _step38;

      try {
        for (_iterator38.s(); !(_step38 = _iterator38.n()).done;) {
          var target = _step38.value;
          var valid = true;

          var _iterator39 = _createForOfIteratorHelper(target),
              _step39;

          try {
            for (_iterator39.s(); !(_step39 = _iterator39.n()).done;) {
              var targ = _step39.value;
              if (targ.isDead()) valid = false;
            }
          } catch (err) {
            _iterator39.e(err);
          } finally {
            _iterator39.f();
          }

          if (valid) possibleTarget.push(target);
        }
      } catch (err) {
        _iterator38.e(err);
      } finally {
        _iterator38.f();
      }

      return possibleTarget;
    }
  }, {
    key: "targetFilterDead",
    value: function targetFilterDead(targets) {
      //chars that are dead
      var possibleTarget = [];

      var _iterator40 = _createForOfIteratorHelper(targets),
          _step40;

      try {
        for (_iterator40.s(); !(_step40 = _iterator40.n()).done;) {
          var target = _step40.value;
          var valid = true;

          var _iterator41 = _createForOfIteratorHelper(target),
              _step41;

          try {
            for (_iterator41.s(); !(_step41 = _iterator41.n()).done;) {
              var targ = _step41.value;
              if (!targ.isDead()) valid = false;
            }
          } catch (err) {
            _iterator41.e(err);
          } finally {
            _iterator41.f();
          }

          if (valid) possibleTarget.push(target);
        }
      } catch (err) {
        _iterator40.e(err);
      } finally {
        _iterator40.f();
      }

      return possibleTarget;
    }
  }, {
    key: "targetMultiple",
    value: function targetMultiple(targets) {
      var possibletarget = targets.slice(0); //[[mole1],[mole2]]

      var multi = [];
      multi.name = "all"; //there has to be a name for display

      var _iterator42 = _createForOfIteratorHelper(possibletarget),
          _step42;

      try {
        for (_iterator42.s(); !(_step42 = _iterator42.n()).done;) {
          var el = _step42.value;
          if (el.length === 1) //dont stack multi-targets
            multi.push(el[0]);
        }
      } catch (err) {
        _iterator42.e(err);
      } finally {
        _iterator42.f();
      }

      if (multi.length > 0) possibletarget.push(multi); //[[mole1],[mole2],[mole1,mole2]]

      return possibletarget;
    }
  }, {
    key: "parent",
    get: function get() {
      return this._parent ? this._parent() : null;
    }
  }, {
    key: "caster",
    get: function get() {
      return this.parent.parent;
    } //implement this for description

  }, {
    key: "desc",
    get: function get() {
      return this.name;
    }
  }]);

  return Skill;
}();

"use strict";
/* classes to affect...: 
    - the state of a character like     'tired'
    - stats of a character like healthMax
    - 
 */
///////////////////////////////////////////////////////////////


var StatsDictionary = /*#__PURE__*/function (_Inventory) {
  _inherits(StatsDictionary, _Inventory);

  var _super3 = _createSuper(StatsDictionary);

  //Todo a collection of Stats is similiar to Inventory?
  function StatsDictionary(externlist) {
    var _this3;

    _classCallCheck(this, StatsDictionary);

    _this3 = _super3.call(this, externlist);
    window.storage.registerConstructor(StatsDictionary);
    return _this3;
  }

  _createClass(StatsDictionary, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("StatsDictionary", this);
    }
  }, {
    key: "get",
    //
    value: function get(id) {
      return this.getItem(id);
    }
  }, {
    key: "modifyHidden",
    value: function modifyHidden(id, hidden) {
      var _data = this.get(id).data;
      _data.hidden = hidden;
    } // adds a modifier to a Stat or replaces it

  }, {
    key: "addModifier",
    value: function addModifier(toId, modData) {
      var _stat = this.get(toId);

      var _oldMods = _stat.data.modifier;

      var _x = -1;

      for (var i = 0; i < _oldMods.length; i++) {
        if (_oldMods[i].id === modData.id) _x = i;
      }

      if (_x >= 0) _oldMods.splice(_x, 1);

      _oldMods.push(modData);

      window.gm.pushLog(_stat.Calc().msg);
    }
  }, {
    key: "removeModifier",
    value: function removeModifier(toId, modData) {
      var _stat = this.get(toId);

      var _oldMods = _stat.data.modifier;

      var _x = -1;

      for (var i = 0; i < _oldMods.length; i++) {
        if (_oldMods[i].id === modData.id) _x = i;
      }

      if (_x >= 0) _oldMods.splice(_x, 1);
      window.gm.pushLog(_stat.Calc().msg);
    } //override

  }, {
    key: "postItemChange",
    value: function postItemChange(id, operation, msg) {
      window.gm.pushLog('Stats: ' + operation + ' ' + id + ' ' + msg);
    } //override; only use to create new stats !

  }, {
    key: "addItem",
    value: function addItem(stat) {
      var _i = this.findItemSlot(stat.name);

      if (_i < 0) {
        stat._parent = window.gm.util.refToParent(this);
        this.list.push({
          'id': stat.id,
          'count': 1,
          item: stat
        });
      }
    } //override

  }, {
    key: "removeItem",
    value: function removeItem(id) {
      var _i = this.findItemSlot(id);

      if (_i < 0) return; //just skip if not found

      var _stat = this.get(id);

      this.list.splice(_i, 1);

      _stat.calc(); //trigger update of dependent stat

    }
  }, {
    key: "increment",
    value: function increment(id, value) {
      var attr = this.get(id);
      attr.data.base += value;
      window.gm.pushLog(attr.Calc(this, id).msg); // todo show only for player
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      var _x = window.storage.Generic_fromJSON(StatsDictionary, value.data);

      return _x;
    }
  }]);

  return StatsDictionary;
}(Inventory); //class for an Attribute


var Stat = /*#__PURE__*/function () {
  _createClass(Stat, null, [{
    key: "dataPrototype",
    value: function dataPrototype() {
      return {
        id: '',
        base: 0,
        value: 0,
        limits: [],
        modifier: [],
        modifys: [],
        hidden: 0
      }; //limit = {min: max:}   limit to apply to value and base; either statid or number
      //modifier {id: bonus:}      Stat that modifys value, bonus is value to add             todo: multiplier but then we have to sort modifiers somehow
      //modifys {id:}         point to the Stats that have modifiers from this stat or is used as limit
      //hidden 0 = visible, 1= name unreadable, 2= value unreadable, 4= hidden
    }
  }]);

  function Stat() {
    _classCallCheck(this, Stat);

    this.data = Stat.dataPrototype();
  } // Attention !!
  //_parent will be added dynamical


  _createClass(Stat, [{
    key: "_relinkItems",
    value: function _relinkItems(parent) {
      this._parent = window.gm.util.refToParent(parent);
    }
  }, {
    key: "Calc",
    //this is called to update value of the stat and will trigger calculation of dependend stats 
    value: function Calc() {
      var attr = this.data;
      var min = -999999;
      var max = 999999;
      var msg = ''; //get limits

      for (var k = 0; k < attr.limits.length; k++) {
        //this might behave odly if any min>max
        var lmin = attr.limits[k].min,
            lmax = attr.limits[k].max; //lm__ is id or number

        if (lmin || lmin === 0) {
          min = typeof lmin === 'string' ? Math.max(this.parent.get(lmin).value, min) : Math.max(lmin, min);
        }

        if (lmax || lmax === 0) {
          max = typeof lmax === 'string' ? Math.min(this.parent.get(lmax).value, max) : Math.min(lmax, max);
        }
      } //recalculate modifiers


      var _old = attr.value;
      attr.base = attr.value = Math.max(min, Math.min(max, attr.base));

      for (var i = 0; i < attr.modifier.length; i++) {
        attr.value += attr.modifier[i].bonus;
      }

      var _new = Math.max(min, Math.min(max, attr.value));

      attr.value = _new;
      msg += this.formatMsgStatChange(attr, _new, _old); //todo no log hidden

      this.updateModifier(); //trigger recalculation of dependend Stats

      for (var m = 0; m < attr.modifys.length; m++) {
        msg += this.parent.get(attr.modifys[m].id).Calc().msg;
      }

      return {
        OK: true,
        msg: msg
      };
    }
  }, {
    key: "formatMsgStatChange",
    value: function formatMsgStatChange(attr, _new, _old) {
      if (_new - _old > 0) {
        return '<statup>' + attr.id + " off " + this.parent.parent.name + " regenerated by " + (_new - _old).toFixed(1).toString() + "</statup>";
      } else if (_new - _old < 0) {
        return '<statdown>' + attr.id + " off " + this.parent.parent.name + " decreased by " + (_new - _old).toFixed(1).toString() + "</statdown>";
      }

      return "";
    }
  }, {
    key: "updateModifier",
    value: function updateModifier() {}
  }, {
    key: "parent",
    get: function get() {
      return this._parent ? this._parent() : null;
    }
  }, {
    key: "name",
    get: function get() {
      return this.data.id;
    }
  }, {
    key: "id",
    get: function get() {
      return this.data.id;
    }
  }, {
    key: "base",
    get: function get() {
      return this.data.base;
    }
  }, {
    key: "value",
    get: function get() {
      return this.data.value;
    }
  }, {
    key: "hidden",
    get: function get() {
      return this.data.hidden;
    }
  }]);

  return Stat;
}(); /////////////////////////////////////////////////////////////////////////


var Effects = /*#__PURE__*/function (_Inventory2) {
  _inherits(Effects, _Inventory2);

  var _super4 = _createSuper(Effects);

  //Todo a collection of Stats is similiar to Inventory?
  function Effects(externlist) {
    var _this4;

    _classCallCheck(this, Effects);

    _this4 = _super4.call(this, externlist);
    window.storage.registerConstructor(Effects); //! this doesnt work after load! see PubSub comments
    //window.gm.timeEvent.subscribe("change", this.updateTime.bind(this) ); 

    return _this4;
  }

  _createClass(Effects, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("Effects", this);
    }
  }, {
    key: "get",
    value: function get(id) {
      return this.getItem(id);
    }
    /*
    * findItemslot uses id, this one finds all effects with a name
    */

  }, {
    key: "findEffect",
    value: function findEffect(name) {
      var _items = [];

      for (var i = 0; i < this.count(); i++) {
        if (this.list[i].item.name === name) _items.push(this.list[i].item);
      }

      return _items;
    } //override

  }, {
    key: "removeItem",
    value: function removeItem(id) {
      var _i = this.findItemSlot(id);

      if (_i < 0) return; //just skip if not found

      var _eff = this.get(id);

      this.list.splice(_i, 1);

      _eff.onRemove(this, this.list[_i]);

      this.postItemChange(id, "removed", "");
    }
  }, {
    key: "addItem",
    value: function addItem(id, effect) {
      var _i = this.findItemSlot(id);

      var res; //if effect with same id is already present, merge them

      if (_i > -1) {
        var _old = this.get(id); //effect.id);


        res = _old.merge(effect);

        if (res != null) {
          if (res === true) {} else res(this); //should be a function


          this.postItemChange(id, "merged", "");
          return;
        }
      } //or if there are similiar effects try to merge with them


      for (var i = 0; i < this.list.length; i++) {
        var _old2 = this.list[i].item;
        res = _old2.merge(effect);

        if (res != null) {
          if (res === true) {} else res(this); //should be a function


          this.postItemChange(id, "merged", "");
          return;
        }
      } //else add it to list


      this.list.push({
        'id': id,
        'count': 1,
        item: effect
      });
      effect._parent = window.gm.util.refToParent(this);
      effect.onApply();
      this.postItemChange(id, "added", "");
    }
  }, {
    key: "replace",
    value: function replace(id, neweffect) {
      var _i = this.findItemSlot(id);

      if (_i < 0) return; //Todo do nothing

      var _old = this.get(id);

      _old.onRemove();

      neweffect._parent = window.gm.util.refToParent(this);
      this.list[_i].id = neweffect.id, this.list[_i].item = neweffect;
      neweffect.onApply();
    }
  }, {
    key: "updateTime",
    value: function updateTime() {
      var now = window.gm.getTime();

      for (var i = 0; i < this.list.length; i++) {
        var _eff = this.list[i].item;

        var foo = _eff.onTimeChange(now);

        if (foo) foo(this);
      }
    } //override

  }, {
    key: "postItemChange",
    value: function postItemChange(id, operation, msg) {
      window.gm.pushLog('Effects: ' + operation + ' ' + id + ' ' + msg, window.story.state._gm.debug || window.gm.player.name === window.story.state.playerVR.name || window.gm.player.name === window.story.state.playerRL.name); //todo only show logs for player?
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      var _x = window.storage.Generic_fromJSON(Effects, value.data);

      return _x;
    }
  }]);

  return Effects;
}(Inventory); /////////////////////////////////////////////////////////////////////////


var Effect = /*#__PURE__*/function () {
  function Effect() {
    _classCallCheck(this, Effect);

    this.data = Effect.dataPrototype();
    this.data.time = window.gm.getTime();
  }

  _createClass(Effect, [{
    key: "_relinkItems",
    value: function _relinkItems(parent) {
      this._parent = window.gm.util.refToParent(parent);
    } // id = SlumberPotion:Stunned;  name = Stunned

  }, {
    key: "merge",
    //is called when a effect is applied to check if the new effect can be combined with an exisitng one
    //return null if no merge occured
    //return true if the neweffect was merged into existing one; no other effects are then checked for mergeability
    //or return function that has to be executed: (function(Effects){ Effects.replace(data.id,NotTired);}));
    value: function merge(neweffect) {
      return null;
    }
  }, {
    key: "onTimeChange",
    value: function onTimeChange(time) {
      return null;
    }
  }, {
    key: "onApply",
    value: function onApply() {}
  }, {
    key: "onRemove",
    value: function onRemove() {}
  }, {
    key: "parent",
    // Attention !!
    //_parent will be added dynamical
    get: function get() {
      return this._parent ? this._parent() : null;
    }
  }, {
    key: "id",
    get: function get() {
      return this.data.id;
    },
    set: function set(id) {
      this.data.id = id;
    } // Attention !!  effTired.name returns constructor-name but Effects.getById('effTired').name returns data.name

  }, {
    key: "name",
    get: function get() {
      return this.data.name;
    }
  }, {
    key: "time",
    get: function get() {
      return this.data.time;
    }
  }, {
    key: "duration",
    get: function get() {
      return this.data.duration;
    }
  }, {
    key: "hidden",
    get: function get() {
      return this.data.hidden;
    }
  }, {
    key: "desc",
    get: function get() {
      return this.name;
    }
  }, {
    key: "shortDesc",
    get: function get() {
      return this.name;
    }
  }], [{
    key: "dataPrototype",
    value: function dataPrototype() {
      return {
        id: 'xxx',
        name: Effect.name,
        time: 0,
        duration: 0,
        hidden: 0
      }; //hidden 0 = visible, 1= name unreadable, 2= value unreadable, 4= hidden
    }
  }]);

  return Effect;
}(); /////////////////////////////////////////////////////////////////////////
//combat effect use turn-count instead of realtime as duration


var CombatEffect = /*#__PURE__*/function (_Effect) {
  _inherits(CombatEffect, _Effect);

  var _super5 = _createSuper(CombatEffect);

  function CombatEffect() {
    _classCallCheck(this, CombatEffect);

    return _super5.call(this);
  }

  _createClass(CombatEffect, [{
    key: "onCombatEnd",
    //duration in turns !
    value: function onCombatEnd() {} //called before targets turn

  }, {
    key: "onTurnStart",
    value: function onTurnStart() {} //at end of targets turn

  }, {
    key: "onTurnEnd",
    value: function onTurnEnd() {}
  }, {
    key: "shortDesc",
    get: function get() {
      return this.desc + " for " + this.data.duration + " turns";
    }
  }]);

  return CombatEffect;
}(Effect);

;

(function () {
  "use strict"; // Style Switcher from https://www.stichpunkt.de/css/styleswitch.html

  var StyleSwitcher = /*#__PURE__*/function () {
    function StyleSwitcher() {
      _classCallCheck(this, StyleSwitcher);

      this.style = "default";
      this.cookie = "Layout";
      this.days = 30;
    }

    _createClass(StyleSwitcher, [{
      key: "switchStyle",
      value: function switchStyle(s) {
        if (!document.getElementsByTagName) return;
        var el = document.getElementsByTagName("link");

        for (var i = 0; i < el.length; i++) {
          if (el[i].getAttribute("rel").indexOf("style") != -1 && el[i].getAttribute("title")) {
            el[i].disabled = true;
            if (el[i].getAttribute("title") == s) el[i].disabled = false;
          }
        }
      }
    }, {
      key: "loadStyle",
      value: function loadStyle() {
        var c = this.getStyleCookie();

        if (c && c != this.style) {
          this.switchStyle(c);
          this.style = c;
        }
      }
    }, {
      key: "setStyle",
      value: function setStyle(s) {
        if (s != this.style) {
          this.switchStyle(s);
          this.style = s;
          this.setStyleCookie();
        }
      } // Cookie-Funktionen

    }, {
      key: "setCookie",
      value: function setCookie(name, value, expdays) {
        var now = new Date();
        var exp = new Date(now.getTime() + 1000 * 60 * 60 * 24 * expdays);
        var val = name + "=" + escape(value) + "," + "expires=" + exp.toGMTString() + "," + "path=/";
        document.cookie = val;
      }
    }, {
      key: "delCookie",
      value: function delCookie(name) {
        // expires ist abgelaufen
        var now = new Date();
        var exp = new Date(now.getTime() - 1);
        document.cookie = name + "=;" + "expires=" + exp.toGMTString() + ";" + "path=/";
      }
    }, {
      key: "getCookie",
      value: function getCookie(name) {
        var cname = name + "=";
        var dc = document.cookie;

        if (dc.length > 0) {
          var start = dc.indexOf(cname);

          if (start != -1) {
            start += cname.length;
            var stop = dc.indexOf(";", start);
            if (stop == -1) stop = dc.length;
            return unescape(dc.substring(start, stop));
          }
        }

        return null;
      } // todo cookies dont work with files that are not served by server!?

    }, {
      key: "setStyleCookie",
      value: function setStyleCookie() {
        //this.setCookie(this.cookie, this.style, this.days);
        if (!window.story.state._gm) return; // window.story.state._gm might not yet exist

        window.story.state._gm.style = this.style;
      }
    }, {
      key: "getStyleCookie",
      value: function getStyleCookie() {
        //return this.getCookie(this.cookie);
        if (!window.story.state._gm) return 'default';
        return window.story.state._gm.style;
      }
    }, {
      key: "delStyleCookie",
      value: function delStyleCookie() {
        //this.delCookie(this.cookie);
        if (!window.story.state._gm) return;
        window.story.state._gm.style = 'default';
      }
    }]);

    return StyleSwitcher;
  }();

  window.styleSwitcher = new StyleSwitcher();
  window.styleSwitcher.loadStyle(); //window.onload = window.styleSwitcher.loadStyle;
})(window, document);
/*! Toasty.js - v1.5.0 - 2018-05-04
* https://jakim.me/Toasty.js/
* Copyright (c) 2015-2018 Jakim Hernández; Licensed MIT */


;

(function () {
  'use strict';
  /**
   * All available default CSS transitions for plug-in:
   *
   * @var array
   */

  var _transitions = ["fade", "slideLeftFade", "slideLeftRightFade", "slideRightFade", "slideRightLeftFade", "slideUpFade", "slideUpDownFade", "slideDownFade", "slideDownUpFade", "pinItUp", "pinItDown"];
  /**
   * Default configuration for plug-in:
   *
   * @var object
   */

  var _defaults = {
    // STRING: main class name used to styling each toast message with CSS:
    // .... IMPORTANT NOTE:
    // .... if you change this, the configuration consider that you´re
    // .... re-stylized the plug-in and default toast styles, including CSS3 transitions are lost.
    classname: "toast",
    // STRING: name of the CSS transition that will be used to show and hide all toast by default:
    transition: "slideLeftRightFade",
    // BOOLEAN: specifies the way in which the toasts will be inserted in the HTML code:
    // .... Set to BOOLEAN TRUE and the toast messages will be inserted before those already generated toasts.
    // .... Set to BOOLEAN FALSE otherwise.
    insertBefore: true,
    // INTEGER: duration that the toast will be displayed in milliseconds:
    // .... Default value is set to 4000 (4 seconds). 
    // .... If it set to 0, the duration for each toast is calculated by text-message length.
    duration: 4000,
    // BOOLEAN: enable or disable toast sounds:
    // .... Set to BOOLEAN TRUE  - to enable toast sounds.
    // .... Set to BOOLEAN FALSE - otherwise.
    // NOTE: this is not supported by mobile devices.
    enableSounds: false,
    // BOOLEAN: enable or disable auto hiding on toast messages:
    // .... Set to BOOLEAN TRUE  - to enable auto hiding.
    // .... Set to BOOLEAN FALSE - disable auto hiding. Instead the user must click on toast message to close it.
    autoClose: true,
    // BOOLEAN: enable or disable the progressbar:
    // .... Set to BOOLEAN TRUE  - enable the progressbar only if the autoClose option value is set to BOOLEAN TRUE.
    // .... Set to BOOLEAN FALSE - disable the progressbar. 
    progressBar: false,
    // IMPORTANT: mobile browsers does not support this feature!
    // Yep, support custom sounds for each toast message when are shown if the
    // enableSounds option value is set to BOOLEAN TRUE:
    // NOTE: the paths must point from the project's root folder.
    sounds: {
      // path to sound for informational message:
      info: "./dist/sounds/info/1.mp3",
      // path to sound for successfull message:
      success: "./dist/sounds/success/1.mp3",
      // path to sound for warn message:
      warning: "./dist/sounds/warning/1.mp3",
      // path to sound for error message:
      error: "./dist/sounds/error/1.mp3"
    },
    // callback:
    // onShow function will be fired when a toast message appears.
    onShow: function onShow(type) {},
    // callback:
    // onHide function will be fired when a toast message disappears.
    onHide: function onHide(type) {},
    // the placement where prepend the toast container:
    prependTo: document.body.childNodes[0]
  };
  /**
   * Map to create each necessary CSS classess:
   *
   * @var object
   */

  var _mappings = {
    container: "{:class-name}-container",
    mainwrapp: "{:class-name}-wrapper",
    toasts: {
      info: "{:class-name}--info",
      success: "{:class-name}--success",
      warning: "{:class-name}--warning",
      error: "{:class-name}--error"
    },
    animate: {
      init: "{:transition}-init",
      show: "{:transition}-show",
      hide: "{:transition}-hide"
    },
    progressbar: "{:class-name}-progressbar",
    playerclass: "{:class-name}-soundplayer"
  };
  /**
   * A time offset to define the plug-in behavior:
   *
   * @var object
   */

  var _timeOffset = 100;
  /**
   * A native JS extend() function
   *
   * Returns a new object instead, preserving all of the original objects
   * and their properties. Supported back to IE6.
   *
   * All credits to author.
   * https://gomakethings.com/vanilla-javascript-version-of-jquery-extend/
   *
   * @return object
   */

  function extend() {
    var extended = {};
    var deep = false;
    var i = 0;
    var length = arguments.length; // check if a deep merge

    if (Object.prototype.toString.call(arguments[0]) === '[object Boolean]') {
      deep = arguments[0];
      i++;
    } // merge the object into the extended object


    var merge = function merge(obj) {
      for (var prop in obj) {
        if (Object.prototype.hasOwnProperty.call(obj, prop) === true) {
          // if deep merge and property is an object, merge properties
          if (deep && Object.prototype.toString.call(obj[prop]) === '[object Object]') extended[prop] = extend(true, extended[prop], obj[prop]);else extended[prop] = obj[prop];
        }
      }
    }; // loop through each object and conduct a merge


    for (i; i < length; i++) {
      var obj = arguments[i];
      merge(obj);
    }

    return extended;
  }
  /**
   * Simple creation of an Element Node with the specified 'name'.
   *
   * @return HTML Element
   */


  function node(name) {
    return document.createElement(name || 'div');
  }
  /**
   * Returns the parent Element or Node from any other HTML Element.
   *
   * @return HTML Element
   */


  function parentElement(el) {
    return el.parentElement || el.parentNode;
  }
  /**
   * Regexp to find a className on a string.
   *
   * @return RegExp Obj
   */


  function classReg(className) {
    return new RegExp('(^|\\s+)' + className + '(\\s+|$)');
  }
  /**
   * Returns a Boolean value, indicating whether an element has
   * the specified class name.
   * 
   * Usage:
   *
   * var exists = containsClass(element, 'className');
   * 
   * @return bool
   */


  function containsClass(el, className) {
    var fn;

    if (document.documentElement.classList) {
      fn = function fn(el, className) {
        return el.classList.contains(className);
      };
    } else {
      fn = function fn(el, className) {
        if (!el || !el.className) return false;
        return el.className.match(classReg(className));
      };
    }

    return fn(el, className);
  }
  /**
   * Adds one or more class names to an element.
   * If the specified class already exist, the class will not be added.
   *
   * Usage:
   *
   * addClass(el, 'class1', 'class2', 'class3', ...);
   *
   * @return HTML Element|bool false
   */


  function addClass(el) {
    var fn;
    var classNames = arguments;
    if (classNames.length <= 1 || _typeof(el) != 'object') return false;
    if (document.documentElement.classList) fn = function fn(el, classNames) {
      for (var i = 1; i < classNames.length; i++) {
        if (typeof classNames[i] == 'string') {
          el.classList.add(classNames[i]);
        }
      }

      return el;
    };else fn = function fn(el, classNames) {
      for (var i = 1; i < classNames.length; i++) {
        if (!containsClass(el, classNames[i]) && typeof classNames[i] == 'string') {
          el.className += (el.className ? ' ' : '') + classNames[i];
        }
      }

      return el;
    };
    return fn(el, classNames);
  }
  /**
   * Removes one or more class names from an element.
   * Note: Removing a class that does not exist, does NOT throw an error.
   *
   * Usage:
   *
   * removeClass(el, 'class1', 'class2', 'class3', ...);
   *
   * @return HTML Element|bool false
   */


  function removeClass(el) {
    var fn;
    var classNames = arguments;
    if (classNames.length <= 1 || _typeof(el) != 'object') return false;
    if (document.documentElement.classList) fn = function fn(el, classNames) {
      for (var i = 1; i < classNames.length; i++) {
        if (typeof classNames[i] == 'string') {
          el.classList.remove(classNames[i]);
        }
      }

      return el;
    };else fn = function fn(el, classNames) {
      for (var i = 1; i < classNames.length; i++) {
        if (containsClass(el, classNames[i]) && typeof classNames[i] == 'string') {
          el.className = el.className.replace(classReg(classNames[i]), '$2');
        }
      }

      return el;
    };
    return fn(el, classNames);
  }
  /**
   * Toggles between a class name for an element.
   * 
   * Usage:
   *
   * var result = toggleClass(el, 'className');
   *
   * @return bool
   */


  function toggleClass(el, className) {
    var fn;
    if (document.documentElement.classList) fn = function fn(el, className) {
      return el.classList.toggle(className);
    };else fn = function fn(el, className) {
      var exists = containsClass(el, className);
      var caller = exists === true ? removeClass : addClass;
      caller(el, className);
      return !exists;
    };
    return fn(el, className);
  }
  /**
   * Add Event
   *
   * Attaches an event handler to the document.
   *
   * http://www.thecssninja.com/javascript/handleevent
   *
   * @param  {element}  element
   * @param  {event}    event
   * @param  {Function} fn
   * @param  {boolean}  bubbling
   * @return el
   */


  function addEvent(el, evt, fn, bubble) {
    if ('addEventListener' in el) {
      // BBOS6 doesn't support handleEvent, catch and polyfill:
      try {
        el.addEventListener(evt, fn, bubble);
      } catch (e) {
        if (_typeof(fn) === 'object' && fn.handleEvent) {
          el.addEventListener(evt, function (e) {
            // bind fn as this and set first arg as event object:
            fn.handleEvent.call(fn, e);
          }, bubble);
        } else {
          throw e;
        }
      }
    } else if ('attachEvent' in el) {
      // check if the callback is an object and contains handleEvent:
      if (_typeof(fn) === 'object' && fn.handleEvent) {
        el.attachEvent('on' + evt, function () {
          // bind fn as this:
          fn.handleEvent.call(fn);
        });
      } else {
        el.attachEvent('on' + evt, fn);
      }
    }

    return el;
  }
  /**
   * Remove Event
   *
   * Removes an event handler that has been attached with the 'addEvent' method.
   *
   * http://www.thecssninja.com/javascript/handleevent
   *
   * @param  {element}  element
   * @param  {event}    event
   * @param  {Function} fn
   * @param  {boolean}  bubbling
   * @return el
   */


  function removeEvent(el, evt, fn, bubble) {
    if ('removeEventListener' in el) {
      try {
        el.removeEventListener(evt, fn, bubble);
      } catch (e) {
        if (_typeof(fn) === 'object' && fn.handleEvent) {
          el.removeEventListener(evt, function (e) {
            fn.handleEvent.call(fn, e);
          }, bubble);
        } else {
          throw e;
        }
      }
    } else if ('detachEvent' in el) {
      if (_typeof(fn) === 'object' && fn.handleEvent) {
        el.detachEvent('on' + evt, function () {
          fn.handleEvent.call(fn);
        });
      } else {
        el.detachEvent('on' + evt, fn);
      }
    }

    return el;
  }
  /**
   * Detect the property name of supported transition event.
   * 
   * Function from David Walsh:
   * http://davidwalsh.name/css-animation-callback
   *
   * @return string|undefined (if transitions not supported by client)
   */


  function whichTransitionEvent() {
    var t,
        el = node('transitionElement');
    var transitions = {
      WebkitTransition: 'webkitTransitionEnd',
      MozTransition: 'transitionend',
      OTransition: 'oTransitionEnd otransitionend',
      transition: 'transitionend'
    };

    for (t in transitions) {
      if (el.style[t] !== undefined) {
        return transitions[t];
      }
    }
  }
  /**
   * Calculates the auto close duration to be set in
   * each toast message:
   * 
   * @return number
   */


  function getAutoCloseDuration(message, duration, settings) {
    duration = duration || settings.duration;
    if (duration == 0) duration = message.length * (_timeOffset / 2);
    return Math.floor(duration);
  }
  /**
   * Replace each object values with a map of key => values:
   *
   * @return object
   */


  function walker(obj, map) {
    for (var o in obj) {
      if (obj.hasOwnProperty(o) === true) {
        // ini loop:
        switch (_typeof(obj[o])) {
          case 'object':
            walker(obj[o], map);
            break;

          case 'string':
            for (var m in map) {
              if (map.hasOwnProperty(m) === true) {
                obj[o] = obj[o].replace(m, map[m]);
              }
            }

            break;
        } // end loop.

      }
    }

    return obj;
  }
  /**
   * Generate an HTML audio instance for each type of
   * toast message:
   *
   * @return void
   */


  var playSound = function playSound(type, container, sounds, playerclass) {
    var sound = sounds[type],
        audio = addClass(node('audio'), playerclass);
    addEvent(audio, 'ended', function () {
      var parent = parentElement(this);
      this.remove(); // also, remove the main container if it empty:

      if (parent.childNodes.length < 1) parentElement(parent).remove();
    });
    audio.setAttribute('autoplay', 'autoplay');
    audio.innerHTML = '<source src="' + sound + '" type="audio/mpeg"/>' + '<embed hidden="true" autoplay="false" loop="false" src="' + sound + '" />';
    parentElement(container).appendChild(audio);
  };
  /**
   * Show the toast message with an CSS3 transition
   * if transition event is supported:
   *
   * @return void
   */


  var showToast = function showToast(type, el, container, animate, duration, insertBefore, callback) {
    var timer = 0;

    var delay = function delay(callback, ms) {
      clearTimeout(timer);
      timer = setTimeout(callback, ms);
    };

    var onShowToast = function onShowToast(e) {
      removeEvent(e.target, e.type, onShowToast, false);
      if (typeof callback == 'function') callback(type);
    };

    var show = function show() {
      var transitionEvent = whichTransitionEvent();

      if (transitionEvent !== undefined) {
        // initialize the CSS transition event:
        addEvent(el, transitionEvent, onShowToast, false);
      } else {
        // navigator does not support transition events:
        if (typeof callback == 'function') callback(type);
      }

      addClass(el, animate.show);
    }; // insert in the DOM and show toast:


    var beforeNode = container.childNodes;
    beforeNode = beforeNode[insertBefore === true ? 0 : beforeNode.length];
    container.insertBefore(el, beforeNode);
    delay(show, _timeOffset);
  };
  /**
   * Hide the toast message with an CSS3 transition
   * if transition event is supported:
   *
   * @return void
   */


  var hideToast = function hideToast(type, el, duration, animate, callback) {
    var timer = 0;

    var delay = function delay(callback, ms) {
      clearTimeout(timer);
      timer = setTimeout(callback, ms);
    };

    var onHideToast = function onHideToast(e) {
      removeEvent(e.target, e.type, onHideToast, false);
      remove();
      if (typeof callback == 'function') callback(type);
    };

    var remove = function remove() {
      var container = parentElement(el); // the wrapper.

      el.remove();
      var num = container.childNodes.length;

      if (num < 1) {
        parentElement(container).remove();
      }
    };

    var hide = function hide() {
      var transitionEvent = whichTransitionEvent();

      if (transitionEvent !== undefined) {
        // initialize the CSS transition event:
        addEvent(el, transitionEvent, onHideToast, false);
      } else {
        // navigator does not support transition events:
        remove();
        if (typeof callback == 'function') callback(type);
      }

      addClass(el, animate.hide);
    };

    delay(hide, _timeOffset * 10 + duration);
  };
  /**
   * Hide the toast message with an CSS3 transition when
   * the user clicks on the message:
   *
   * @return void
   */


  var hideToastOnClick = function hideToastOnClick(type, el, animate, callback, class2close) {
    var hideOnClick = function hideOnClick(e) {
      e.stopPropagation();
      removeClass(el, class2close);
      hideToast(type, el, 0, animate, callback);
    };

    addClass(el, class2close);
    addEvent(el, 'click', hideOnClick);
  };
  /**
   * The progressbar:
   *
   * @return void
   */


  var showProgressBar = function showProgressBar(type, el, duration, transition) {
    var timer = 0;

    var delay = function delay(callback, ms) {
      clearTimeout(timer);
      timer = setTimeout(callback, ms);
    };

    var progressbar = function progressbar() {
      var progressBar = addClass(node('div'), transition.progressbar, transition.progressbar + '--' + type);
      el.appendChild(progressBar);
      var iterat = 0,
          offset = 0;
      var interval = setInterval(function () {
        iterat++;
        offset = Math.round(1000 * iterat / duration);

        if (offset > 100) {
          clearInterval(interval);
        } else {
          progressBar.style.width = offset + '%';
        }
      }, 10);
    };

    delay(progressbar, _timeOffset * 10);
  };
  /**
   * Register a new transition only:
   *
   * @return string
   */


  var registerTransition = function registerTransition(self, name) {
    if (typeof name === "string") {
      self.classmap[name] = extend(true, _mappings, {});
      self.classmap[name] = walker(self.classmap[name], {
        '{:class-name}': self.settings.classname,
        '{:transition}': name
      });
    }

    return name;
  };
  /*!
   * The exposed public object:
   */


  var Toasty = function Toasty(options) {
    this.settings = {};
    this.classmap = {};
    this.configure(_typeof(options) === 'object' ? options : {}); // add classmap for default transitions:

    if (_typeof(_transitions) === 'object') for (var key in _transitions) {
      if (_transitions.hasOwnProperty(key) === true) {
        registerTransition(this, _transitions[key]);
      }
    }
  };

  Toasty.prototype.configure = function (options) {
    this.settings = extend(true, _defaults, this.settings, options);
    return this;
  };

  Toasty.prototype.transition = function (name) {
    this.settings.transition = registerTransition(this, name);
    return this;
  };

  Toasty.prototype.toast = function (type, message, duration) {
    var classes = this.classmap;
    var options = this.settings; // check if the transition name provided in options
    // exists in classes, if not register it:

    if (classes.hasOwnProperty(options.transition) === false) registerTransition(this, options.transition); // use the transition name provided in options:

    var transition = classes[options.transition]; // check if the toast container exists:

    var container = null;
    if (typeof options.transition === 'string') container = document.querySelector('.' + transition.container + '--' + options.transition);else container = document.querySelector('.' + transition.container);
    var containerExists = !!container;

    if (containerExists) {
      // create the toast container if not exists:
      container = container.querySelector('.' + transition.mainwrapp); // use the wrapper instead of main container.
    } else {
      container = addClass(node('div'), transition.container, transition.container + '--' + options.transition); // create a alert wrapper instance:

      var wrapp = addClass(node('div'), transition.mainwrapp); // append the alert wrapper and now, this is the main container:

      container.appendChild(container = wrapp);
    } // create a new toast instance


    var newToast = addClass(node('div'), options.classname, transition.toasts[type], transition.animate.init);
    newToast.innerHTML = message; // insert the toast container into the HTML:

    if (!containerExists) document.body.insertBefore(parentElement(container), options.prependTo); // OPTIONAL STEP (must be first):
    // INI: enable or disable toast sounds.
    // --------------------------------------------------------------------

    if (options.enableSounds == true) playSound(type, container, options.sounds, transition.playerclass); // --------------------------------------------------------------------
    // END: enable or disable toast sounds.
    // STEP 1:
    // INI: showing the toas message
    // --------------------------------------------------------------------

    showToast(type, newToast, container, transition.animate, duration, options.insertBefore, options.onShow); // --------------------------------------------------------------------
    // END: showing the toas message
    // STEP 2:
    // INI: prepare the toast to hide it.
    // --------------------------------------------------------------------

    if (options.autoClose == true) // hide the toast message automatically:
      hideToast(type, newToast, duration, transition.animate, options.onHide);else // hide the toast message on click it with an CSS3 transition:
      hideToastOnClick(type, newToast, transition.animate, options.onHide, 'close-on-click'); // --------------------------------------------------------------------
    // END: prepare the toast to hide it.
    // OPTIONAL STEP (must be last):
    // INI: Enable or disable the progressbar.
    // --------------------------------------------------------------------

    if (options.progressBar == true && options.autoClose == true) showProgressBar(type, newToast, duration, transition); // --------------------------------------------------------------------
    // END: Enable or disable the progressbar.

    return this;
  };

  Toasty.prototype.info = function (message, duration) {
    duration = getAutoCloseDuration(message, duration, this.settings);
    this.toast("info", message, duration);
  };

  Toasty.prototype.success = function (message, duration) {
    duration = getAutoCloseDuration(message, duration, this.settings);
    this.toast("success", message, duration);
  };

  Toasty.prototype.warning = function (message, duration) {
    duration = getAutoCloseDuration(message, duration, this.settings);
    this.toast("warning", message, duration);
  };

  Toasty.prototype.error = function (message, duration) {
    duration = getAutoCloseDuration(message, duration, this.settings);
    this.toast("error", message, duration);
  }; // FALLBACK:
  // Create Element.remove() function if not exist:


  if ('remove' in Element.prototype) {// the browser supports .remove() function...
  } else {
    Element.prototype.remove = function () {
      if (this.parentNode) this.parentNode.removeChild(this);
    };
  }

  window.Toasty = Toasty;
})(window, document);

"use strict"; // SelectionController ist eine abstrakte Basisklasse für die konkreten Controller, die zur Anbindung der select Elemente dienen
// Abstrakte Methoden sind
// getValue(key) - muss das Datenobjekt liefern, das zu einer ausgewählten option gehört.
// Als key wird der Wert des value-Attributs dieser Option übergeben.
// getValueList(dataSource) - muss Daten für die option-Elemente liefern, die im select 
// Element einzutragen sind. Ergebnis muss ein Array aus Objekten sein, jedes Objekt muss
// die Properties value (für das value-Attribut) und text (für den Inhalt des option Elements) enthalten


"use strict"; //bodyparts are special equipment


var BaseHumanoid = /*#__PURE__*/function (_Equipment) {
  _inherits(BaseHumanoid, _Equipment);

  var _super6 = _createSuper(BaseHumanoid);

  function BaseHumanoid() {
    var _this5;

    _classCallCheck(this, BaseHumanoid);

    _this5 = _super6.call(this, 'BaseHumanoid');
    _this5.tags = ['body'];
    _this5.slotUse = ['bBase'];
    return _this5;
  }

  _createClass(BaseHumanoid, [{
    key: "descLong",
    value: function descLong(fconv) {
      return fconv('$[My]$ body is that of an human.');
    } //$[I]$ $[have]$ a humanoid body.

  }, {
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("BaseHumanoid", this);
    }
  }, {
    key: "descShort",
    get: function get() {
      return this.desc;
    }
  }, {
    key: "desc",
    get: function get() {
      return '';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(BaseHumanoid, value.data);
    }
  }]);

  return BaseHumanoid;
}(Equipment);

var BaseQuadruped = /*#__PURE__*/function (_Equipment2) {
  _inherits(BaseQuadruped, _Equipment2);

  var _super7 = _createSuper(BaseQuadruped);

  function BaseQuadruped() {
    var _this6;

    _classCallCheck(this, BaseQuadruped);

    _this6 = _super7.call(this, 'BaseQuadruped');
    _this6.tags = ['body'];
    _this6.slotUse = ['bBase'];
    return _this6;
  }

  _createClass(BaseQuadruped, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("BaseQuadruped", this);
    }
  }, {
    key: "descLong",
    value: function descLong(fconv) {
      return fconv('$[I]$ $[am]$ walking on 4 legs like a feral mammal.');
    }
  }, {
    key: "descShort",
    get: function get() {
      return this.desc;
    }
  }, {
    key: "desc",
    get: function get() {
      return '';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(BaseQuadruped, value.data);
    }
  }]);

  return BaseQuadruped;
}(Equipment);

var BaseWorm = /*#__PURE__*/function (_Equipment3) {
  _inherits(BaseWorm, _Equipment3);

  var _super8 = _createSuper(BaseWorm);

  function BaseWorm() {
    var _this7;

    _classCallCheck(this, BaseWorm);

    _this7 = _super8.call(this, 'BaseWorm');
    _this7.tags = ['body'];
    _this7.slotUse = ['bBase'];
    return _this7;
  }

  _createClass(BaseWorm, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("BaseWorm", this);
    }
  }, {
    key: "descLong",
    value: function descLong(fconv) {
      return fconv('$[I]$ $[am]$ wriggling around like a snake.');
    }
  }, {
    key: "descShort",
    get: function get() {
      return this.desc;
    }
  }, {
    key: "desc",
    get: function get() {
      return '';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(BaseWorm, value.data);
    }
  }]);

  return BaseWorm;
}(Equipment);

var FaceHuman = /*#__PURE__*/function (_Equipment4) {
  _inherits(FaceHuman, _Equipment4);

  var _super9 = _createSuper(FaceHuman);

  _createClass(FaceHuman, null, [{
    key: "dataPrototype",
    value: function dataPrototype() {
      return {
        femininity: 0.2
      }; //1 = full female 0= male
    }
  }]);

  function FaceHuman() {
    var _this8;

    _classCallCheck(this, FaceHuman);

    _this8 = _super9.call(this, 'FaceHuman');
    _this8.tags = ['body'];
    _this8.slotUse = ['bFace', 'bMouth'];
    _this8.data = FaceHuman.dataPrototype();
    return _this8;
  }

  _createClass(FaceHuman, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("FaceHuman", this);
    }
  }, {
    key: "descLong",
    value: function descLong(fconv) {
      return fconv('$[My]$ face ressembles that of a human');
    }
  }, {
    key: "descShort",
    get: function get() {
      return 'human face';
    }
  }, {
    key: "desc",
    get: function get() {
      return 'hominid face';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(FaceHuman, value.data);
    }
  }]);

  return FaceHuman;
}(Equipment);

var FaceWolf = /*#__PURE__*/function (_Equipment5) {
  _inherits(FaceWolf, _Equipment5);

  var _super10 = _createSuper(FaceWolf);

  _createClass(FaceWolf, null, [{
    key: "dataPrototype",
    value: function dataPrototype() {
      return {
        style: 'wolf',
        femininity: 0.2,
        pDamage: 0
      };
    }
  }, {
    key: "factory",
    value: function factory(id) {
      var obj = new FaceWolf();
      obj.setStyle(id);
      return obj;
    }
  }]);

  function FaceWolf() {
    var _this9;

    _classCallCheck(this, FaceWolf);

    _this9 = _super10.call(this, 'FaceWolf');
    _this9.tags = ['body'];
    _this9.slotUse = ['bFace', 'bMouth']; //todo separate mouth-bodypart??

    _this9.data = FaceWolf.dataPrototype();
    return _this9;
  }

  _createClass(FaceWolf, [{
    key: "setStyle",
    value: function setStyle(id) {
      switch (id) {
        case 'cat':
        case 'dog':
        case 'wolf':
        case 'lizard':
          this.data.style = id;
          this.pDamage = 10;
          break;

        case 'horse':
          this.data.style = id;
          this.pDamage = 0;
          break;

        default:
          throw new Error("unknown Face-style " + id);
      }
    }
  }, {
    key: "getStyle",
    value: function getStyle() {
      return this.data.style;
    }
  }, {
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("FaceWolf", this);
    }
  }, {
    key: "onEquip",
    value: function onEquip(context) {
      var old = context.parent.Skills.countItem(SkillBite.name);
      if (old > 0) context.parent.Skills.removeItem(SkillBite.name, old);
      context.parent.Skills.addItem(new SkillBite());
      return {
        OK: true,
        msg: 'shifted'
      };
    }
  }, {
    key: "onUnequip",
    value: function onUnequip() {
      var old = this.parent.parent.Skills.countItem(SkillBite.name);
      if (old > 0) this.parent.parent.Skills.removeItem(SkillBite.name, old);
      return {
        OK: true,
        msg: 'shifted'
      };
    }
  }, {
    key: "descLong",
    value: function descLong(fconv) {
      return fconv('$[I]$ $[have]$ a muzzle like a ' + this.data.style + '.');
    }
  }, {
    key: "attackMod",
    value: function attackMod(target) {
      var mod = new SkillMod();
      mod.onHit = [{
        target: target,
        eff: [effDamage.setup(11, 'slash')]
      }];
      return mod;
    }
  }, {
    key: "descShort",
    get: function get() {
      return this.desc;
    }
  }, {
    key: "desc",
    get: function get() {
      return this.data.style + '\'like face.';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(FaceWolf, value.data);
    }
  }]);

  return FaceWolf;
}(Equipment);

var FaceHorse = /*#__PURE__*/function (_Equipment6) {
  _inherits(FaceHorse, _Equipment6);

  var _super11 = _createSuper(FaceHorse);

  _createClass(FaceHorse, null, [{
    key: "dataPrototype",
    value: function dataPrototype() {
      return {
        femininity: 0.2
      };
    }
  }]);

  function FaceHorse() {
    var _this10;

    _classCallCheck(this, FaceHorse);

    _this10 = _super11.call(this, 'FaceHorse');
    _this10.tags = ['body'];
    _this10.slotUse = ['bFace', 'bMouth'];
    _this10.data = FaceHorse.dataPrototype();
    return _this10;
  }

  _createClass(FaceHorse, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("FaceHorse", this);
    }
  }, {
    key: "descLong",
    value: function descLong(fconv) {
      return fconv('$[I]$ $[have]$ a muzzle like a horse');
    }
  }, {
    key: "descShort",
    get: function get() {
      return 'wolf muzzle';
    }
  }, {
    key: "desc",
    get: function get() {
      return 'wolf muzzle';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(FaceHorse, value.data);
    }
  }]);

  return FaceHorse;
}(Equipment);

var SkinHuman = /*#__PURE__*/function (_Equipment7) {
  _inherits(SkinHuman, _Equipment7);

  var _super12 = _createSuper(SkinHuman);

  function SkinHuman() {
    var _this11;

    _classCallCheck(this, SkinHuman);

    _this11 = _super12.call(this, 'SkinHuman');
    _this11.tags = ['body'];
    _this11.slotUse = ['bSkin'];
    return _this11;
  }

  _createClass(SkinHuman, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("SkinHuman", this);
    }
  }, {
    key: "descLong",
    value: function descLong(fconv) {
      return fconv('Smooth skin covers most of $[my]$ body.');
    }
  }, {
    key: "desc",
    get: function get() {
      'a smooth tanned skin mostly bare of noticable hair.';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(SkinHuman, value.data);
    }
  }]);

  return SkinHuman;
}(Equipment);

var SkinFur = /*#__PURE__*/function (_Equipment8) {
  _inherits(SkinFur, _Equipment8);

  var _super13 = _createSuper(SkinFur);

  _createClass(SkinFur, null, [{
    key: "dataPrototype",
    value: function dataPrototype() {
      return {
        style: 'wolf',
        color: 'dark grey',
        pattern: 'dense'
      };
    }
  }, {
    key: "factory",
    value: function factory(id) {
      var obj = new SkinFur();
      obj.setStyle(id);
      return obj;
    }
  }]);

  function SkinFur() {
    var _this12;

    _classCallCheck(this, SkinFur);

    _this12 = _super13.call(this, 'SkinFur');
    _this12.tags = ['body'];
    _this12.slotUse = ['bSkin'];
    _this12.data = SkinFur.dataPrototype();
    return _this12;
  }

  _createClass(SkinFur, [{
    key: "setStyle",
    value: function setStyle(id) {
      var color = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'dark grey';
      this.data.style = id;
      this.data.color = color;

      switch (id) {
        case 'cat':
          this.data.pattern = 'fine';
          break;

        case 'dog':
          this.data.pattern = 'spotted';
          break;

        case 'horse':
          this.data.pattern = 'short';
          break;

        case 'wolf':
          this.data.pattern = 'rough';
          break;

        default:
          throw new Error("unknown Fur-style " + id);
      }
    }
  }, {
    key: "getStyle",
    value: function getStyle() {
      return this.data.style;
    }
  }, {
    key: "toJSON",
    //todo color
    value: function toJSON() {
      return window.storage.Generic_toJSON("SkinFur", this);
    }
  }, {
    key: "descLong",
    value: function descLong(fconv) {
      return fconv('A ' + this.data.pattern + ', ' + this.data.color + ' fur covers $[my]$ body.');
    }
  }, {
    key: "descShort",
    get: function get() {
      return this.desc;
    }
  }, {
    key: "desc",
    get: function get() {
      'a dense fur covering the whole body.';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(SkinFur, value.data);
    }
  }]);

  return SkinFur;
}(Equipment);

var TailWolf = /*#__PURE__*/function (_Equipment9) {
  _inherits(TailWolf, _Equipment9);

  var _super14 = _createSuper(TailWolf);

  _createClass(TailWolf, null, [{
    key: "dataPrototype",
    value: function dataPrototype() {
      return {
        style: 'wolf',
        growth: 0.1,
        maxGrowth: 1.5,
        pDamage: 0
      };
    }
  }, {
    key: "factory",
    value: function factory(id) {
      var obj = new TailWolf();
      obj.setStyle(id);
      return obj;
    }
  }]);

  function TailWolf() {
    var _this13;

    _classCallCheck(this, TailWolf);

    _this13 = _super14.call(this, 'TailWolf');
    _this13.tags = ['body'];
    _this13.slotUse = ['bTailBase'];
    _this13.data = TailWolf.dataPrototype();
    return _this13;
  }

  _createClass(TailWolf, [{
    key: "setStyle",
    value: function setStyle(id) {
      switch (id) {
        case 'human':
        case 'cat':
        case 'dog':
        case 'horse':
        case 'wolf':
        case 'lizard':
          this.data.style = id;
          this.data.growth = 0.10; //in %/100 maxGrowth

          this.data.maxGrowth = 1.2; //in meter, todo depends on bodysize

          break;

        default:
          throw new Error("unknown Tail-style " + id);
      }
    }
  }, {
    key: "getStyle",
    value: function getStyle() {
      return this.data.style;
    }
  }, {
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("TailWolf", this);
    }
  }, {
    key: "descLong",
    value: function descLong(fconv) {
      return fconv('Some ' + this.data.style + '-tail is attached to $[my]$ spine.');
    }
  }, {
    key: "descShort",
    get: function get() {
      return this.desc;
    }
  }, {
    key: "desc",
    get: function get() {
      var msg = '';

      switch (this.data.style) {
        case 'cat':
          msg = 'a flexible,furred tail like that of a cat.';
          break;

        default:
          msg = this.data.style + '\'like tail.';
      }

      return msg;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(TailWolf, value.data);
    }
  }]);

  return TailWolf;
}(Equipment);

var HandsPaw = /*#__PURE__*/function (_Equipment10) {
  _inherits(HandsPaw, _Equipment10);

  var _super15 = _createSuper(HandsPaw);

  _createClass(HandsPaw, null, [{
    key: "dataPrototype",
    //paws of ferals
    value: function dataPrototype() {
      return {
        style: 'wolf',
        pDamage: 0
      };
    }
  }, {
    key: "factory",
    value: function factory(id) {
      var obj = new HandsPaw();
      obj.setStyle(id);
      return obj;
    }
  }]);

  function HandsPaw() {
    var _this14;

    _classCallCheck(this, HandsPaw);

    _this14 = _super15.call(this, 'HandsPaw');
    _this14.tags = ['body'];
    _this14.slotUse = ['bHands'];
    _this14.data = HandsPaw.dataPrototype();
    return _this14;
  }

  _createClass(HandsPaw, [{
    key: "setStyle",
    value: function setStyle(id) {
      switch (id) {
        case 'cat':
        case 'dog':
        case 'wolf':
        case 'lizard':
          this.data.style = id;
          this.data.pDamage = 10;
          break;

        default:
          throw new Error("unknown HandsPaw-style " + id);
      }
    }
  }, {
    key: "getStyle",
    value: function getStyle() {
      return this.data.style;
    }
  }, {
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("HandsPaw", this);
    }
  }, {
    key: "descLong",
    value: function descLong(fconv) {
      return fconv('$[I]$ $[have]$ paws like that of a ' + this.data.style + '.');
    }
  }, {
    key: "attackMod",
    value: function attackMod(target) {
      var mod = new SkillMod();
      mod.onHit = [{
        target: target,
        eff: [effDamage.setup(10, 'slash')]
      }];
      return mod;
    }
  }, {
    key: "descShort",
    get: function get() {
      return this.desc;
    }
  }, {
    key: "desc",
    get: function get() {
      return this.data.style + '\'like paws.';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(HandsPaw, value.data);
    }
  }]);

  return HandsPaw;
}(Equipment);

var HandsHuman = /*#__PURE__*/function (_Equipment11) {
  _inherits(HandsHuman, _Equipment11);

  var _super16 = _createSuper(HandsHuman);

  _createClass(HandsHuman, null, [{
    key: "dataPrototype",
    value: function dataPrototype() {
      return {
        style: 'human',
        pDamage: 0
      };
    }
  }, {
    key: "factory",
    value: function factory(id) {
      var obj = new HandsHuman();
      obj.setStyle(id);
      return obj;
    }
  }]);

  function HandsHuman() {
    var _this15;

    _classCallCheck(this, HandsHuman);

    _this15 = _super16.call(this, 'HandsHuman');
    _this15.tags = ['body'];
    _this15.slotUse = ['bHands'];
    _this15.data = HandsHuman.dataPrototype();
    return _this15;
  }

  _createClass(HandsHuman, [{
    key: "setStyle",
    value: function setStyle(id) {
      this.data.style = id;

      switch (id) {
        case 'dog':
        case 'wolf':
        case 'horse':
          this.data.pDamage = 7;
          break;

        case 'cat':
        case 'lizard':
          this.data.pDamage = 14;
          break;

        case 'human':
          this.data.pDamage = 0;
          break;

        default:
          throw new Error("unknown Hands-style " + id);
      }
    }
  }, {
    key: "getStyle",
    value: function getStyle() {
      return this.data.style;
    }
  }, {
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("HandsHuman", this);
    }
  }, {
    key: "descLong",
    value: function descLong(fconv) {
      var msg = '$[My]$ hands consist of a palm and fingers.';
      msg += ['dog', 'wolf', 'cat'].includes(this.data.style) ? this.data.style + '-claws adorn the fingertips' : '';
      msg += ['lizard'].includes(this.data.style) ? 'Large talons grow from their fingertips.' : '';
      return fconv(msg);
    }
  }, {
    key: "descShort",
    get: function get() {
      return this.desc;
    }
  }, {
    key: "desc",
    get: function get() {
      return 'human like hands.';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(HandsHuman, value.data);
    }
  }]);

  return HandsHuman;
}(Equipment);

var BreastHuman = /*#__PURE__*/function (_Equipment12) {
  _inherits(BreastHuman, _Equipment12);

  var _super17 = _createSuper(BreastHuman);

  _createClass(BreastHuman, null, [{
    key: "dataPrototype",
    value: function dataPrototype() {
      return {
        size: 3
      };
    }
  }, {
    key: "factory",
    value: function factory(id) {
      var obj = new BreastHuman();
      obj.setStyle(id);
      return obj;
    }
  }]);

  function BreastHuman() {
    var _this16;

    _classCallCheck(this, BreastHuman);

    _this16 = _super17.call(this, 'BreastHuman');
    _this16.tags = ['body'];
    _this16.slotUse = ['bBreast'];
    _this16.data = BreastHuman.dataPrototype();
    return _this16;
  }

  _createClass(BreastHuman, [{
    key: "setStyle",
    value: function setStyle(id) {
      this.data.style = id;

      switch (id) {
        case 'human':
        case 'horse':
          break;

        case 'cat':
        case 'dog':
        case 'wolf':
          break;

        case 'lizard':
          break;

        default:
          throw new Error("unknown breast-style " + id);
      }
    }
  }, {
    key: "getStyle",
    value: function getStyle() {
      return this.data.style;
    }
  }, {
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("BreastHuman", this);
    }
  }, {
    key: "descLong",
    value: function descLong(fconv) {
      return fconv('$[My]$ breasts are small but perky.');
    }
  }, {
    key: "descShort",
    get: function get() {
      return this.desc;
    }
  }, {
    key: "desc",
    get: function get() {
      return 'some human breasts.';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(BreastHuman, value.data);
    }
  }]);

  return BreastHuman;
}(Equipment);

var VulvaHuman = /*#__PURE__*/function (_Equipment13) {
  _inherits(VulvaHuman, _Equipment13);

  var _super18 = _createSuper(VulvaHuman);

  _createClass(VulvaHuman, null, [{
    key: "dataPrototype",
    value: function dataPrototype() {
      //
      return {
        labia: 0,
        virgin: true,
        wetgen: 1,
        stretch: 1,
        depth: 1,
        clitsize: 0.5,
        spermtype: '',
        sperm: 0
      };
    }
  }, {
    key: "factory",
    value: function factory(id) {
      var obj = new VulvaHuman();
      obj.setStyle(id);
      return obj;
    }
  }]);

  function VulvaHuman() {
    var _this17;

    _classCallCheck(this, VulvaHuman);

    _this17 = _super18.call(this, 'VulvaHuman');
    _this17.tags = ['body'];
    _this17.slotUse = ['bVulva'];
    _this17.data = VulvaHuman.dataPrototype();
    return _this17;
  }

  _createClass(VulvaHuman, [{
    key: "setStyle",
    value: function setStyle(id) {
      this.data.style = id;

      switch (id) {
        case 'human':
        case 'cat':
        case 'dog':
        case 'horse':
        case 'wolf':
        case 'lizard':
          break;

        default:
          throw new Error("unknown vulva-style " + id);
      }
    }
  }, {
    key: "getStyle",
    value: function getStyle() {
      return this.data.style;
    }
  }, {
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("VulvaHuman", this);
    }
  }, {
    key: "descLong",
    value: function descLong(fconv) {
      var msg = "$[My]$ vagina can snuggly fit around " + this.data.stretch + "cm in diameter and " + this.data.depth + "cm in depth.";
      msg += "Its clit is of a size of around " + this.data.clitsize + "cm.";

      if (this.data.spermtype !== '') {
        msg += this.data.sperm + "ml of sperm from a " + this.data.spermtype + " might be deposited in $[my]$ womb.";
      }

      return fconv(msg);
    }
  }, {
    key: "onEquip",
    value: function onEquip(context) {
      context.parent.addEffect('effSpermInWomb', new window.storage.constructors['effSpermInWomb']());
      context.parent.addEffect('effVaginalFertil', new window.storage.constructors['effVaginalFertil']());
      return {
        OK: true,
        msg: 'equipped'
      };
    }
  }, {
    key: "onUnequip",
    value: function onUnequip(context) {
      context.parent.Effects.removeItem('effVaginalFertil');
      context.parent.Effects.removeItem('effVaginalPregnant');
      context.parent.Effects.removeItem('effSpermInWomb');
      return {
        OK: true,
        msg: 'unequipped'
      };
    }
  }, {
    key: "addSperm",
    value: function addSperm(type, amount) {
      if (amount > this.data.sperm || this.data.spermtype) {
        this.data.spermtype = type;
      }

      this.data.sperm += amount;
    }
  }, {
    key: "removeSperm",
    value: function removeSperm(amount) {
      if (amount > 0) {
        this.data.sperm -= amount;
      } else this.data.sperm = 0;

      if (this.data.sperm <= 0) {
        this.data.sperm = 0;
        this.data.spermtype = '';
      }
    }
  }, {
    key: "descShort",
    get: function get() {
      return this.data.style + ' vagina';
    }
  }, {
    key: "desc",
    get: function get() {
      return 'puffy cunt';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(VulvaHuman, value.data);
    }
  }]);

  return VulvaHuman;
}(Equipment);

var PenisHuman = /*#__PURE__*/function (_Equipment14) {
  _inherits(PenisHuman, _Equipment14);

  var _super19 = _createSuper(PenisHuman);

  _createClass(PenisHuman, null, [{
    key: "dataPrototype",
    value: function dataPrototype() {
      return {
        style: 'human',
        size: 16,
        virgin: true,
        wetgen: 1,
        sheath: 0,
        ballsize: 2.3
      };
    }
  }, {
    key: "factory",
    value: function factory(id) {
      var obj = new PenisHuman();
      obj.setStyle(id);
      return obj;
    }
  }]);

  function PenisHuman() {
    var _this18;

    _classCallCheck(this, PenisHuman);

    _this18 = _super19.call(this, 'PenisHuman');
    _this18.tags = ['body'];
    _this18.slotUse = ['bPenis', 'bBalls'];
    _this18.data = PenisHuman.dataPrototype();
    return _this18;
  }

  _createClass(PenisHuman, [{
    key: "setStyle",
    value: function setStyle(id) {
      this.data.style = id;

      switch (id) {
        case 'human':
        case 'cat':
        case 'dog':
        case 'horse':
        case 'wolf':
          break;

        case 'lizard':
          break;

        default:
          throw new Error("unknown penis-style " + id);
      }
    }
  }, {
    key: "getStyle",
    value: function getStyle() {
      return this.data.style;
    }
  }, {
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("PenisHuman", this);
    }
  }, {
    key: "canEquip",
    value: function canEquip(context) {
      return {
        OK: true,
        msg: 'equipable'
      };
    }
  }, {
    key: "canUnequip",
    value: function canUnequip() {
      return {
        OK: true,
        msg: 'unequipable'
      };
    }
  }, {
    key: "descLong",
    value: function descLong(fconv) {
      var msg = "$[My]$ " + this.data.style + "-dong is around " + this.data.size + "cm long.";
      msg += "A Ballsack dangles below it that measures around " + this.data.ballsize + "cm.";
      return fconv(msg);
    }
  }, {
    key: "descShort",
    get: function get() {
      return this.desc;
    }
  }, {
    key: "desc",
    get: function get() {
      var msg = '';

      switch (this.data.style) {
        case 'cat':
          msg = 'a slim but spiked cat-member.';
          break;

        default:
          msg = 'a schlong of a ' + this.data.style + '.';
      }

      return msg;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(PenisHuman, value.data);
    }
  }]);

  return PenisHuman;
}(Equipment); //todo BodyPartLib ??


window.gm.ItemsLib = function (ItemsLib) {
  window.storage.registerConstructor(BaseHumanoid);
  window.storage.registerConstructor(BaseQuadruped);
  window.storage.registerConstructor(BaseWorm);
  window.storage.registerConstructor(HandsHuman);
  window.storage.registerConstructor(HandsPaw);
  window.storage.registerConstructor(FaceHorse);
  window.storage.registerConstructor(FaceHuman);
  window.storage.registerConstructor(FaceWolf);
  window.storage.registerConstructor(SkinHuman);
  window.storage.registerConstructor(SkinFur);
  window.storage.registerConstructor(TailWolf);
  window.storage.registerConstructor(BreastHuman);
  window.storage.registerConstructor(PenisHuman);
  window.storage.registerConstructor(VulvaHuman);
  return ItemsLib;
}(window.gm.ItemsLib || {}); //todo randomize what is mutated
//number of mutations depends on magnitude?
//temporary mutate to feral?

/*
* those mutations are usually triggered by effects, calculate some changes and 
* if related to player pushDeffered Event for displaying message  
*/


window.gm.MutationsLib = window.gm.MutationsLib || {};

window.gm.MutationsLib['vaginaSpermDissolve'] = function (char) {
  var vulva = char.getVagina();
  vulva.removeSperm(2); //todo decay depends on looseness, soulgem absorption??

  var msg = '';
  msg += "You can feel some of the cum in your womb dribble down your leg. ";
  var lewdMark = char.Effects.findEffect(effLewdMark.name)[0];
  var pregnancy = char.Effects.findEffect(effVaginalPregnant.name)[0];

  if (pregnancy) {
    if (lewdMark) {
      msg += "More of that precious seed is absorbed by that soulgem growing in you.</br>";
      vulva.removeSperm(2); //todo decay depends on looseness, soulgem absorption??
    } else msg += "But you are pregnant already anyway.</br>";
  }

  if (!pregnancy) {
    pregnancy = char.Effects.findEffect(effVaginalFertil.name)[0];

    if (pregnancy) {
      //todo random chance according to base-fertility-stat, sperm-fertility, vulva-fertility
      //race-compatibility between father-mother
      if (true || _.random(0, 100) > 75) {
        msg += "Has your last fling got you impregnated?</br>";
        pregnancy = new effVaginalPregnant();
        pregnancy.data.type = vulva.data.spermtype;
        if (lewdMark) pregnancy.data.type = 'soulgem';
        char.addEffect(effVaginalPregnant.name, pregnancy);
      } else msg += "Hopefully there is nothing to worry about?</br>";
    }
  }

  if (vulva.data.sperm > 0) {
    msg += "There might still be " + window.gm.util.formatNumber(vulva.data.sperm, 0) + "ml sperm left.</br>";
  } else msg += "This was possibly the last remains of sperm.</br>";

  if (char === window.gm.player) {
    window.gm.pushDeferredEvent("GenericDeffered", [msg]);
  }
};

window.gm.MutationsLib['vaginaPregnancy'] = function (char) {
  var msg = '';
  var lewdMark = char.Effects.findEffect(effLewdMark.name)[0];
  var pregnancy = char.Effects.findEffect(effVaginalPregnant.name)[0];

  if (pregnancy) {
    if (lewdMark && pregnancy.data.type === 'soulgem') {
      if (pregnancy.data.cycles <= 0) {
        pregnancy = new effVaginalFertil();
        char.addEffect(effVaginalFertil.name, pregnancy);
        msg += "A homemade soulgem slips out of your nethers !</br>";
        char.Inv.addItem(window.gm.ItemsLib['TinySoulGem']());
      } else msg += "If you dont provide that soulgem something to feed off, it might absorb some energy from you instead!.</br>";
    } else {
      if (pregnancy.data.cycles <= 0) {
        msg += "Congrats, you brought some more " + pregnancy.data.type + " into this world.</br>";
      } else {
        msg += "Your belly is swollen with the spawn of some " + pregnancy.data.type + ".</br>";
      }
    }

    if (window.story.state._gm.dbgShowMoreInfo) msg += pregnancy.data.cycles * pregnancy.data.duration + " minutes to go.";
  } //todo go in heat if fertility-cycle triggers?


  if (char === window.gm.player) {
    window.gm.pushDeferredEvent("GenericDeffered", [msg]);
  }
};

window.gm.MutationsLib['swapGender'] = function (char, genderItem) {
  var msg = '';
  var penis = char.getPenis();
  var vulva = char.getVagina();
  var style = penis ? penis.getStyle() : vulva ? vulva.getStyle() : 'human';
  var newItem = genderItem.factory(style);

  if (newItem.slotUse.includes('bPenis')) {
    if (vulva !== null) {
      window.gm.player.Outfit.removeItem(vulva.id, true);
      msg += 'You lost your female privats. ';
    }

    if (penis === null) {
      window.gm.player.Outfit.addItem(newItem.factory(style), true);
      msg += 'Instead a dick sprouts in your nethers.</br>';
    }
  }

  if (newItem.slotUse.includes('bVulva')) {
    if (penis !== null) {
      window.gm.player.Outfit.removeItem(penis.id, true);
      msg += 'Your fine penis shrinks down until it is finally completely absorbed in your body. ';
    }

    if (vulva === null) {
      window.gm.player.Outfit.addItem(newItem, true);
      msg += 'A female opening forms itself in your groin.</br>';
    }
  }

  if (char === window.gm.player) {
    window.gm.pushDeferredEvent("GenericDeffered", [msg]);
  }
};

window.gm.MutationsLib['mutateWolf'] = function () {
  var _rnd = _.random(1, 100);

  var msg = '',
      _TF = "TailWolf";

  if (window.gm.player.Outfit.countItem(_TF) > 0) {
    var item = window.gm.player.Outfit.getItem("TailWolf");

    if (item.getStyle() !== 'wolf') {
      item.setStyle('wolf');
      msg = "Your tail is now a fuzzy bush like that of a wolf.</br>";
    } else {
      var growth = item.growth + 0.25;
      var maxGrowth = item.maxGrowth;

      if (growth >= 1) {
        msg += "That tail didnt grow any further.</br>";
      } else {
        item.growth = growth;
        msg += "Your bushy tail must have grown and is now " + window.gm.util.formatNumber(growth * maxGrowth, 1) + " meter long.</br>";
      }
    }
  } else {
    window.gm.player.Outfit.addItem(window.storage.constructors[_TF].factory('wolf'));
    msg += "You have grown a fuzzy tail !</br>";
  }

  _TF = 'FaceWolf';
  var face = window.gm.player.Outfit.getItemForSlot(window.gm.OutfitSlotLib.bFace);
  var skin = window.gm.player.Outfit.getItemForSlot(window.gm.OutfitSlotLib.bSkin);

  if (face === null || face.id !== _TF) {
    window.gm.player.Outfit.addItem(window.storage.constructors[_TF].factory('wolf'));
    msg += "Your face got transformed into a dog-like muzzle.</br>";
  } else if (face.getStyle() !== 'wolf') {
    face.setStyle('wolf');
    msg += "Your not so human face got transformed into a dog-like muzzle.</br>";
  } else if (skin === null || skin.id != "SkinFur") {
    window.gm.player.Outfit.addItem(window.storage.constructors['SkinFur']());
    msg += "A dense coat of fur spreads over your body.</br>";
  }

  if (msg === '') msg = "Your anxiety goes by as you didnt get any more wolflike.";

  if (char === window.gm.player) {
    window.gm.pushDeferredEvent("GenericDeffered", [msg]);
  }
};

window.gm.MutationsLib['mutateCat'] = function () {
  var msg = '',
      _TF = "TailWolf";

  if (window.gm.player.Outfit.countItem(_TF) > 0) {
    var item = window.gm.player.Outfit.getItem(_TF);

    if (item.getStyle() !== 'cat') {
      item.setStyle('cat');
      msg = "Your tail reshapes itself to a be more cat-like.</br>";
    } else {
      var growth = item.data.growth + 0.25;
      var maxGrowth = 2; //window.gm.player.Outfit.getItem("TailWolf").maxGrowth;

      if (growth >= 1) {
        msg = "You already changed to a cat as far as possible.</br>";
      } else {
        item.data.growth = growth;
        msg = "Your tail must have grown and is now " + growth * maxGrowth + " meter long.</br>";
      }
    }
  } else {
    window.gm.player.Outfit.addItem(window.storage.constructors['TailWolf'].factory('cat'));
    msg = "You have grown a cat tail !</br>";
  }

  if (char === window.gm.player) {
    window.gm.pushDeferredEvent("GenericDeffered", [msg]);
  }
};

"use strict";
/**
 * Items can have bonus/curse(s) that is applied when its condition is met 
 * condition is checked when equipped and on every timechange (no check if not equipped ? )
 * if trigger succeeds, apply-function is called  
 * the curse should be initially hidden to the player but might be revealed by a magican
 * 
 * possible conditions to think of:
 * - is activated if worn for some time
 * - is activated if other certain (cursed) items are worn
 * - is activated if effect is active
 * - is activated if in location
 * 
 * possible actions to think of:
 * - disable unequip/ locking
 * - replace the item with a different one
 * - add an effect
 * 
 * use deffered event to show the triggerd curse
 * 
 * ways to remove a curse (not yet triggered)
 * - by magican?
 * 
 * ways to remove active curse
 * - a key to unlock
 * - dissolve the item by a magican
 * - use item/potion that counters the effect
 * - mutate body to remove bodypart (snake -> no wristcuffs) 
 */

/**
 * //hidden 0 = visible, 1= name=???, 2= , 4= hidden
 */


var Curse = /*#__PURE__*/function () {
  function Curse() {
    _classCallCheck(this, Curse);

    this.hidden = 0;
    this.trigger = null;
    this.list = [];
  }
  /* 
  * parent is the item !
  * Attention !! _parent will be added dynamical
  */


  _createClass(Curse, [{
    key: "configureCurse",
    value: function configureCurse(item, trigger, curses) {
      this.trigger = trigger;
      this.list = curses;
      item.bonus.push(this);

      this._relinkItems(item);
    }
  }, {
    key: "_relinkItems",
    value: function _relinkItems(parent) {
      this._parent = window.gm.util.refToParent(parent);
      this.trigger._parent = window.gm.util.refToParent(this);

      var _iterator43 = _createForOfIteratorHelper(this.list),
          _step43;

      try {
        for (_iterator43.s(); !(_step43 = _iterator43.n()).done;) {
          el = _step43.value;
          el._parent = window.gm.util.refToParent(this);
        }
      } catch (err) {
        _iterator43.e(err);
      } finally {
        _iterator43.f();
      }
    }
  }, {
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("Curse", this);
    }
  }, {
    key: "onEquip",
    value: function onEquip() {
      if (this.trigger.onEquip()) this.apply();
    }
  }, {
    key: "onUnequip",
    value: function onUnequip() {
      if (this.trigger.onUnequip()) this.apply(true);
    }
  }, {
    key: "canUnequip",
    value: function canUnequip() {
      //ask effects if allowed to unequip/not locked
      var res;

      var _iterator44 = _createForOfIteratorHelper(this.list),
          _step44;

      try {
        for (_iterator44.s(); !(_step44 = _iterator44.n()).done;) {
          el = _step44.value;
          res = el.canUnequip();
          if (res.OK == false) return res;
        }
      } catch (err) {
        _iterator44.e(err);
      } finally {
        _iterator44.f();
      }

      res = {
        OK: true,
        msg: 'unequipable'
      };
      return res;
    }
  }, {
    key: "onTimeChange",
    value: function onTimeChange(time) {
      if (this.trigger.onTimeChange(time)) this.apply();
    }
  }, {
    key: "apply",
    value: function apply(unapply) {
      this.hidden = 0; //reveal

      var _iterator45 = _createForOfIteratorHelper(this.list),
          _step45;

      try {
        for (_iterator45.s(); !(_step45 = _iterator45.n()).done;) {
          el = _step45.value;
          el.apply(unapply); //todo 3 effects would generate 3 defferedEvents; instead combine text into single event
        }
      } catch (err) {
        _iterator45.e(err);
      } finally {
        _iterator45.f();
      }
    }
  }, {
    key: "parent",
    get: function get() {
      return this._parent ? this._parent() : null;
    }
  }, {
    key: "desc",
    get: function get() {
      var msg = '';

      if ((this.hidden & 0x4) > 0) {//completely hidden
      } else if ((this.hidden & 0x1) > 0) {
        msg = 'unknown effect';
      } else if (this.hidden === 0) {
        msg = this.trigger.desc;

        var _iterator46 = _createForOfIteratorHelper(this.list),
            _step46;

        try {
          for (_iterator46.s(); !(_step46 = _iterator46.n()).done;) {
            el = _step46.value;
            msg += "; " + el.desc;
          }
        } catch (err) {
          _iterator46.e(err);
        } finally {
          _iterator46.f();
        }
      }

      return msg;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(Curse, value.data);
    }
  }]);

  return Curse;
}(); //-------------------------------------------------------------------------


var CrsTrigger = /*#__PURE__*/function () {
  function CrsTrigger() {
    _classCallCheck(this, CrsTrigger);

    this.id = '';
  }
  /* 
  * parent is the curse !
  * Attention !! _parent will be added dynamical
  */


  _createClass(CrsTrigger, [{
    key: "onEquip",
    value: function onEquip() {
      return false;
    }
  }, {
    key: "onUnequip",
    value: function onUnequip() {
      return true;
    } //by default trigger unapply when unequipped

  }, {
    key: "onTimeChange",
    value: function onTimeChange(time) {
      return false;
    }
  }, {
    key: "parent",
    get: function get() {
      return this._parent ? this._parent() : null;
    }
  }, {
    key: "desc",
    get: function get() {
      return '';
    }
  }]);

  return CrsTrigger;
}();

var CrsTrgOnEquip = /*#__PURE__*/function (_CrsTrigger) {
  _inherits(CrsTrgOnEquip, _CrsTrigger);

  var _super20 = _createSuper(CrsTrgOnEquip);

  function CrsTrgOnEquip() {
    var _this19;

    _classCallCheck(this, CrsTrgOnEquip);

    _this19 = _super20.call(this);
    _this19.minItems = 0; //if 0 always trigger onEquip

    _this19.curseName = ''; //todo ..otherwise min no. items with this keyword need to be equipped

    return _this19;
  }

  _createClass(CrsTrgOnEquip, [{
    key: "onEquip",
    value: function onEquip() {
      return true;
    }
  }, {
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("CrsTrgOnEquip", this);
    }
  }, {
    key: "desc",
    get: function get() {
      return 'when equipped';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(CrsTrgOnEquip, value.data);
    }
  }]);

  return CrsTrgOnEquip;
}(CrsTrigger);

var CrsTrgDelayed = /*#__PURE__*/function (_CrsTrigger2) {
  _inherits(CrsTrgDelayed, _CrsTrigger2);

  var _super21 = _createSuper(CrsTrgDelayed);

  function CrsTrgDelayed() {
    var _this20;

    _classCallCheck(this, CrsTrgDelayed);

    _this20 = _super21.call(this);
    _this20.timeToTrigger = 60 * 2;
    _this20.timeStart = null;
    return _this20;
  }

  _createClass(CrsTrgDelayed, [{
    key: "onEquip",
    value: function onEquip() {
      this.timeStart = window.gm.getTime();
      return false;
    }
  }, {
    key: "onTimeChange",
    value: function onTimeChange(time) {
      return this.timeToTrigger < window.gm.getDeltaTime(time, this.time);
    }
  }, {
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("CrsTrgDelayed", this);
    }
  }, {
    key: "desc",
    get: function get() {
      return 'after ' + window.gm.util.formatNumber(this.timeToTrigger, 0) + 'min';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(CrsTrgDelayed, value.data);
    }
  }]);

  return CrsTrgDelayed;
}(CrsTrigger); //-------------------------------------------------------------------------


var CrsEffect = /*#__PURE__*/function () {
  function CrsEffect() {
    _classCallCheck(this, CrsEffect);

    this.hidden = 0;
    this.id = '';
  }
  /* 
  * parent is the curse !
  * Attention !! _parent will be added dynamical
  */


  _createClass(CrsEffect, [{
    key: "canUnequip",
    value: function canUnequip() {
      return {
        OK: true,
        msg: 'unequipable'
      };
    }
  }, {
    key: "parent",
    get: function get() {
      return this._parent ? this._parent() : null;
    }
  }, {
    key: "desc",
    get: function get() {
      return '';
    }
  }]);

  return CrsEffect;
}();

var CrsEffLock = /*#__PURE__*/function (_CrsEffect) {
  _inherits(CrsEffLock, _CrsEffect);

  var _super22 = _createSuper(CrsEffLock);

  function CrsEffLock() {
    var _this21;

    _classCallCheck(this, CrsEffLock);

    _this21 = _super22.call(this);
    _this21.id = 'CrsEffLock';
    _this21.key = 'KeyRestraintA';
    return _this21;
  }

  _createClass(CrsEffLock, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("CrsEffLock", this);
    }
  }, {
    key: "canUnequip",
    value: function canUnequip() {
      var res = {
        OK: true,
        msg: 'This devices requires ' + this.key + ' to unlock'
      };

      if (this.parent.parent.parent.parent.Inv.countItem(this.key) <= 0) {
        res.OK = false;
      }

      return res;
    }
  }, {
    key: "apply",
    value: function apply(unapply) {
      if (unapply) {
        this.parent.parent.parent.parent.Inv.removeItem(this.key, 1);
        window.gm.pushDeferredEvent("GenericDeffered", ['With the key, it was now possible to unlock and remove ' + this.parent.parent.name + ' !']);
      } else {
        window.gm.pushDeferredEvent("GenericDeffered", ['As soon as you equiped ' + this.parent.parent.name + ', some hidden lock sealed the item on you !']);
      }
    }
  }, {
    key: "desc",
    get: function get() {
      return "The item can only be unlocked with a " + this.key + ".";
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(CrsEffLock, value.data);
    }
  }]);

  return CrsEffLock;
}(CrsEffect);

var CrsEffEnergyDrain = /*#__PURE__*/function (_CrsEffect2) {
  _inherits(CrsEffEnergyDrain, _CrsEffect2);

  var _super23 = _createSuper(CrsEffEnergyDrain);

  function CrsEffEnergyDrain() {
    var _this22;

    _classCallCheck(this, CrsEffEnergyDrain);

    _this22 = _super23.call(this);
    _this22.id = 'CrsEffEnergyDrain';
    return _this22;
  }

  _createClass(CrsEffEnergyDrain, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("CrsEffEnergyDrain", this);
    }
  }, {
    key: "apply",
    value: function apply(unapply) {
      if (unapply) {
        this.parent.parent.parent.parent.Effects.removeItem(this.parent.parent.id + '_EnergyDrain');
      } else {
        //this->curse->item->outfit->char     id="cursed_leather_bracer.EnergyDrain"
        this.parent.parent.parent.parent.addEffect(this.parent.parent.id + '_EnergyDrain', new window.storage.constructors['effEnergyDrain']());
      }
    }
  }, {
    key: "desc",
    get: function get() {
      return "Drains wearers energy.";
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(CrsEffEnergyDrain, value.data);
    }
  }]);

  return CrsEffEnergyDrain;
}(CrsEffect);

var CrsEffStatBonus = /*#__PURE__*/function (_CrsEffect3) {
  _inherits(CrsEffStatBonus, _CrsEffect3);

  var _super24 = _createSuper(CrsEffStatBonus);

  function CrsEffStatBonus() {
    var _this23;

    _classCallCheck(this, CrsEffStatBonus);

    _this23 = _super24.call(this);
    _this23.id = 'CrsEffStatBonus';
    _this23.statid = 'strength';
    _this23.statbonus = 5;
    return _this23;
  }

  _createClass(CrsEffStatBonus, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("CrsEffStatBonus", this);
    }
  }, {
    key: "apply",
    value: function apply(unapply) {
      if (unapply) {
        this.parent.parent.parent.parent.Stats.removeModifier(this.statid, {
          id: this.statid + ":" + this.parent.parent.id
        });
      } else {
        this.parent.parent.parent.parent.Stats.addModifier(this.statid, {
          id: this.statid + ":" + this.parent.parent.id,
          bonus: this.statbonus
        });
      }
    }
  }, {
    key: "desc",
    get: function get() {
      return this.statid + " +" + this.statbonus;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(CrsEffStatBonus, value.data);
    }
  }]);

  return CrsEffStatBonus;
}(CrsEffect); //todo wrap you in rubber; pony gear,

/**
 * adds a curse-function to an item
 */


window.gm.makeCursedItem = function (item, extra) {
  var curse = new Curse();
  var eff = null;
  var list = [];
  curse.trigger = new CrsTrgOnEquip();

  if (extra.hidden) {
    curse.hidden = extra.hidden;
  } else curse.hidden = 4; //by default hidden


  if (extra.delayed) {
    curse.trigger = new CrsTrgDelayed();
  }

  if (extra.lock) {
    eff = new CrsEffLock();
    list.push(eff);
  }

  if (extra.energydrain) {
    eff = new CrsEffEnergyDrain();
    list.push(eff);
  }

  curse.configureCurse(item, curse.trigger, list);
  return item;
};

window.gm.makeBonusItem = function (item, extra) {
  var curse = new Curse();
  var eff = null;
  var list = [];
  curse.trigger = new CrsTrgOnEquip();

  if (extra.hidden) {
    curse.hidden = extra.hidden;
  } else curse.hidden = 0; //by default visible?


  if (extra.statBoost && extra.statBonus) {
    eff = new CrsEffStatBonus();
    eff.statid = extra.statBoost, eff.statbonus = extra.statBonus;
    list.push(eff);
  }

  curse.configureCurse(item, curse.trigger, list);
  return item;
};

window.gm.ItemsLib = function (ItemsLib) {
  window.storage.registerConstructor(Curse);
  window.storage.registerConstructor(CrsTrgDelayed);
  window.storage.registerConstructor(CrsTrgOnEquip);
  window.storage.registerConstructor(CrsEffLock);
  window.storage.registerConstructor(CrsEffEnergyDrain);
  window.storage.registerConstructor(CrsEffStatBonus);
}(window.gm.ItemsLib || {});

"use strict";

var BeeHive = /*#__PURE__*/function (_DngDungeon) {
  _inherits(BeeHive, _DngDungeon);

  var _super25 = _createSuper(BeeHive);

  function BeeHive() {
    var _this24;

    _classCallCheck(this, BeeHive);

    _this24 = _super25.call(this, "BeeHive", function () {
      return "There seem to live alot of giant bees here.";
    }, window.story.state.dng[BeeHive.name]);

    _this24.buildFloors();

    return _this24;
  }

  _createClass(BeeHive, [{
    key: "buildFloors",
    value: function buildFloors() {
      var _floors = [];
      var firstFloor; //:DngFloor;

      var stairUp; //:DngRoom;

      var stairDown; //:DngRoom;

      firstFloor = new DngFloor("1.Floor", function () {
        return "This is the lowest floor of the beehive.";
      });
      var room; //:DngRoom;
      //var rooms:LookupTable = new LookupTable(); 

      var rooms = new Map();
      /* first floor
      *  A1 - A2 - A3 - A4
      *  	    |	  |    |	
      *  B1 - B2   B3   B4
      *  |    |    |    |
      *  E    C2   C3   S
      * */

      rooms.set("Entrance", new DngRoom("Entrance", null, false));
      rooms.set("B1", new DngRoom("B1", null, false));
      rooms.set("A1", new DngRoom("A1", null, true)); //hidden

      rooms.set("B2", new DngRoom("B2", null, false));
      rooms.set("C2", new DngRoom("C2", null, false));
      rooms.set("A2", new DngRoom("A2", null, false));
      rooms.set("B3", new DngRoom("B3", null, false));
      rooms.set("C3", new DngRoom("C3", null, false));
      rooms.set("A3", new DngRoom("A3", null, false));
      rooms.set("B4", new DngRoom("B4", null, false));
      rooms.set("A4", new DngRoom("A4", null, false));
      rooms.set("Stairs", new DngRoom("Stairs", null, false));
      DngDirection.createDirection(DngDirection.DirN, rooms.get("Entrance"), rooms.get("B1"));
      DngDirection.createDirection(DngDirection.DirE, rooms.get("B1"), rooms.get("B2"));
      DngDirection.createDirection(DngDirection.DirN, rooms.get("B2"), rooms.get("A2"));
      DngDirection.createDirection(DngDirection.DirN, rooms.get("C2"), rooms.get("B2"), true);
      DngDirection.createDirection(DngDirection.DirW, rooms.get("A2"), rooms.get("A1"));
      DngDirection.createDirection(DngDirection.DirE, rooms.get("A2"), rooms.get("A3"));
      DngDirection.createDirection(DngDirection.DirE, rooms.get("A3"), rooms.get("A4"));
      DngDirection.createDirection(DngDirection.DirN, rooms.get("B3"), rooms.get("A3"), true);
      DngDirection.createDirection(DngDirection.DirN, rooms.get("C3"), rooms.get("B3"), true);
      DngDirection.createDirection(DngDirection.DirS, rooms.get("A4"), rooms.get("B4"));
      DngDirection.createDirection(DngDirection.DirS, rooms.get("B4"), rooms.get("Stairs"));
      room = rooms.get("Entrance");
      room.isDungeonEntry = room.isDungeonExit = true;
      room = rooms.get("B1"); //room.onEnterFct = encounterTentacle;

      room = rooms.get("B2"); //room.onEnterFct = this.encounterBee2;

      room = rooms.get("A4");
      room.onEnterFct = this.encounterBee2;
      room = rooms.get("A3");
      room.onEnterFct = this.encounterBee2;
      room = rooms.get("B4");
      room.getDirection(DngDirection.DirS).canExitFct = this.hasItem;
      stairUp = rooms.get("Stairs");
      firstFloor.setRooms(Array.from(rooms.values()));

      _floors.push(firstFloor);

      var secondFloor;
      secondFloor = new DngFloor("2.Floor", function () {
        return "This is the second floor of the beehive.";
      });
      rooms = new Map();
      /* second floor
      * 	A1# - A2 - A3# - A4
      *  |	  |	   |     |	
      *  B1 -  B2 - B3 -  B4
      *  |     |    |     |
      *  C1 - C2# - C3# - S
      * */

      rooms.set("C1", new DngRoom("C1", null, false));
      rooms.set("B1", new DngRoom("B1", null, false));
      rooms.set("A1", new DngRoom("A1", null, false));
      rooms.set("C2", new DngRoom("C2", null, false));
      rooms.set("B2", new DngRoom("B2", null, false));
      rooms.set("A2", new DngRoom("A2", null, false));
      rooms.set("C3", new DngRoom("C3", null, false));
      rooms.set("B3", new DngRoom("B3", null, false));
      rooms.set("A3", new DngRoom("A3", null, false));
      rooms.set("StairsDown", new DngRoom("StairsDown", null, false));
      rooms.set("B4", new DngRoom("B4", null, false));
      rooms.set("A4", new DngRoom("A4", null, false));
      DngDirection.createDirection(DngDirection.DirE, rooms.get("C3"), rooms.get("StairsDown"));
      DngDirection.createDirection(DngDirection.DirE, rooms.get("C2"), rooms.get("C3"));
      DngDirection.createDirection(DngDirection.DirE, rooms.get("C1"), rooms.get("C2"));
      DngDirection.createDirection(DngDirection.DirE, rooms.get("A3"), rooms.get("A4"));
      DngDirection.createDirection(DngDirection.DirE, rooms.get("A2"), rooms.get("A3"));
      DngDirection.createDirection(DngDirection.DirE, rooms.get("A1"), rooms.get("A2"));
      DngDirection.createDirection(DngDirection.DirE, rooms.get("B3"), rooms.get("B4"));
      DngDirection.createDirection(DngDirection.DirE, rooms.get("B2"), rooms.get("B3"));
      DngDirection.createDirection(DngDirection.DirE, rooms.get("B1"), rooms.get("B2"));
      DngDirection.createDirection(DngDirection.DirE, rooms.get("C3"), rooms.get("C4"));
      DngDirection.createDirection(DngDirection.DirE, rooms.get("C2"), rooms.get("C3"));
      DngDirection.createDirection(DngDirection.DirE, rooms.get("C1"), rooms.get("C2"));
      DngDirection.createDirection(DngDirection.DirN, rooms.get("B1"), rooms.get("A1"));
      DngDirection.createDirection(DngDirection.DirN, rooms.get("C1"), rooms.get("B1"));
      DngDirection.createDirection(DngDirection.DirN, rooms.get("B2"), rooms.get("A2"));
      DngDirection.createDirection(DngDirection.DirN, rooms.get("C2"), rooms.get("B2"));
      DngDirection.createDirection(DngDirection.DirN, rooms.get("B3"), rooms.get("A3"));
      DngDirection.createDirection(DngDirection.DirN, rooms.get("C3"), rooms.get("B3"));
      DngDirection.createDirection(DngDirection.DirN, rooms.get("B4"), rooms.get("A4"));
      DngDirection.createDirection(DngDirection.DirN, rooms.get("StairsDown"), rooms.get("B4"));
      room = rooms.get("B4");
      stairDown = room = rooms.get("StairsDown");
      room.getDirection(DngDirection.DirW).onExitFct = this.trapDoor; //its a trap

      room = rooms.get("B3");
      room.getDirection(DngDirection.DirW).canExitFct = this.hasItem;
      room.getDirection(DngDirection.DirN).onExitFct = this.trapDoor; //its a trap

      room.getDirection(DngDirection.DirS).onExitFct = this.trapDoor; //its a trap

      room = rooms.get("B2");
      room.getDirection(DngDirection.DirE).onExitFct = this.trapDoor; //its a trap

      room = rooms.get("A2");
      room.getDirection(DngDirection.DirW).onExitFct = this.trapDoor; //its a trap

      room = rooms.get("B1");
      room.getDirection(DngDirection.DirN).onExitFct = this.trapDoor; //its a trap

      secondFloor.setRooms(Array.from(rooms.values()));

      _floors.push(secondFloor); //now create floor links


      DngDirection.createDirection(DngDirection.StairUp, stairUp, stairDown);
      this.setFloors(_floors); //assign floors to dng
    }
  }, {
    key: "exitDungeon",
    value: function exitDungeon() {
      _get(_getPrototypeOf(BeeHive.prototype), "exitDungeon", this).call(this);

      window.story.show("ForestEntrance");
    }
  }, {
    key: "encounterTentacle",
    value: function encounterTentacle(Me) {
      window.story.show('DungeonFoundNothing');
      return true;
    }
  }, {
    key: "encounterBee2",
    value: function encounterBee2(Me) {
      window.story.show('DungeonFoundNothing');
      return true;
    }
  }, {
    key: "hasItem",
    value: function hasItem(Me) {
      /* if (!player.hasItem(ItemType.lookupItem("BeeHony"), 1))
       {
           Me.tooltip = "You dont have a vial of beehoney";
           return false;
       }*/
      return true;
    } //player falls down to 1.floor when entering the room

  }, {
    key: "trapDoor",
    value: function trapDoor(Me) {
      window.story.show('DungeonCrashedThroughFloor');
      return true;
      var floor1 = this.floor.dungeon.allFloors()[0];
      var Room = floor1.getRoom(Me.roomB.name); //room names are the same at same position of floor

      if (Room != null) {
        this.floor.dungeon.teleport(floor1, Room);
        return true;
      }

      return false;
    }
  }]);

  return BeeHive;
}(DngDungeon);

var ShatteredCity = /*#__PURE__*/function (_DngDungeon2) {
  _inherits(ShatteredCity, _DngDungeon2);

  var _super26 = _createSuper(ShatteredCity);

  _createClass(ShatteredCity, [{
    key: "persistentDngDataTemplate",
    value: function persistentDngDataTemplate() {
      var _data = {
        A1Chest: ["TailRibbon", "HorsePotion"],
        A2defeated: 0
      };
      return _data;
    }
  }]);

  function ShatteredCity() {
    var _this25;

    _classCallCheck(this, ShatteredCity);

    _this25 = _super26.call(this, "ShatteredCity", function () {
      return "A once thriving city now lies in ruins.";
    }, window.story.state.dng[ShatteredCity.name]);

    _this25.buildFloors();

    return _this25;
  }

  _createClass(ShatteredCity, [{
    key: "buildFloors",
    value: function buildFloors() {
      var _floors = [];
      var firstFloor; //:DngFloor;

      var stairUp; //:DngRoom;

      var stairDown; //:DngRoom;

      firstFloor = new DngFloor("main street");
      var room; //:DngRoom;

      var rooms = new Map();
      /* main street
      *  A1 - A2 - A3 - A4
      *      |      |    |	
      *  B1 - B2   B3   B4
      *  |    |    |    |
      *  C1   C2   C3   C4
      * B1 = Entrance; B2 Camp; A1 Chest
      * */

      rooms.set("C1", new DngRoom("C1", null, false));
      rooms.set("B1", new DngRoom("B1", null, false));
      rooms.set("A1", new DngRoom("A1", null, false));
      rooms.set("B2", new DngRoom("B2", function () {
        return 'Campfire';
      }, false));
      rooms.set("C2", new DngRoom("C2", null, false));
      rooms.set("A2", new DngRoom("A2", null, false));
      rooms.set("B3", new DngRoom("B3", null, false));
      rooms.set("C3", new DngRoom("C3", null, false));
      rooms.set("A3", new DngRoom("A3", null, false));
      rooms.set("B4", new DngRoom("B4", null, false));
      rooms.set("A4", new DngRoom("A4", null, false));
      rooms.set("C4", new DngRoom("C4", null, false));
      DngDirection.createDirection(DngDirection.DirN, rooms.get("C1"), rooms.get("B1"));
      DngDirection.createDirection(DngDirection.DirE, rooms.get("B1"), rooms.get("B2"));
      DngDirection.createDirection(DngDirection.DirN, rooms.get("B2"), rooms.get("A2"));
      DngDirection.createDirection(DngDirection.DirN, rooms.get("C2"), rooms.get("B2"));
      DngDirection.createDirection(DngDirection.DirW, rooms.get("A2"), rooms.get("A1"));
      DngDirection.createDirection(DngDirection.DirE, rooms.get("A2"), rooms.get("A3"));
      DngDirection.createDirection(DngDirection.DirE, rooms.get("A3"), rooms.get("A4"));
      DngDirection.createDirection(DngDirection.DirN, rooms.get("B3"), rooms.get("A3"));
      DngDirection.createDirection(DngDirection.DirN, rooms.get("C3"), rooms.get("B3"));
      DngDirection.createDirection(DngDirection.DirS, rooms.get("A4"), rooms.get("B4"));
      DngDirection.createDirection(DngDirection.DirS, rooms.get("B4"), rooms.get("C4"));
      room = rooms.get("B1");
      room.isDungeonEntry = room.isDungeonExit = true;
      room = rooms.get("A1");

      var _evt = new DngOperation("Chest");

      _evt.canTrigger = function () {
        return true;
      };

      _evt.onTrigger = function () {
        this.renderEvent = this.renderChestA1;
        this.evtData = {};
        this.renderNext(1);
      };

      room.operations = [_evt]; //adds an loot-chest in this room

      room = rooms.get("B2");
      room.allowSave = true;
      room = rooms.get("C1");
      _evt = new DngOperation("Scavenge");

      _evt.canTrigger = function () {
        return true;
      };

      _evt.onTrigger = function () {
        this.renderEvent = this.renderScavengeA3;
        this.evtData = {};
        this.renderNext(1);
      };

      room.operations = [_evt];
      room = rooms.get("A3");
      room.onEnterFct = this.sneekAround();
      room = rooms.get("A4"); //room.onEnterFct = this.sneekAround();

      room.getDirection(DngDirection.DirS).canExitFct = this.hasItem;
      stairUp = rooms.get("C4");
      firstFloor.setRooms(Array.from(rooms.values()));

      _floors.push(firstFloor);

      this.setFloors(_floors);
    }
  }, {
    key: "exitDungeon",
    value: function exitDungeon() {
      _get(_getPrototypeOf(ShatteredCity.prototype), "exitDungeon", this).call(this);

      window.story.show("ForestEntrance");
    }
  }, {
    key: "renderNext",
    value: function renderNext(id) {
      //helper function because for fucks sake i cant insert " in strings ?! 
      window.gm.dng.evtData.id = id;
      window.story.show("DungeonGenericEvent");
    }
  }, {
    key: "sneekAround",
    value: function sneekAround() {
      var cb = function (that) {
        return function (me) {
          that.renderEvent = that.renderSneekAround;
          that.evtData = {};
          that.renderNext(1);
          return true;
        };
      }(this);

      return cb;
    }
  }, {
    key: "renderSneekAround",
    value: function renderSneekAround(evt) {
      var msg = '';

      var _rnd = _.random(0, 100);

      if (evt.id === 1) {
        window.gm.addTime(30);
        msg = 'There is a gang of barbarians. You could try to sneek around them, talk your way through it or start a surprise attack.</br>';
        msg += window.gm.printLink("sneak around", "window.gm.dng.renderNext(2)");
        msg += window.gm.printPassageLink("approach", "SC_BarbarianMeetup");
        msg += window.gm.printLink("attack", "window.gm.dng._fight(1)");
      } else if (evt.id === 2) {
        if (_rnd > 70) {
          msg += 'Someone spotted you !</br>';
          msg += window.gm.printLink("Next", 'window.gm.dng._fight()');
        } else {
          msg = 'You succesfully bypassed the threat.</br>';
          msg += window.gm.printLink("Leave", "window.gm.dng.resumeRoom()");
        }
      } else if (evt.id === 3) {
        msg += 'Someone spotted you !</br>';
        msg += window.gm.printLink("Next", 'window.gm.dng._fight()');
      }

      return msg;
    }
  }, {
    key: "renderChestA1",
    value: function renderChestA1(evt) {
      //this is some statemachine to render the screen for lootchest
      var msg = '';

      if (evt.id === 1) {
        window.gm.addTime(30);
        msg = 'There is a chest. Do you dare to open it?</br>';
        msg += window.gm.printLink("open chest", "window.gm.dng.renderNext(2)");
        msg += window.gm.printLink("Leave", "window.gm.dng.resumeRoom()");
      } else if (evt.id === 2 && this.data.A1Chest.length > 0) {
        msg = 'You find:' + this.data.A1Chest.join(",") + '</br>';
        msg += window.gm.printLink("Take all", "window.gm.dng.renderNext(3)");
      } else if (evt.id === 3) {
        var _iterator47 = _createForOfIteratorHelper(this.data.A1Chest),
            _step47;

        try {
          for (_iterator47.s(); !(_step47 = _iterator47.n()).done;) {
            el = _step47.value;

            this._addItemToPlayer(el);
          }
        } catch (err) {
          _iterator47.e(err);
        } finally {
          _iterator47.f();
        }

        this.data.A1Chest = [];
        msg = 'You take everything from the chest.</br>';
        msg += window.gm.printLink("Leave", "window.gm.dng.resumeRoom()");
      } else {
        msg = 'There is nothing useful.</br>';
        msg += window.gm.printLink("Leave", "window.gm.dng.resumeRoom()");
      }

      return msg;
    }
  }, {
    key: "renderScavengeA3",
    value: function renderScavengeA3(evt) {
      //
      var msg = '';

      var _rnd = _.random(0, 100);

      if (evt.id === 1) {
        window.gm.addTime(30); //todo would be better to update time after battle

        msg = 'You search the area for something useful...</br>';

        if (_rnd > 30) {
          msg += '... and found some trouble !</br>';
          msg += window.gm.printLink("Next", 'window.gm.dng._fight()');
        } else {
          msg = '...but you didnt find anything.</br>';
          msg += window.gm.printLink("Leave", "window.gm.dng.resumeRoom()");
        }
      }

      return msg;
    }
  }, {
    key: "_fight",
    value: function _fight(evt) {
      if (evt === 1) window.gm.encounters.wolf(window.gm.player.location);else window.gm.encounters.wolf(window.gm.player.location);
    }
  }, {
    key: "_addItemToPlayer",
    value: function _addItemToPlayer(id) {
      var item = new window.storage.constructors[id]();

      if (item.canEquip) {
        window.gm.player.Wardrobe.addItem(item);
      } else {
        window.gm.player.Inv.addItem(item);
      }
    }
  }]);

  return ShatteredCity;
}(DngDungeon);

var ArenaTrialsNo1 = /*#__PURE__*/function (_DngDungeon3) {
  _inherits(ArenaTrialsNo1, _DngDungeon3);

  var _super27 = _createSuper(ArenaTrialsNo1);

  _createClass(ArenaTrialsNo1, [{
    key: "persistentDngDataTemplate",
    value: function persistentDngDataTemplate() {
      var _data = {
        currentRoom: 0,
        maxRoom: 0
      };
      return _data;
    }
  }]);

  function ArenaTrialsNo1() {
    var _this26;

    _classCallCheck(this, ArenaTrialsNo1);

    _this26 = _super27.call(this, "ArenaTrialNo1", ArenaTrialsNo1.desc, window.story.state.dng[ArenaTrialsNo1.name]);
    _this26.data.currentRoom = 1;
    _this26.data.rewards = [{}, {
      id: 'Money',
      amount: 20
    }, {
      id: 'Money',
      amount: 20
    }, {
      id: 'Money',
      amount: 20
    }, {
      id: 'Money',
      amount: 20
    }];
    _this26.data.challenger = ['', 'wolf', 'moleX2', 'wolf', 'wolf'];

    _this26.buildFloors();

    return _this26;
  }

  _createClass(ArenaTrialsNo1, [{
    key: "buildFloors",
    value: function buildFloors() {
      var _floors = [];
      var firstFloor; //:DngFloor;

      var stairUp; //:DngRoom;

      var stairDown; //:DngRoom;

      firstFloor = new DngFloor("1.Floor", function () {
        return "Arena gauntlet #1.";
      });
      var room; //:DngRoom;

      var rooms = new Map();
      /* first floor
      *  
      * E - B1 - B2 - B3 - B4
      *   
      * */
      //Todo should be able to go into arena only once a day/with entryfee

      var foo1 = function () {
        return ArenaTrialsNo1.desc() + '</br>If you survive your first challenger, you get ' + this.data.rewards[this.data.currentRoom].amount + 'x ' + this.data.rewards[this.data.currentRoom].id + '.</br>';
      }.bind(this);

      var foo2 = function () {
        return 'If you survive the second challenge, you get ' + this.data.rewards[this.data.currentRoom].amount + 'x ' + this.data.rewards[this.data.currentRoom].id + '.</br>';
      }.bind(this);

      var foo3 = function () {
        return 'If you survive the third challenge, you get ' + this.data.rewards[this.data.currentRoom].amount + 'x ' + this.data.rewards[this.data.currentRoom].id + '.</br>';
      }.bind(this);

      var foo4 = function () {
        return 'If you survive the last challenge, you get ' + this.data.rewards[this.data.currentRoom].amount + 'x ' + this.data.rewards[this.data.currentRoom].id + '.</br>';
      }.bind(this);

      var foo5 = function foo5() {
        return 'Congratulations. You have passed all the challenges and trully earned your reward.</br>';
      };

      var _evt = new DngOperation("Retreat");

      _evt.canTrigger = function () {
        return true;
      };

      _evt.onTrigger = function () {
        this.renderEvent = this.renderRetreat;
        this.evtData = {};
        this.renderNext(1);
      };

      rooms.set("Entrance", new DngRoom("Entrance", foo1, false));
      rooms.set("B1", new DngRoom("B1", foo2, false));
      rooms.set("B2", new DngRoom("B2", foo3, false));
      rooms.set("B3", new DngRoom("B3", foo4, false));
      rooms.set("B4", new DngRoom("B4", foo5, false));
      rooms.set("Stairs", new DngRoom("Stairs", null, false));
      DngDirection.createDirection(DngDirection.DirE, rooms.get("Entrance"), rooms.get("B1"), true);
      DngDirection.createDirection(DngDirection.DirE, rooms.get("B1"), rooms.get("B2"));
      DngDirection.createDirection(DngDirection.DirE, rooms.get("B2"), rooms.get("B3"));
      DngDirection.createDirection(DngDirection.DirE, rooms.get("B3"), rooms.get("B4"));
      room = rooms.get("Entrance");
      room.isDungeonEntry = room.isDungeonExit = true;
      room.getDirection(DngDirection.DirE).onExitFct = this._fight.bind(this, 1);
      room = rooms.get("B1");
      room.getDirection(DngDirection.DirE).onExitFct = this._fight.bind(this, 2);
      room.operations = [_evt];
      room = rooms.get("B2");
      room.getDirection(DngDirection.DirE).onExitFct = this._fight.bind(this, 3);
      room.operations = [_evt];
      room = rooms.get("B3");
      room.getDirection(DngDirection.DirE).onExitFct = this._fight.bind(this, 4);
      room.operations = [_evt];
      room = rooms.get("B4");
      room.operations = [_evt];
      firstFloor.setRooms(Array.from(rooms.values()));

      _floors.push(firstFloor);

      this.setFloors(_floors);
    }
  }, {
    key: "exitDungeon",
    value: function exitDungeon() {
      _get(_getPrototypeOf(ArenaTrialsNo1.prototype), "exitDungeon", this).call(this);

      window.story.show("PlainsFarmland");
    }
  }, {
    key: "renderNext",
    value: function renderNext(id) {
      window.gm.dng.evtData.id = id;
      window.story.show("DungeonGenericEvent");
    }
  }, {
    key: "renderRetreat",
    value: function renderRetreat(evt) {
      //
      var msg = '';

      if (evt.id === 1) {
        for (var i = 1; i < this.data.rewards.length; i++) {
          if (this.data.currentRoom > i) {
            window.gm.player.Inv.addItem(window.gm.ItemsLib[this.data.rewards[i].id](), this.data.rewards[i].amount);
          }
        }

        msg += 'You decided to not continue the fight.</br>';
        msg += window.gm.printLink("Next", 'window.gm.dng.exitDungeon()');
      }

      return msg;
    }
  }, {
    key: "_fight",
    value: function _fight(evt) {
      this.data.currentRoom = evt;
      this.data.maxRoom = this.data.currentRoom > this.data.maxRoom ? this.data.currentRoom : this.data.maxRoom;
      window.gm.encounters[this.data.challenger[this.data.currentRoom]](window.gm.player.location);

      window.gm.Encounter.onVictory = function () {
        //need to resumeRoom...
        this.data.currentRoom += 1;
        return 'Victory ! </br>Some ' + this.data.rewards[this.data.currentRoom].id + ' was added to the reward-pile.</br>' + window.gm.printLink('Next', 'window.gm.dng.resumeRoom()');
      }.bind(this);

      return true; //return true to indicate a intermittent scene
    }
  }], [{
    key: "desc",
    value: function desc() {
      return "You have to challenge several enemys one by one. The stakes increase with each challenge and after each fight you may decide to drop out with the rewards you gathered so far. But if you loose, you dont get anything, just your own insights.";
    }
  }]);

  return ArenaTrialsNo1;
}(DngDungeon);

window.gm.dngs = function (dngs) {
  dngs.BeeHive = function () {
    return new BeeHive();
  };

  dngs.ShatteredCity = function () {
    return new ShatteredCity();
  };

  dngs.ArenaTrialsNo1 = function () {
    return new ArenaTrialsNo1();
  };

  return dngs;
}(window.gm.dngs || {});

"use strict";
/* combat encounters are defined here */


window.gm = window.gm || {};
window.gm.encounters = window.gm.encounters || {};

window.gm.encounters.mole = function (location) {
  window.gm.Encounter = new CombatSetup();

  window.gm.Encounter.EnemyFunc = function () {
    var x = new window.gm.Mobs.Mole();
    x.scaleLevel(window.gm.player.level);
    return [x];
  };

  window.gm.Encounter.Location = location;
  window.gm.Encounter.scenePic = window.gm.getScenePic(location);

  window.gm.Encounter.onSubmit = function () {
    return 'What will now happen to you?</br>' + window.gm.printPassageLink('Next', 'Mole Submit');
  };

  window.gm.Encounter.initCombat();
};

window.gm.encounters.moleX2 = function (location) {
  window.gm.Encounter = new CombatSetup();

  window.gm.Encounter.EnemyFunc = function () {
    var a = new window.gm.Mobs.Mole();
    var b = new window.gm.Mobs.Mole();
    a.name = a.name + "#1";
    b.name = b.name + "#2";
    return [a, b];
  };

  window.gm.Encounter.Location = location;
  window.gm.Encounter.scenePic = window.gm.getScenePic(location);

  window.gm.Encounter.onSubmit = function () {
    return 'What will now happen to you?</br>' + window.gm.printPassageLink('Next', 'Mole Submit');
  };

  window.gm.Encounter.initCombat();
};

window.gm.encounters.leech = function (location) {
  var amount = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
  window.gm.Encounter = new CombatSetup();

  window.gm.Encounter.EnemyFunc = function () {
    var mobs = [];

    for (var i = amount; i > 0; i -= 1) {
      var x = new window.gm.Mobs.Leech();
      x.scaleLevel(window.gm.player.level);
      mobs.push(x);
    }

    return mobs;
  };

  window.gm.Encounter.Location = location;
  window.gm.Encounter.scenePic = window.gm.getScenePic(location);
  window.gm.Encounter.initCombat();
};

window.gm.encounters.mechanicguy = function (location) {
  window.gm.Encounter = new CombatSetup();
  window.gm.Encounter.EnemyFunc = window.gm.Mobs.Mechanic;
  window.gm.Encounter.Location = location;
  window.gm.Encounter.scenePic = window.gm.getScenePic(location);
  window.gm.Encounter.initCombat();
};

window.gm.encounters.huntress = function (location) {
  window.gm.Encounter = new CombatSetup();
  window.gm.Encounter.EnemyFunc = window.gm.Mobs.Huntress;
  window.gm.Encounter.Location = location;
  window.gm.Encounter.scenePic = window.gm.getScenePic(location);
  window.gm.Encounter.initCombat();
};

window.gm.encounters.wolf = function (location) {
  window.gm.Encounter = new CombatSetup();

  window.gm.Encounter.EnemyFunc = function () {
    var x = new window.gm.Mobs.Wolf();

    if (_.random(1, 100) > 50) {
      x.Outfit.addItem(VulvaHuman.factory('wolf'));
    } else {
      x.Outfit.addItem(PenisHuman.factory('wolf'));
    }

    x.scaleLevel(window.gm.player.level);
    x.Stats.increment("health", 9999);
    x.Stats.increment("energy", 9999);
    return [x];
  };

  window.gm.Encounter.Location = location;
  window.gm.Encounter.scenePic = window.gm.getScenePic(location);

  window.gm.Encounter.onSubmit = window.gm.Encounter.onDefeat = function () {
    return 'You cannot fight anymore and surrender to the beast.</br>' + window.gm.printPassageLink('Next', 'WolfSubmit');
  };

  window.gm.Encounter.onVictory = function () {
    return 'Intimitated, the wolf rolls on its back, whimpering submissively and exposing its throat.</br>' + this.fetchLoot() + '</br>' + window.gm.printPassageLink('Next', 'WolfVictory');
  };

  window.gm.Encounter.sceneDone = false; //attach flag to combatsetup-Instance;

  window.gm.Encounter.onMoveSelect = function () {
    var s = window.story.state;
    var result = {
      OK: false,
      msg: ''
    };

    if (window.gm.Encounter.sceneDone === false && s.combat.turnCount === 3) {
      result.OK = window.gm.Encounter.sceneDone = true;
      result.msg = 'Wolf growls at you.</br>' + window.gm.printPassageLink('Next', 'WolffightIntermezzo');
    }

    return result;
  };

  window.gm.Encounter.initCombat();
};

window.gm.encounters.dryad = function (location) {
  window.gm.Encounter = new CombatSetup();

  window.gm.Encounter.EnemyFunc = function () {
    var x = new window.gm.Mobs.Dryad();
    x.scaleLevel(window.gm.player.level);
    x.Stats.increment("health", 9999);
    x.Stats.increment("energy", 9999);
    return [x];
  };

  window.gm.Encounter.Location = location;
  window.gm.Encounter.scenePic = window.gm.getScenePic(location);
  window.gm.Encounter.initCombat();
};

window.gm.encounters.Carlia = function (location) {
  window.gm.Encounter = new CombatSetup();

  window.gm.Encounter.EnemyFunc = function () {
    var x = window.story.state.Carlia;
    x.Stats.increment("health", 9999);
    x.Stats.increment("energy", 9999);
    return [x];
  };

  window.gm.Encounter.Location = location;
  window.gm.Encounter.scenePic = window.gm.getScenePic(location);

  window.gm.Encounter.onSubmit = window.gm.Encounter.onDefeat = function () {
    return 'You surrender to the monster-girl.</br>' + window.gm.printPassageLink('Next', 'CarliaSubmit');
  };

  window.gm.Encounter.onVictory = function () {
    return 'Carlia doesnt want to fight anymore.</br>' + window.gm.printPassageLink('Next', 'CarliaVictory');
  };

  window.gm.Encounter.sceneDone = 0; //attach flag to combatsetup-Instance;

  window.gm.Encounter.onMoveSelect = function () {
    var s = window.story.state;
    var result = {
      OK: false,
      msg: ''
    };

    if (window.gm.Encounter.sceneDone === 0 && s.combat.turnCount >= 4) {
      result.OK = window.gm.Encounter.sceneDone = 100;
      window.gm.Encounter.endCombat();
      result.msg = window.gm.printPassageLink('Next', 'CarliaMakeDeal');
    }

    return result;
  };

  window.gm.Encounter.initCombat();
};

window.gm.encounters.Trent = function (location) {
  window.gm.Encounter = new CombatSetup();

  window.gm.Encounter.EnemyFunc = function () {
    var x = window.story.state.Trent; //no leveadaption? x.scaleLevel(window.gm.player.level);

    x.Stats.increment("health", 9999);
    return [x];
  };

  window.gm.Encounter.Location = location;
  window.gm.Encounter.scenePic = window.gm.getScenePic(location);

  window.gm.Encounter.onSubmit = window.gm.Encounter.onDefeat = function () {
    return 'You cannot fight anymore and surrender to the beast-man.</br>' + window.gm.printPassageLink('Next', 'TrentSubmit');
  };

  window.gm.Encounter.onVictory = function () {
    return 'It was barely an even fight but you showed this horsy its place.</br>' + window.gm.printPassageLink('Next', 'TrentVictory');
  };

  window.gm.Encounter.initCombat();
};

window.gm.encounters.Ruff = function (location) {
  window.gm.Encounter = new CombatSetup();

  window.gm.Encounter.EnemyFunc = function () {
    var x = window.story.state.Ruff; //no leveadaption? x.scaleLevel(window.gm.player.level);

    x.Stats.increment("health", 9999);
    return [x];
  };

  window.gm.Encounter.Location = location;
  window.gm.Encounter.scenePic = window.gm.getScenePic(location);

  window.gm.Encounter.onSubmit = window.gm.Encounter.onDefeat = function () {
    return 'You cannot fight anymore and surrender to the beast-man.</br>' + window.gm.printPassageLink('Next', 'TrentSubmit');
  };

  window.gm.Encounter.onVictory = function () {
    return 'It was barely an even fight but you showed this horsy its place.</br>' + window.gm.printPassageLink('Next', 'TrentVictory');
  };

  window.gm.Encounter.initCombat();
};

"use strict";
/* bundles some utility operations*/


window.gm.getSaveVersion = function () {
  return [0, 1, 0];
}; // reimplement to setup the game


var _origInitGame = window.gm.initGame;

window.gm.initGame = function (forceReset) {
  var NGP = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;

  _origInitGame(forceReset, NGP);

  var s = window.story.state;
  s._gm.timeRL = s._gm.timeVR = s._gm.time;
  s._gm.dayRL = s._gm.dayVR = s._gm.day; //TODO set debug to 0 for distribution !

  s._gm.debug = 1, s._gm.dbgShowCombatRoll = true, s._gm.dbgShowQuestInfo = true;
  s._gm.dbgShowMoreInfo = true;

  if (!s.vars || forceReset) {
    var _s$vars;

    // storage of variables that doesnt fit player
    s.vars = (_s$vars = {
      debugInv: new Inventory(),
      inVR: false,
      playerPartyVR: [],
      playerPartyRL: [],
      //flags for global states
      qDogSit: 0,
      // see park
      qUnlockCampus: 0,
      //see passage into city
      qUnlockPark: 0,
      qUnlockMall: 0,
      qUnlockBeach: 0,
      qUnlockDowntown: 0,
      qUnlockNorthlake: 0,
      qUnlockRedlight: 0
    }, _defineProperty(_s$vars, "qUnlockBeach", 0), _defineProperty(_s$vars, "crowBarLeft", 1), _defineProperty(_s$vars, "wolfKnowledge", 0), _defineProperty(_s$vars, "wolfSubmit", 0), _defineProperty(_s$vars, "wolfVictory", 0), _s$vars);
    s.vars.debugInv._parent = window.gm.util.refToParent(null);
    s.vars.debugInv.addItem(new Money(), 200);
  }

  if (!window.gm.achievements || forceReset) {
    //outside of window.story !
    window.gm.achievements = {
      moleKillerGoldMedal: false //add your flags here

    };
    window.storage.loadAchivementsFromBrowser();
  }

  if (!s.mom || forceReset) {
    s.mom = {
      location: "Kitchen",
      coffeeStore: 5,
      foodStore: 3,
      foodMaxStore: 4
    };
  }

  if (!s.Cyril || forceReset) {
    //
    var ch = new Character();
    ch.name = ch.id = "Cyril";
    ch.faction = "Player"; //add some basic inventory

    ch.Outfit.addItem(new BaseHumanoid());
    ch.Outfit.addItem(new SkinHuman());
    ch.Outfit.addItem(HandsHuman.factory('human'));
    ch.Outfit.addItem(new FaceHuman());
    ch.Wardrobe.addItem(new Jeans());
    ch.Wardrobe.addItem(new TankShirt());
    ch.Outfit.addItem(new Jeans());
    ch.Outfit.addItem(new TankShirt());
    ch.Stats.increment('strength', 3);
    s.Cyril = ch;
  }

  if (!s.Carlia || forceReset) {
    //the cat/dog-woman
    var _ch = new Carlia();

    s.Carlia = _ch;
  }

  if (!s.Ruff || forceReset) {
    //Ruff the wolf
    var _ch2 = new Ruff();

    s.Ruff = _ch2;
  }

  if (!s.Trent || forceReset) {
    //the horse-bully from the bridge
    var _ch3 = new Trent();

    _ch3.name = _ch3.id = "Trent";
    s.Trent = _ch3;
  }

  if (!s.PlayerVR || forceReset) {
    var _ch4 = new Character();

    _ch4.id = "PlayerVR";
    _ch4.name = "Zeph";
    _ch4.faction = "Player"; //body

    _ch4.Outfit.addItem(new BaseHumanoid());

    _ch4.Outfit.addItem(new SkinHuman());

    _ch4.Outfit.addItem(new FaceHuman());

    _ch4.Outfit.addItem(HandsHuman.factory('human'));

    _ch4.Outfit.addItem(PenisHuman.factory('human'));

    _ch4.Skills.addItem(new SkillInspect());

    _ch4.Skills.addItem(new SkillUltraKill());

    s.PlayerVR = _ch4;
  }

  if (!s.PlayerRL || forceReset) {
    var _ch5 = new Character();

    _ch5.id = "PlayerRL";
    _ch5.name = "Andrew";
    _ch5.faction = "Player";

    _ch5.Effects.addItem(skCooking.name, new skCooking()); //add some basic inventory


    _ch5.Inv.addItem(new Money(), 20);

    _ch5.Inv.addItem(new LighterDad());

    _ch5.Inv.addItem(new FlashBang(), 2);

    _ch5.Inv.addItem(new CanOfCoffee(), 2);

    _ch5.Wardrobe.addItem(new Jeans());

    _ch5.Wardrobe.addItem(new Briefs());

    _ch5.Wardrobe.addItem(new Sneakers());

    _ch5.Wardrobe.addItem(new TankShirt());

    _ch5.Wardrobe.addItem(new Pullover());

    _ch5.Outfit.addItem(new BaseHumanoid());

    _ch5.Outfit.addItem(new FaceHuman());

    _ch5.Outfit.addItem(HandsHuman.factory('human'));

    _ch5.Outfit.addItem(new SkinHuman());

    _ch5.Outfit.addItem(PenisHuman.factory('human'));

    _ch5.Wardrobe.addItem(new Briefs());

    _ch5.Outfit.addItem(new Jeans());

    _ch5.Outfit.addItem(new Sneakers());

    _ch5.Outfit.addItem(new Pullover()); //special skills


    _ch5.Effects.addItem(effNotTired.name, new effNotTired()); //depending on sleep Tired will be set to NotTired or Tired
    //ch.Skills.addItem(SkillCallHelp.setup('Mole'));


    s.PlayerRL = _ch5;
  }
  /*let dngs = [BeeHive,ShatteredCity]; //add your dngs here !
  for(el of dngs) {
    if (!s.dng[el.name]||forceReset) { 
      s.dng[el.name] = el.persistentDngDataTemplate();
    }
  } */


  window.gm.switchPlayer("PlayerRL"); //take over flags for newgameplus

  if (NGP) {
    window.story.state.vars.crowBarLeft = NGP.crowBarLeft;
  }

  NGP = null; //release memory
}; // lookup function for sidebar icon


window.gm.getSidebarPic = function () {
  //todo display doll ??
  if (window.story.state.vars.inVR) {
    return "assets/icons/icon_swordspade.svg";
  }

  return 'assets/icons/icon_cityskyline.svg';
}; // lookup function for scene background


window.gm.getScenePic = function (id) {
  if (id === 'Garden' || id === 'Park') return 'assets/bg_park.png';
  if (id === 'Bedroom' || id === 'Your Bedroom') return 'assets/bg_bedroom.png';
  return 'assets/bg_park.png'; //todo placehodler
};

window.gm.enterVR = function () {
  //todo update effects in VR but stop RL effects
  var s = window.story.state;
  if (s.vars.inVR) return;
  s.vars.playerPartyRL = s._gm.playerParty;
  s._gm.playerParty = s.vars.playerPartyVR;
  window.gm.switchPlayer("PlayerVR");
  s.vars.inVR = true; //time in VR is paused when in RL

  s._gm.timeRL = s._gm.time, s._gm.dayRL = s._gm.day;
  s._gm.time = s._gm.timeVR, s._gm.day = s._gm.dayVR;
  window.gm.addTime(0);
  window.gm.respawn({
    keepInventory: true
  });
};

window.gm.leaveVR = function () {
  //todo update effects in VR but stop RL effects
  var s = window.story.state;
  if (!s.vars.inVR) return;
  s.vars.playerPartyVR = s._gm.playerParty;
  s._gm.playerParty = s.vars.playerPartyRL;
  window.gm.switchPlayer("PlayerRL");
  s.vars.inVR = false; //while in VR time in RL is paused but advances 1h on leave??

  s._gm.timeVR = s._gm.time, s._gm.dayVR = s._gm.day;
  s._gm.time = s._gm.timeRL, s._gm.day = s._gm.dayRL;
  window.gm.addTime(60); //todo copy fetish-stats back to RLPlayer ?
}; //call this after onVictory/onFlee-scene to continue in dng or other location
//this function is also used to restore after loading save !


window.gm.postVictory = function () {
  var reloadDng = window.gm.dng === null;

  if (window.story.state.dng.id !== "") {
    if (reloadDng) window.gm.dng = window.gm.dngs[window.story.state.dng.id]();
    var floor = window.gm.dng.getFloor(window.story.state.dng.floorId);
    var room = floor.getRoom(window.story.state.dng.roomId);
    if (reloadDng) window.gm.dng.enterDungeon(); //first call enterdungeon to setup everything !

    window.gm.dng.teleport(floor, room);
  } else {
    window.story.show(window.gm.player.location); //history disabled ! window.story.history[window.story.history.length - 1], true);   
  }
}; //call this after your onDefeat/onSubmit-scene to respawn at respawn-point; cleansup dng-variables


window.gm.postDefeat = function () {
  window.story.state.dng.id = "";
  window.gm.dng = null;
  window.gm.respawn();
}; //after passing out: heal player and remove inventory {keepInventory=false,location=''}


window.gm.respawn = function () {
  var conf = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {
    keepInventory: false
  };
  window.gm.player.Stats.increment("energy", 9999);
  window.gm.player.Stats.increment("will", 9999);
  window.gm.player.Stats.increment("health", 9999);

  if (!conf.keepInventory) {
    //remove inentory and outfit that is not questitem, cursed or permanent
    for (var i = window.gm.player.Outfit.list.length - 1; i >= 0; i -= 1) {
      var _el3 = window.gm.player.Outfit.list[i];
      if (_el3.item && _el3.item.lossOnRespawn) window.gm.player.Outfit.removeItem(_el3.id, true);
    }

    for (var _i3 = window.gm.player.Wardrobe.list.length - 1; _i3 >= 0; _i3 -= 1) {
      var _el4 = window.gm.player.Wardrobe.list[0];
      if (_el4.item.lossOnRespawn) window.gm.player.Wardrobe.removeItem(_el4.id, _el4.count);
    }

    for (var _i4 = window.gm.player.Inv.list.length - 1; _i4 >= 0; _i4 -= 1) {
      var _el5 = window.gm.player.Inv.list[_i4];
      if (_el5.item.lossOnRespawn) window.gm.player.Inv.removeItem(_el5.id, _el5.count);
    }
  }

  if (window.gm.quests.getMilestoneState("qDiedAgain").id === 2) {
    window.story.show('YouDiedOnce');
  } else if ([100, 200, 300].includes(window.gm.quests.getMilestoneState("qBondageKink").id)) {
    window.story.show('YouDiedWithCursedGear');
  } else {
    var robes = new window.storage.constructors['RobesZealot']();
    window.gm.player.Wardrobe.addItem(robes);
    window.gm.player.Outfit.addItem(robes);
    robes = new window.storage.constructors['Briefs']();
    window.gm.player.Wardrobe.addItem(robes);
    window.gm.player.Outfit.addItem(robes);
    var staff = new window.storage.constructors['StaffWodden']();
    window.gm.player.Inv.addItem(staff);
    window.gm.player.Outfit.addItem(staff);
    window.story.show('ForestRespawnPodExit'); //todo what location
  }
}; //sets current player location and advances time
//call this in passage header


window.gm.moveHere = function () {
  var time = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 10;

  if (window.gm.player.location !== window.passage.name) {
    window.gm.player.location = window.passage.name;
    window.gm.addTime(time);
  }
};

window.gm.rollExploreCity = function () {
  var s = window.story.state;
  var places = [];

  var r = _.random(0, 100); //todo:depending of your actual location you have a chance to find connected locations or end up in a known one


  if (window.gm.player.location == 'Park') places = ['Mall', 'Beach', 'Downtown'];
  if (window.gm.player.location == 'Mall') places = ['Park', 'Beach', 'Downtown'];
  if (window.gm.player.location == 'Beach') places = ['Park', 'Mall'];

  if (window.gm.player.location == 'Downtown') {
    places.push('Pawn shop');
  }

  if (places.length == 0) places = [window.gm.player.location]; //fallback if unspeced location

  r = _.random(1, places.length) - 1; //chances are equal

  window.gm.addTime(20);
  window.story.show(places[r]);
};

window.gm.giveCyrilFood = function () {
  if (window.gm.player.Inv.countItem('SimpleFood') > 0) {
    var res = window.gm.player.Inv.use('SimpleFood', window.story.state.Cyril);
    window.gm.printOutput(res.msg);
  } else {
    window.gm.printOutput("you have no food to spare");
  }
};
/*
* ReactTest = a box is moing repeatedly left-right-left and the user has to click on it to 
* stop it inside a hit area (success if center of moving box is inside one hit-area)
*
* call this setup-function once and use the returned start & click function for game input
* bar is the id of the moving element-node; example:
* <div style='height:1em; width: 100%;'><div id='bar' style="position:relative; width:5%; height:100%; background-color:green;"></div></div>
* 
* you might provide callbacks for start & stop, stop will get area-index on success or -1 on fail
* speed is ms for one movement of the box from left to right 
* area is a list of non-overlapping hit-areas like [{a:5,b:10, color:'orange'}]; 
*/


window.gm.startReactTest = function (bar, speed, stopCB, startCB, areas) {
  /**
   * starts the game
   */
  function start() {
    //todo instead left-right also up-down should be possible
    data.stop();
    data.value = 0, data.run = true;
    data.bargraph.style.left = data.value + '%'; //dont start in between; speed would be slowed down to maintain transition time

    var width = window.getComputedStyle(data.bargraph).getPropertyValue('width');
    var total = window.getComputedStyle(data.bargraph.parentNode).getPropertyValue('width'); //calculate barsize relative to total width (necessary if windowsize changed in between )

    data.barsize = 100 * parseFloat(width.split('px')) / parseFloat(total.split('px'));
    data.bargraph.style.transition = "left " + data.speed + "ms linear"; //configure transition for animation

    if (data.startCB) data.startCB(); //called before transition-start!

    data.bargraph.ontransitionend(); //start transition
  }
  /**
   * this stops the game and returns the index of hit area; use click() instead !
   */


  function stop() {
    var computedStyle = window.getComputedStyle(data.bargraph);
    var left = computedStyle.getPropertyValue('left');
    data.bargraph.style.left = left;
    data.bargraph.style.transition = null; // disable transition AFTER fetching computed value !

    var total = window.getComputedStyle(data.bargraph.parentNode).getPropertyValue('width');
    left = parseFloat(left.split('px')), total = parseFloat(total.split('px'));
    left = 100 * left / total + data.barsize / 2;
    var res = -1; //detect if area was hit or not

    for (var i = data.areas.length - 1; i >= 0; i--) {
      if (data.areas[i].a <= left && left <= data.areas[i].b) res = i;
    }

    data.run = false;
    return res;
  }
  /**
   * this can be bound to eventhandler for user input detection to trigger stop and will call stop-CB
   */


  function click() {
    var run = data.run;
    var res = data.stop();
    if (run && data.stopCB) data.stopCB(res);
  }

  var data = {
    //internal state of game
    bargraph: document.getElementById(bar),
    run: false,
    //game started?
    value: 0,
    //actual setpoint in%
    barsize: 5,
    //width of hitbox relative to total width in %
    areas: areas,
    //list of areas to hit in %;
    speed: speed,
    //transition time in ms
    stopCB: stopCB,
    //callback after user trigger 
    startCB: startCB,
    //callback after start
    start: start,
    //ref to start-function
    stop: stop,
    //ref to stop-func
    click: click //ref to click-func

  };
  var gradient = '';

  var _iterator48 = _createForOfIteratorHelper(data.areas),
      _step48;

  try {
    for (_iterator48.s(); !(_step48 = _iterator48.n()).done;) {
      el = _step48.value;
      //todo need to sort from left to right
      gradient += '#80808000 0 ' + el.a + '%, ' + el.color + ' ' + el.a + '%,' + el.color + ' ' + el.b + '%,#80808000 ' + el.b + '%,';
    }
  } catch (err) {
    _iterator48.e(err);
  } finally {
    _iterator48.f();
  }

  data.bargraph.parentNode.style.backgroundImage = 'linear-gradient(to right,' + gradient.slice(0, -1) + ')';
  /**
   * instead of using timers rely on css-transition handling and events
   */

  data.bargraph.ontransitionend = function () {
    data.value = data.value === 0 ? 100 - data.barsize : 0;
    data.bargraph.style.left = data.value + '%'; //this should trigger css-transition
  };

  return data;
};
/**
 * by pressing left/right alternatively you move a box along a bar until you reach its end or run out of time
 * the bar will slowly slide back to origin without proper input (you have to press quickly to finish); each time you pass an area, this movement increases 
 * 
 * @param {*} bar : the element to move
 * @param {*} speed : recovery rate in ms 
 * @param {*} stopCB 
 * @param {*} startCB 
 * @param {*} areas 
 */


window.gm.startReactTest2 = function (bar, speed, stopCB, startCB, areas) {
  //todo timeout starts after first click

  /**
   * starts the game
   */
  function start() {
    //todo instead left-right also up-down should be possible
    data.stop();
    data.run = true;
    data.bargraph.style.left = data.value + '%'; //dont start in between; speed would be slowed down to maintain transition time

    var width = window.getComputedStyle(data.bargraph).getPropertyValue('width');
    var total = window.getComputedStyle(data.bargraph.parentNode).getPropertyValue('width'); //calculate barsize relative to total width (necessary if windowsize changed in between )

    data.barsize = 100 * parseFloat(width.split('px')) / parseFloat(total.split('px')); //data.bargraph.style.transition = "left "+data.speed+"ms linear"; //configure transition for animation

    if (data.startCB) data.startCB(); //called before transition-start!
    //data.bargraph.ontransitionend(); //start transition

    data.value = 20, data.speed2 = 1;
    tick();
    data.intervalID = window.setInterval(tick, data.speed);
  }
  /**
   * this stops the game and returns the index of hit area; use click() instead !
   */


  function stop() {
    if (data.intervalID) window.clearInterval(data.intervalID);
    var computedStyle = window.getComputedStyle(data.bargraph);
    var left = computedStyle.getPropertyValue('left');
    data.bargraph.style.left = left;
    data.bargraph.style.transition = null; // disable transition AFTER fetching computed value !

    data.run = false;
  }

  function tick() {
    data.value = Math.max(0, data.value - data.speed2);
    data.bargraph.style.left = data.value + '%';
  }
  /**
   * this can be bound to eventhandler for user input detection to trigger stop and will call stop-CB
   */


  function click(evt) {
    if (!data.run) return;
    var prevKey = data.lastKey;

    if (prevKey !== evt.key && (evt.key === 'a' || evt.key === 'ArrowLeft' || evt.key === 'd' || evt.key === 'ArrowRight')) {
      data.lastKey = evt.key, data.value += 5;
      data.bargraph.style.left = data.value + '%';
    }

    var left = data.value + data.barsize / 2;
    var res = -1; //detect if area was hit or not

    for (var i = data.areas.length - 1; i >= 0; i--) {
      if (data.areas[i].a <= left && left <= data.areas[i].b) {
        res = i;
        data.speed2 = (i + 1) * 2;
      }
    }

    if (res === data.areas.length - 1) {
      stop();
      if (data.stopCB) data.stopCB(res);
    }
  }

  var data = {
    //internal state of game
    bargraph: document.getElementById(bar),
    run: false,
    //game started?
    value: 0,
    //actual setpoint in%
    barsize: 5,
    //width of hitbox relative to total width in %
    areas: areas,
    //list of areas to hit in %;
    speed: speed,
    //transition time in ms
    speed2: 1,
    //recovery speed in % of barwidth
    stopCB: stopCB,
    //callback after user trigger 
    startCB: startCB,
    //callback after start
    start: start,
    //ref to start-function
    stop: stop,
    //ref to stop-func
    click: click,
    //ref to click-func
    intervalID: null,
    lastKey: ''
  };
  var gradient = '';

  var _iterator49 = _createForOfIteratorHelper(data.areas),
      _step49;

  try {
    for (_iterator49.s(); !(_step49 = _iterator49.n()).done;) {
      el = _step49.value;
      //todo need to sort from left to right
      gradient += '#80808000 0 ' + el.a + '%, ' + el.color + ' ' + el.a + '%,' + el.color + ' ' + el.b + '%,#80808000 ' + el.b + '%,';
    }
  } catch (err) {
    _iterator49.e(err);
  } finally {
    _iterator49.f();
  }

  data.bargraph.parentNode.style.backgroundImage = 'linear-gradient(to right,' + gradient.slice(0, -1) + ')';
  /**
   * instead of using timers rely on css-transition handling and events
   */

  /*data.bargraph.ontransitionend = () => {
    data.value = (data.value===0)?100-data.barsize:0;
    data.bargraph.style.left=data.value+'%'; //this should trigger css-transition
  };*/

  return data;
}; //print list of actions for actual day and hour


window.gm.printSchedule = function () {
  var elmt = '';
  var s = window.story.state;
  var now = window.gm.getTimeStruct();
  var jobs = Object.values(window.gm.jobs);

  for (var i = 0; i < jobs.length; i++) {
    var id = jobs[i].id;

    if (jobs[i].isHidden() === true) {//NOP;
    } else if (jobs[i].isDisabled() === true) {
      elmt += "<div>".concat(jobs[i].disabledReason(), "</div></br>");
    } else if (jobs[i].DoW.includes(now.DoW) && s._gm.time >= jobs[i].startTimeMin && s._gm.time < jobs[i].startTimeMax) {
      if (window.gm.player.energy().value >= jobs[i].reqEnergy) {
        elmt += "<a0 id='".concat(id, "' onclick='(function($event){window.story.show(\"").concat(id, "\");})(this);'>").concat(jobs[i].name, " </a>");
        elmt += "</br><div>".concat(jobs[i].descr, " It might require ").concat(jobs[i].reqTime, " minutes of your time and around ").concat(jobs[i].reqEnergy, " energy.</div></br>");
      } else {
        elmt += "<div>You are to tired to do ".concat(jobs[i].name, ".</div></br>");
      }
    } else {
      var days = "";

      for (var k = 0; k < jobs[i].DoW.length; k++) {
        days += window.gm.DoWs[jobs[i].DoW[k] - 1] + ",";
      }

      elmt += "<div>".concat(jobs[i].name, " is only available between ").concat((jobs[i].startTimeMin / 100).toFixed(0), " and ").concat((jobs[i].startTimeMax / 100).toFixed(0), " at ").concat(days, ". </div></br>");
    }
  }

  return elmt;
}; //prints a list of quest


window.gm.printQuestList = function () {
  var elmt = '<hr><form><ul style=\"list-style-type: none; padding-inline-start: 0px;\" ><legend>In progress</legend>';
  var s = window.story.state; //elmt +="<li><label><input type=\"checkbox\" name=\"y\" value=\"x\" readonly disabled>always: keep the fridge filled</label></li>";

  for (var i = 0; i < s.quests.activeQuests.length; i++) {
    var qId = s.quests.activeQuests[i].id;
    var flags = s.quests.activeQuests[i].flags;
    var msId = s.quests.activeQuestsMS[i].id;
    var quest = window.gm.questDef[qId];
    var mile = quest.getMileById(msId);

    if (!quest.HiddenCB() || window.story.state._gm.dbgShowQuestInfo) {
      elmt += "<li style=\"padding-bottom: 0.5em;\"><input type=\"checkbox\" name=\"y\" value=\"x\" readonly disabled><label>" + quest.name + (window.story.state._gm.dbgShowQuestInfo ? " " + msId + " 0x" + flags.toString(16) : "") + " : " + (mile.HiddenCB() === true ? "???" : mile.descr) + "</label></li>"; //checked="checked"
    }
  }

  elmt += "</ul></form></br>";
  elmt += '<hr><form><ul style=\"list-style-type: none\" ><legend>Completed</legend>';

  for (var _i5 = 0; _i5 < s.quests.finishedQuests.length; _i5++) {
    var _qId = s.quests.finishedQuests[_i5].id;
    var _flags = s.quests.activeQuests[_i5].flags;
    var _msId = s.quests.finishedQuestsMS[_i5].id;
    var _quest = window.gm.questDef[_qId];

    var _mile = _quest.getMileById(_msId);

    if (!_quest.HiddenCB() || window.story.state._gm.dbgShowQuestInfo) {
      elmt += "<li><input type=\"checkbox\" name=\"y\" value=\"x\" readonly disabled checked=\"checked\"><label>" + _quest.name + (window.story.state._gm.dbgShowQuestInfo ? " " + _msId + " 0x" + _flags.toString(16) : "") + " : " + _mile.descr + "</label></li>";
    }
  }

  elmt += "</ul></form></br>";
  return elmt;
}; //prints a description of the chars-body


window.gm.printBodyDescription = function (whom) {
  var onlyvisible = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
  var msg = "";
  var conv = window.gm.util.descFixer(whom);
  var wornIds = whom.Outfit.getAllIds(); //todo this returns wearables & bodyparts

  var base = [],
      head = [],
      torso = [],
      arms = [],
      legs = [],
      groin = [],
      other = [],
      breast = [],
      ignore = []; //sort the order: place Breast & Nipple-Piercing together 

  var fbase = ['bBase', 'bSkin'],
      fhead = ['bHeadHair', 'bFace', 'bEars', 'bEyes', 'bMouth', 'bTongue', 'Head', 'Mouth', 'Neck'],
      ftorso = ['bTorso', 'bTailBase', 'bWings', 'Breast', 'Stomach', 'Hips'],
      farms = ['bArms', 'bHands', 'Arms', 'Wrists', 'RHand', 'LHand'],
      flegs = ['bLegs', 'bFeet', 'Feet', 'Thighs'],
      fbreast = ['bBreast', 'pNipples'],
      fgroin = ['bVulva', 'bPenis', 'pClit', 'bPubicHair', 'bHips', 'bAnus', 'Vulva', 'Clit', 'Anus', 'Penis', 'Balls'],
      fignore = [],
      fcovered = [];

  if (onlyvisible) {
    // filter by visibility 
    var covered = [];

    var _iterator50 = _createForOfIteratorHelper(wornIds),
        _step50;

    try {
      for (_iterator50.s(); !(_step50 = _iterator50.n()).done;) {
        el = _step50.value;
        //notice that an item is only pushed once even if has multiple slots
        var item = whom.Outfit.getItem(el);
        covered = covered.concat(item.slotCover);
      }
    } catch (err) {
      _iterator50.e(err);
    } finally {
      _iterator50.f();
    }

    var _iterator51 = _createForOfIteratorHelper(covered),
        _step51;

    try {
      for (_iterator51.s(); !(_step51 = _iterator51.n()).done;) {
        el = _step51.value;
        if (!fcovered.includes(el)) fcovered.push(el);
      }
    } catch (err) {
      _iterator51.e(err);
    } finally {
      _iterator51.f();
    }
  }

  var _iterator52 = _createForOfIteratorHelper(wornIds),
      _step52;

  try {
    for (_iterator52.s(); !(_step52 = _iterator52.n()).done;) {
      el = _step52.value;

      //notice that an item is only pushed once even if has multiple slots
      var _item2 = whom.Outfit.getItem(el);

      if (_item2.slotUse.every(function (name) {
        return fcovered.includes(name);
      })) ignore.push(_item2); //ignore those that are overed completely
      else if (_item2.slotUse.some(function (name) {
          return fignore.includes(name);
        })) ignore.push(_item2);else if (_item2.slotUse.some(function (name) {
          return fbase.includes(name);
        })) base.push(_item2);else if (_item2.slotUse.some(function (name) {
          return fhead.includes(name);
        })) head.push(_item2);else if (_item2.slotUse.some(function (name) {
          return ftorso.includes(name);
        })) torso.push(_item2);else if (_item2.slotUse.some(function (name) {
          return fbreast.includes(name);
        })) breast.push(_item2);else if (_item2.slotUse.some(function (name) {
          return farms.includes(name);
        })) arms.push(_item2);else if (_item2.slotUse.some(function (name) {
          return flegs.includes(name);
        })) legs.push(_item2);else if (_item2.slotUse.some(function (name) {
          return fgroin.includes(name);
        })) groin.push(_item2);else other.push(_item2);
    } //null is used to mark linebreaks

  } catch (err) {
    _iterator52.e(err);
  } finally {
    _iterator52.f();
  }

  var all = base.concat([null]).concat(head).concat([null]).concat(torso).concat([null]).concat(arms).concat([null]);
  all = all.concat(legs).concat([null]).concat(groin).concat([null]).concat(breast).concat([null]).concat(other);

  var _iterator53 = _createForOfIteratorHelper(all),
      _step53;

  try {
    for (_iterator53.s(); !(_step53 = _iterator53.n()).done;) {
      el = _step53.value;
      msg += el !== null ? el.descLong(conv) + ' ' : '</br>';
    }
  } catch (err) {
    _iterator53.e(err);
  } finally {
    _iterator53.f();
  }

  var lewd = whom.Outfit.getLewdness();
  msg += '</br>Total lewdness sluty:' + lewd.slut + ' bondage:' + lewd.bondage + ' sm:' + lewd.sm;
  return msg + "</br>";
}; // returns singular pronoun for the char depending on gender


window.gm.util.estimatePronoun = function (whom) {
  var isplayer = whom.name === window.gm.player.name;
  var vulva = whom.Outfit.getItemForSlot(window.gm.OutfitSlotLib.bVulva);
  var penis = whom.Outfit.getItemForSlot(window.gm.OutfitSlotLib.bPenis); //todo what if whom is a gang of imps?

  if (isplayer) {
    return 'i';
  } else if (vulva && penis) {
    return 'shi';
  } else if (vulva) {
    return 'she';
  } else if (penis) {
    return 'he';
  }

  return 'it';
}; //returns a function that accept a text and fixes the word-phrases: let fixer = window.gm.util.descFixer(this.actor);msg=fixer('[I] [like] this shit.');


window.gm.util.descFixer = function (whom) {
  var pron = window.gm.util.estimatePronoun(whom);
  return function (pron) {
    return function (text) {
      var repl = [],
          br = 0,
          aft,
          bef,
          found; //search brackets like $[dff]$ $[[sdff]]$ dont find [ ] or \[ \] ; 
      //using no regex because couldnt get it get working:(!\[|[^\[])([\[]{1})(!\]|!\[|[^\[\]])+[\]]{1}([^\]]|!\])

      for (var i = text.length - 1, max = text.length - 1; i >= 0; i -= 1) {
        //in backward direction !
        bef = i > 0 ? text[i - 1] : '';
        aft = i < max ? text[i + 1] : '';

        if (text[i] === ']' && aft === '$') {
          //opening braket
          br += 1;

          if (br > 1) {
            //there was already opening but no closing bracket !
            //no bracket in bracket allowed; ignore previous bracket
            br = 1;
          }

          found = {
            end: i
          };
        }

        if (text[i] === '[' && bef === '$') {
          //opening braket
          br -= 1;

          if (br < 0) {
            //there was already closing but no opening bracket !
            //no bracket in bracket allowed; ignore previous bracket
            br = 0;
          } else {
            found.start = i;
            found.text = text.slice(found.start + 1, found.end); //text within brackets

            found.start -= 1, found.end += 1; // inlude $ $

            repl.push(found);
          }
        }
      }

      for (var _i6 = 0, _repl = repl; _i6 < _repl.length; _i6++) {
        el = _repl[_i6];
        //replace bracket+bracketcontent,
        el.new = window.gm.util.lookupWord(el.text, pron);

        var _bef = text.substring(0, el.start),
            _aft = text.substr(el.end + 1);

        text = _bef + el.new + _aft;
      } // $[I]$ $[have]$ some rough [hair] that needs a lot combing. He has some rough...
      // c. She buys those pants. 
      // That hat [I] [wear] is ugly. That hat she wears is ugly.  
      // A dense fur covers $[my]$ body. A dense fur covers your body.  


      return text;
    };
  }(pron);
}; // add irregular words here


window.gm.util.wordlist = function buildWordList(list) {
  //defines for each word a list to match to pronoun to replace with
  //have = [I have, you have, he/she has, we have, you have, they have ]
  list['i'] = {
    def: 'I',
    i: 'I',
    you: 'you',
    he: 'he',
    she: 'she',
    shi: 'shi',
    it: 'it'
  };
  list['you'] = list['i']; //if you use you instead I as it would be required ...

  list['me'] = {
    def: 'me',
    i: 'me',
    you: 'you',
    he: 'him',
    she: 'her',
    shi: 'hir',
    it: 'it'
  };
  list['my'] = {
    def: 'my',
    i: 'my',
    you: 'your',
    he: 'his',
    she: 'her',
    shi: 'hir',
    it: 'its'
  };
  list['have'] = {
    def: 'have',
    he: 'has',
    she: 'has',
    shi: 'has',
    it: 'has'
  };
  list['am'] = {
    def: 'is',
    i: 'am',
    he: 'is',
    she: 'is',
    shi: 'is',
    it: 'is'
  };
  list['them'] = {
    def: 'them',
    i: 'me',
    he: 'him',
    she: 'her',
    shi: 'hir',
    it: 'it'
  }; //I snap at them -> He snaps at me.

  return list;
}(window.gm.util.wordlist || {}); //looks up a word in the wordlist and retourns the version fitting pronoun


window.gm.util.lookupWord = function (word, pron) {
  var output = word;
  var x = word.toLowerCase();
  var repl = window.gm.util.wordlist[x];

  if (repl) {
    output = repl[pron] ? repl[pron] : repl.def;

    if (word[0] === word[0].toUpperCase()) {
      //check if first letter needs to be large; 'I' is always large
      output = output[0].toUpperCase() + output.substr(1);
    }
  } else {
    if (pron === 'he' || pron === 'she' || pron === 'shi') {
      output += 's'; //wear -> wears
    }
  }

  return output;
};

"use strict";

var LighterDad = /*#__PURE__*/function (_Item2) {
  _inherits(LighterDad, _Item2);

  var _super28 = _createSuper(LighterDad);

  function LighterDad() {
    _classCallCheck(this, LighterDad);

    return _super28.call(this, 'LighterDad');
  }

  _createClass(LighterDad, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("LighterDad", this);
    }
  }, {
    key: "desc",
    get: function get() {
      return 'I got this lighter from my real dad.';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(LighterDad, value.data);
    }
  }]);

  return LighterDad;
}(Item);

;

var Money = /*#__PURE__*/function (_Item3) {
  _inherits(Money, _Item3);

  var _super29 = _createSuper(Money);

  function Money() {
    _classCallCheck(this, Money);

    return _super29.call(this, 'Money');
  }

  _createClass(Money, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("Money", this);
    }
  }, {
    key: "desc",
    get: function get() {
      return 'shiny,clinky coin.';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(Money, value.data);
    }
  }]);

  return Money;
}(Item);

;

var LaptopPS = /*#__PURE__*/function (_Item4) {
  _inherits(LaptopPS, _Item4);

  var _super30 = _createSuper(LaptopPS);

  function LaptopPS() {
    _classCallCheck(this, LaptopPS);

    return _super30.call(this, 'LaptopPS');
  }

  _createClass(LaptopPS, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("LaptopPS", this);
    }
  }, {
    key: "desc",
    get: function get() {
      return 'Power converter for laptop.';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(LaptopPS, value.data);
    }
  }]);

  return LaptopPS;
}(Item);

;

var Dildo_small = /*#__PURE__*/function (_Item5) {
  _inherits(Dildo_small, _Item5);

  var _super31 = _createSuper(Dildo_small);

  function Dildo_small() {
    _classCallCheck(this, Dildo_small);

    return _super31.call(this, 'Dildo_small');
  }

  _createClass(Dildo_small, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("Dildo_small", this);
    }
  }, {
    key: "desc",
    get: function get() {
      return 'A dildo, smaller than an average dong, made from rubbery plastic.';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(Dildo_small, value.data);
    }
  }]);

  return Dildo_small;
}(Item);

var Lube = /*#__PURE__*/function (_Item6) {
  _inherits(Lube, _Item6);

  var _super32 = _createSuper(Lube);

  function Lube() {
    _classCallCheck(this, Lube);

    return _super32.call(this, 'Lube');
  }

  _createClass(Lube, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("Lube", this);
    }
  }, {
    key: "desc",
    get: function get() {
      return 'Slippery lubricant for personal use.';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(Lube, value.data);
    }
  }]);

  return Lube;
}(Item);

var Battery = /*#__PURE__*/function (_Item7) {
  _inherits(Battery, _Item7);

  var _super33 = _createSuper(Battery);

  function Battery() {
    _classCallCheck(this, Battery);

    return _super33.call(this, 'Battery');
  }

  _createClass(Battery, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("Battery", this);
    }
  }, {
    key: "desc",
    get: function get() {
      return 'Provides electricity for devices.';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(Battery, value.data);
    }
  }]);

  return Battery;
}(Item);

var GameVoucher = /*#__PURE__*/function (_Item8) {
  _inherits(GameVoucher, _Item8);

  var _super34 = _createSuper(GameVoucher);

  function GameVoucher() {
    var _this27;

    _classCallCheck(this, GameVoucher);

    _this27 = _super34.call(this, 'GameVoucher');
    _this27.lossOnRespawn = false;
    return _this27;
  }

  _createClass(GameVoucher, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("GameVoucher", this);
    }
  }, {
    key: "changeId",
    value: function changeId(id) {
      this.id = id;
    }
  }, {
    key: "desc",
    get: function get() {
      return GameVoucher.lookupId(this.id).desc;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(GameVoucher, value.data);
    }
  }, {
    key: "lookupId",
    value: function lookupId(id) {
      var info = {
        desc: ''
      };

      switch (id) {
        case "BronzeCoupon":
          info.desc = "bronze-voucher for ingame-shop";
          break;

        case "SilverCoupon":
          info.desc = "silver-voucher for ingame-shop";
          break;

        default:
      }

      return info;
    }
  }]);

  return GameVoucher;
}(Item);

;

var Ingredient = /*#__PURE__*/function (_Item9) {
  _inherits(Ingredient, _Item9);

  var _super35 = _createSuper(Ingredient);

  function Ingredient() {
    var _this28;

    _classCallCheck(this, Ingredient);

    _this28 = _super35.call(this, 'Ingredient');
    _this28.lossOnRespawn = true;
    return _this28;
  }

  _createClass(Ingredient, [{
    key: "changeId",
    value: function changeId(id) {
      this.id = id;
    } //instead of creating full class for every useless junk I use this and just add variable that will be restored after load

  }, {
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("Ingredient", this);
    }
  }, {
    key: "desc",
    get: function get() {
      return Ingredient.lookupId(this.id).desc;
    }
  }], [{
    key: "lookupId",
    value: function lookupId(id) {
      var info = {
        desc: ''
      };

      switch (id) {
        case "ApocaFlower":
          info.desc = "yellow bluish flower";
          break;

        case "PurpleBerry":
          info.desc = "purple berrys grown in the forest";
          break;

        case "BloatedMushroom":
          info.desc = "mushrooms from a cave";
          break;

        case "SquishedLeech":
          info.desc = "I dont wanna carry that around";
          break;

        case "WolfTooth":
          info.desc = "Some canine from a canine";
          break;

        default:
      }

      return info;
    }
  }, {
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(Ingredient, value.data);
    }
  }]);

  return Ingredient;
}(Item);

var SoulGem = /*#__PURE__*/function (_Item10) {
  _inherits(SoulGem, _Item10);

  var _super36 = _createSuper(SoulGem);

  function SoulGem() {
    var _this29;

    _classCallCheck(this, SoulGem);

    _this29 = _super36.call(this, 'SoulGem');
    _this29.lossOnRespawn = true;
    return _this29;
  }

  _createClass(SoulGem, [{
    key: "changeId",
    value: function changeId(id) {
      this.id = id;
    } //instead of creating full class for every useless junk I use this and just add variable that will be restored after load

  }, {
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("SoulGem", this);
    }
  }, {
    key: "desc",
    get: function get() {
      return SoulGem.lookupId(this.id).desc;
    }
  }], [{
    key: "lookupId",
    value: function lookupId(id) {
      var info = {
        desc: ''
      };

      switch (id) {
        case "TinySoulGem":
          info.desc = "tiny soulgem";
          break;

        case "SmallSoulGem":
          info.desc = "small soulgem";
          break;

        case "SmallBlackSoulGem":
          info.desc = "small corrupted soulgem";
          break;

        case "TinyBlackSoulGem":
          info.desc = "tiny corrupted soulgem";
          break;

        default:
      }

      return info;
    }
  }, {
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(Ingredient, value.data);
    }
  }]);

  return SoulGem;
}(Item);

var KeyRestraint = /*#__PURE__*/function (_Item11) {
  _inherits(KeyRestraint, _Item11);

  var _super37 = _createSuper(KeyRestraint);

  function KeyRestraint() {
    var _this30;

    _classCallCheck(this, KeyRestraint);

    _this30 = _super37.call(this, 'KeyRestraint');
    _this30.lossOnRespawn = true;
    return _this30;
  }

  _createClass(KeyRestraint, [{
    key: "changeId",
    value: function changeId(id) {
      this.id = id;
    }
  }, {
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("KeyRestraint", this);
    }
  }, {
    key: "desc",
    get: function get() {
      return KeyRestraint.lookupId(this.id).desc;
    }
  }], [{
    key: "lookupId",
    value: function lookupId(id) {
      var info = {
        desc: ''
      };

      switch (id) {
        case "KeyRestraintA":
          info.desc = "Key for type A restraints";
          break;

        case "KeyRestraintB":
          info.desc = "Key for type B restraints";
          break;

        default:
      }

      return info;
    }
  }, {
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(KeyRestraint, value.data);
    }
  }]);

  return KeyRestraint;
}(Item);

var FlashBang = /*#__PURE__*/function (_Item12) {
  _inherits(FlashBang, _Item12);

  var _super38 = _createSuper(FlashBang);

  function FlashBang() {
    _classCallCheck(this, FlashBang);

    return _super38.call(this, 'FlashBang');
  }

  _createClass(FlashBang, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("FlashBang", this);
    }
  }, {
    key: "targetFilter",
    //context is the skillUseItem calling this
    value: function targetFilter(targets, context) {
      if (!window.gm.combat.inCombat()) return []; //to use skill-targetfilter we need an instance of skill bound to the caster  - todo this is ugly
      //let _sk = this.parent.parent.Skills.getItem('UseItem');//._parent=window.gm.util.refToParent(this.parent.parent.Skills); 

      return context.targetMultiple(context.targetFilterFighting(context.targetFilterEnemy(targets)));
    }
  }, {
    key: "usable",
    value: function usable(context) {
      var on = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
      //can only be used while in combat and target is enemy
      var result = {
        OK: false,
        msg: 'cannot use'
      };

      if (!window.gm.combat.inCombat()) {
        result.msg = 'can only be used in combat';
      } else {
        result.msg = 'use', result.OK = true;
      }

      return result;
    }
  }, {
    key: "use",
    value: function use(context) {
      var on = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
      var result = {
        OK: false,
        msg: ''
      };

      if (context instanceof Inventory) {
        context.removeItem('FlashBang');

        if (context.parent instanceof Character) {
          if (on === null) on = context.parent;

          if (on.length && on.length > 0) {//on can be several targets (array)
          } else {
            on = [on]; //..if not an array change it
          }

          result.msg = context.parent.name + ' uses ' + this.name + '.';

          var _iterator54 = _createForOfIteratorHelper(on),
              _step54;

          try {
            for (_iterator54.s(); !(_step54 = _iterator54.n()).done;) {
              var _targ = _step54.value;

              _targ.addEffect(effStunned.id, new effStunned()); //todo should 'FlashBang:Stunned' merge with other stunned? 


              result.msg += _targ.name + ' got stunned. ';
            }
          } catch (err) {
            _iterator54.e(err);
          } finally {
            _iterator54.f();
          }

          result.OK = true;
          return result;
        }
      } else throw new Error('context is invalid');
    }
  }, {
    key: "desc",
    get: function get() {
      return 'Stun someone with a blinding light.';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(FlashBang, value.data);
    }
  }]);

  return FlashBang;
}(Item);

;

var CanOfCoffee = /*#__PURE__*/function (_Item13) {
  _inherits(CanOfCoffee, _Item13);

  var _super39 = _createSuper(CanOfCoffee);

  function CanOfCoffee() {
    _classCallCheck(this, CanOfCoffee);

    return _super39.call(this, 'CanOfCoffee');
  }

  _createClass(CanOfCoffee, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("CanOfCoffee", this);
    }
  }, {
    key: "usable",
    value: function usable(context) {
      return {
        OK: true,
        msg: 'drink'
      };
    }
  }, {
    key: "use",
    value: function use(context) {
      if (context instanceof Inventory) {
        context.removeItem('CanOfCoffee');

        if (context.parent instanceof Character) {
          context.parent.addEffect('CanOfCoffee:Energized', new effEnergized()); //apply over-time-effect instead directly changing stat

          return {
            OK: true,
            msg: context.parent.name + ' gulped down a can of iced coffee.'
          };
        }
      } else throw new Error('context is invalid');
    }
  }, {
    key: "desc",
    get: function get() {
      return 'Cold coffee in a can. Tasty? Not really!';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(CanOfCoffee, value.data);
    }
  }]);

  return CanOfCoffee;
}(Item);

;

var SimpleFood = /*#__PURE__*/function (_Item14) {
  _inherits(SimpleFood, _Item14);

  var _super40 = _createSuper(SimpleFood);

  function SimpleFood() {
    _classCallCheck(this, SimpleFood);

    return _super40.call(this, 'SimpleFood');
  }

  _createClass(SimpleFood, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("SimpleFood", this);
    }
  }, {
    key: "usable",
    value: function usable(context) {
      var on = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
      return {
        OK: true,
        msg: 'eat'
      };
    }
  }, {
    key: "use",
    value: function use(context) {
      var on = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
      var _gaveAway = false;

      if (context instanceof Inventory) {
        if (on === null) on = context.parent;else _gaveAway = true;
        context.removeItem('Simple food');

        if (on instanceof Character) {
          on.addEffect('Simple food:Energized', new effEnergized());
          return {
            OK: true,
            msg: on.name + ' ate some plain foods.'
          };
        }
      } else throw new Error('context is invalid');
    }
  }, {
    key: "desc",
    get: function get() {
      return 'Something to eat.';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(SimpleFood, value.data);
    }
  }]);

  return SimpleFood;
}(Item);

var HealthPotion = /*#__PURE__*/function (_Item15) {
  _inherits(HealthPotion, _Item15);

  var _super41 = _createSuper(HealthPotion);

  _createClass(HealthPotion, null, [{
    key: "lookupId",
    value: function lookupId(id) {
      var info = {
        desc: '',
        amount: 10
      };

      switch (id) {
        case "HealthPotion":
          info.amount = 45, info.desc = "health potion";
          break;

        case "HealthPotion(small)":
          info.amount = 20, info.desc = "small health potion";
          break;

        default:
      }

      return info;
    }
  }]);

  function HealthPotion() {
    var _this31;

    _classCallCheck(this, HealthPotion);

    _this31 = _super41.call(this, 'HealthPotion');

    _this31.changeId('HealthPotion');

    return _this31;
  }

  _createClass(HealthPotion, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("HealthPotion", this);
    }
  }, {
    key: "usable",
    value: function usable(context) {
      var on = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
      return {
        OK: true,
        msg: 'drink'
      };
    }
  }, {
    key: "use",
    value: function use(context) {
      var on = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
      var _gaveAway = false;

      if (context instanceof Inventory) {
        if (on === null) on = context.parent;else _gaveAway = true;
        context.removeItem(this.id);

        if (on instanceof Character) {
          on.Stats.increment("health", this.amount);
          return {
            OK: true,
            msg: on.name + ' drank a potion.'
          };
        }
      } else throw new Error('context is invalid');
    }
  }, {
    key: "changeId",
    value: function changeId(id) {
      this.id = id;
      this.amount = HealthPotion.lookupId(id).amount;
    } //instead of creating full class for every useless junk I use this and just add variable that will be restored after load

  }, {
    key: "desc",
    get: function get() {
      return HealthPotion.lookupId(this.id).desc;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(HealthPotion, value.data);
    }
  }]);

  return HealthPotion;
}(Item);

var HorsePotion = /*#__PURE__*/function (_Item16) {
  _inherits(HorsePotion, _Item16);

  var _super42 = _createSuper(HorsePotion);

  _createClass(HorsePotion, null, [{
    key: "lookupId",
    value: function lookupId(id) {
      var info = {
        desc: '',
        amount: 10
      };

      switch (id) {
        case "HorsePotion":
          info.amount = 10, info.desc = "horse power potion";
          break;

        default:
      }

      return info;
    }
  }]);

  function HorsePotion() {
    var _this32;

    _classCallCheck(this, HorsePotion);

    _this32 = _super42.call(this, 'HorsePotion');

    _this32.changeId('HorsePotion');

    return _this32;
  }

  _createClass(HorsePotion, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("HorsePotion", this);
    }
  }, {
    key: "usable",
    value: function usable(context) {
      var on = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
      return {
        OK: true,
        msg: 'drink'
      };
    }
  }, {
    key: "use",
    value: function use(context) {
      var on = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
      var _gaveAway = false;

      if (context instanceof Inventory) {
        if (on === null) on = context.parent;else _gaveAway = true;
        context.removeItem(this.id);

        if (on instanceof Character) {
          if (on instanceof Character) {
            on.addEffect('HorsePower', new effHorsePower());
            on.Stats.increment("health", 100);
          }

          return {
            OK: true,
            msg: on.name + ' drank a potion.'
          };
        }
      } else throw new Error('context is invalid');
    }
  }, {
    key: "changeId",
    value: function changeId(id) {
      this.id = id;
      this.amount = HorsePotion.lookupId(id).amount;
    }
  }, {
    key: "desc",
    get: function get() {
      return HorsePotion.lookupId(this.id).desc;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(HorsePotion, value.data);
    }
  }]);

  return HorsePotion;
}(Item);

window.gm.ItemsLib = function (ItemsLib) {
  window.storage.registerConstructor(LighterDad);
  window.storage.registerConstructor(GameVoucher);
  window.storage.registerConstructor(Money);
  window.storage.registerConstructor(LaptopPS);
  window.storage.registerConstructor(Battery);
  window.storage.registerConstructor(Dildo_small);
  window.storage.registerConstructor(Lube);
  window.storage.registerConstructor(CanOfCoffee);
  window.storage.registerConstructor(KeyRestraint);
  window.storage.registerConstructor(SimpleFood);
  window.storage.registerConstructor(HealthPotion);
  window.storage.registerConstructor(HorsePotion);
  window.storage.registerConstructor(Ingredient); //only need constructor for base-ingredient

  window.storage.registerConstructor(FlashBang);
  window.storage.registerConstructor(SoulGem); //Some of those items are generics that need some setup; so I create a template-library here

  ItemsLib['Money'] = function () {
    return new Money();
  };

  ItemsLib['LighterDad'] = function () {
    return new LighterDad();
  };

  ItemsLib['LaptopPS'] = function () {
    return new LaptopPS();
  };

  ItemsLib['Battery'] = function () {
    return new Battery();
  };

  ItemsLib['Dildo_small'] = function () {
    return new Dildo_small();
  }; // consumables


  ItemsLib['Lube'] = function () {
    return new Lube();
  };

  ItemsLib['CanOfCoffee'] = function () {
    return new CanOfCoffee();
  };

  ItemsLib['SimpleFood'] = function () {
    return new SimpleFood();
  };

  ItemsLib['FlashBang'] = function () {
    return new FlashBang();
  };

  ItemsLib['HealthPotion'] = function () {
    var x = new HealthPotion();
    x.changeId("HealthPotion");
    return x;
  };

  ItemsLib['HealthPotion(small)'] = function () {
    var x = new HealthPotion();
    x.changeId("HealthPotion(small)");
    return x;
  };

  ItemsLib['BloatedMushroom'] = function () {
    var x = new Ingredient();
    x.changeId("BloatedMushroom");
    return x;
  };

  ItemsLib['PurpleBerry'] = function () {
    var x = new Ingredient();
    x.changeId("PurpleBerry");
    return x;
  };

  ItemsLib['WolfTooth'] = function () {
    var x = new Ingredient();
    x.changeId("WolfTooth");
    return x;
  };

  ItemsLib['ApocaFlower'] = function () {
    var x = new Ingredient();
    x.changeId("ApocaFlower");
    return x;
  };

  ItemsLib['TinySoulGem'] = function () {
    var x = new SoulGem();
    x.changeId("TinySoulGem");
    return x;
  };

  ItemsLib['KeyRestraintA'] = function () {
    var x = new KeyRestraint();
    x.changeId("KeyRestraintA");
    return x;
  };

  ItemsLib['KeyRestraintB'] = function () {
    var x = new KeyRestraint();
    x.changeId("KeyRestraintB");
    return x;
  };

  ItemsLib['GameVoucherBronze'] = function () {
    var x = new GameVoucher();
    x.changeId("BronzeCoupon");
    return x;
  };

  return ItemsLib;
}(window.gm.ItemsLib || {});

"use strict";
/*
- imp
- nymph
- kobold
- lizard-man
- naga
- stag-boy/-Stud
- cougar-girl/-mistress
- grizzly
- werwolf
- vile vine
- lush orchid
- slug
- Giant-Snake
- Giant wasp
- spider/tarantula
- raptor
- gryphon
- felkin
- drider
- dragon/wyvern

 */
////////////////////////////////////////////////////////
// normal foes


var Mole = /*#__PURE__*/function (_Mob) {
  _inherits(Mole, _Mob);

  var _super43 = _createSuper(Mole);

  function Mole() {
    var _this33;

    _classCallCheck(this, Mole);

    _this33 = _super43.call(this);
    _this33.name = _this33.id = 'Mole';
    _this33.pic = 'assets/mole.jpg';

    _this33.Stats.increment('healthMax', -1 * (_this33.health().max - 20));

    return _this33;
  }

  return Mole;
}(Mob);

var Wolf = /*#__PURE__*/function (_Mob2) {
  _inherits(Wolf, _Mob2);

  var _super44 = _createSuper(Wolf);

  function Wolf() {
    var _this34;

    _classCallCheck(this, Wolf);

    _this34 = _super44.call(this);
    _this34.name = _this34.id = 'Wolf';
    _this34.pic = 'assets/bw_wolf1.png';
    _this34.level_min = 3;
    _this34.loot = [{
      id: 'WolfTooth',
      amount: 1
    }];

    _this34.Outfit.addItem(new BaseQuadruped());

    _this34.Outfit.addItem(SkinFur.factory('wolf', 'black'));

    _this34.Outfit.addItem(HandsPaw.factory('wolf'));

    _this34.Outfit.addItem(TailWolf.factory('wolf'));

    _this34.Outfit.addItem(FaceWolf.factory('wolf'));

    _this34.Stats.increment('armblunt', 5);

    _this34.fconv = null; //lazy init because descfixer depends on gm.player

    return _this34;
  }

  _createClass(Wolf, [{
    key: "calcCombatMove",
    value: function calcCombatMove(enemys, friends) {
      var result = {
        OK: true,
        msg: ''
      }; //this._canAct();

      var rnd = _.random(1, 100); //if(!this.fconv) this.fconv = window.gm.util.descFixer(this);


      result.action = result.target = null;

      if (window.story.state.combat.turnCount % 2 === 0) {
        rnd = _.random(0, enemys.length - 1);
        result.action = "Bite";
        result.target = [enemys[rnd]];
        result.msg = this.name + " snaps at " + result.target[0].name + ".</br>" + result.msg;
        return result;
      }

      return _get(_getPrototypeOf(Wolf.prototype), "calcCombatMove", this).call(this, enemys, friends);
    }
  }]);

  return Wolf;
}(Mob);

var Leech = /*#__PURE__*/function (_Mob3) {
  _inherits(Leech, _Mob3);

  var _super45 = _createSuper(Leech);

  function Leech() {
    var _this35;

    _classCallCheck(this, Leech);

    _this35 = _super45.call(this);
    _this35.name = _this35.id = 'Leech';
    _this35.pic = 'assets/Leech.png'; //todo

    _this35.level_min = 1;

    _this35.Outfit.addItem(new BaseWorm());

    _this35.Skills.addItem(new SkillLeechHealth());

    _this35.tmp = {
      grappleCoolDown: 1
    };
    _this35.fconv = null; //lazy init because descfixer depends on gm.player

    return _this35;
  }

  _createClass(Leech, [{
    key: "calcCombatMove",
    value: function calcCombatMove(enemys, friends) {
      var result = {
        OK: true,
        msg: ''
      };

      var rnd = _.random(1, 100);

      if (!this.fconv) this.fconv = window.gm.util.descFixer(this);
      result.action = result.target = null;

      if (this.Effects.countItem(effGrappling.name) > 0) {
        this.tmp.grappleCoolDown = 2;
        result.msg = this.fconv(this.name + " sucks blood.</br>") + result.msg;
        return result;
      } else if (this.tmp.grappleCoolDown <= 0) {
        this.tmp.grappleCoolDown = 2;
        rnd = _.random(0, enemys.length - 1);
        result.action = "Leech";
        result.target = [enemys[rnd]];
        result.msg = this.fconv("$[I]$ $[snap]$ at " + result.target[0].name + ".</br>") + result.msg;
        return result;
      } else {
        this.tmp.grappleCoolDown -= 1;
      }

      return _get(_getPrototypeOf(Leech.prototype), "calcCombatMove", this).call(this, enemys, friends);
    }
  }]);

  return Leech;
}(Mob);

var Huntress = /*#__PURE__*/function (_Mob4) {
  _inherits(Huntress, _Mob4);

  var _super46 = _createSuper(Huntress);

  function Huntress() {
    var _this36;

    _classCallCheck(this, Huntress);

    _this36 = _super46.call(this);
    _this36.name = _this36.id = 'Huntress';
    _this36.pic = 'assets/icons/icon_question.svg';

    _this36.Outfit.addItem(new BaseHumanoid());

    _this36.Outfit.addItem(new SkinHuman());

    _this36.Outfit.addItem(HandsHuman.factory('cat'));

    _this36.Outfit.addItem(BreastHuman.factory('cat'));

    _this36.Outfit.addItem(FaceWolf.factory('cat'));

    _this36.Outfit.addItem(VulvaHuman.factory('cat'));

    _this36.Outfit.addItem(new BikiniBottomLeather());

    _this36.levelUp(3);

    _this36.autoLeveling();

    return _this36;
  }

  _createClass(Huntress, [{
    key: "calcCombatMove",
    value: function calcCombatMove(enemys, friends) {
      var result = {
        OK: true,
        msg: ''
      };

      var rnd = _.random(1, 100);

      result.action = result.target = null; //todo shoot arrow, pounce, throw net

      return _get(_getPrototypeOf(Huntress.prototype), "calcCombatMove", this).call(this, enemys, friends);
    }
  }]);

  return Huntress;
}(Mob);

var Dryad = /*#__PURE__*/function (_Mob5) {
  _inherits(Dryad, _Mob5);

  var _super47 = _createSuper(Dryad);

  function Dryad() {
    var _this37;

    _classCallCheck(this, Dryad);

    _this37 = _super47.call(this);
    _this37.name = _this37.id = 'Dryad';
    _this37.pic = 'assets/icons/icon_question.svg';

    _this37.Outfit.addItem(new BaseHumanoid());

    _this37.Outfit.addItem(new SkinHuman());

    _this37.Outfit.addItem(HandsHuman.factory('human'));

    _this37.Outfit.addItem(BreastHuman.factory('human'));

    _this37.Outfit.addItem(new FaceHuman());

    _this37.Outfit.addItem(VulvaHuman.factory('human'));

    _this37.Outfit.addItem(new BikiniBottomLeather());

    _this37.Skills.addItem(SkillCallHelp.setup('Vine'));

    _this37.levelUp(3);

    _this37.autoLeveling();

    _this37.tmp = {
      vines: 0
    };
    return _this37;
  }

  _createClass(Dryad, [{
    key: "calcCombatMove",
    value: function calcCombatMove(enemys, friends) {
      var result = {
        OK: true,
        msg: ''
      };

      var rnd = _.random(1, 100);

      if (!this.fconv) this.fconv = window.gm.util.descFixer(this);
      result.action = result.target = null;

      if (this.tmp.vines < 1) {
        this.tmp.vines += 1;
        result.msg = this.fconv(this.name + " starts to summon something...</br>") + result.msg;
        result.action = 'CallHelp';
        result.target = [this];
        return result;
      } //todo poison


      return _get(_getPrototypeOf(Dryad.prototype), "calcCombatMove", this).call(this, enemys, friends);
    }
  }]);

  return Dryad;
}(Mob);

var Vine = /*#__PURE__*/function (_Mob6) {
  _inherits(Vine, _Mob6);

  var _super48 = _createSuper(Vine);

  function Vine() {
    var _this38;

    _classCallCheck(this, Vine);

    _this38 = _super48.call(this);
    _this38.name = _this38.id = 'Vine';
    _this38.pic = 'assets/icons/icon_question.svg';

    _this38.Outfit.addItem(new BaseWorm());

    _this38.Skills.addItem(new SkillGrapple());

    _this38.levelUp(1);

    _this38.autoLeveling();

    _this38.tmp = {
      grappleCoolDown: 1
    };
    return _this38;
  }

  _createClass(Vine, [{
    key: "calcCombatMove",
    value: function calcCombatMove(enemys, friends) {
      var result = {
        OK: true,
        msg: ''
      };

      var rnd = _.random(1, 100);

      if (!this.fconv) this.fconv = window.gm.util.descFixer(this);
      result.action = result.target = null;

      if (this.Effects.countItem(effGrappling.name) > 0) {
        this.tmp.grappleCoolDown = 5;
        result.msg = this.fconv(this.name + " entwines its prey.</br>") + result.msg;
        return result;
      } else if (this.tmp.grappleCoolDown <= 0) {
        this.tmp.grappleCoolDown = 2;
        rnd = _.random(0, enemys.length - 1);
        result.action = "Grapple";
        result.target = [enemys[rnd]];
        result.msg = this.fconv("$[I]$ $[snap]$ at " + result.target[0].name + ".</br>") + result.msg;
        return result;
      } else {
        this.tmp.grappleCoolDown -= 1;
      }

      return _get(_getPrototypeOf(Vine.prototype), "calcCombatMove", this).call(this, enemys, friends);
    }
  }]);

  return Vine;
}(Mob);

var Mechanic = /*#__PURE__*/function (_Mob7) {
  _inherits(Mechanic, _Mob7);

  var _super49 = _createSuper(Mechanic);

  function Mechanic() {
    var _this39;

    _classCallCheck(this, Mechanic);

    _this39 = _super49.call(this);
    _this39.name = _this39.id = 'Mechanic-Guy';
    _this39.pic = 'assets/mechanic.jpg';
    return _this39;
  }

  _createClass(Mechanic, [{
    key: "calcCombatMove",
    value: function calcCombatMove(enemys, friends) {
      var result = {
        OK: true,
        msg: ''
      };

      var rnd = _.random(1, 100);

      result.action = result.target = null;

      if (window.story.state.combat.turnCount < 3) {
        rnd = _.random(0, enemys.length - 1);
        result.action = "Stun";
        result.target = [enemys[rnd]];
        result.msg = this.name + " trys to hit your head whith his wrench.</br>" + result.msg;
        return result;
      }

      return _get(_getPrototypeOf(Mechanic.prototype), "calcCombatMove", this).call(this, enemys, friends);
    }
  }]);

  return Mechanic;
}(Mob); /////////////////////////////////////////////////////////
// special NPC


var Carlia = /*#__PURE__*/function (_Mob8) {
  _inherits(Carlia, _Mob8);

  var _super50 = _createSuper(Carlia);

  function Carlia() {
    var _this40;

    _classCallCheck(this, Carlia);

    _this40 = _super50.call(this);
    _this40.name = _this40.id = 'Carlia';
    _this40.pic = 'assets/icons/icon_question.svg';

    _this40.Outfit.addItem(new BaseHumanoid());

    _this40.Outfit.addItem(new SkinHuman());

    _this40.Outfit.addItem(HandsHuman.factory('cat'));

    _this40.Outfit.addItem(FaceWolf.factory('cat'));

    _this40.Outfit.addItem(BreastHuman.factory('human'));

    _this40.Outfit.addItem(VulvaHuman.factory('human'));

    _this40.Outfit.addItem(new BikiniBottomLeather());

    _this40.levelUp(3);

    _this40.autoLeveling();

    return _this40;
  }

  return Carlia;
}(Mob);

var Ruff = /*#__PURE__*/function (_Wolf) {
  _inherits(Ruff, _Wolf);

  var _super51 = _createSuper(Ruff);

  function Ruff() {
    var _this41;

    _classCallCheck(this, Ruff);

    _this41 = _super51.call(this);
    _this41.name = _this41.id = 'Ruff';
    _this41.pic = 'assets/bw_wolf1.png';

    _this41.Outfit.addItem(PenisHuman.factory('wolf'));

    _this41.levelUp(3);

    _this41.autoLeveling();

    return _this41;
  }

  return Ruff;
}(Wolf);

var Trent = /*#__PURE__*/function (_Mob9) {
  _inherits(Trent, _Mob9);

  var _super52 = _createSuper(Trent);

  function Trent() {
    var _this42;

    _classCallCheck(this, Trent);

    _this42 = _super52.call(this);
    _this42.name = _this42.id = 'Trent';
    _this42.pic = 'assets/icons/icon_question.svg';

    _this42.Outfit.addItem(new BaseHumanoid());

    _this42.Outfit.addItem(SkinFur.factory('horse', 'brown'));

    _this42.Outfit.addItem(HandsHuman.factory('horse'));

    _this42.Outfit.addItem(TailWolf.factory('horse'));

    _this42.Outfit.addItem(FaceWolf.factory('horse'));

    _this42.Outfit.addItem(PenisHuman.factory('horse'));

    _this42.Outfit.addItem(new ShortsLeather());

    _this42.Outfit.addItem(new MaceSteel());

    _this42.Stats.increment('strength', 3);

    _this42.levelUp(6);

    _this42.autoLeveling();

    return _this42;
  }

  return Trent;
}(Mob); //collection of mob-constructors


window.gm.Mobs = function (Mobs) {
  Mobs.Mole = function () {
    return new Mole();
  };

  Mobs.Wolf = function () {
    return new Wolf();
  };

  Mobs.Leech = function () {
    return new Leech();
  };

  Mobs.Dryad = function () {
    return new Dryad();
  };

  Mobs.Vine = function () {
    return new Vine();
  };

  Mobs.Mechanic = function () {
    return new Mechanic();
  };

  return Mobs;
}(window.gm.Mobs || {});

"use strict";

var Leggings = /*#__PURE__*/function (_Equipment15) {
  _inherits(Leggings, _Equipment15);

  var _super53 = _createSuper(Leggings);

  function Leggings() {
    var _this43;

    _classCallCheck(this, Leggings);

    _this43 = _super53.call(this, 'Leggings');
    _this43.tags = ['cloth'];
    _this43.slotUse = ['Legs', 'Hips'];
    return _this43;
  }

  _createClass(Leggings, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("Leggings", this);
    }
  }, {
    key: "onEquip",
    value: function onEquip(context) {
      context.parent.Stats.addModifier('agility', {
        id: 'agility:Leggings',
        bonus: 5
      });
      return {
        OK: true,
        msg: 'equipped'
      };
    }
  }, {
    key: "onUnequip",
    value: function onUnequip() {
      this.parent.parent.Stats.removeModifier('agility', {
        id: 'agility:Leggings'
      });
      return {
        OK: true,
        msg: 'unequipped'
      };
    }
  }, {
    key: "desc",
    get: function get() {
      return 'Spandex-leggings for sport. (agility+)';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(Leggings, value.data);
    }
  }]);

  return Leggings;
}(Equipment);

var Jeans = /*#__PURE__*/function (_Equipment16) {
  _inherits(Jeans, _Equipment16);

  var _super54 = _createSuper(Jeans);

  function Jeans() {
    var _this44;

    _classCallCheck(this, Jeans);

    _this44 = _super54.call(this, 'Jeans');
    _this44.tags = ['cloth'];
    _this44.slotUse = ['Legs', 'Hips'];
    return _this44;
  }

  _createClass(Jeans, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("Jeans", this);
    }
  }, {
    key: "desc",
    get: function get() {
      return 'plain old blue jeans';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(Jeans, value.data);
    }
  }]);

  return Jeans;
}(Equipment);

var Sneakers = /*#__PURE__*/function (_Equipment17) {
  _inherits(Sneakers, _Equipment17);

  var _super55 = _createSuper(Sneakers);

  function Sneakers() {
    var _this45;

    _classCallCheck(this, Sneakers);

    _this45 = _super55.call(this, 'Sneakers');
    _this45.tags = ['cloth'];
    _this45.slotUse = ['Feet'];
    return _this45;
  }

  _createClass(Sneakers, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("Sneakers", this);
    }
  }, {
    key: "desc",
    get: function get() {
      return 'Sneakers for sport and recreational activities.';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(Sneakers, value.data);
    }
  }]);

  return Sneakers;
}(Equipment);

var TankShirt = /*#__PURE__*/function (_Equipment18) {
  _inherits(TankShirt, _Equipment18);

  var _super56 = _createSuper(TankShirt);

  function TankShirt() {
    var _this46;

    _classCallCheck(this, TankShirt);

    _this46 = _super56.call(this, 'TankShirt');
    _this46.tags = ['cloth'];
    _this46.slotUse = ['Breast', 'Stomach'];
    return _this46;
  }

  _createClass(TankShirt, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("TankShirt", this);
    }
  }, {
    key: "desc",
    get: function get() {
      return 'light blue tank-top';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(TankShirt, value.data);
    }
  }]);

  return TankShirt;
}(Equipment);

var Pullover = /*#__PURE__*/function (_Equipment19) {
  _inherits(Pullover, _Equipment19);

  var _super57 = _createSuper(Pullover);

  function Pullover() {
    var _this47;

    _classCallCheck(this, Pullover);

    _this47 = _super57.call(this, 'Pullover');
    _this47.tags = ['cloth'];
    _this47.slotUse = ['Breast', 'Stomach', 'Arms'];
    return _this47;
  }

  _createClass(Pullover, [{
    key: "descLong",
    value: function descLong(fconv) {
      var msg = '';
      if (this.isEquipped()) msg = 'A warm pullover adorns $[me]$.';else msg = '$[I]$ $[have]$ ' + this.name + ".";
      return fconv(msg);
    }
  }, {
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("Pullover", this);
    }
  }, {
    key: "desc",
    get: function get() {
      return 'warm pullover';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(Pullover, value.data);
    }
  }]);

  return Pullover;
}(Equipment);

var BracerLeather = /*#__PURE__*/function (_Equipment20) {
  _inherits(BracerLeather, _Equipment20);

  var _super58 = _createSuper(BracerLeather);

  function BracerLeather() {
    var _this48;

    _classCallCheck(this, BracerLeather);

    _this48 = _super58.call(this, 'BracerLeather');
    _this48.tags = ['cloth'];
    _this48.slotUse = ['Wrists'];
    _this48.style = 0;
    _this48.lossOnRespawn = true;
    return _this48;
  }

  _createClass(BracerLeather, [{
    key: "descLong",
    value: function descLong(fconv) {
      var msg = '';
      if (this.isEquipped()) msg = 'A pair of bracers adorns $[my]$ lower arms.';else msg = '$[I]$ $[have]$ ' + this.name + ".";
      return fconv(msg);
    }
  }, {
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("BracerLeather", this);
    }
  }, {
    key: "style",
    set: function set(style) {
      this._style = style; //if(style===100) this.lossOnRespawn=false;
    },
    get: function get() {
      return this._style;
    }
  }, {
    key: "desc",
    get: function get() {
      var msg = 'worn bracers made of leather';
      if (this.style === 100) msg = 'leather bracers with steel-studs';
      return msg + this.bonusDesc();
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(BracerLeather, value.data);
    }
  }]);

  return BracerLeather;
}(Equipment);

var HandCuffs = /*#__PURE__*/function (_Equipment21) {
  _inherits(HandCuffs, _Equipment21);

  var _super59 = _createSuper(HandCuffs);

  function HandCuffs() {
    var _this49;

    _classCallCheck(this, HandCuffs);

    _this49 = _super59.call(this, 'HandCuffs');
    _this49.tags = ['restrain'];
    _this49.slotUse = ['RHand', 'LHand', 'Wrists'];
    return _this49;
  }

  _createClass(HandCuffs, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("HandCuffs", this);
    }
  }, {
    key: "usable",
    value: function usable(context) {
      return this.canEquip(context);
    }
  }, {
    key: "use",
    value: function use(context) {
      //context here is inventory not outfit
      if (this.parent.parent.Outfit.findItemSlot(this.id).length > 0) {
        this.parent.parent.Outfit.removeItem(this.id);
        return {
          OK: true,
          msg: 'unequipped ' + this.name
        }; //todo
      } else {
        this.parent.parent.Outfit.addItem(this);
        return {
          OK: true,
          msg: 'equipped ' + this.name
        }; //todo
      }
    }
  }, {
    key: "canEquip",
    value: function canEquip(context) {
      if (this.parent.parent.Outfit.findItemSlot(this.id).length > 0) return {
        OK: true,
        msg: 'unequip'
      }; //todo check for key
      else return {
          OK: true,
          msg: 'equip'
        };
    }
  }, {
    key: "canUnequip",
    value: function canUnequip() {
      return {
        OK: false,
        msg: 'You need to find a key first to be able to remove it!'
      };
    }
  }, {
    key: "desc",
    get: function get() {
      return 'handcuffs like the police use them';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(HandCuffs, value.data);
    }
  }]);

  return HandCuffs;
}(Equipment);

var WristCuffs = /*#__PURE__*/function (_Equipment22) {
  _inherits(WristCuffs, _Equipment22);

  var _super60 = _createSuper(WristCuffs);

  function WristCuffs() {
    var _this50;

    _classCallCheck(this, WristCuffs);

    _this50 = _super60.call(this, 'WristCuffs');
    _this50.tags = [];
    _this50.slotUse = ['Wrists'];
    _this50.lossOnRespawn = false;
    return _this50;
  }

  _createClass(WristCuffs, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("WristCuffs", this);
    }
  }, {
    key: "usable",
    value: function usable(context) {
      return this.canEquip(context);
    }
  }, {
    key: "use",
    value: function use(context) {
      //context here is inventory not outfit
      if (this.parent.parent.Outfit.findItemSlot(this.id).length > 0) {
        this.parent.parent.Outfit.removeItem(this.id);
        return {
          OK: true,
          msg: 'unequipped ' + this.name
        }; //todo
      } else {
        this.parent.parent.Outfit.addItem(this);
        return {
          OK: true,
          msg: 'equipped ' + this.name
        }; //todo
      }
    }
  }, {
    key: "canEquip",
    value: function canEquip(context) {
      if (this.parent.parent.Outfit.findItemSlot(this.id).length > 0) return {
        OK: true,
        msg: 'unequip'
      };else return {
        OK: true,
        msg: 'equip'
      };
    }
  }, {
    key: "canUnequip",
    value: function canUnequip() {
      return {
        OK: false,
        msg: 'Those cuffs can only be removed by a magican!'
      };
    }
  }, {
    key: "desc",
    get: function get() {
      return 'some leather cuffs for wrists';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(WristCuffs, value.data);
    }
  }]);

  return WristCuffs;
}(Equipment);

var CollarQuest = /*#__PURE__*/function (_Equipment23) {
  _inherits(CollarQuest, _Equipment23);

  var _super61 = _createSuper(CollarQuest);

  function CollarQuest() {
    var _this51;

    _classCallCheck(this, CollarQuest);

    _this51 = _super61.call(this, 'CollarQuest');
    _this51.tags = [];
    _this51.slotUse = ['Neck'];
    _this51.lossOnRespawn = false;
    return _this51;
  }

  _createClass(CollarQuest, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("CollarQuest", this);
    }
  }, {
    key: "usable",
    value: function usable(context) {
      return this.canEquip(context);
    }
  }, {
    key: "use",
    value: function use(context) {
      //context here is inventory not outfit
      if (this.parent.parent.Outfit.findItemSlot(this.id).length > 0) {
        this.parent.parent.Outfit.removeItem(this.id);
        return {
          OK: true,
          msg: 'unequipped ' + this.name
        }; //todo
      } else {
        this.parent.parent.Outfit.addItem(this);
        return {
          OK: true,
          msg: 'equipped ' + this.name
        }; //todo
      }
    }
  }, {
    key: "canEquip",
    value: function canEquip(context) {
      if (this.parent && this.parent.parent.Outfit.findItemSlot(this.id).length > 0) return {
        OK: true,
        msg: 'unequip'
      };else return {
        OK: true,
        msg: 'equip'
      };
    }
  }, {
    key: "canUnequip",
    value: function canUnequip() {
      return {
        OK: false,
        msg: 'This can only be removed by a magican!'
      };
    }
  }, {
    key: "desc",
    get: function get() {
      return 'a collar';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(CollarQuest, value.data);
    }
  }]);

  return CollarQuest;
}(Equipment);

var PiercingClit = /*#__PURE__*/function (_Equipment24) {
  _inherits(PiercingClit, _Equipment24);

  var _super62 = _createSuper(PiercingClit);

  function PiercingClit() {
    var _this52;

    _classCallCheck(this, PiercingClit);

    _this52 = _super62.call(this, 'PiercingClit');
    _this52.tags = ['piercing'];
    _this52.slotUse = ['pClit'];
    _this52.style = 0;
    _this52.lossOnRespawn = true;
    return _this52;
  }

  _createClass(PiercingClit, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("PiercingClit", this);
    }
  }, {
    key: "onEquip",
    value: function onEquip(context) {
      if (this.style === 100) {
        context.parent.addEffect("effGrowVulva", window.storage.constructors['effGrowVulva']()); //only works for player since effects of NPC dont receive ticks!
      }

      return {
        OK: true,
        msg: 'equipped'
      };
    }
  }, {
    key: "style",
    set: function set(style) {
      this._style = style;
      if (style === 100) this.lossOnRespawn = false;
    },
    get: function get() {
      return this._style;
    }
  }, {
    key: "desc",
    get: function get() {
      if (this.style === 100) return 'cursed piercing';
      return 'small clitoris-piercing';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(PiercingClit, value.data);
    }
  }]);

  return PiercingClit;
}(Equipment);

var TattooGroin = /*#__PURE__*/function (_Equipment25) {
  _inherits(TattooGroin, _Equipment25);

  var _super63 = _createSuper(TattooGroin);

  function TattooGroin() {
    var _this53;

    _classCallCheck(this, TattooGroin);

    _this53 = _super63.call(this, 'TattooGroin');
    _this53.tags = ['tattoo'];
    _this53.slotUse = ['tStomach'];
    _this53.style = 0;
    _this53.lossOnRespawn = false;
    return _this53;
  }

  _createClass(TattooGroin, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("TattooGroin", this);
    }
  }, {
    key: "canEquip",
    value: function canEquip(context) {
      return {
        OK: false,
        msg: 'unequipable'
      };
    }
  }, {
    key: "canUnequip",
    value: function canUnequip() {
      return {
        OK: false,
        msg: 'not so easy to get rid off'
      };
    }
  }, {
    key: "onEquip",
    value: function onEquip(context) {
      if (this.style === 100) {
        context.parent.addEffect("effLewdMark", window.storage.constructors['effLewdMark']()); //only works for player since effects of NPC dont receive ticks!
      }

      return {
        OK: true,
        msg: 'tattoed'
      };
    }
  }, {
    key: "style",
    set: function set(style) {
      this._style = style;
    },
    get: function get() {
      return this._style;
    }
  }, {
    key: "desc",
    get: function get() {
      if (this.style === 100) return 'a kind of lewd mark';
      return 'a tribal tatto on the lower belly';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(TattooGroin, value.data);
    }
  }]);

  return TattooGroin;
}(Equipment); //this is an Inventory-item, not wardrobe


var Crowbar = /*#__PURE__*/function (_Equipment26) {
  _inherits(Crowbar, _Equipment26);

  var _super64 = _createSuper(Crowbar);

  function Crowbar() {
    var _this54;

    _classCallCheck(this, Crowbar);

    _this54 = _super64.call(this, 'Crowbar');
    _this54.tags = ['tool', 'weapon'];
    _this54.slotUse = ['RHand'];
    _this54.lossOnRespawn = true;
    return _this54;
  }

  _createClass(Crowbar, [{
    key: "descLong",
    value: function descLong(fconv) {
      return fconv('$[I]$ $[hold]$ a crowbar.');
    }
  }, {
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("Crowbar", this);
    }
  }, {
    key: "usable",
    value: function usable(context) {
      return this.canEquip(context);
    }
  }, {
    key: "use",
    value: function use(context) {
      //context here is inventory not outfit
      if (this.parent.parent.Outfit.findItemSlot(this.id).length > 0) {
        this.parent.parent.Outfit.removeItem(this.id);
        return {
          OK: true,
          msg: 'unequipped ' + this.name
        }; //todo
      } else {
        this.parent.parent.Outfit.addItem(this);
        return {
          OK: true,
          msg: 'equipped ' + this.name
        }; //todo
      }
    }
  }, {
    key: "onEquip",
    value: function onEquip(context) {
      //context.parent.Stats.addModifier('pAttack',{id:'pAttack:Crowbar', bonus:2});
      return {
        OK: true,
        msg: 'equipped'
      };
    }
  }, {
    key: "onUnequip",
    value: function onUnequip() {
      //this.parent.parent.Stats.removeModifier('pAttack',{id:'pAttack:Crowbar'});
      return {
        OK: true,
        msg: 'unequipped'
      };
    }
  }, {
    key: "desc",
    get: function get() {
      return 'durable crowbar.';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(Crowbar, value.data);
    }
  }]);

  return Crowbar;
}(Equipment); //this is an Inventory-item, not wardrobe


var Shovel = /*#__PURE__*/function (_Equipment27) {
  _inherits(Shovel, _Equipment27);

  var _super65 = _createSuper(Shovel);

  function Shovel() {
    var _this55;

    _classCallCheck(this, Shovel);

    _this55 = _super65.call(this, 'Shovel');
    _this55.tags = ['tool', 'weapon'];
    _this55.slotUse = ['RHand', 'LHand'];
    _this55.lossOnRespawn = true;
    return _this55;
  }

  _createClass(Shovel, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("Shovel", this);
    }
  }, {
    key: "usable",
    value: function usable(context) {
      return this.canEquip(context);
    }
  }, {
    key: "use",
    value: function use(context) {
      //context here is inventory not outfit
      if (this.parent.parent.Outfit.findItemSlot(this.id).length > 0) {
        this.parent.parent.Outfit.removeItem(this.id);
        return {
          OK: true,
          msg: 'unequipped ' + this.name
        }; //todo
      } else {
        this.parent.parent.Outfit.addItem(this);
        return {
          OK: true,
          msg: 'equipped ' + this.name
        }; //todo
      }
    }
  }, {
    key: "onEquip",
    value: function onEquip(context) {
      //context.parent.Stats.addModifier('pAttack',{id:'pAttack:Shovel', bonus:2});
      return {
        OK: true,
        msg: 'equipped'
      };
    }
  }, {
    key: "onUnequip",
    value: function onUnequip() {
      //this.parent.parent.Stats.removeModifier('pAttack',{id:'pAttack:Shovel'});
      return {
        OK: true,
        msg: 'unequipped'
      };
    }
  }, {
    key: "desc",
    get: function get() {
      return 'A rusty,old shovel.';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(Shovel, value.data);
    }
  }]);

  return Shovel;
}(Equipment);

var RobesZealot = /*#__PURE__*/function (_Equipment28) {
  _inherits(RobesZealot, _Equipment28);

  var _super66 = _createSuper(RobesZealot);

  function RobesZealot() {
    var _this56;

    _classCallCheck(this, RobesZealot);

    _this56 = _super66.call(this, 'RobesZealot');
    _this56.tags = ['cloth'];
    _this56.slotUse = ['Breast', 'Stomach', 'Hips', 'Legs'];
    _this56.slotCover = ['bBreast', 'uBreast', 'pNipples'];
    _this56.lossOnRespawn = true;
    return _this56;
  }

  _createClass(RobesZealot, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("RobesZealot", this);
    }
  }, {
    key: "desc",
    get: function get() {
      return 'light blue tank-top';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(RobesZealot, value.data);
    }
  }]);

  return RobesZealot;
}(Equipment);

var Briefs = /*#__PURE__*/function (_Equipment29) {
  _inherits(Briefs, _Equipment29);

  var _super67 = _createSuper(Briefs);

  function Briefs() {
    var _this57;

    _classCallCheck(this, Briefs);

    _this57 = _super67.call(this, 'Briefs');
    _this57.tags = ['cloth'];
    _this57.slotUse = ['uHips'];
    _this57.slotCover = ['bPenis', 'bVulva', 'bBalls', 'bClit', 'bAnus', 'pPenis', 'pClit'];
    _this57.lossOnRespawn = true;
    _this57.lewd.slut = 1;
    return _this57;
  }

  _createClass(Briefs, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("Briefs", this);
    }
  }, {
    key: "desc",
    get: function get() {
      return 'plain briefs';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(Briefs, value.data);
    }
  }]);

  return Briefs;
}(Equipment);

var BikiniBottomLeather = /*#__PURE__*/function (_Equipment30) {
  _inherits(BikiniBottomLeather, _Equipment30);

  var _super68 = _createSuper(BikiniBottomLeather);

  function BikiniBottomLeather() {
    var _this58;

    _classCallCheck(this, BikiniBottomLeather);

    _this58 = _super68.call(this, 'BikiniBottomLeather');
    _this58.tags = ['cloth'];
    _this58.slotUse = ['uHips'];
    _this58.slotCover = ['bPenis', 'bVulva', 'bBalls', 'bClit', 'bAnus', 'pPenis', 'pClit'];
    _this58.lossOnRespawn = true;
    return _this58;
  }

  _createClass(BikiniBottomLeather, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("BikiniBottomLeather", this);
    }
  }, {
    key: "desc",
    get: function get() {
      return 'leather triangle-bikini bottom';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(BikiniBottomLeather, value.data);
    }
  }]);

  return BikiniBottomLeather;
}(Equipment);

var BikiniTopLeather = /*#__PURE__*/function (_Equipment31) {
  _inherits(BikiniTopLeather, _Equipment31);

  var _super69 = _createSuper(BikiniTopLeather);

  function BikiniTopLeather() {
    var _this59;

    _classCallCheck(this, BikiniTopLeather);

    _this59 = _super69.call(this, 'BikiniTopLeather');
    _this59.tags = ['cloth'];
    _this59.slotUse = ['uBreast'];
    _this59.slotCover = ['pNipples'];
    _this59.lossOnRespawn = true;
    return _this59;
  }

  _createClass(BikiniTopLeather, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("BikiniTopLeather", this);
    }
  }, {
    key: "desc",
    get: function get() {
      return 'leather triangle-bikini top';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(BikiniTopLeather, value.data);
    }
  }]);

  return BikiniTopLeather;
}(Equipment);

var ShortsLeather = /*#__PURE__*/function (_Equipment32) {
  _inherits(ShortsLeather, _Equipment32);

  var _super70 = _createSuper(ShortsLeather);

  function ShortsLeather() {
    var _this60;

    _classCallCheck(this, ShortsLeather);

    _this60 = _super70.call(this, 'ShortsLeather');
    _this60.tags = ['cloth'];
    _this60.slotUse = ['Hips', 'Legs'];
    _this60.slotCover = ['bPenis', 'bVulva', 'bBalls', 'bClit', 'bAnus', 'pPenis', 'pClit'];
    _this60.lossOnRespawn = true;
    return _this60;
  }

  _createClass(ShortsLeather, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("ShortsLeather", this);
    }
  }, {
    key: "desc",
    get: function get() {
      return 'leather shorts';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(ShortsLeather, value.data);
    }
  }]);

  return ShortsLeather;
}(Equipment);

var BowWodden = /*#__PURE__*/function (_Equipment33) {
  _inherits(BowWodden, _Equipment33);

  var _super71 = _createSuper(BowWodden);

  function BowWodden() {
    var _this61;

    _classCallCheck(this, BowWodden);

    _this61 = _super71.call(this, 'BowWodden');
    _this61.tags = ['weapon'];
    _this61.slotUse = ['RHand', 'LHand'];
    _this61.lossOnRespawn = true;
    _this61.pDamage = 11;
    return _this61;
  }

  _createClass(BowWodden, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("BowWodden", this);
    }
  }, {
    key: "usable",
    value: function usable(context) {
      return this.canEquip(context);
    }
  }, {
    key: "use",
    value: function use(context) {
      //context here is inventory not outfit
      if (this.parent.parent.Outfit.findItemSlot(this.id).length > 0) {
        this.parent.parent.Outfit.removeItem(this.id);
        return {
          OK: true,
          msg: 'unequipped ' + this.name
        };
      } else {
        this.parent.parent.Outfit.addItem(this);
        return {
          OK: true,
          msg: 'equipped ' + this.name
        };
      }
    }
  }, {
    key: "onEquip",
    value: function onEquip(context) {
      return {
        OK: true,
        msg: 'equipped'
      };
    }
  }, {
    key: "onUnequip",
    value: function onUnequip() {
      return {
        OK: true,
        msg: 'unequipped'
      };
    }
  }, {
    key: "desc",
    get: function get() {
      return 'A simple bow';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(BowWodden, value.data);
    }
  }]);

  return BowWodden;
}(Equipment);

var DaggerSteel = /*#__PURE__*/function (_Equipment34) {
  _inherits(DaggerSteel, _Equipment34);

  var _super72 = _createSuper(DaggerSteel);

  function DaggerSteel() {
    var _this62;

    _classCallCheck(this, DaggerSteel);

    _this62 = _super72.call(this, 'DaggerSteel');
    _this62.tags = ['weapon'];
    _this62.slotUse = ['RHand'];
    _this62.lossOnRespawn = true;
    _this62.pDamage = 6;
    return _this62;
  }

  _createClass(DaggerSteel, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("DaggerSteel", this);
    }
  }, {
    key: "usable",
    value: function usable(context) {
      return this.canEquip(context);
    }
  }, {
    key: "use",
    value: function use(context) {
      //context here is inventory not outfit
      if (this.parent.parent.Outfit.findItemSlot(this.id).length > 0) {
        this.parent.parent.Outfit.removeItem(this.id);
        return {
          OK: true,
          msg: 'unequipped ' + this.name
        };
      } else {
        this.parent.parent.Outfit.addItem(this);
        return {
          OK: true,
          msg: 'equipped ' + this.name
        };
      }
    }
  }, {
    key: "onEquip",
    value: function onEquip(context) {
      return {
        OK: true,
        msg: 'equipped'
      };
    }
  }, {
    key: "onUnequip",
    value: function onUnequip() {
      return {
        OK: true,
        msg: 'unequipped'
      };
    }
  }, {
    key: "desc",
    get: function get() {
      return 'A steel dagger.';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(DaggerSteel, value.data);
    }
  }]);

  return DaggerSteel;
}(Equipment);

var StaffWodden = /*#__PURE__*/function (_Equipment35) {
  _inherits(StaffWodden, _Equipment35);

  var _super73 = _createSuper(StaffWodden);

  function StaffWodden() {
    var _this63;

    _classCallCheck(this, StaffWodden);

    _this63 = _super73.call(this, 'StaffWodden');
    _this63.tags = ['weapon'];
    _this63.slotUse = ['RHand', 'LHand'];
    _this63.lossOnRespawn = true;
    _this63.pDamage = 5;
    return _this63;
  }

  _createClass(StaffWodden, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("StaffWodden", this);
    }
  }, {
    key: "usable",
    value: function usable(context) {
      return this.canEquip(context);
    }
  }, {
    key: "use",
    value: function use(context) {
      //context here is inventory not outfit
      if (this.parent.parent.Outfit.findItemSlot(this.id).length > 0) {
        this.parent.parent.Outfit.removeItem(this.id);
        return {
          OK: true,
          msg: 'unequipped ' + this.name
        }; //todo
      } else {
        this.parent.parent.Outfit.addItem(this);
        return {
          OK: true,
          msg: 'equipped ' + this.name
        }; //todo
      }
    }
  }, {
    key: "onEquip",
    value: function onEquip(context) {
      var sk = new SkillSmash();
      sk.weapon = this.id;
      this.parent.parent.Skills.addItem(sk);
      return {
        OK: true,
        msg: 'equipped'
      };
    }
  }, {
    key: "onUnequip",
    value: function onUnequip() {
      this.parent.parent.Skills.removeItem('Smash');
      return {
        OK: true,
        msg: 'unequipped'
      };
    }
  }, {
    key: "attackMod",
    value: function attackMod(target) {
      var mod = new SkillMod();
      mod.onHit = [{
        target: target,
        eff: [effDamage.setup(11, 'blunt')]
      }];
      mod.critChance = 50;
      mod.onCrit = [{
        target: target,
        eff: [effDamage.setup(11, 'blunt'), new effStunned()]
      }];
      return mod;
    }
  }, {
    key: "desc",
    get: function get() {
      return 'A staff made from wood.';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(StaffWodden, value.data);
    }
  }]);

  return StaffWodden;
}(Equipment);

var MaceSteel = /*#__PURE__*/function (_Equipment36) {
  _inherits(MaceSteel, _Equipment36);

  var _super74 = _createSuper(MaceSteel);

  function MaceSteel() {
    var _this64;

    _classCallCheck(this, MaceSteel);

    _this64 = _super74.call(this, 'MaceSteel');
    _this64.tags = ['weapon'];
    _this64.slotUse = ['RHand'];
    _this64.lossOnRespawn = true;
    _this64.pDamage = 15;
    /*this.attack = window.gm.combat.AttackSetup();
    let dmg = {target:"defender", effect:"effDamage", value: 10};
    let stun = {target:"defender", effect:"effStun", value: 10};
    this.attack.apply = [{cond:100, apply:dmg},{cond:50,apply:stun}]; */

    return _this64;
  }

  _createClass(MaceSteel, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("MaceSteel", this);
    }
  }, {
    key: "usable",
    value: function usable(context) {
      return this.canEquip(context);
    }
  }, {
    key: "use",
    value: function use(context) {
      //context here is inventory not outfit
      if (this.parent.parent.Outfit.findItemSlot(this.id).length > 0) {
        this.parent.parent.Outfit.removeItem(this.id);
        return {
          OK: true,
          msg: 'unequipped ' + this.name
        }; //todo
      } else {
        this.parent.parent.Outfit.addItem(this);
        return {
          OK: true,
          msg: 'equipped ' + this.name
        }; //todo
      }
    }
  }, {
    key: "onEquip",
    value: function onEquip(context) {
      return {
        OK: true,
        msg: 'equipped'
      };
    }
  }, {
    key: "onUnequip",
    value: function onUnequip() {
      return {
        OK: true,
        msg: 'unequipped'
      };
    }
  }, {
    key: "desc",
    get: function get() {
      return 'A heavy steel mace.';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(MaceSteel, value.data);
    }
  }]);

  return MaceSteel;
}(Equipment);

var TailRibbon = /*#__PURE__*/function (_Equipment37) {
  _inherits(TailRibbon, _Equipment37);

  var _super75 = _createSuper(TailRibbon);

  function TailRibbon() {
    var _this65;

    _classCallCheck(this, TailRibbon);

    _this65 = _super75.call(this, 'TailRibbon');
    _this65.tags = ['cloth'];
    _this65.slotUse = ['TailTip'];
    return _this65;
  }

  _createClass(TailRibbon, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("TailRibbon", this);
    }
  }, {
    key: "canEquip",
    value: function canEquip(context) {
      if (this.parent.parent.Outfit.findItemSlot(this.id).length > 0) return {
        OK: true,
        msg: 'unequip'
      }; //todo check for key
      else {
          if (this.parent.parent.Outfit.countItem("TailWolf") > 0) {
            return {
              OK: true,
              msg: 'equip'
            };
          } else {
            return {
              OK: false,
              msg: 'This requires a propper tail to attach to!'
            };
          }
        }
    }
  }, {
    key: "desc",
    get: function get() {
      'a fancy color band that can be wrapped around someones tailtip';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(TailRibbon, value.data);
    }
  }]);

  return TailRibbon;
}(Equipment); //todo bow,whip,blowpipe
//todo vest,chaps,bikini top, greaves , jacket


window.gm.ItemsLib = function (ItemsLib) {
  window.storage.registerConstructor(BikiniBottomLeather);
  window.storage.registerConstructor(BikiniTopLeather);
  window.storage.registerConstructor(BracerLeather);
  window.storage.registerConstructor(Briefs);
  window.storage.registerConstructor(CollarQuest);
  window.storage.registerConstructor(DaggerSteel);
  window.storage.registerConstructor(Leggings);
  window.storage.registerConstructor(MaceSteel);
  window.storage.registerConstructor(TankShirt);
  window.storage.registerConstructor(Jeans);
  window.storage.registerConstructor(Sneakers);
  window.storage.registerConstructor(Pullover);
  window.storage.registerConstructor(Crowbar);
  window.storage.registerConstructor(Shovel);
  window.storage.registerConstructor(TailRibbon);
  window.storage.registerConstructor(PiercingClit);
  window.storage.registerConstructor(TattooGroin);
  window.storage.registerConstructor(RobesZealot);
  window.storage.registerConstructor(ShortsLeather);
  window.storage.registerConstructor(StaffWodden);
  window.storage.registerConstructor(WristCuffs); //.. and Wardrobe

  ItemsLib['CollarQuest'] = function () {
    return new CollarQuest();
  };

  ItemsLib['Leggings'] = function () {
    return new Leggings();
  };

  ItemsLib['Tank-shirt'] = function () {
    return new TankShirt();
  };

  ItemsLib['Jeans'] = function () {
    return new Jeans();
  };

  ItemsLib['Sneakers'] = function () {
    return new Sneakers();
  };

  ItemsLib['Pullover'] = function () {
    return new Pullover();
  };

  ItemsLib['TailRibbon'] = function () {
    return new TailRibbon();
  };

  ItemsLib['PiercingClit'] = function () {
    return new PiercingClit();
  };

  ItemsLib['TattooGroin'] = function () {
    return new TattooGroin();
  };

  ItemsLib['RobesZealot'] = function () {
    return new RobesZealot();
  };

  ItemsLib['WristCuffs'] = function () {
    return new WristCuffs();
  }; //special wardrobe-item combination


  ItemsLib['Crowbar'] = function () {
    return new Crowbar();
  };

  ItemsLib['Shovel'] = function () {
    return new Shovel();
  };

  ItemsLib['StaffWodden'] = function () {
    return new StaffWodden();
  };

  ItemsLib['Handcuffs'] = function () {
    return new HandCuffs();
  };

  ItemsLib['DaggerSteel'] = function () {
    return new DaggerSteel();
  };

  return ItemsLib;
}(window.gm.ItemsLib || {}); //this holds the definition of all quests; but which quests/ms are active is stored in window.story.state.quests !


window.gm.questDef = window.gm.questDef || {};
{
  var quest = new Quest("qFindGarden", "Find the garden", "The Garden is somewhere around the house.");
  var mile1 = new QuestMilestone(1, "Find the garden", "You heard rumors that there is a garden behind the house.Find it.", //each milestone should define a function that checks if the milestone is fullfilled or not or if no more milestones
  function () {
    if (window.passage.name === "Garden") {
      return 100;
    } else return 0;
  });
  var mile2 = new QuestMilestone(100, "Found the garden", "Congratulation. You found the garden.", function () {
    return -1;
  });
  quest.addMileStone(mile1);
  quest.addMileStone(mile2);
  window.gm.questDef[quest.id] = quest;
}
{
  var NOP = function NOP() {
    return 0;
  };

  var _quest2 = new Quest("qFixLaptop", "Upgrade your Laptop", "");

  _quest2.addMileStone(new QuestMilestone(1, "", "The powerconverter for your laptop should be somewhere around in the house. ", NOP));

  _quest2.addMileStone(new QuestMilestone(1000, "", "The Laptop is working.", NOP)); // install webcam


  window.gm.questDef[_quest2.id] = _quest2;
}
{
  var _NOP = function _NOP() {
    return 0;
  };

  var _quest3 = new Quest("qStudy", "Do some studying", "Do something for your success at university.");

  _quest3.addMileStone(new QuestMilestone(1, "", "Sitting down and reading a book might get you some knowledge.", _NOP));

  _quest3.addMileStone(new QuestMilestone(100, "", "At least you feel a little smarter now.", function () {
    return -1;
  }));

  window.gm.questDef[_quest3.id] = _quest3;
}
{
  var _NOP2 = function _NOP2() {
    return 0;
  };

  var hidden = function hidden() {
    return window.gm.quests.getMilestoneState("qMyPleasure").id < 100;
  };

  var _quest4 = new Quest("qMyPleasure", "Pleasure yourself", "Pleasure yourself.", hidden);

  _quest4.addMileStone(new QuestMilestone(1, "", "Rub yourself.", _NOP2, hidden));

  _quest4.addMileStone(new QuestMilestone(100, "", "You created a mess in your bedsheets.", function () {
    return -1;
  }));

  window.gm.questDef[_quest4.id] = _quest4;
}
{
  //quest-flag counts the shifts done in week
  var _NOP3 = function _NOP3() {
    return 0;
  };

  var _quest5 = new Quest("qFindAJob", "Find a job", "Somehow you have to make a living.");

  _quest5.addMileStone(new QuestMilestone(1, "", "Maybe you can ask around or check the blackboard at the uni for some offers.", _NOP3));

  _quest5.addMileStone(new QuestMilestone(100, "", "You've got that job-ad from Harcon Health Inc that is somewhere in downtown. Maybe you could inquire there whats up with it.", _NOP3));

  _quest5.addMileStone(new QuestMilestone(200, "", "They offered you to work in logistic department. You will move boxes and crates around for little money but at least its a start. Check your job-schedule", _NOP3));

  _quest5.addMileStone(new QuestMilestone(300, "", "???", _NOP3));

  window.gm.questDef[_quest5.id] = _quest5;
} //////////////////////////////////////////////////////////////////////////////////////

{
  // the quest keeps track of the VR-Game main development
  var _NOP4 = function _NOP4() {
    return 0;
  };

  var _hidden = function _hidden() {
    return window.gm.quests.getMilestoneState("qDLCMain").id < 100;
  };

  var _quest6 = new Quest("qDLCMain", "qDLCMain", "qDLCMain", _hidden);

  _quest6.addMileStone(new QuestMilestone(1, "", "Sign betatestcontract.", _NOP4, _hidden));

  _quest6.addMileStone(new QuestMilestone(100, "", "It will take some days until the game-equipment arrives. Spent some time studying or working.", _NOP4, _hidden));

  _quest6.addMileStone(new QuestMilestone(500, "", "Setup VR-equipment.", _NOP4, _hidden));

  _quest6.addMileStone(new QuestMilestone(600, "", "Enter the game.", _NOP4, _hidden));

  _quest6.addMileStone(new QuestMilestone(700, "", "Get to the settlement.", _NOP4, _hidden));

  _quest6.addMileStone(new QuestMilestone(800, "", "Ask around for a quest.", _NOP4, _hidden));

  _quest6.addMileStone(new QuestMilestone(900, "", "Finish the PurpleBerryQuest.", _NOP4));

  _quest6.addMileStone(new QuestMilestone(1000, "", "Get past that bridge and find your way to the village", _NOP4)); //<--


  _quest6.addMileStone(new QuestMilestone(1100, "", "Ask around in the village for help with that collar.", _NOP4));

  _quest6.addMileStone(new QuestMilestone(1000, "", "Someone called \"Librarian\" might be found in \"Shattered City\"", _NOP4));

  window.gm.questDef[_quest6.id] = _quest6;
}
{
  // the quest tracks death for tutorial
  var _NOP5 = function _NOP5() {
    return 0;
  };

  var _hidden2 = function _hidden2() {
    return window.gm.quests.getMilestoneState("qDiedAgain").id < 0;
  };

  var _quest7 = new Quest("qDiedAgain", "qDiedAgain", "qDiedAgain", _hidden2);

  _quest7.addMileStone(new QuestMilestone(1, "", "Life is a game.", _NOP5, _hidden2));

  _quest7.addMileStone(new QuestMilestone(2, "", "Find your first death.", _NOP5, _hidden2));

  _quest7.addMileStone(new QuestMilestone(100, "", "Die with some bonded equipment.", _NOP5, _hidden2));

  _quest7.addMileStone(new QuestMilestone(200, "", "Die by pleasure.", _NOP5, _hidden2)); //todo what if this is before previous?


  _quest7.addMileStone(new QuestMilestone(300, "", ".", _NOP5, _hidden2));

  window.gm.questDef[_quest7.id] = _quest7;
}
{
  //
  var _NOP6 = function _NOP6() {
    return 0;
  };

  var _hidden3 = function _hidden3() {
    return false;
  };

  var _quest8 = new Quest("qPurpleBerry", "qPurpleBerry", "qPurpleBerry", _hidden3);

  _quest8.addMileStone(new QuestMilestone(1, "", "Search the forest for 5 handful of purple berrys and deliver them to the alchemist.", _NOP6, _hidden3));

  _quest8.addMileStone(new QuestMilestone(100, "", "You delivered the berries to the alchemist.", _NOP6, _hidden3));

  _quest8.addMileStone(new QuestMilestone(200, "", "Find 4 purple berrys, 2 apoca-blossoms, 2 leeches.", _NOP6, _hidden3));

  _quest8.addMileStone(new QuestMilestone(300, "", "Fetch the potion from the alchemist.", _NOP6, _hidden3));

  window.gm.questDef[_quest8.id] = _quest8;
}
{
  var _NOP7 = function _NOP7() {
    return 0;
  };

  var _hidden4 = function _hidden4() {
    return window.gm.quests.getMilestoneState("qCarlia").id < 100;
  };

  var _quest9 = new Quest("qCarlia", "Carlia", "Carlia", _hidden4);

  _quest9.addMileStone(new QuestMilestone(1, "", "", _NOP7, _hidden4));

  _quest9.addMileStone(new QuestMilestone(100, "", "A strange individual is stalking you.", _NOP7, _hidden4));

  _quest9.addMileStone(new QuestMilestone(200, "", "That stalker was eying you again. He was disappearing into the cliffs direction.", _NOP7, _hidden4));

  _quest9.addMileStone(new QuestMilestone(300, "", "There were some footprint at the cliff that led you to a concealed path.", _NOP7));

  _quest9.addMileStone(new QuestMilestone(400, "", "Someone setup a camp in a cave entrance. Maybe you an find some clues there.", _NOP7));

  _quest9.addMileStone(new QuestMilestone(500, "", "Pooking around in other peoples stuff got you a \"present\".", _NOP7));

  _quest9.addMileStone(new QuestMilestone(600, "", "The stalker didnt care to hide any longer and accused you of thievery.", _NOP7));

  _quest9.addMileStone(new QuestMilestone(700, "", "Try to convince her that she can trust you by finding her a home.", _NOP7));

  _quest9.addMileStone(new QuestMilestone(800, "", "Tell Carlia that the Alchemist aggreed to let Carlia sleep in his hut.", _NOP7));

  _quest9.addMileStone(new QuestMilestone(900, "", "For your help Carlia showed you a new \'skill\'.", _NOP7));

  window.gm.questDef[_quest9.id] = _quest9;
}
{
  var _NOP8 = function _NOP8() {
    return 0;
  };

  var _hidden5 = function _hidden5() {
    return window.gm.quests.getMilestoneState("qWolfMate").id < 100;
  };

  var _quest10 = new Quest("qWolfMate", "qWolfMate", "qWolfMate", _hidden5);

  _quest10.addMileStone(new QuestMilestone(1, "", "Saw a wolf.", _NOP8, _hidden5));

  _quest10.addMileStone(new QuestMilestone(400, "", "Is that wolf stronger than you? Lets find out.", _NOP8, _hidden5));

  _quest10.addMileStone(new QuestMilestone(500, "", "", _NOP8));

  window.gm.questDef[_quest10.id] = _quest10;
}
{
  // 
  var _NOP9 = function _NOP9() {
    return 0;
  };

  var _hidden6 = function _hidden6() {
    return window.gm.quests.getMilestoneState("qBondageKink").id < 100;
  };

  var _quest11 = new Quest("qBondageKink", "qBondageKink", "qBondageKink", _hidden6);

  _quest11.addMileStone(new QuestMilestone(1, "", "qBondageKink", _NOP9, _hidden6));

  _quest11.addMileStone(new QuestMilestone(100, "", "You got some collar on your neck. Find someone that can check on that.", _NOP9, _hidden6));

  _quest11.addMileStone(new QuestMilestone(200, "", "The alchemist suggested to search for help in the next town. The road along the bridge should lead there.", _NOP9, _hidden6));

  _quest11.addMileStone(new QuestMilestone(300, "", "You found the bridge on your route blocked by a bully. Get rid of him.", _NOP9, _hidden6));

  _quest11.addMileStone(new QuestMilestone(400, "", "Find your way past the bridge to the town.", _NOP9, _hidden6));

  _quest11.addMileStone(new QuestMilestone(500, "", "...", _NOP9, _hidden6));

  window.gm.questDef[_quest11.id] = _quest11;
}
{
  var _NOP10 = function _NOP10() {
    return 0;
  };

  var _hidden7 = function _hidden7() {
    return window.gm.quests.getMilestoneState("qBeastKink").id < 100;
  };

  var _quest12 = new Quest("qBeastKink", "BeastKink", "Humans are fun to fool around with. But how about beasts.", _hidden7);

  _quest12.addMileStone(new QuestMilestone(1, "", "Beasts have sex too.", _NOP10, _hidden7));

  _quest12.addMileStone(new QuestMilestone(400, "", "SEEING is BELIEVING. Catch someone having intercourse with animal.", _NOP10, _hidden7));

  _quest12.addMileStone(new QuestMilestone(500, "", "Maybe you can find a dog or other canine and play with him.", _NOP10));

  window.gm.questDef[_quest12.id] = _quest12;
}
"use strict";

window.gm.jobs = window.gm.jobs || {}; // global definition of repeatable tasks

/*
passage linked to the task
time-schedule; 
used resources; time and energy used
hidden; job is hidden in schedule
disable; job is displayed in schedule but unavailable
critical; indicates that if not done on time there is punishment (just shows the indicator in the sidebar)
onAddTime-CB is called when time passes; can be used to check if task was done on time
 */

var Job = /*#__PURE__*/function () {
  function Job(id, name, descr) {
    _classCallCheck(this, Job);

    this.id = id, this.name = name;
    this.descr = descr, this.reqEnergy = 0, this.reqTime = 0, this.startTimeMin = 0, this.startTimeMax = 0, this.DoW = [], this.onAddTimeCB = null;
  }

  _createClass(Job, [{
    key: "onAddTime",
    value: function onAddTime() {}
  }, {
    key: "isDisabled",
    value: function isDisabled() {
      return false;
    }
  }, {
    key: "disabledReason",
    value: function disabledReason() {
      return "";
    }
  }, {
    key: "isHidden",
    value: function isHidden() {
      return false;
    }
  }]);

  return Job;
}();

{
  var job;
  job = new Job("Campus", "get to the uni", "You have to at least attend some of the lectures to keep up with the studys.");
  job.reqEnergy = 5, job.reqTime = 15, job.startTimeMin = 700, job.startTimeMax = 1100, job.DoW = [1, 2, 3, 4, 5];
  window.gm.jobs[job.id] = job;
  job = new Job("Harcon_work", "work at Hacorn facility", "do a shift at Harcon logistic dept.");
  job.reqEnergy = 10, job.reqTime = 20, job.startTimeMin = 800, job.startTimeMax = 930, job.DoW = [1, 3, 5];

  job.isHidden = function () {
    return !window.gm.quests.hasActiveQuest("qFindAJob", 200);
  };

  window.gm.jobs[job.id] = job;
  job = new Job("Dogsit_NewCall", "Dog-sitting", "You could call the dogsit agency if they have a new job.");
  job.reqEnergy = 20, job.reqTime = 120, job.startTimeMin = 900, job.startTimeMax = 1300, job.DoW = [2, 3, 4];

  job.isHidden = function () {
    return true;
  };

  window.gm.jobs[job.id] = job;
  job = new Job("Home_Study", "Studying", "Do some studying for your graduation.");
  job.reqEnergy = 20, job.reqTime = 120, job.startTimeMin = 700, job.startTimeMax = 1800, job.DoW = [1, 2, 3, 4, 5, 6, 7];

  job.isDisabled = function () {
    return true;
  };

  job.disabledReason = function () {
    return "You are not in the mood to waste your time with books.";
  };

  window.gm.jobs[job.id] = job;
} //todo UNUSED

/**
     * standfaceback
     * standfaceface
     * doggystyle
     * doggystyle3some
     * missionary|mf
     * cowgirl|fm
     * spoon|mf
     * kneelfaceface
     * 69
     */

/*window.gm.sex.fuck = function(style, setup) {
    //style defines number of involved chars and how to interact
    //order of chars defines theire role in position f.e. CharA is giving,CharB is receiving
    //addtional modifiers
    //style = '69|m,m', setup=[{Char:Player},{Char:Carlia}] 
    //m = cock  a=anal f= vagina, o =oral
    let option = style.split('|');
    let genders = option[1].split(',');
    let count =2; //how many partakers expected
    if(option[0]==='doggystyle3some'){

    }
    if(setup.length<count || genders.length<count) throw new Error("requires more parttakers");
    let tools = [];
    let tool;
    for(var i=0;i<count-1;i++) {
        if(genders[i]==='m') {
            tool = setup[i].Char.Outfit.getItemId("bPenis");
        } else if (genders[i]==='f') {
            tool = setup[i].Char.Outfit.getItemId("bVulva");
        } else {
            tool = setup[i].Char.Outfit.getItemId("bAnus");
        }
        tools.push(tool);
    }
    //deposit

    
}*/

window.gm.sex = window.gm.sex || {};

window.gm.sex.createButton = function (label, foo) {
  var link;
  link = document.createElement('a');
  link.href = 'javascript:void(0)';
  link.addEventListener("click", function () {
    foo();
  });
  link.textContent = label;
  $("div#choice")[0].appendChild(link);
}; //cleans up choice-list


window.gm.sex.beginScene = function () {
  for (var i = $("div#choice")[0].childNodes.length - 1; i >= 0; i--) {
    $("div#choice")[0].removeChild($("div#choice")[0].childNodes[i]);
  }
}; //add scenedescription to panel


window.gm.sex.updateScene = function (entry) {
  $("div#panel")[0].appendChild(entry);
};
/*
* calculates which of the generic scenes can play after a battle
*/

/*window.gm.sex.setupPostBattleScene = function(battleResult,sexsceneCB,extra) {
    let s=windows.story.state;
    //s.combat.playerParty  detect scene by available actors?
    let data = {state:0 , battleResul:battleResult, player:s._gm.activePlayer }; //data should not contain objects beause using object.assign!
    data.foes = [];
    for(el of s.combat.enemyParty)
    {
        data.foes.push(String.toLowerCase(el.id));
    }
    data.foes.sort();

}*/


window.gm.sex.wolfOnPlayer = function (data) {
  window.gm.sex.beginScene();
  var entry = document.createElement('p');
  var createButton = window.gm.sex.createButton;
  var newdata = {};

  if (data.state < 0) {
    //quit if scene is done
    if (data.battleResult === 'victory') window.gm.postVictory(); //todo flee, submit, defeat
    else window.gm.postDefeat();
    return;
  } else if (data.state === 0) {
    //start-menu
    if (data.battleResult === 'victory') {
      entry.textContent = "You arent horny enough. | The beast is quite in the mood to fool around. | You need some hard wolfcock right now. "; //todo detect gender,.. -> available position;

      data.state = 'plDomPosSelect';
      Object.assign(newdata, data); //need a copy to create different data-values

      newdata.position = 'Straddle Him';
      createButton(newdata.position, window.gm.sex.wolfOnPlayer.bind(null, newdata));
      newdata = {}, Object.assign(newdata, data);
      newdata.position = 'On all 4';
      createButton(newdata.position, window.gm.sex.wolfOnPlayer.bind(null, newdata));
      newdata = {}, Object.assign(newdata, data);
      newdata.state = -1;
      createButton('Walk away', window.gm.sex.wolfOnPlayer.bind(null, newdata));
    } else {
      entry.textContent = "The creature isnt interested in you.";
      data.state = -1;
      createButton('Pass out', window.gm.sex.wolfOnPlayer.bind(null, data));
    }
  } else if (data.state === 'plDomPosSelect') {
    //each button-click will call this sm again and switch state
    if (data.position === 'On all 4') {
      entry.textContent = "You strip of your gear and drop down on knees and hands.";
    } else {
      entry.textContent = "Rolling the big,bad wuff on its back, you climb on top of it, straddeling him with your naked body.";
    }

    entry.textContent += "The question now is, which of your holes would you like to get filled?"; //todo detect available holes and let select

    data.state = 'plDomHoleSelect';
    Object.assign(newdata, data);
    newdata.hole = "anal";
    createButton(newdata.hole, window.gm.sex.wolfOnPlayer.bind(null, newdata));

    if (window.gm.player.getVagina()) {
      newdata = {}, Object.assign(newdata, data);
      newdata.hole = "vaginal";
      createButton(newdata.hole, window.gm.sex.wolfOnPlayer.bind(null, newdata));
    }
  } else if (data.state === 'plDomHoleSelect') {
    entry.textContent = "The wolf mounts you and drills into your " + data.hole + " opening."; // Surprised, you find your comrade has grown a large lump at the base of its cock that now bumps against your entrance.
    // to late you notice that his knot is already swelling in your thight orifice. You wouldnt be able to dislodge unless he gets his rocks off.

    data.state = 'plDomOrgasm';
    Object.assign(newdata, data);
    createButton("Take it", window.gm.sex.wolfOnPlayer.bind(null, newdata));
  } else if (data.state === 'plDomOrgasm') {
    entry.textContent = "Wolf-jizzm is painting your insides white."; //Unfortunatly, the stud came before you did -- 

    if (data.hole === 'vaginal') {
      window.gm.player.getVagina().addSperm('wolf', 3);
    } else if (data.hole === 'anal') {} //todo insert sperm in hole


    data.state = -1;
    Object.assign(newdata, data);
    createButton("Pass out", window.gm.sex.wolfOnPlayer.bind(null, newdata));
  }

  window.gm.sex.updateScene(entry);
};

"use strict";

var SkillInspect = /*#__PURE__*/function (_Skill) {
  _inherits(SkillInspect, _Skill);

  var _super76 = _createSuper(SkillInspect);

  function SkillInspect() {
    var _this66;

    _classCallCheck(this, SkillInspect);

    _this66 = _super76.call(this, "Inspect");
    _this66.msg = '';
    return _this66;
  }

  _createClass(SkillInspect, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("SkillInspect", this);
    }
  }, {
    key: "targetFilter",
    value: function targetFilter(targets) {
      return this.targetFilterEnemy(this.targetFilterAlive(targets));
    }
  }, {
    key: "previewCast",
    value: function previewCast(targets) {
      var result = new SkillResult();
      result.skill = this;
      result.source = this.caster;
      result.targets = targets;
      this.msg = '';

      if (this.isValidTarget(targets)) {
        result.OK = true;
        result.msg = this.msg = window.gm.printBodyDescription(targets[0], true); //todo display stats dependign on skill
      }

      return result;
    }
  }, {
    key: "getCastDescription",
    value: function getCastDescription(result) {
      return this.msg;
    }
  }, {
    key: "desc",
    get: function get() {
      return "Check out your foe.";
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(SkillInspect, value.data);
    }
  }]);

  return SkillInspect;
}(Skill); //execute simple attack with active weapon or claws


var SkillAttack = /*#__PURE__*/function (_Skill2) {
  _inherits(SkillAttack, _Skill2);

  var _super77 = _createSuper(SkillAttack);

  function SkillAttack() {
    var _this67;

    _classCallCheck(this, SkillAttack);

    _this67 = _super77.call(this, "Attack");
    _this67.msg = '';
    _this67.weapon = '';
    return _this67;
  }

  _createClass(SkillAttack, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("SkillAttack", this);
    }
  }, {
    key: "targetFilter",
    value: function targetFilter(targets) {
      return this.targetFilterEnemy(this.targetFilterAlive(targets));
    }
  }, {
    key: "previewCast",
    value: function previewCast(targets) {
      var result = new SkillResult();
      result.skill = this;
      result.source = this.caster;
      result.targets = targets;
      this.msg = '';

      if (this.isValidTarget(targets)) {
        result.OK = true;

        var _iterator55 = _createForOfIteratorHelper(targets),
            _step55;

        try {
          for (_iterator55.s(); !(_step55 = _iterator55.n()).done;) {
            var target = _step55.value;

            var attack = this.__estimateAttack(target);

            var result2 = window.gm.combat.calcAttack(this.caster, target, attack);
            this.msg += result2.msg;
            result.effects = result.effects.concat(attack.effects);
          }
        } catch (err) {
          _iterator55.e(err);
        } finally {
          _iterator55.f();
        }
      }

      return result;
    }
  }, {
    key: "__estimateAttack",
    value: function __estimateAttack(target) {
      var attack = window.gm.combat.defaultAttackData();
      var lHand = this.caster.Outfit.getItemForSlot(window.gm.OutfitSlotLib.LHand);
      var rHand = this.caster.Outfit.getItemForSlot(window.gm.OutfitSlotLib.RHand);
      attack.mod = new SkillMod();
      var lHDmg = 0,
          rHDmg = 0;

      if (rHand) {
        //get weapon damage info
        attack.mod = rHand.attackMod(target);
      } else if (lHand) {
        //todo dual wield?
        attack.mod = lHand.attackMod(target);
      }

      if (!lHand && !rHand) {
        //if has no weapon get body damage
        rHand = this.caster.Outfit.getItemForSlot(window.gm.OutfitSlotLib.bHands);

        if (rHand && rHand.attackMod) {
          attack.mod = rHand.attackMod(target);
        }
      }

      return attack;
    }
  }, {
    key: "getCastDescription",
    value: function getCastDescription(result) {
      return this.msg;
    }
  }, {
    key: "desc",
    get: function get() {
      return "Use weapon or claws to deal damage.";
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(SkillAttack, value.data);
    }
  }]);

  return SkillAttack;
}(Skill);
/*    __estimateAttack() {
        let attack =window.gm.combat.defaultAttackData();
        let lHand=this.caster.Outfit.getItemForSlot(window.gm.OutfitSlotLib.LHand);
        let rHand=this.caster.Outfit.getItemForSlot(window.gm.OutfitSlotLib.RHand);
        let rHDmg;
        if(rHand) { //get weapon damage info
            rHDmg = rHand.attack;
        } else if(lHand) { 
            rHDmg = lHand.attack;
        }
        if(!lHand && ! rHand) { //if has no weapon get body damage
            rHand=this.caster.Outfit.getItemForSlot(window.gm.OutfitSlotLib.bHands);
            if(rHand) {
                rHDmg = (rHand.data!=='undefined')?rHand.data.attack || 0:0;
            }
        }
        attack.input=rHDmg;
        return(attack);
    }
*/


var SkillSmash = /*#__PURE__*/function (_SkillAttack) {
  _inherits(SkillSmash, _SkillAttack);

  var _super78 = _createSuper(SkillSmash);

  function SkillSmash() {
    var _this68;

    _classCallCheck(this, SkillSmash);

    _this68 = _super78.call(this);
    _this68.id = _this68.name = 'Smash';
    _this68.msg = '';
    _this68.weapon = '';
    return _this68;
  }

  _createClass(SkillSmash, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("SkillSmash", this);
    }
  }, {
    key: "previewCast",
    value: function previewCast(targets) {
      var result = new SkillResult();
      result.skill = this;
      result.source = this.caster;
      result.targets = targets;
      this.msg = '';

      if (this.isValidTarget(targets)) {
        result.OK = true;

        var _iterator56 = _createForOfIteratorHelper(targets),
            _step56;

        try {
          for (_iterator56.s(); !(_step56 = _iterator56.n()).done;) {
            var target = _step56.value;
            var attack = window.gm.combat.defaultAttackData(); //get data from weapon

            var _mod = this.parent.parent.Outfit.getItem(this.weapon).attackMod(target); //modify chance& values depending on stats??


            attack.mod = _mod;
            var result2 = window.gm.combat.calcAttack(this.caster, target, attack);
            this.msg += result2.msg;
            result.effects = result.effects.concat(attack.effects);
          }
        } catch (err) {
          _iterator56.e(err);
        } finally {
          _iterator56.f();
        }
      }

      return result;
    }
  }, {
    key: "desc",
    get: function get() {
      return "Use " + this.weapon;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(SkillSmash, value.data);
    }
  }]);

  return SkillSmash;
}(SkillAttack);

var SkillUltraKill = /*#__PURE__*/function (_SkillAttack2) {
  _inherits(SkillUltraKill, _SkillAttack2);

  var _super79 = _createSuper(SkillUltraKill);

  function SkillUltraKill() {
    var _this69;

    _classCallCheck(this, SkillUltraKill);

    _this69 = _super79.call(this);
    _this69.id = _this69.name = 'UltraKill';
    _this69.msg = '';
    return _this69;
  }

  _createClass(SkillUltraKill, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("SkillUltraKill", this);
    }
  }, {
    key: "__estimateAttack",
    value: function __estimateAttack(target) {
      var attack = window.gm.combat.defaultAttackData();
      attack.mod = new SkillMod();
      attack.mod.onHit = [{
        target: target,
        eff: [effDamage.setup(99999, 'blunt')]
      }];
      return attack;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(SkillUltraKill, value.data);
    }
  }]);

  return SkillUltraKill;
}(SkillAttack); //execute attack with Face


var SkillBite = /*#__PURE__*/function (_SkillAttack3) {
  _inherits(SkillBite, _SkillAttack3);

  var _super80 = _createSuper(SkillBite);

  function SkillBite() {
    var _this70;

    _classCallCheck(this, SkillBite);

    _this70 = _super80.call(this);
    _this70.id = _this70.name = 'Bite';
    _this70.msg = '';
    return _this70;
  }

  _createClass(SkillBite, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("SkillBite", this);
    }
  }, {
    key: "__estimateAttack",
    value: function __estimateAttack(target) {
      var attack = window.gm.combat.defaultAttackData();
      var mouth = this.caster.Outfit.getItemForSlot(window.gm.OutfitSlotLib.bMouth);
      attack.mod = new SkillMod();

      if (mouth && mouth.attackMod) {
        //get teeth damage info
        attack.mod = mouth.attackMod(target);
      }

      return attack;
    }
  }, {
    key: "desc",
    get: function get() {
      return "Use your maw to bite the foe.";
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(SkillBite, value.data);
    }
  }]);

  return SkillBite;
}(SkillAttack);

var SkillChainLightning = /*#__PURE__*/function (_Skill3) {
  _inherits(SkillChainLightning, _Skill3);

  var _super81 = _createSuper(SkillChainLightning);

  function SkillChainLightning() {
    var _this71;

    _classCallCheck(this, SkillChainLightning);

    _this71 = _super81.call(this, 'ChainLightning');
    _this71.msg = '';
    return _this71;
  }

  _createClass(SkillChainLightning, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("SkillChainLightning", this);
    }
  }, {
    key: "targetFilter",
    value: function targetFilter(targets) {
      return this.targetFilterEnemy(this.targetFilterAlive(targets));
    }
  }, {
    key: "previewCast",
    value: function previewCast(targets) {
      var result = new SkillResult();
      result.skill = this;
      result.source = this.caster;
      result.targets = targets;
      this.msg = '';

      if (this.isValidTarget(targets)) {
        result.OK = true;
        var target = targets[0];
        var attack = window.gm.combat.defaultAttackData(); // attack.effects.push(effDamage.setup(15,'spark'))
        //calc hit-chance
        //cause spark-dmg
        //chance to hit secondary target

        var secTarget = window.story.state.combat.playerParty.concat(window.story.state.combat.enemyParty);
        secTarget = this.targetFilterEnemy(this.targetFilterAlive(secTarget));
        var secTarget2 = [];

        while (secTarget.length > _i) {
          var target2 = secTarget.pop()[0]; //[[mob1]]

          if (target2 !== target) {
            secTarget2.push(target2);
          }

          if (secTarget2.length >= 2) break;
        } //spark-dmg to secondary target


        var result2 = window.gm.combat.calcTeaseAttack(this.caster, target, attack);
        this.msg += result2.msg;
        result.effects = result.effects.concat(attack.effects);
      }

      return result;
    }
  }, {
    key: "getCastDescription",
    value: function getCastDescription(result) {
      return this.msg;
    }
  }, {
    key: "desc",
    get: function get() {
      return "Throw some sparks at your foes.";
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(SkillChainLightning, value.data);
    }
  }]);

  return SkillChainLightning;
}(Skill);

var SkillTease = /*#__PURE__*/function (_Skill4) {
  _inherits(SkillTease, _Skill4);

  var _super82 = _createSuper(SkillTease);

  function SkillTease() {
    var _this72;

    _classCallCheck(this, SkillTease);

    _this72 = _super82.call(this, "Tease");
    _this72.msg = '';
    _this72.magnitude = 0.5;
    return _this72;
  }

  _createClass(SkillTease, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("SkillTease", this);
    }
  }, {
    key: "targetFilter",
    value: function targetFilter(targets) {
      return this.targetFilterEnemy(this.targetFilterAlive(targets));
    }
  }, {
    key: "previewCast",
    value: function previewCast(targets) {
      var result = new SkillResult();
      result.skill = this;
      result.source = this.caster;
      result.targets = targets;
      this.msg = '';

      if (this.isValidTarget(targets)) {
        result.OK = true;
        var dmg = 5; //tease depends on teaseproficiency, clothing slutiness/nudeness,own arousal

        if (this.parent.parent.Stats.getItem('arousal').value > 40) dmg += 5;
        dmg *= Math.max(0, this.magnitude * this.__slutDetector(this.caster));
        this.msg = 'Shaking his hips, xxx trys to arouse the audience.'; //todo

        var _iterator57 = _createForOfIteratorHelper(targets),
            _step57;

        try {
          for (_iterator57.s(); !(_step57 = _iterator57.n()).done;) {
            var target = _step57.value;
            var attack = window.gm.combat.defaultAttackData();
            attack.mod = new SkillMod();
            attack.mod.onHit = [{
              target: target,
              eff: [effTeaseDamage.setup(dmg)]
            }];
            var result2 = window.gm.combat.calcTeaseAttack(this.caster, target, attack);
            this.msg += result2.msg;
            result.effects = result.effects.concat(attack.effects);
          }
        } catch (err) {
          _iterator57.e(err);
        } finally {
          _iterator57.f();
        }
      }

      return result;
    }
  }, {
    key: "__slutDetector",
    value: function __slutDetector(target) {
      var x = 1;
      var lewd = this.caster.Outfit.getLewdness();
      if (lewd.slut > 3) x += 0.1; //todo bondage 

      if (lewd.slut > 6) x += 0.1;
      return x;
    }
  }, {
    key: "getCastDescription",
    value: function getCastDescription(result) {
      return this.msg;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(SkillTease, value.data);
    }
  }]);

  return SkillTease;
}(Skill);

var SkillStun = /*#__PURE__*/function (_Skill5) {
  _inherits(SkillStun, _Skill5);

  var _super83 = _createSuper(SkillStun);

  //execute stun attack
  function SkillStun() {
    var _this73;

    _classCallCheck(this, SkillStun);

    _this73 = _super83.call(this, "Stun");
    _this73.cost.energy = 20;
    return _this73;
  }

  _createClass(SkillStun, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("SkillStun", this);
    }
  }, {
    key: "targetFilter",
    value: function targetFilter(targets) {
      var possibletarget = this.targetFilterFighting(this.targetFilterEnemy(targets)); //[[mole1],[mole2]]

      var multi = [];
      multi.name = "all";

      var _iterator58 = _createForOfIteratorHelper(possibletarget),
          _step58;

      try {
        for (_iterator58.s(); !(_step58 = _iterator58.n()).done;) {
          var el = _step58.value;
          if (el.length === 1) //dont stack multi-targets
            multi.push(el[0]);
        }
      } catch (err) {
        _iterator58.e(err);
      } finally {
        _iterator58.f();
      }

      if (multi.length > 1) possibletarget.push(multi); //if there is only [[mole]] we dont want [[mole],[mole]]

      return possibletarget; //[[mole1],[mole2],[mole1,mole2]]
    }
  }, {
    key: "previewCast",
    value: function previewCast(targets) {
      var result = new SkillResult();
      result.skill = this;
      result.source = this.caster;
      result.targets = targets;

      if (this.isValidTarget(targets)) {
        result.OK = true;

        var _iterator59 = _createForOfIteratorHelper(targets),
            _step59;

        try {
          for (_iterator59.s(); !(_step59 = _iterator59.n()).done;) {
            var target = _step59.value;
            result.effects.push({
              target: target,
              eff: [new effStunned()]
            });
          }
        } catch (err) {
          _iterator59.e(err);
        } finally {
          _iterator59.f();
        }
      }

      return result;
    }
  }, {
    key: "getCastDescription",
    value: function getCastDescription(result) {
      //update msg after sucessful cast
      return this.caster.name + " stunned " + (result.targets.length > 1 ? result.targets.name : result.targets[0].name) + ".";
    }
  }, {
    key: "desc",
    get: function get() {
      return "A successful stun lowers the foes chance to evade and might disable them for some time. " + this.getCost().asText();
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(SkillStun, value.data);
    }
  }]);

  return SkillStun;
}(Skill);

var SkillPoisonCloud = /*#__PURE__*/function (_Skill6) {
  _inherits(SkillPoisonCloud, _Skill6);

  var _super84 = _createSuper(SkillPoisonCloud);

  function SkillPoisonCloud() {
    var _this74;

    _classCallCheck(this, SkillPoisonCloud);

    _this74 = _super84.call(this, "PoisonCloud");
    _this74.cost.energy = 20;
    _this74.amount = 4;
    return _this74;
  }

  _createClass(SkillPoisonCloud, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("SkillPoisonCloud", this);
    }
  }, {
    key: "targetFilter",
    value: function targetFilter(targets) {
      return this.targetFilterFighting(this.targetFilterEnemy(targets));
    }
  }, {
    key: "previewCast",
    value: function previewCast(targets) {
      var result = new SkillResult();
      result.skill = this;
      result.source = this.caster;
      result.targets = targets;

      if (this.isValidTarget(targets)) {
        result.OK = true;

        var _iterator60 = _createForOfIteratorHelper(targets),
            _step60;

        try {
          for (_iterator60.s(); !(_step60 = _iterator60.n()).done;) {
            var target = _step60.value;
            var attack = window.gm.combat.defaultAttackData();
            attack.mod = new SkillMod();
            attack.mod.onHit = [{
              target: target,
              eff: [effDamage.setup(this.amount, 'poison')]
            }];
            var result2 = window.gm.combat.calcAttack(this.caster, target, attack);
            this.msg += result2.msg;
            result.effects = result.effects.concat(attack.effects);
          }
        } catch (err) {
          _iterator60.e(err);
        } finally {
          _iterator60.f();
        }
      }

      return result;
    }
  }, {
    key: "getCastDescription",
    value: function getCastDescription(result) {
      return this.caster.name + " poisons " + result.targets.name + ".";
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(SkillPoisonCloud, value.data);
    }
  }]);

  return SkillPoisonCloud;
}(Skill);

var SkillHeal = /*#__PURE__*/function (_Skill7) {
  _inherits(SkillHeal, _Skill7);

  var _super85 = _createSuper(SkillHeal);

  function SkillHeal() {
    var _this75;

    _classCallCheck(this, SkillHeal);

    _this75 = _super85.call(this, "Heal");
    _this75.cost.will = 25;
    return _this75;
  }

  _createClass(SkillHeal, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("SkillHeal", this);
    }
  }, {
    key: "targetFilter",
    value: function targetFilter(targets) {
      return this.targetFilterAlly(this.targetFilterAlive(targets));
    }
  }, {
    key: "previewCast",
    value: function previewCast(targets) {
      var result = new SkillResult();
      result.skill = this;
      result.source = this.caster;
      result.targets = targets;

      if (this.isValidTarget(targets)) {
        result.OK = true;

        var _iterator61 = _createForOfIteratorHelper(targets),
            _step61;

        try {
          for (_iterator61.s(); !(_step61 = _iterator61.n()).done;) {
            var target = _step61.value;
            result.effects.push({
              target: target,
              eff: [new effHeal(10)]
            });
          }
        } catch (err) {
          _iterator61.e(err);
        } finally {
          _iterator61.f();
        }
      }

      return result;
    }
  }, {
    key: "desc",
    get: function get() {
      return "Restore some health. " + this.getCost().asText();
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(SkillHeal, value.data);
    }
  }]);

  return SkillHeal;
}(Skill);

var SkillFlee = /*#__PURE__*/function (_Skill8) {
  _inherits(SkillFlee, _Skill8);

  var _super86 = _createSuper(SkillFlee);

  function SkillFlee() {
    var _this76;

    _classCallCheck(this, SkillFlee);

    _this76 = _super86.call(this, "Flee");
    _this76.msg = '';
    return _this76;
  }

  _createClass(SkillFlee, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("SkillFlee", this);
    }
  }, {
    key: "targetFilter",
    value: function targetFilter(targets) {
      return this.targetFilterSelf(targets);
    }
  }, {
    key: "previewCast",
    value: function previewCast(targets) {
      var result = new SkillResult();
      this.msg = '';
      result.skill = this, result.source = this.caster, result.targets = targets;

      if (this.isValidTarget(targets)) {
        result.OK = true;

        var rnd = _.random(1, 100);

        if (rnd > 40) {
          //Todo fleeing chance calculation
          result.msg += "You escaped the fight.";
          window.story.state.combat.playerFleeing = true; //just setting the flag, you have to take care of handling!
        } else {
          result.msg += "Your attempts to escape failed."; //result.OK=false;
        }

        this.msg = result.msg;
      }

      return result;
    }
  }, {
    key: "getCastDescription",
    value: function getCastDescription(result) {
      return this.msg;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(SkillFlee, value.data);
    }
  }]);

  return SkillFlee;
}(Skill);

var SkillSubmit = /*#__PURE__*/function (_Skill9) {
  _inherits(SkillSubmit, _Skill9);

  var _super87 = _createSuper(SkillSubmit);

  function SkillSubmit() {
    var _this77;

    _classCallCheck(this, SkillSubmit);

    _this77 = _super87.call(this, "Submit");
    _this77.msg = '';
    return _this77;
  }

  _createClass(SkillSubmit, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("SkillSubmit", this);
    }
  }, {
    key: "targetFilter",
    value: function targetFilter(targets) {
      return this.targetFilterSelf(targets);
    }
  }, {
    key: "previewCast",
    value: function previewCast(targets) {
      var result = new SkillResult();
      this.msg = '';
      result.skill = this, result.source = this.caster, result.targets = targets;

      if (this.isValidTarget(targets)) {
        result.OK = true;

        var rnd = _.random(1, 100);

        if (rnd > 0) {
          //Todo fleeing chance calculation
          result.msg += "You submit to your foe.";
          window.story.state.combat.playerSubmitting = true; //just setting the flag, you have to take care of handling!
        } else {
          result.msg += "Your attempts to submit failed."; //result.OK=false;
        }

        this.msg = result.msg;
      }

      return result;
    }
  }, {
    key: "getCastDescription",
    value: function getCastDescription(result) {
      return this.msg;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(SkillSubmit, value.data);
    }
  }]);

  return SkillSubmit;
}(Skill);

var SkillGrapple = /*#__PURE__*/function (_Skill10) {
  _inherits(SkillGrapple, _Skill10);

  var _super88 = _createSuper(SkillGrapple);

  function SkillGrapple() {
    var _this78;

    _classCallCheck(this, SkillGrapple);

    _this78 = _super88.call(this, "Grapple");
    _this78.msg = '';
    return _this78;
  }

  _createClass(SkillGrapple, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("SkillGrapple", this);
    }
  }, {
    key: "targetFilter",
    value: function targetFilter(targets) {
      return this.targetFilterEnemy(this.targetFilterAlive(targets));
    }
  }, {
    key: "previewCast",
    value: function previewCast(targets) {
      var result = new SkillResult();
      this.msg = '';
      result.skill = this;
      result.source = this.caster;
      result.targets = targets;

      if (this.isValidTarget(targets)) {
        result.OK = true;
        var target = targets[0];

        var rnd = _.random(0, 100);

        if (rnd > 30) {
          //todo chance to grapple depends on?
          var x = effGrappled.factory(); //target get grappled effect and caster grappling until the grapple is undone

          result.effects.push({
            target: this.caster,
            eff: [x.sourceEff]
          });
          result.effects.push({
            target: target,
            eff: [x.targetEff]
          });
        }
      }

      this.msg = result.msg;
      return result;
    }
  }, {
    key: "getCastDescription",
    value: function getCastDescription(result) {
      return this.msg;
    }
  }, {
    key: "desc",
    get: function get() {
      return "Grapple the opponent to restrict his movement.";
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(SkillGrapple, value.data);
    }
  }]);

  return SkillGrapple;
}(Skill); //char attaches itself to target and sucks health


var SkillLeechHealth = /*#__PURE__*/function (_Skill11) {
  _inherits(SkillLeechHealth, _Skill11);

  var _super89 = _createSuper(SkillLeechHealth);

  function SkillLeechHealth() {
    var _this79;

    _classCallCheck(this, SkillLeechHealth);

    _this79 = _super89.call(this, "Leech");
    _this79.msg = '';
    return _this79;
  }

  _createClass(SkillLeechHealth, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("SkillLeechHealth", this);
    }
  }, {
    key: "targetFilter",
    value: function targetFilter(targets) {
      return this.targetFilterEnemy(this.targetFilterAlive(targets));
    }
  }, {
    key: "previewCast",
    value: function previewCast(targets) {
      var result = new SkillResult();
      this.msg = '';
      result.skill = this;
      result.source = this.caster;
      result.targets = targets;

      if (this.isValidTarget(targets)) {
        result.OK = true;
        var target = targets[0];

        var rnd = _.random(0, 100);

        if (rnd > 30) {
          //todo chance to grapple depends on?
          var x = effGrappled.factory();

          this.__combineGrabAndLeech(x.targetEff, x.sourceEff);

          result.effects.push({
            target: this.caster,
            eff: [x.sourceEff]
          }); //,heal,leeching]

          result.effects.push({
            target: target,
            eff: [x.targetEff]
          }); //im
        }
      }

      this.msg = result.msg;
      return result;
    }
  }, {
    key: "__combineGrabAndLeech",
    value: function __combineGrabAndLeech(grabEff, grapplingEff) {
      grapplingEff.onTurnStart = function (me) {
        var eff = grapplingEff;

        var _old = eff.onTurnStart.bind(eff);

        var foo = function foo() {
          _old(); //override  but call orignial fct


          eff.parent.parent.Stats.increment('health', 5); //todo scale by ??
        };

        return foo;
      }(this);

      grabEff.onTurnStart = function (me) {
        var eff = grabEff;

        var _old = eff.onTurnStart.bind(eff);

        var foo = function foo() {
          _old(); //override  but call orignial fct


          eff.parent.parent.Stats.increment('health', -5);
        };

        return foo;
      }(this);
    }
  }, {
    key: "getCastDescription",
    value: function getCastDescription(result) {
      return this.msg;
    }
  }, {
    key: "desc",
    get: function get() {
      return "Grapple the opponent and suck the life from him.";
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(SkillLeechHealth, value.data);
    }
  }]);

  return SkillLeechHealth;
}(Skill); //try to ungrapple


var SkillStruggle = /*#__PURE__*/function (_Skill12) {
  _inherits(SkillStruggle, _Skill12);

  var _super90 = _createSuper(SkillStruggle);

  //todo improves defense
  function SkillStruggle() {
    var _this80;

    _classCallCheck(this, SkillStruggle);

    _this80 = _super90.call(this, "Struggle");
    _this80.msg = '';
    return _this80;
  }

  _createClass(SkillStruggle, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("SkillStruggle", this);
    }
  }, {
    key: "targetFilter",
    value: function targetFilter(targets) {
      return this.targetFilterSelf(targets);
    }
  }, {
    key: "isEnabled",
    value: function isEnabled() {
      var res = _get(_getPrototypeOf(SkillStruggle.prototype), "isEnabled", this).call(this);

      if (res.OK === false) return res;
      var x = !(this.parent.parent.Effects.countItem(effGrappled.name) <= 0);
      return {
        OK: x,
        msg: ''
      };
    }
  }, {
    key: "previewCast",
    value: function previewCast(targets) {
      var result = new SkillResult();
      this.msg = '';
      result.skill = this;
      result.source = this.caster;
      result.targets = targets;

      if (this.isValidTarget(targets)) {
        result.OK = true;

        var _iterator62 = _createForOfIteratorHelper(targets),
            _step62;

        try {
          for (_iterator62.s(); !(_step62 = _iterator62.n()).done;) {
            var target = _step62.value;

            if (target.Effects.countItem(effGrappled.name) > 0) {
              var rnd = _.random(0, 100);

              var eff = target.Effects.get(effGrappled.name);
              result.msg = "Attempts to escape the grapple failed.";

              if (rnd > 30) {
                //todo chance to ungrapple increase over time
                result.effects.push({
                  target: target,
                  eff: [new effUngrappling(eff)]
                });
                result.msg = this.caster.name + " was able to escape from " + eff.source.parent.parent.name + ".";
              }
            }
          }
        } catch (err) {
          _iterator62.e(err);
        } finally {
          _iterator62.f();
        }
      }

      this.msg = result.msg;
      return result;
    }
  }, {
    key: "getCastDescription",
    value: function getCastDescription(result) {
      return this.msg;
    }
  }, {
    key: "desc",
    get: function get() {
      return "Try to escape a grapple.";
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(SkillStruggle, value.data);
    }
  }]);

  return SkillStruggle;
}(Skill);

var SkillGuard = /*#__PURE__*/function (_Skill13) {
  _inherits(SkillGuard, _Skill13);

  var _super91 = _createSuper(SkillGuard);

  function SkillGuard() {
    _classCallCheck(this, SkillGuard);

    return _super91.call(this, "Guard");
  }

  _createClass(SkillGuard, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("SkillGuard", this);
    }
  }, {
    key: "targetFilter",
    value: function targetFilter(targets) {
      return this.targetFilterSelf(targets);
    }
  }, {
    key: "previewCast",
    value: function previewCast(targets) {
      var result = new SkillResult();
      result.skill = this;
      result.source = this.caster;
      result.targets = targets;

      if (this.isValidTarget(targets)) {
        result.OK = true;

        var _iterator63 = _createForOfIteratorHelper(targets),
            _step63;

        try {
          for (_iterator63.s(); !(_step63 = _iterator63.n()).done;) {
            /*result.effects.push( {target:target,
                eff:[new effHeal(10)]})*/

            var target = _step63.value;
          }
        } catch (err) {
          _iterator63.e(err);
        } finally {
          _iterator63.f();
        }
      }

      return result;
    }
  }, {
    key: "desc",
    get: function get() {
      return "Boosts your defense.";
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(SkillGuard, value.data);
    }
  }]);

  return SkillGuard;
}(Skill);

var SkillUseItem = /*#__PURE__*/function (_Skill14) {
  _inherits(SkillUseItem, _Skill14);

  var _super92 = _createSuper(SkillUseItem);

  function SkillUseItem() {
    var _this81;

    _classCallCheck(this, SkillUseItem);

    _this81 = _super92.call(this, "UseItem");
    _this81.item = '';
    _this81.msg = '';
    return _this81;
  }

  _createClass(SkillUseItem, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("SkillUseItem", this);
    }
  }, {
    key: "targetFilter",
    // first item has to be set
    // then when targetFilter is called, forward the filterrequest to the item
    // the item has to implement targetFilter and also check if the item is valid for use in combat    
    value: function targetFilter(targets) {
      return this.caster.Inv.getItem(this.item).targetFilter(targets, this);
    }
  }, {
    key: "previewCast",
    value: function previewCast(targets) {
      var result = new SkillResult();
      result.skill = this;
      result.source = this.caster;
      result.targets = targets;

      if (this.isValidTarget(targets)) {
        result.OK = true;
        this.msg = result.msg = this.caster.Inv.use(this.item, targets).msg; //Todo preview shouldnt call use !
      }

      return result;
    }
  }, {
    key: "getCastDescription",
    value: function getCastDescription(result) {
      return this.msg;
    }
  }, {
    key: "item",
    get: function get() {
      return this._item;
    },
    set: function set(item) {
      this._item = item;
      this.msg = '';
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(SkillUseItem, value.data);
    }
  }]);

  return SkillUseItem;
}(Skill); //calls reinforcement; set item before casting to the mob-name to spawn


var SkillCallHelp = /*#__PURE__*/function (_Skill15) {
  _inherits(SkillCallHelp, _Skill15);

  var _super93 = _createSuper(SkillCallHelp);

  _createClass(SkillCallHelp, null, [{
    key: "setup",
    value: function setup(item) {
      var sk = new SkillCallHelp();
      sk.item = item; //todo delay and cooldown

      return sk;
    }
  }]);

  function SkillCallHelp() {
    var _this82;

    _classCallCheck(this, SkillCallHelp);

    _this82 = _super93.call(this, "CallHelp");
    _this82.item = '';
    return _this82;
  }

  _createClass(SkillCallHelp, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("SkillCallHelp", this);
    }
  }, {
    key: "targetFilter",
    value: function targetFilter(targets) {
      return this.targetFilterSelf(targets);
    }
  }, {
    key: "previewCast",
    value: function previewCast(targets) {
      var result = new SkillResult();
      result.skill = this, result.source = this.caster, result.targets = targets;

      if (this.isValidTarget(targets)) {
        result.OK = true;

        var _iterator64 = _createForOfIteratorHelper(targets),
            _step64;

        try {
          for (_iterator64.s(); !(_step64 = _iterator64.n()).done;) {
            var target = _step64.value;
            var eff = new effCallHelp();
            eff.configureSpawn(this.item, this.caster.faction);
            result.effects.push({
              target: target,
              eff: [eff]
            });
          }
        } catch (err) {
          _iterator64.e(err);
        } finally {
          _iterator64.f();
        }
      }

      return result;
    }
  }, {
    key: "getCastDescription",
    value: function getCastDescription(result) {
      return "Calls some " + this.item + " as reinforcement.";
    }
  }, {
    key: "desc",
    get: function get() {
      return "Summon " + this.item;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(SkillCallHelp, value.data);
    }
  }]);

  return SkillCallHelp;
}(Skill);

window.gm.SkillsLib = function (Lib) {
  window.storage.registerConstructor(SkillAttack);
  window.storage.registerConstructor(SkillBite);
  window.storage.registerConstructor(SkillCallHelp);
  window.storage.registerConstructor(SkillGrapple);
  window.storage.registerConstructor(SkillFlee);
  window.storage.registerConstructor(SkillGuard);
  window.storage.registerConstructor(SkillHeal);
  window.storage.registerConstructor(SkillInspect);
  window.storage.registerConstructor(SkillPoisonCloud);
  window.storage.registerConstructor(SkillSmash);
  window.storage.registerConstructor(SkillStun);
  window.storage.registerConstructor(SkillSubmit);
  window.storage.registerConstructor(SkillStruggle);
  window.storage.registerConstructor(SkillTease);
  window.storage.registerConstructor(SkillUltraKill);
  window.storage.registerConstructor(SkillUseItem); //    Lib['SkillAttack'] = function () { return new SkillAttack();};

  return Lib;
}(window.gm.SkillsLib || {});
/*todo 
Slash: (weapontype) causes slash-damage; chance to cause bleed on critical (on non-constructs/conjuration)

Stoneskin: (passive) if a slash-attack would cause bleed; attackers weapon gets blunted for rest of fight

GolemCrusher: increased blunt-damage against golems

LifeDrain: soul-damage; restores health equal to fraction of damage caused on living

Supraconductor: incoming ice-damage has chance to increase spark-damage output for some turns; but fire-damage has the oposite effect

BladeMace: deals slash or blunt-damage depending which would cause more damage

PoisonCloud: small damage over time to lifing  
 */


"use strict"; //this is special stat used together with Relation-collection
//person is used as id instead of stat-name


var stRelation = /*#__PURE__*/function (_Stat) {
  _inherits(stRelation, _Stat);

  var _super94 = _createSuper(stRelation);

  _createClass(stRelation, null, [{
    key: "setup",
    value: function setup(context, base, max, person) {
      //todo Max-Limit
      var _stat = new stRelation();

      var _n = _stat.data;
      _n.id = person + "_Max", _n.base = max, _n.value = max, _n.limits = [{
        max: 999,
        min: -999
      }];
      context.addItem(_stat);
      _stat = new stRelation();
      _n = _stat.data;
      _n.id = person + "_Min", _n.base = 0, _n.value = 0, _n.limits = [{
        max: 999,
        min: -999
      }];
      context.addItem(_stat);
      _stat = new stRelation();
      _n = _stat.data;
      _n.id = person, _n.base = base, _n.value = base, _n.limits = [{
        max: person + "_Max",
        min: person + "_Min"
      }];
      context.addItem(_stat);

      _stat.Calc();
    }
  }]);

  function stRelation() {
    _classCallCheck(this, stRelation);

    return _super94.call(this);
  }

  _createClass(stRelation, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("stRelation", this);
    }
  }, {
    key: "formatMsgStatChange",
    value: function formatMsgStatChange(attr, _new, _old) {
      if (_new - _old > 0) {
        return '<statup>Your relation to ' + attr.id + " improved by " + (_new - _old).toFixed(1).toString() + "</statup>";
      } else if (_new - _old < 0) {
        return '<statdown>Your relation to ' + attr.id + " worsend by " + (_new - _old).toFixed(1).toString() + "</statdown>";
      } else {
        return 'Your relation to ' + attr.id + " wasnt affected at all by your behaviour.</br>";
      }
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(stRelation, value.data);
    }
  }]);

  return stRelation;
}(Stat); //generic class for resistance to damage like blunt, fire, poison,...
// Resistance is modified by effects (applied by equipment/perks/items) and stats
// 0 = no bonus resistance; -20 = 20% weaker ; capped at +-100% ?


var stResistance = /*#__PURE__*/function (_Stat2) {
  _inherits(stResistance, _Stat2);

  var _super95 = _createSuper(stResistance);

  _createClass(stResistance, null, [{
    key: "setup",
    value: function setup(context, base, kind) {
      var _stat = new stResistance();

      var _n = _stat.data;
      _n.id = "rst" + kind, _n.base = base, _n.value = base, _n.limits = [{
        max: 100,
        min: -100
      }];
      context.addItem(_stat);

      _stat.Calc();
    }
  }]);

  function stResistance() {
    _classCallCheck(this, stResistance);

    return _super95.call(this);
  }

  _createClass(stResistance, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("stResistance", this);
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(stResistance, value.data);
    }
  }]);

  return stResistance;
}(Stat); //generic class for armor


var stArmor = /*#__PURE__*/function (_Stat3) {
  _inherits(stArmor, _Stat3);

  var _super96 = _createSuper(stArmor);

  _createClass(stArmor, null, [{
    key: "setup",
    value: function setup(context, base, name) {
      var _stat = new stArmor();

      var _n = _stat.data;
      _n.id = "arm" + name, _n.base = base, _n.value = base, _n.limits = [{
        max: 999999,
        min: 0
      }];
      context.addItem(_stat);

      _stat.Calc();
    }
  }]);

  function stArmor() {
    _classCallCheck(this, stArmor);

    return _super96.call(this);
  }

  _createClass(stArmor, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("stArmor", this);
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(stArmor, value.data);
    }
  }]);

  return stArmor;
}(Stat);

var stHealthMax = /*#__PURE__*/function (_Stat4) {
  _inherits(stHealthMax, _Stat4);

  var _super97 = _createSuper(stHealthMax);

  _createClass(stHealthMax, null, [{
    key: "setup",
    value: function setup(context, max) {
      var _stat = new stHealthMax();

      var _n = _stat.data;
      _n.id = 'healthMax', _n.base = max, _n.value = max, _n.modifys = [{
        id: 'health'
      }], _n.limits = [{
        max: 99999,
        min: 0
      }];
      context.addItem(_stat); //_stat.Calc(); cause problem because health not yet present
    }
  }]);

  function stHealthMax() {
    _classCallCheck(this, stHealthMax);

    return _super97.call(this);
  }

  _createClass(stHealthMax, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("stHealthMax", this);
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(stHealthMax, value.data);
    }
  }]);

  return stHealthMax;
}(Stat);

var stHealth = /*#__PURE__*/function (_Stat5) {
  _inherits(stHealth, _Stat5);

  var _super98 = _createSuper(stHealth);

  _createClass(stHealth, null, [{
    key: "setup",
    value: function setup(context, base, max) {
      stHealthMax.setup(context, max);

      var _stat = new stHealth();

      var _n = _stat.data;
      _n.id = 'health', _n.base = base, _n.value = base, _n.limits = [{
        max: 'healthMax',
        min: 0
      }];
      context.addItem(_stat);

      _stat.Calc();
    }
  }]);

  function stHealth() {
    _classCallCheck(this, stHealth);

    return _super98.call(this);
  }

  _createClass(stHealth, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("stHealth", this);
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(stHealth, value.data);
    }
  }]);

  return stHealth;
}(Stat);

var stEnergyMax = /*#__PURE__*/function (_Stat6) {
  _inherits(stEnergyMax, _Stat6);

  var _super99 = _createSuper(stEnergyMax);

  _createClass(stEnergyMax, null, [{
    key: "setup",
    value: function setup(context, max) {
      var _stat = new stEnergyMax();

      var _n = _stat.data;
      _n.id = 'energyMax', _n.base = max, _n.value = max, _n.modifys = [{
        id: 'energy'
      }], _n.limits = [{
        max: 99999,
        min: 0
      }];
      context.addItem(_stat);
    }
  }]);

  function stEnergyMax() {
    _classCallCheck(this, stEnergyMax);

    return _super99.call(this);
  }

  _createClass(stEnergyMax, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("stEnergyMax", this);
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(stEnergyMax, value.data);
    }
  }]);

  return stEnergyMax;
}(Stat);

var stEnergy = /*#__PURE__*/function (_Stat7) {
  _inherits(stEnergy, _Stat7);

  var _super100 = _createSuper(stEnergy);

  _createClass(stEnergy, null, [{
    key: "setup",
    value: function setup(context, base, max) {
      stEnergyMax.setup(context, max);

      var _stat = new stEnergy();

      var _n = _stat.data;
      _n.id = 'energy', _n.base = base, _n.value = base, _n.limits = [{
        max: 'energyMax',
        min: 0
      }];
      context.addItem(_stat);

      _stat.Calc();
    }
  }]);

  function stEnergy() {
    _classCallCheck(this, stEnergy);

    return _super100.call(this);
  }

  _createClass(stEnergy, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("stEnergy", this);
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(stEnergy, value.data);
    }
  }]);

  return stEnergy;
}(Stat);

var stWillMax = /*#__PURE__*/function (_Stat8) {
  _inherits(stWillMax, _Stat8);

  var _super101 = _createSuper(stWillMax);

  _createClass(stWillMax, null, [{
    key: "setup",
    value: function setup(context, max) {
      var _stat = new stWillMax();

      var _n = _stat.data;
      _n.id = 'willMax', _n.base = max, _n.value = max, _n.modifys = [{
        id: 'will'
      }], _n.limits = [{
        max: 99999,
        min: 0
      }];
      context.addItem(_stat);
    }
  }]);

  function stWillMax() {
    _classCallCheck(this, stWillMax);

    return _super101.call(this);
  }

  _createClass(stWillMax, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("stWillMax", this);
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(stWillMax, value.data);
    }
  }]);

  return stWillMax;
}(Stat);

var stWill = /*#__PURE__*/function (_Stat9) {
  _inherits(stWill, _Stat9);

  var _super102 = _createSuper(stWill);

  _createClass(stWill, null, [{
    key: "setup",
    value: function setup(context, base, max) {
      stWillMax.setup(context, max);

      var _stat = new stWill();

      var _n = _stat.data;
      _n.id = 'will', _n.base = base, _n.value = base, _n.limits = [{
        max: 'willMax',
        min: 0
      }];
      context.addItem(_stat);

      _stat.Calc();
    }
  }]);

  function stWill() {
    _classCallCheck(this, stWill);

    return _super102.call(this);
  }

  _createClass(stWill, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("stWill", this);
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(stWill, value.data);
    }
  }]);

  return stWill;
}(Stat);

var stArousalMax = /*#__PURE__*/function (_Stat10) {
  _inherits(stArousalMax, _Stat10);

  var _super103 = _createSuper(stArousalMax);

  _createClass(stArousalMax, null, [{
    key: "setup",
    value: function setup(context, max) {
      var _stat = new stArousalMax();

      var _n = _stat.data;
      _n.id = 'arousalMax', _n.base = max, _n.value = max, _n.hidden = 3, _n.limits = [{
        max: 999,
        min: 0
      }];
      context.addItem(_stat);

      _stat.Calc();
    }
  }]);

  function stArousalMax() {
    _classCallCheck(this, stArousalMax);

    return _super103.call(this);
  }

  _createClass(stArousalMax, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("stArousalMax", this);
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(stArousalMax, value.data);
    }
  }]);

  return stArousalMax;
}(Stat);

var stArousalMin = /*#__PURE__*/function (_Stat11) {
  _inherits(stArousalMin, _Stat11);

  var _super104 = _createSuper(stArousalMin);

  _createClass(stArousalMin, null, [{
    key: "setup",
    value: function setup(context, max) {
      var _stat = new stArousalMin();

      var _n = _stat.data;
      _n.id = 'arousalMin', _n.base = 0, _n.value = 0, _n.hidden = 1, _n.limits = [{
        max: 999,
        min: 0
      }];
      context.addItem(_stat);

      _stat.Calc();
    }
  }]);

  function stArousalMin() {
    _classCallCheck(this, stArousalMin);

    return _super104.call(this);
  }

  _createClass(stArousalMin, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("stArousalMin", this);
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(stArousalMin, value.data);
    }
  }]);

  return stArousalMin;
}(Stat);

var stArousal = /*#__PURE__*/function (_Stat12) {
  _inherits(stArousal, _Stat12);

  var _super105 = _createSuper(stArousal);

  _createClass(stArousal, null, [{
    key: "setup",
    value: function setup(context, base, max) {
      stArousalMax.setup(context, max);
      stArousalMin.setup(context, 0);

      var _stat = new stArousal();

      var _n = _stat.data;
      _n.id = 'arousal', _n.hidden = 3, _n.base = base, _n.value = base, _n.limits = [{
        max: 'arousalMax',
        min: 'arousalMin'
      }];
      context.addItem(_stat);

      _stat.Calc();
    }
  }]);

  function stArousal() {
    _classCallCheck(this, stArousal);

    return _super105.call(this);
  }

  _createClass(stArousal, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("stArousal", this);
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(stArousal, value.data);
    }
  }]);

  return stArousal;
}(Stat); ////    Base-Stats ///////////////////////////////////////////////


var stAgility = /*#__PURE__*/function (_Stat13) {
  _inherits(stAgility, _Stat13);

  var _super106 = _createSuper(stAgility);

  _createClass(stAgility, null, [{
    key: "setup",
    // core attribute
    value: function setup(context, base, max) {
      var _stat = new stAgility();

      var _n = _stat.data;
      _n.id = 'agility', _n.base = base, _n.value = base, _n.limits = [{
        max: 999,
        min: 0
      }];
      context.addItem(_stat);

      _stat.Calc();
    }
  }]);

  function stAgility() {
    _classCallCheck(this, stAgility);

    return _super106.call(this);
  }

  _createClass(stAgility, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("stAgility", this);
    }
  }, {
    key: "updateModifier",
    value: function updateModifier() {
      this.parent.addModifier('energyMax', {
        id: 'agility',
        bonus: this.parent.get('agility').value * 2
      });
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(stAgility, value.data);
    }
  }]);

  return stAgility;
}(Stat);

var stPerception = /*#__PURE__*/function (_Stat14) {
  _inherits(stPerception, _Stat14);

  var _super107 = _createSuper(stPerception);

  _createClass(stPerception, null, [{
    key: "setup",
    // core attribute
    value: function setup(context, base, max) {
      var _stat = new stPerception();

      var _n = _stat.data;
      _n.id = 'perception', _n.base = base, _n.value = base, _n.limits = [{
        max: 999,
        min: 0
      }];
      context.addItem(_stat);

      _stat.Calc();
    }
  }]);

  function stPerception() {
    _classCallCheck(this, stPerception);

    return _super107.call(this);
  }

  _createClass(stPerception, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("stPerception", this);
    }
  }, {
    key: "updateModifier",
    value: function updateModifier() {
      this.parent.addModifier('willMax', {
        id: 'perception',
        bonus: this.parent.get('perception').value * 2
      });
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(stPerception, value.data);
    }
  }]);

  return stPerception;
}(Stat);

var stLuck = /*#__PURE__*/function (_Stat15) {
  _inherits(stLuck, _Stat15);

  var _super108 = _createSuper(stLuck);

  _createClass(stLuck, null, [{
    key: "setup",
    // core attribute
    value: function setup(context, base, max) {
      var _stat = new stLuck();

      var _n = _stat.data;
      _n.id = 'luck', _n.base = base, _n.value = base, _n.limits = [{
        max: 999,
        min: 0
      }];
      context.addItem(_stat);

      _stat.Calc();
    }
  }]);

  function stLuck() {
    _classCallCheck(this, stLuck);

    return _super108.call(this);
  }

  _createClass(stLuck, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("stLuck", this);
    }
  }, {
    key: "updateModifier",
    value: function updateModifier() {}
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(stLuck, value.data);
    }
  }]);

  return stLuck;
}(Stat);

var stCharisma = /*#__PURE__*/function (_Stat16) {
  _inherits(stCharisma, _Stat16);

  var _super109 = _createSuper(stCharisma);

  _createClass(stCharisma, null, [{
    key: "setup",
    // core attribute
    value: function setup(context, base, max) {
      var _stat = new stCharisma();

      var _n = _stat.data;
      _n.id = 'charisma', _n.base = base, _n.value = base, _n.limits = [{
        max: 999,
        min: 0
      }];
      context.addItem(_stat);

      _stat.Calc();
    }
  }]);

  function stCharisma() {
    _classCallCheck(this, stCharisma);

    return _super109.call(this);
  }

  _createClass(stCharisma, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("stCharisma", this);
    }
  }, {
    key: "updateModifier",
    value: function updateModifier() {
      this.parent.addModifier('energyMax', {
        id: 'charisma',
        bonus: this.parent.get('charisma').value * 2
      });
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(stCharisma, value.data);
    }
  }]);

  return stCharisma;
}(Stat);

var stIntelligence = /*#__PURE__*/function (_Stat17) {
  _inherits(stIntelligence, _Stat17);

  var _super110 = _createSuper(stIntelligence);

  _createClass(stIntelligence, null, [{
    key: "setup",
    // core attribute
    value: function setup(context, base, max) {
      var _stat = new stIntelligence();

      var _n = _stat.data;
      _n.id = 'intelligence', _n.base = base, _n.value = base, _n.limits = [{
        max: 999,
        min: 0
      }];
      context.addItem(_stat);

      _stat.Calc();
    }
  }]);

  function stIntelligence() {
    _classCallCheck(this, stIntelligence);

    return _super110.call(this);
  }

  _createClass(stIntelligence, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("stIntelligence", this);
    }
  }, {
    key: "updateModifier",
    value: function updateModifier() {
      this.parent.addModifier('willMax', {
        id: 'intelligence',
        bonus: this.parent.get('intelligence').value * 2
      });
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(stIntelligence, value.data);
    }
  }]);

  return stIntelligence;
}(Stat);

var stStrength = /*#__PURE__*/function (_Stat18) {
  _inherits(stStrength, _Stat18);

  var _super111 = _createSuper(stStrength);

  _createClass(stStrength, null, [{
    key: "setup",
    // core attribute
    value: function setup(context, base, max) {
      var _stat = new stStrength();

      var _n = _stat.data;
      _n.id = 'strength', _n.base = base, _n.value = base, _n.modifys = [{
        id: 'healthMax'
      }];
      context.addItem(_stat);

      _stat.Calc();
    }
  }]);

  function stStrength() {
    _classCallCheck(this, stStrength);

    return _super111.call(this);
  }

  _createClass(stStrength, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("stStrength", this);
    }
  }, {
    key: "updateModifier",
    value: function updateModifier() {
      this.parent.addModifier('healthMax', {
        id: 'strength',
        bonus: this.parent.get('strength').value * 2
      }); //this.parent.addModifier('pAttack',{id:'strength', bonus:Math.floor(this.parent.get('strength').value/4)});
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(stStrength, value.data);
    }
  }]);

  return stStrength;
}(Stat);

var stEndurance = /*#__PURE__*/function (_Stat19) {
  _inherits(stEndurance, _Stat19);

  var _super112 = _createSuper(stEndurance);

  _createClass(stEndurance, null, [{
    key: "setup",
    // core attribute
    value: function setup(context, base, max) {
      var _stat = new stEndurance();

      var _n = _stat.data;
      _n.id = 'endurance', _n.base = base, _n.value = base, _n.modifys = [{
        id: 'healthMax'
      }];
      context.addItem(_stat);

      _stat.Calc();
    }
  }]);

  function stEndurance() {
    _classCallCheck(this, stEndurance);

    return _super112.call(this);
  }

  _createClass(stEndurance, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("stEndurance", this);
    }
  }, {
    key: "updateModifier",
    value: function updateModifier() {
      this.parent.addModifier('healthMax', {
        id: 'endurance',
        bonus: this.parent.get('endurance').value * 2
      }); //this.parent.addModifier('pDefense',{id:'strength', bonus:this.parent.get('endurance').value%4});
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(stEndurance, value.data);
    }
  }]);

  return stEndurance;
}(Stat); ////////////////////////////////////////////////////////////////////////////////


var stCorruptionMax = /*#__PURE__*/function (_Stat20) {
  _inherits(stCorruptionMax, _Stat20);

  var _super113 = _createSuper(stCorruptionMax);

  _createClass(stCorruptionMax, null, [{
    key: "setup",
    value: function setup(context, base, max) {
      var _stat = new stCorruptionMax();

      var _n = _stat.data;
      _n.id = 'corruptionMax', _n.hidden = 3, _n.base = base, _n.value = base, _n.limits = [{
        max: 99999,
        min: 0
      }];
      context.addItem(_stat);

      _stat.Calc();
    }
  }]);

  function stCorruptionMax() {
    _classCallCheck(this, stCorruptionMax);

    return _super113.call(this);
  }

  _createClass(stCorruptionMax, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("stCorruptionMax", this);
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(stCorruptionMax, value.data);
    }
  }]);

  return stCorruptionMax;
}(Stat);

var stCorruption = /*#__PURE__*/function (_Stat21) {
  _inherits(stCorruption, _Stat21);

  var _super114 = _createSuper(stCorruption);

  _createClass(stCorruption, null, [{
    key: "setup",
    value: function setup(context, base, max) {
      stCorruptionMax.setup(context, max);

      var _stat = new stCorruption();

      var _n = _stat.data;
      _n.id = 'corruption', _n.hidden = 3, _n.base = base, _n.value = base, _n.limits = [{
        max: 'corruptionMax',
        min: 0
      }];
      context.addItem(_stat);

      _stat.Calc();
    }
  }]);

  function stCorruption() {
    _classCallCheck(this, stCorruption);

    return _super114.call(this);
  }

  _createClass(stCorruption, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("stCorruption", this);
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(stCorruption, value.data);
    }
  }]);

  return stCorruption;
}(Stat); //Fetish
// value >0 means character likes that fetish or <0 hates it  


var stFetish = /*#__PURE__*/function (_Stat22) {
  _inherits(stFetish, _Stat22);

  var _super115 = _createSuper(stFetish);

  _createClass(stFetish, null, [{
    key: "setup",
    value: function setup(context, base, max, name) {
      var _stat = new stFetish();

      var _n = _stat.data;
      _n.id = name + "_Max", _n.base = max, _n.value = max, _n.limits = [{
        max: 100,
        min: -100
      }];
      context.addItem(_stat);
      _stat = new stFetish();
      _n = _stat.data;
      _n.id = name + "_Min", _n.base = 0, _n.value = 0, _n.limits = [{
        max: 100,
        min: -100
      }];
      context.addItem(_stat);
      _stat = new stFetish();
      _n = _stat.data;
      _n.id = name, _n.base = base, _n.value = base, _n.limits = [{
        max: name + "_Max",
        min: name + "_Min"
      }];
      context.addItem(_stat);

      _stat.Calc();
    }
  }, {
    key: "listFetish",
    value: function listFetish() {
      var list = ['ftZoophil', 'ftBondage', 'ftDominant', 'ftSubmissive', 'ftreceiveAnal', 'ftgiveAnal', 'ftExhibition'];
      return list;
    }
  }]);

  function stFetish() {
    _classCallCheck(this, stFetish);

    return _super115.call(this);
  }

  _createClass(stFetish, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("stFetish", this);
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(stFetish, value.data);
    }
  }]);

  return stFetish;
}(Stat); //effects


var effEnergized = /*#__PURE__*/function (_Effect2) {
  _inherits(effEnergized, _Effect2);

  var _super116 = _createSuper(effEnergized);

  function effEnergized() {
    var _this83;

    _classCallCheck(this, effEnergized);

    _this83 = _super116.call(this);
    _this83.data.id = _this83.data.name = effEnergized.name, _this83.data.duration = 120;
    return _this83;
  }

  _createClass(effEnergized, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("effEnergized", this);
    }
  }, {
    key: "onTimeChange",
    value: function onTimeChange(time) {
      //+ 10Energy per hour
      var delta = window.gm.getDeltaTime(time, this.data.time);
      this.data.time = time;
      this.data.duration -= delta;

      if (this.data.duration < 0) {
        delta = delta + this.data.duration; // if delta is 20 but remaining duration is only 5, delta should be capped to 5

        this.data.duration = 0;
      } //Effects impact Stats:  Effect->Effects->Character->Stats    is there a prettier wy?


      this.parent.parent.Stats.increment('energy', 10 * delta / 60);

      if (this.data.duration <= 0) {
        //remove yourself
        return function (me) {
          return function (Effects) {
            Effects.removeItem(me.data.id);
          };
        }(this);
      }

      return null;
    }
  }, {
    key: "onApply",
    value: function onApply() {
      //+10 energy
      this.data.duration = 120;
      this.data.time = window.gm.getTime();
      this.parent.parent.Stats.increment('energy', 10);
    }
  }, {
    key: "merge",
    value: function merge(neweffect) {
      if (neweffect.name === this.data.name) {
        this.onApply(); //refresh 

        return true;
      }
    }
  }, {
    key: "desc",
    get: function get() {
      return effEnergized.name;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(effEnergized, value.data);
    }
  }]);

  return effEnergized;
}(Effect);

var effNotTired = /*#__PURE__*/function (_Effect3) {
  _inherits(effNotTired, _Effect3);

  var _super117 = _createSuper(effNotTired);

  function effNotTired() {
    var _this84;

    _classCallCheck(this, effNotTired);

    _this84 = _super117.call(this);
    _this84.data.id = effNotTired.name, _this84.data.name = "not tired", _this84.data.duration = 120, _this84.data.hidden = 4;
    return _this84;
  }

  _createClass(effNotTired, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("effNotTired", this);
    }
  }, {
    key: "onTimeChange",
    value: function onTimeChange(time) {
      //Tired after xxh
      this.data.duration -= window.gm.getDeltaTime(time, this.data.time);
      this.data.time = time;

      if (this.data.duration <= 0) {
        return function (me) {
          return function (Effects) {
            var newdata = new effTired();
            Effects.replace(me.data.id, newdata);
          };
        }(this);
      }

      return null;
    }
  }, {
    key: "onApply",
    value: function onApply() {
      this.data.duration = 120; // todo 600;

      this.data.time = window.gm.getTime();
    }
  }, {
    key: "merge",
    value: function merge(neweffect) {
      if (neweffect.name === this.data.name) {
        this.onApply(); //refresh

        return true;
      }
    }
  }, {
    key: "desc",
    get: function get() {
      return effNotTired.name;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(effNotTired, value.data);
    }
  }]);

  return effNotTired;
}(Effect);

var effTired = /*#__PURE__*/function (_Effect4) {
  _inherits(effTired, _Effect4);

  var _super118 = _createSuper(effTired);

  function effTired() {
    var _this85;

    _classCallCheck(this, effTired);

    _this85 = _super118.call(this);
    _this85.data.id = effTired.name, _this85.data.name = "tired", _this85.data.duration = 0, _this85.data.hidden = 0;
    return _this85;
  }

  _createClass(effTired, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("effTired", this);
    }
  }, {
    key: "onTimeChange",
    value: function onTimeChange(time) {
      //duration not used -> will never expire unless replaced
      var delta = window.gm.getTime() - this.data.time; //-10 max energy after 12h, but only up to 3 times

      if (delta > 60) this.parent.parent.Stats.addModifier('energyMax', {
        id: 'energyMax:Tired',
        bonus: -10
      });
    }
  }, {
    key: "onApply",
    value: function onApply() {
      this.data.time = window.gm.getTime();
    }
  }, {
    key: "onRemove",
    value: function onRemove() {
      this.parent.parent.Stats.removeModifier('energyMax', {
        id: 'energyMax:Tired'
      });
    }
  }, {
    key: "merge",
    value: function merge(neweffect) {
      if (neweffect.name === 'effNotTired') {
        return function (me) {
          return function (Effects) {
            var newdata = new effNotTired();
            Effects.replace(me.data.id, newdata);
          };
        }(this);
      }

      if (neweffect.name === this.data.name) {
        //just ignore
        return true;
      }
    }
  }, {
    key: "desc",
    get: function get() {
      return effTired.name;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(effTired, value.data);
    }
  }]);

  return effTired;
}(Effect);

var effEnergyDrain = /*#__PURE__*/function (_Effect5) {
  _inherits(effEnergyDrain, _Effect5);

  var _super119 = _createSuper(effEnergyDrain);

  function effEnergyDrain() {
    var _this86;

    _classCallCheck(this, effEnergyDrain);

    _this86 = _super119.call(this);
    _this86.data.id = effEnergyDrain.name, _this86.data.name = "energy drained", _this86.data.duration = 0, _this86.data.hidden = 0;
    return _this86;
  }

  _createClass(effEnergyDrain, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("effEnergyDrain", this);
    }
  }, {
    key: "onTimeChange",
    value: function onTimeChange(time) {
      var delta = window.gm.getDeltaTime(time, this.data.time);
      this.data.time = time;
      this.parent.parent.Stats.increment('energy', -3 * delta / 60);
    }
  }, {
    key: "onApply",
    value: function onApply() {
      this.data.time = window.gm.getTime();
    }
  }, {
    key: "merge",
    value: function merge(neweffect) {
      if (neweffect.name === this.data.name) {
        return true;
      }
    }
  }, {
    key: "desc",
    get: function get() {
      return effEnergyDrain.name;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(effEnergyDrain, value.data);
    }
  }]);

  return effEnergyDrain;
}(Effect);

var effMutateCat = /*#__PURE__*/function (_Effect6) {
  _inherits(effMutateCat, _Effect6);

  var _super120 = _createSuper(effMutateCat);

  function effMutateCat() {
    var _this87;

    _classCallCheck(this, effMutateCat);

    _this87 = _super120.call(this);
    _this87.data.id = _this87.data.name = effMutateCat.name, _this87.data.hidden = 0;
    _this87.data.duration = 60, _this87.data.cycles = 3, _this87.data.magnitude = 3;
    return _this87;
  }

  _createClass(effMutateCat, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("effMutateCat", this);
    }
  }, {
    key: "onTimeChange",
    value: function onTimeChange(time) {
      //after some time you mutate a bit
      this.data.duration -= window.gm.getDeltaTime(time, this.data.time);
      this.data.time = time;

      if (this.data.duration <= 0) {
        this.data.duration = 60;
        return function (me) {
          return function (Effects) {
            if (me.data.cycles <= 0) {
              Effects.removeItem(me.data.id);
            }

            window.gm.pushDeferredEvent("MutateCat", [me.data.magnitude]); //window.gm.pushDeferredEvent("CatHabit");

            Effects.removeItem(me.data.id);
          };
        }(this);
      }

      return null;
    }
  }, {
    key: "onApply",
    value: function onApply() {
      this.data.duration = 60, this.data.cycles = 3;
      this.data.time = window.gm.getTime();
    }
  }, {
    key: "merge",
    value: function merge(neweffect) {
      if (neweffect.name === this.data.name) {
        //dont refresh
        return true;
      }
    }
  }, {
    key: "desc",
    get: function get() {
      return "cat-tastic";
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(effMutateCat, value.data);
    }
  }]);

  return effMutateCat;
}(Effect);

var effMutateWolf = /*#__PURE__*/function (_Effect7) {
  _inherits(effMutateWolf, _Effect7);

  var _super121 = _createSuper(effMutateWolf);

  function effMutateWolf() {
    var _this88;

    _classCallCheck(this, effMutateWolf);

    _this88 = _super121.call(this);
    _this88.data.id = _this88.data.name = effMutateWolf.name, _this88.data.hidden = 0;
    _this88.data.duration = 60, _this88.data.cycles = 3, _this88.data.magnitude = 3;
    return _this88;
  }

  _createClass(effMutateWolf, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("effMutateWolf", this);
    }
  }, {
    key: "onTimeChange",
    value: function onTimeChange(time) {
      //after some time you mutate a bit
      this.data.duration -= window.gm.getDeltaTime(time, this.data.time);
      this.data.time = time;

      if (this.data.duration <= 0) {
        this.data.duration = 60;
        return function (me) {
          return function (Effects) {
            if (me.data.cycles <= 0) {
              Effects.removeItem(me.data.id);
            }

            window.gm.pushDeferredEvent("MutateWolf", [me.data.magnitude]); //window.gm.pushDeferredEvent("CatHabit");

            Effects.removeItem(me.data.id);
          };
        }(this);
      }

      return null;
    }
  }, {
    key: "onApply",
    value: function onApply() {
      this.data.duration = 60, this.data.cycles = 3;
      this.data.time = window.gm.getTime();
    }
  }, {
    key: "merge",
    value: function merge(neweffect) {
      if (neweffect.name === this.data.name) {
        //dont refresh
        return true;
      }
    }
  }, {
    key: "desc",
    get: function get() {
      return "wolf-tastic";
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(effMutateWolf, value.data);
    }
  }]);

  return effMutateWolf;
}(Effect);

var effMutateHorse = /*#__PURE__*/function (_Effect8) {
  _inherits(effMutateHorse, _Effect8);

  var _super122 = _createSuper(effMutateHorse);

  function effMutateHorse() {
    var _this89;

    _classCallCheck(this, effMutateHorse);

    _this89 = _super122.call(this);
    _this89.data.id = _this89.data.name = effMutateHorse.name, _this89.data.hidden = 0;
    _this89.data.duration = 60, _this89.data.cycles = 3, _this89.data.magnitude = 3;
    return _this89;
  }

  _createClass(effMutateHorse, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("effMutateHorse", this);
    }
  }, {
    key: "onTimeChange",
    value: function onTimeChange(time) {
      //after some time you mutate a bit
      this.data.duration -= window.gm.getDeltaTime(time, this.data.time);
      this.data.time = time;

      if (this.data.duration <= 0) {
        this.data.duration = 60;
        return function (me) {
          return function (Effects) {
            if (me.data.cycles <= 0) {
              Effects.removeItem(me.data.id);
            }

            window.gm.pushDeferredEvent("MutateHorse", [me.data.magnitude]); //todo non-PC can be mutated (if receives timechange !) but the scene will assume its player?!

            Effects.removeItem(me.data.id);
          };
        }(this);
      }

      return null;
    }
  }, {
    key: "onApply",
    value: function onApply() {
      this.data.duration = 60, this.data.cycles = 3;
      this.data.time = window.gm.getTime();
    }
  }, {
    key: "merge",
    value: function merge(neweffect) {
      if (neweffect.name === this.data.name) {
        //dont refresh
        return true;
      }
    }
  }, {
    key: "desc",
    get: function get() {
      return "horse-tastic";
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(effMutateHorse, value.data);
    }
  }]);

  return effMutateHorse;
}(Effect);

var effHorsePower = /*#__PURE__*/function (_Effect9) {
  _inherits(effHorsePower, _Effect9);

  var _super123 = _createSuper(effHorsePower);

  function effHorsePower() {
    var _this90;

    _classCallCheck(this, effHorsePower);

    _this90 = _super123.call(this);
    _this90.data.id = _this90.data.name = effHorsePower.name, _this90.data.hidden = 0;
    _this90.data.duration = 120, _this90.data.cycles = 3, _this90.data.magnitude = 1;
    return _this90;
  }

  _createClass(effHorsePower, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("effHorsePower", this);
    }
  }, {
    key: "onTimeChange",
    value: function onTimeChange(time) {
      //+ 10Energy per hour
      var delta = window.gm.getDeltaTime(time, this.data.time);
      this.data.time = time;
      this.data.duration -= delta;

      if (this.data.duration < 0) {
        delta = delta + this.data.duration; // if delta is 20 but remaining duration is only 5, delta should be capped to 5

        this.data.duration = 0;
      }

      this.parent.parent.Stats.increment('energy', 10 * delta / 60);

      if (this.data.magnitude > 2) {
        var _i7 = this.parent.findItemSlot(this.data.id);

        if (_i7 < 0) {
          //todo extend if exist?
          this.parent.parent.addEffect(effMutateHorse.id, new effMutateHorse());
        }
      }

      if (this.data.duration <= 0) {
        //remove yourself
        return function (me) {
          return function (Effects) {
            Effects.removeItem(me.data.id);
          };
        }(this);
      }

      return null;
    }
  }, {
    key: "onApply",
    value: function onApply() {
      this.data.duration = 120;
      this.data.duration = 3;
      this.data.time = window.gm.getTime();
    }
  }, {
    key: "merge",
    value: function merge(neweffect) {
      if (neweffect.id === this.data.id) {
        this.onApply(); //refresh 

        this.data.magnitude += 1; //bonus effect triggers only if added multiple times

        window.gm.pushDeferredEvent("HorsePowerNotice", [this.data.magnitude]);
        return true;
      }
    }
  }, {
    key: "desc",
    get: function get() {
      return effHorsePower.name;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(effHorsePower, value.data);
    }
  }]);

  return effHorsePower;
}(Effect);

var effGrowBreast = /*#__PURE__*/function (_Effect10) {
  _inherits(effGrowBreast, _Effect10);

  var _super124 = _createSuper(effGrowBreast);

  function effGrowBreast() {
    var _this91;

    _classCallCheck(this, effGrowBreast);

    _this91 = _super124.call(this);
    _this91.data.id = _this91.data.name = effGrowBreast.name, _this91.data.duration = 60, _this91.data.hidden = 0;
    _this91.data.cycles = 3, _this91.data.magnitude = 3;
    return _this91;
  }

  _createClass(effGrowBreast, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("effGrowBreast", this);
    }
  }, {
    key: "onTimeChange",
    value: function onTimeChange(time) {
      //after some time you mutate a bit
      this.data.duration = Math.max(this.data.duration - window.gm.getDeltaTime(time, this.data.time), 0);
      this.data.time = time;

      if (this.data.duration <= 0 && this.data.cycles > 0) {
        this.data.cycles -= 1;
        return function (me) {
          return function (Effects) {
            if (me.data.cycles <= 0) {
              Effects.removeItem(me.data.id);
              window.gm.pushDeferredEvent("MutateBreastEnd");
            } else window.gm.pushDeferredEvent("MutateBreast");
          };
        }(this);
      }

      return null;
    }
  }, {
    key: "onApply",
    value: function onApply() {
      this.data.duration = 60;
      this.data.time = window.gm.getTime();
    }
  }, {
    key: "merge",
    value: function merge(neweffect) {
      if (neweffect.name === this.data.name) {
        this.data.cycles += neweffect.data.cycles; //prolong the effect

        return true;
      }
    }
  }, {
    key: "desc",
    get: function get() {
      return effGrowBreast.name;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(effGrowBreast, value.data);
    }
  }]);

  return effGrowBreast;
}(Effect);

var effGrowVulva = /*#__PURE__*/function (_Effect11) {
  _inherits(effGrowVulva, _Effect11);

  var _super125 = _createSuper(effGrowVulva);

  function effGrowVulva() {
    var _this92;

    _classCallCheck(this, effGrowVulva);

    _this92 = _super125.call(this);
    _this92.data.id = _this92.data.name = effGrowVulva.name, _this92.data.duration = 60, _this92.data.hidden = 0;
    _this92.data.cycles = 3, _this92.data.magnitude = 3;
    return _this92;
  }

  _createClass(effGrowVulva, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("effGrowVulva", this);
    }
  }, {
    key: "onTimeChange",
    value: function onTimeChange(time) {
      //after some time you mutate a bit
      this.data.duration = Math.max(this.data.duration - window.gm.getDeltaTime(time, this.data.time), 0);
      this.data.time = time;

      if (this.data.duration <= 0 && this.data.cycles > 0) {
        this.data.cycles -= 1;
        return function (me) {
          return function (Effects) {
            if (me.data.cycles <= 0) {
              Effects.removeItem(me.data.id);
              window.gm.pushDeferredEvent("MutateVulvaEnd");
            } else window.gm.pushDeferredEvent("MutateVulva");
          };
        }(this);
      }

      return null;
    }
  }, {
    key: "onApply",
    value: function onApply() {
      this.data.duration = 60;
      this.data.time = window.gm.getTime();
    }
  }, {
    key: "merge",
    value: function merge(neweffect) {
      if (neweffect.name === this.data.name) {
        this.data.cycles += neweffect.data.cycles; //prolong the effect

        return true;
      }
    }
  }, {
    key: "desc",
    get: function get() {
      return effGrowVulva.name;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(effGrowVulva, value.data);
    }
  }]);

  return effGrowVulva;
}(Effect);

var effLewdMark = /*#__PURE__*/function (_Effect12) {
  _inherits(effLewdMark, _Effect12);

  var _super126 = _createSuper(effLewdMark);

  function effLewdMark() {
    var _this93;

    _classCallCheck(this, effLewdMark);

    _this93 = _super126.call(this);
    _this93.data.id = _this93.data.name = effLewdMark.name, _this93.data.duration = 60, _this93.data.hidden = 0;
    _this93.data.cycles = 3, _this93.data.magnitude = 1;
    return _this93;
  }

  _createClass(effLewdMark, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("effLewdMark", this);
    }
  }, {
    key: "onTimeChange",
    value: function onTimeChange(time) {
      //todo the mark indicates that you can bear soulgems; the stronger the mark, the better the gem
      //with each birth, the mark grows stronger;
      //while you are pampering the gem, it sucks up your arcana if you dont have sex
      //chance to go into heat if you dont have a gem
      return null;
    }
  }, {
    key: "onApply",
    value: function onApply() {
      this.data.duration = 60;
      this.data.time = window.gm.getTime();
    }
  }, {
    key: "merge",
    value: function merge(neweffect) {
      if (neweffect.name === this.data.name) {
        return true;
      }
    }
  }, {
    key: "desc",
    get: function get() {
      return effLewdMark.name;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(effLewdMark, value.data);
    }
  }]);

  return effLewdMark;
}(Effect);

var effInHeat = /*#__PURE__*/function (_Effect13) {
  _inherits(effInHeat, _Effect13);

  var _super127 = _createSuper(effInHeat);

  function effInHeat() {
    var _this94;

    _classCallCheck(this, effInHeat);

    _this94 = _super127.call(this);
    _this94.data.id = _this94.data.name = effInHeat.name, _this94.data.duration = 60, _this94.data.hidden = 0;
    _this94.data.cycles = 3, _this94.data.magnitude = 1;
    return _this94;
  }

  _createClass(effInHeat, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("effInHeat", this);
    }
  }, {
    key: "desc",
    get: function get() {
      return effInHeat.name;
    } //todo if female, you might go into heat (only when not carrying child/soulgem ?) 
    //more arousal damage by studs
    //succesful impregation or time might end heat

  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(effInHeat, value.data);
    }
  }]);

  return effInHeat;
}(Effect);

var effInRut = /*#__PURE__*/function (_Effect14) {
  _inherits(effInRut, _Effect14);

  var _super128 = _createSuper(effInRut);

  function effInRut() {
    var _this95;

    _classCallCheck(this, effInRut);

    _this95 = _super128.call(this);
    _this95.data.id = _this95.data.name = effInRut.name, _this95.data.duration = 60, _this95.data.hidden = 0;
    _this95.data.cycles = 3, _this95.data.magnitude = 1;
    return _this95;
  }

  _createClass(effInRut, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("effInRut", this);
    }
  }, {
    key: "desc",
    get: function get() {
      return effInRut.name;
    } //todo if male, you might go into rut  
    //more arousal damage by sluts
    //multiple succesful impregations/balldrain or time might end rut

  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(effInRut, value.data);
    }
  }]);

  return effInRut;
}(Effect);

var effVaginalFertil = /*#__PURE__*/function (_Effect15) {
  _inherits(effVaginalFertil, _Effect15);

  var _super129 = _createSuper(effVaginalFertil);

  function effVaginalFertil() {
    var _this96;

    _classCallCheck(this, effVaginalFertil);

    _this96 = _super129.call(this);
    _this96.data.id = _this96.data.name = effVaginalFertil.name, _this96.data.duration = 60, _this96.data.hidden = 0;
    _this96.data.cycles = 3, _this96.data.magnitude = 1;
    return _this96;
  }

  _createClass(effVaginalFertil, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("effVaginalFertil", this);
    }
  }, {
    key: "onTimeChange",
    value: function onTimeChange(time) {
      //todo can get pregnant with child,eggs ; natural heat might be triggered
      // if fertility of Vagina is 0, can still bear parasites,soulgem; fertility heat might not trigger 
      return null;
    }
  }, {
    key: "onApply",
    value: function onApply() {
      //todo remove infertile,fertileEffect
      this.parent.removeItem(effVaginalPregnant.name);
      this.data.duration = 60;
      this.data.time = window.gm.getTime();
    }
  }, {
    key: "merge",
    value: function merge(neweffect) {
      if (neweffect.name === this.data.name) {
        //no merge
        return true;
      }
    }
  }, {
    key: "desc",
    get: function get() {
      return effVaginalFertil.name;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(effVaginalFertil, value.data);
    }
  }]);

  return effVaginalFertil;
}(Effect);

var effVaginalPregnant = /*#__PURE__*/function (_Effect16) {
  _inherits(effVaginalPregnant, _Effect16);

  var _super130 = _createSuper(effVaginalPregnant);

  function effVaginalPregnant() {
    var _this97;

    _classCallCheck(this, effVaginalPregnant);

    _this97 = _super130.call(this);
    _this97.data.id = _this97.data.name = effVaginalPregnant.name, _this97.data.duration = 60, _this97.data.hidden = 0;
    _this97.data.cycles = 3, _this97.data.magnitude = 1, _this97.data.type = '';
    return _this97;
  }

  _createClass(effVaginalPregnant, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("effVaginalPregnant", this);
    }
  }, {
    key: "onTimeChange",
    value: function onTimeChange(time) {
      //todo be pregnant with child,eggs,parasites,soulgem
      //normal pregnancy will grow over time, might be aborted by medicine
      //soulgem grows over time, consumes arcana or sperm
      this.data.duration = Math.max(this.data.duration - window.gm.getDeltaTime(time, this.data.time), 0);
      this.data.time = time;

      if (this.data.duration <= 0 && this.data.cycles > 0) {
        this.data.cycles -= 1, this.data.duration = 60;
        window.gm.MutationsLib.vaginaPregnancy(this.parent.parent);
      }

      return null;
    }
  }, {
    key: "onApply",
    value: function onApply() {
      //todo remove infertile,fertileEffect
      this.parent.removeItem(effVaginalFertil.name);
      this.data.duration = 60;
      this.data.time = window.gm.getTime();
    }
  }, {
    key: "merge",
    value: function merge(neweffect) {
      if (neweffect.name === this.data.name) {
        //no merge
        return true;
      }
    }
  }, {
    key: "desc",
    get: function get() {
      return effVaginalPregnant.name;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(effVaginalPregnant, value.data);
    }
  }]);

  return effVaginalPregnant;
}(Effect); //todo VaginalParasite


var effSpermInWomb = /*#__PURE__*/function (_Effect17) {
  _inherits(effSpermInWomb, _Effect17);

  var _super131 = _createSuper(effSpermInWomb);

  //if you have womb filled with sperm, this handles impregnation and sperm-decay
  function effSpermInWomb() {
    var _this98;

    _classCallCheck(this, effSpermInWomb);

    _this98 = _super131.call(this);
    _this98.data.id = _this98.data.name = effSpermInWomb.name, _this98.data.duration = 60, _this98.data.hidden = 0;
    _this98.data.cycles = 1, _this98.data.magnitude = 2;
    return _this98;
  }

  _createClass(effSpermInWomb, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("effSpermInWomb", this);
    }
  }, {
    key: "onTimeChange",
    value: function onTimeChange(time) {
      this.data.duration = Math.max(this.data.duration - window.gm.getDeltaTime(time, this.data.time), 0);
      this.data.time = time;

      if (this.data.duration <= 0 && this.data.cycles > 0) {
        this.data.duration = 60;
        var vagina = this.parent.parent.getVagina();

        if (vagina && vagina.data.sperm > 0) {
          //todo add option to show only big changes/sometime
          window.gm.MutationsLib.vaginaSpermDissolve(this.parent.parent);
        }
      }

      return null;
    }
  }, {
    key: "onApply",
    value: function onApply() {
      this.data.duration = 60;
      this.data.time = window.gm.getTime();
    }
  }, {
    key: "merge",
    value: function merge(neweffect) {
      if (neweffect.name === this.data.name) {
        return true;
      }
    }
  }, {
    key: "desc",
    get: function get() {
      return effSpermInWomb.name;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(effSpermInWomb, value.data);
    }
  }]);

  return effSpermInWomb;
}(Effect); /////////////// combateffects /////////////////////////


var effHeal = /*#__PURE__*/function (_CombatEffect) {
  _inherits(effHeal, _CombatEffect);

  var _super132 = _createSuper(effHeal);

  function effHeal(amount) {
    var _this99;

    var duration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;

    _classCallCheck(this, effHeal);

    _this99 = _super132.call(this);
    _this99.amount = amount;
    _this99.data.id = _this99.data.name = effHeal.name, _this99.data.startduration = duration, _this99.data.hidden = 0;
    return _this99;
  }

  _createClass(effHeal, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("effHeal", this);
    }
  }, {
    key: "onApply",
    value: function onApply() {
      this.data.duration = this.data.startduration;
      this.parent.parent.Stats.increment('health', this.amount);
    }
  }, {
    key: "merge",
    value: function merge(neweffect) {
      if (neweffect.name === this.data.name) {
        //extends stun
        this.onApply();
        return true;
      }
    }
  }, {
    key: "onCombatEnd",
    value: function onCombatEnd() {
      this.parent.removeItem(this.data.id);
    }
  }, {
    key: "onTurnStart",
    value: function onTurnStart() {
      this.data.duration -= 1;
      if (this.data.duration <= 0) this.parent.removeItem(this.data.id);else {
        this.parent.parent.Stats.increment('health', this.amount);
      }
    }
  }, {
    key: "desc",
    get: function get() {
      return effHeal.name;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(effHeal, value.data);
    }
  }]);

  return effHeal;
}(CombatEffect);

var effGuard = /*#__PURE__*/function (_CombatEffect2) {
  _inherits(effGuard, _CombatEffect2);

  var _super133 = _createSuper(effGuard);

  function effGuard() {
    var _this100;

    _classCallCheck(this, effGuard);

    _this100 = _super133.call(this);
    _this100.data.id = _this100.data.name = effGuard.name, _this100.data.duration = 0, _this100.data.hidden = 0;
    return _this100;
  }

  _createClass(effGuard, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("effGuard", this);
    }
  }, {
    key: "onApply",
    value: function onApply() {
      this.data.duration = 2;
      this.parent.parent.Stats.addModifier('rstblunt', {
        id: 'rstblunt:Guard',
        bonus: 5
      });
      this.parent.parent.Stats.addModifier('rstslash', {
        id: 'rstblunt:Guard',
        bonus: 5
      });
      this.parent.parent.Stats.addModifier('rstpierce', {
        id: 'rstpierce:Guard',
        bonus: 5
      });
    }
  }, {
    key: "merge",
    value: function merge(neweffect) {
      if (neweffect.name === this.data.name) {
        //extends
        this.onApply();
        return true;
      }
    }
  }, {
    key: "onCombatEnd",
    value: function onCombatEnd() {
      this.parent.removeItem(this.data.id);
    }
  }, {
    key: "onTurnStart",
    value: function onTurnStart() {
      this.data.duration -= 1;
      if (this.data.duration <= 0) this.parent.removeItem(this.data.id);
    }
  }, {
    key: "onRemove",
    value: function onRemove() {
      this.parent.parent.Stats.removeModifier('rstblunt', {
        id: 'rstblunt:Guard'
      });
      this.parent.parent.Stats.removeModifier('rstblunt', {
        id: 'rstblunt:Guard'
      });
      this.parent.parent.Stats.removeModifier('rstpierce', {
        id: 'rstpierce:Guard'
      });
    }
  }, {
    key: "desc",
    get: function get() {
      return effGuard.name;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(effGuard, value.data);
    }
  }]);

  return effGuard;
}(CombatEffect); //to combine multiple effects that get dispelled together 


var effCombined = /*#__PURE__*/function (_CombatEffect3) {
  _inherits(effCombined, _CombatEffect3);

  var _super134 = _createSuper(effCombined);

  function effCombined(EffectsA, EffectsB) {
    var _this101;

    _classCallCheck(this, effCombined);

    _this101 = _super134.call(this);
    _this101.effects = EffectsA.concat(EffectsB);
    _this101.data.id = _this101.data.name = effCombined.name, _this101.data.duration = 0, _this101.data.hidden = 0;

    var _iterator65 = _createForOfIteratorHelper(EffectsA),
        _step65;

    try {
      for (_iterator65.s(); !(_step65 = _iterator65.n()).done;) {
        el = _step65.value;

        el.onRemove = function (me) {
          var _old = el.onRemove.bind(el);

          var foo = function foo() {
            _old.call(el); //override onRemove but call orignial fct


            var i = me.effects.indexOf(el);
            if (i >= 0) me.effects.splice(i, 1);
            me.removeAll();
          };

          return foo;
        }(_assertThisInitialized(_this101));
      }
    } catch (err) {
      _iterator65.e(err);
    } finally {
      _iterator65.f();
    }

    return _this101;
  }

  _createClass(effCombined, [{
    key: "removeAll",
    value: function removeAll() {
      var _iterator66 = _createForOfIteratorHelper(this.effects),
          _step66;

      try {
        for (_iterator66.s(); !(_step66 = _iterator66.n()).done;) {
          el = _step66.value;
          if (el) el.parent.removeItem(el.id);
        }
      } catch (err) {
        _iterator66.e(err);
      } finally {
        _iterator66.f();
      }

      this.parent.removeItem(this.id);
    }
  }, {
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("effCombined", this);
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(effCombined, value.data);
    }
  }]);

  return effCombined;
}(CombatEffect);

var effDamage = /*#__PURE__*/function (_CombatEffect4) {
  _inherits(effDamage, _CombatEffect4);

  var _super135 = _createSuper(effDamage);

  _createClass(effDamage, null, [{
    key: "setup",
    value: function setup(amount, type) {
      var onHitCB = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
      var eff = new effDamage();
      eff.amount = amount;
      eff.type = type;
      eff.onHit = onHitCB;
      return eff;
    }
  }]);

  function effDamage() {
    var _this102;

    _classCallCheck(this, effDamage);

    _this102 = _super135.call(this);
    _this102.amount = 8;
    _this102.data.id = _this102.data.name = effDamage.name, _this102.data.duration = 0, _this102.data.hidden = 0;
    return _this102;
  }

  _createClass(effDamage, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("effDamage", this);
    }
  }, {
    key: "onApply",

    /*??onCast(targets,caster) {
        let result={OK:false,msg:''};
        targets[0].
        if(this.onHitCB) onHitCB(targets,caster);
    }*/
    value: function onApply() {
      this.data.duration = 0;
      this.parent.parent.Stats.increment('health', -1 * this.amount);
      if (this.data.duration < 1) this.parent.removeItem(this.data.id);
    }
  }, {
    key: "merge",
    value: function merge(neweffect) {
      if (neweffect.name === this.data.name) {
        //ignore
        return;
      }
    }
  }, {
    key: "onCombatEnd",
    value: function onCombatEnd() {
      this.parent.removeItem(this.data.id);
    }
  }, {
    key: "onTurnStart",
    value: function onTurnStart() {
      this.data.duration -= 1;
      if (this.data.duration <= 0) this.parent.removeItem(this.data.id);
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(effDamage, value.data);
    }
  }]);

  return effDamage;
}(CombatEffect); //damage over time todo affects only bleedable targets 


var effBleed = /*#__PURE__*/function (_CombatEffect5) {
  _inherits(effBleed, _CombatEffect5);

  var _super136 = _createSuper(effBleed);

  function effBleed(amount) {
    var _this103;

    _classCallCheck(this, effBleed);

    _this103 = _super136.call(this);
    _this103.amount = amount;
    _this103.data.id = _this103.data.name = effBleed.name, _this103.data.duration = 0, _this103.data.hidden = 0;
    return _this103;
  }

  _createClass(effBleed, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("effBleed", this);
    }
  }, {
    key: "onApply",
    value: function onApply() {
      this.data.duration = 3;
      this.parent.parent.Stats.increment('health', -1 * this.amount);
    }
  }, {
    key: "merge",
    value: function merge(neweffect) {
      if (neweffect.name === this.data.name) {
        //ignore
        //this.onApply();
        return true;
      }
    }
  }, {
    key: "onCombatEnd",
    value: function onCombatEnd() {
      this.parent.removeItem(this.data.id);
    }
  }, {
    key: "onTurnStart",
    value: function onTurnStart() {
      this.data.duration -= 1;

      if (this.data.duration <= 0) {
        this.parent.removeItem(this.data.id);
      } else {
        this.parent.parent.Stats.increment('health', -1 * this.amount);
      }
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(effBleed, value.data);
    }
  }]);

  return effBleed;
}(CombatEffect); //the character is in close combat with whom; 


var effGrappled = /*#__PURE__*/function (_CombatEffect6) {
  _inherits(effGrappled, _CombatEffect6);

  var _super137 = _createSuper(effGrappled);

  _createClass(effGrappled, null, [{
    key: "factory",
    value: function factory() {
      var grappled = new effGrappled(2),
          grappling = new effGrappling();
      grappled.source = grappling, grappling.target = grappled;
      return {
        targetEff: grappled,
        sourceEff: grappling
      };
    }
  }]);

  function effGrappled(amount) {
    var _this104;

    _classCallCheck(this, effGrappled);

    _this104 = _super137.call(this);
    _this104.source = null;
    _this104.data.id = _this104.data.name = effGrappled.name, _this104.data.duration = 0, _this104.data.hidden = 0;
    return _this104;
  }

  _createClass(effGrappled, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("effGrappled", this);
    }
  }, {
    key: "onApply",
    value: function onApply() {
      this.data.duration = 5;
      this.data.name = this.data.name + "(" + this.source.parent.parent.name + ")";
    }
  }, {
    key: "merge",
    value: function merge(neweffect) {
      if (neweffect.name === this.data.name) {
        //ignore
        //this.onApply();
        return true;
      }
    }
  }, {
    key: "onRemove",
    value: function onRemove() {
      if (this.source) {
        this.source.parent.removeItem(effGrappling.name);
        this.source = null;
      }
    }
  }, {
    key: "onCombatEnd",
    value: function onCombatEnd() {
      this.parent.removeItem(this.data.id);
    }
  }, {
    key: "onTurnStart",
    value: function onTurnStart() {
      this.data.duration -= 1;

      if (this.data.duration <= 0) {
        this.parent.removeItem(this.data.id);
      } else {}
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(effGrappled, value.data);
    }
  }]);

  return effGrappled;
}(CombatEffect); //when a char casts grappling, the target gets effGrappled and the caster gets effGrappling
//if one of the effects got removed, it will also remove the other


var effGrappling = /*#__PURE__*/function (_CombatEffect7) {
  _inherits(effGrappling, _CombatEffect7);

  var _super138 = _createSuper(effGrappling);

  function effGrappling(targetEffect) {
    var _this105;

    _classCallCheck(this, effGrappling);

    _this105 = _super138.call(this);
    _this105.target = targetEffect;
    _this105.data.id = _this105.data.name = effGrappling.name, _this105.data.duration = 0, _this105.data.hidden = 0;
    return _this105;
  }

  _createClass(effGrappling, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("effGrappling", this);
    }
  }, {
    key: "onApply",
    value: function onApply() {
      this.data.duration = 5;
    }
  }, {
    key: "merge",
    value: function merge(neweffect) {
      if (neweffect.name === this.data.name) {
        //ignore
        //this.onApply();
        return true;
      }
    }
  }, {
    key: "onRemove",
    value: function onRemove() {
      if (this.target) {
        this.target.parent.removeItem(effGrappled.name);
        this.target = null;
      }
    }
  }, {
    key: "onCombatEnd",
    value: function onCombatEnd() {
      this.parent.removeItem(this.data.id);
    }
  }, {
    key: "onTurnStart",
    value: function onTurnStart() {
      this.data.duration -= 1;

      if (this.data.duration <= 0) {
        this.parent.removeItem(this.data.id);
      } else {}
    }
  }, {
    key: "desc",
    get: function get() {
      return this.data.name;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(effGrappling, value.data);
    }
  }]);

  return effGrappling;
}(CombatEffect);

var effUngrappling = /*#__PURE__*/function (_CombatEffect8) {
  _inherits(effUngrappling, _CombatEffect8);

  var _super139 = _createSuper(effUngrappling);

  function effUngrappling(targetEffect) {
    var _this106;

    _classCallCheck(this, effUngrappling);

    _this106 = _super139.call(this);
    _this106.target = targetEffect;
    _this106.data.id = _this106.data.name = effUngrappling.name, _this106.data.duration = 0, _this106.data.hidden = 0;
    return _this106;
  }

  _createClass(effUngrappling, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("effUngrappling", this);
    }
  }, {
    key: "onApply",
    value: function onApply() {
      this.parent.removeItem(this.target.id);
      this.parent.removeItem(this.data.id);
    }
  }, {
    key: "merge",
    value: function merge(neweffect) {
      if (neweffect.name === this.data.name) {
        //ignore
        //this.onApply();
        return true;
      }
    }
  }, {
    key: "onCombatEnd",
    value: function onCombatEnd() {
      this.parent.removeItem(this.data.id);
    }
  }, {
    key: "onTurnStart",
    value: function onTurnStart() {
      this.data.duration -= 1;
      if (this.data.duration <= 0) this.parent.removeItem(this.data.id);
    }
  }, {
    key: "desc",
    get: function get() {
      return this.data.name;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(effUngrappling, value.data);
    }
  }]);

  return effUngrappling;
}(CombatEffect);

var effTeaseDamage = /*#__PURE__*/function (_CombatEffect9) {
  _inherits(effTeaseDamage, _CombatEffect9);

  var _super140 = _createSuper(effTeaseDamage);

  _createClass(effTeaseDamage, null, [{
    key: "setup",
    value: function setup(amount, type) {
      var eff = new effTeaseDamage();
      eff.amount = amount;
      eff.type = type;
      return eff;
    }
  }]);

  function effTeaseDamage(amount) {
    var _this107;

    _classCallCheck(this, effTeaseDamage);

    _this107 = _super140.call(this);
    _this107.amount = amount;
    _this107.data.id = _this107.data.name = effTeaseDamage.name, _this107.data.duration = 0, _this107.data.hidden = 0;
    return _this107;
  }

  _createClass(effTeaseDamage, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("effTeaseDamage", this);
    }
  }, {
    key: "onApply",
    value: function onApply() {
      this.data.duration = 0;
      this.parent.parent.Stats.increment('arousal', 1 * this.amount);
      if (this.data.duration < 1) this.parent.removeItem(this.data.id);
    }
  }, {
    key: "merge",
    value: function merge(neweffect) {
      if (neweffect.name === this.data.name) {
        //ignore
        //this.onApply();
        return false;
      }
    }
  }, {
    key: "onCombatEnd",
    value: function onCombatEnd() {
      this.parent.removeItem(this.data.id);
    }
  }, {
    key: "onTurnStart",
    value: function onTurnStart() {
      this.data.duration -= 1;
      if (this.data.duration <= 0) this.parent.removeItem(this.data.id);
    }
  }, {
    key: "desc",
    get: function get() {
      return effTeaseDamage.name;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(effTeaseDamage, value.data);
    }
  }]);

  return effTeaseDamage;
}(CombatEffect);

var effStunned = /*#__PURE__*/function (_CombatEffect10) {
  _inherits(effStunned, _CombatEffect10);

  var _super141 = _createSuper(effStunned);

  function effStunned() {
    var _this108;

    _classCallCheck(this, effStunned);

    _this108 = _super141.call(this);
    _this108.data.id = _this108.data.name = effStunned.name, _this108.data.duration = 2;
    return _this108;
  }

  _createClass(effStunned, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("effStunned", this);
    }
  }, {
    key: "onApply",
    value: function onApply() {
      this.data.duration = 2;
    }
  }, {
    key: "merge",
    value: function merge(neweffect) {
      if (neweffect.name === this.data.name) {
        //extends stun
        this.onApply();
        return true;
      }
    }
  }, {
    key: "onCombatEnd",
    value: function onCombatEnd() {
      this.parent.removeItem(this.data.id);
    }
  }, {
    key: "onTurnStart",
    value: function onTurnStart() {
      this.data.duration -= 1;
      if (this.data.duration <= 0) this.parent.removeItem(this.data.id);
    }
  }, {
    key: "desc",
    get: function get() {
      return this.data.name;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(effStunned, value.data);
    }
  }]);

  return effStunned;
}(CombatEffect);

var effCallHelp = /*#__PURE__*/function (_CombatEffect11) {
  _inherits(effCallHelp, _CombatEffect11);

  var _super142 = _createSuper(effCallHelp);

  function effCallHelp() {
    var _this109;

    _classCallCheck(this, effCallHelp);

    _this109 = _super142.call(this);
    _this109.data.id = _this109.data.name = effCallHelp.name, _this109.data.duration = 2;
    return _this109;
  }

  _createClass(effCallHelp, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("effCallHelp", this);
    }
  }, {
    key: "onApply",
    value: function onApply() {
      this.data.duration = 2;
    }
  }, {
    key: "merge",
    value: function merge(neweffect) {
      if (neweffect.name === this.data.name) {
        //ignore
        return true;
      }
    }
  }, {
    key: "onCombatEnd",
    value: function onCombatEnd() {
      this.parent.removeItem(this.data.id);
    }
  }, {
    key: "onTurnStart",
    value: function onTurnStart() {
      this.data.duration -= 1;

      if (this.data.duration <= 0) {
        window.gm.Encounter.spawnChar(this.data.item, this.data.faction, this.data.amount);
        this.parent.removeItem(this.data.id);
      }
    }
  }, {
    key: "configureSpawn",
    value: function configureSpawn(item, faction) {
      var amount = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;
      this.data.item = item, this.data.faction = faction, this.data.amount = amount;
    }
  }, {
    key: "desc",
    get: function get() {
      return effCallHelp.name;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(effCallHelp, value.data);
    }
  }]);

  return effCallHelp;
}(CombatEffect); //skills


var skCooking = /*#__PURE__*/function (_Effect18) {
  _inherits(skCooking, _Effect18);

  var _super143 = _createSuper(skCooking);

  function skCooking() {
    var _this110;

    _classCallCheck(this, skCooking);

    _this110 = _super143.call(this);
    _this110.data.id = _this110.data.name = skCooking.name;
    return _this110;
  }

  _createClass(skCooking, [{
    key: "toJSON",
    value: function toJSON() {
      return window.storage.Generic_toJSON("skCooking", this);
    }
  }, {
    key: "desc",
    get: function get() {
      return skCooking.name;
    }
  }], [{
    key: "fromJSON",
    value: function fromJSON(value) {
      return window.storage.Generic_fromJSON(skCooking, value.data);
    }
  }]);

  return skCooking;
}(Effect);
/*skAlchemist
 * Lv1 - can create potions from 1 ingredient
 * Lv2 - can create potion from 2 ingredients
 * Lv3 - can combine 2 potions into better one
 * Lv4 - can use 3 ingredients
 */


window.gm.StatsLib = function (StatsLib) {
  //...stats
  window.storage.registerConstructor(stHealthMax);
  window.storage.registerConstructor(stHealth);
  window.storage.registerConstructor(stRelation);
  window.storage.registerConstructor(stFetish);
  window.storage.registerConstructor(stAgility);
  window.storage.registerConstructor(stCharisma);
  window.storage.registerConstructor(stEndurance);
  window.storage.registerConstructor(stIntelligence);
  window.storage.registerConstructor(stLuck);
  window.storage.registerConstructor(stPerception);
  window.storage.registerConstructor(stStrength);
  window.storage.registerConstructor(stResistance);
  window.storage.registerConstructor(stEnergyMax);
  window.storage.registerConstructor(stEnergy);
  window.storage.registerConstructor(stWillMax);
  window.storage.registerConstructor(stWill);
  window.storage.registerConstructor(stArousalMax);
  window.storage.registerConstructor(stArousalMin);
  window.storage.registerConstructor(stArousal);
  window.storage.registerConstructor(stCorruptionMax);
  window.storage.registerConstructor(stCorruption);
  window.storage.registerConstructor(stArmor); //...effects

  window.storage.registerConstructor(effCallHelp);
  window.storage.registerConstructor(effDamage);
  window.storage.registerConstructor(effBleed);
  window.storage.registerConstructor(effCombined);
  window.storage.registerConstructor(effGrappled);
  window.storage.registerConstructor(effGrappling);
  window.storage.registerConstructor(effUngrappling);
  window.storage.registerConstructor(effEnergized);
  window.storage.registerConstructor(effNotTired);
  window.storage.registerConstructor(effTeaseDamage);
  window.storage.registerConstructor(effTired);
  window.storage.registerConstructor(effStunned);
  window.storage.registerConstructor(effGuard);
  window.storage.registerConstructor(effHeal);
  window.storage.registerConstructor(effEnergyDrain);
  window.storage.registerConstructor(effHorsePower);
  window.storage.registerConstructor(effMutateHorse);
  window.storage.registerConstructor(effMutateWolf);
  window.storage.registerConstructor(effMutateCat);
  window.storage.registerConstructor(effGrowBreast);
  window.storage.registerConstructor(effGrowVulva);
  window.storage.registerConstructor(effLewdMark);
  window.storage.registerConstructor(effInHeat);
  window.storage.registerConstructor(effInRut);
  window.storage.registerConstructor(effSpermInWomb);
  window.storage.registerConstructor(effVaginalFertil);
  window.storage.registerConstructor(effVaginalPregnant); //

  window.storage.registerConstructor(skCooking);
  return StatsLib;
}(window.gm.StatsLib || {});
/* twine-user-script #2: "Story JavaScript" */
</script><tw-tag name="template" color="orange"></tw-tag><tw-tag name="_back_" color="gray"></tw-tag><tw-tag name="_nosave_" color="yellow"></tw-tag><tw-tag name="_nodeffered_" color="yellow"></tw-tag><tw-tag name="_isdeffered_" color="brown"></tw-tag><tw-passagedata pid="1" name="Info_Jake" tags="_back_" position="100,100" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
Jake is here.&lt;/br&gt;
You barely know anything about him.&lt;/br&gt;
[[Back|_back_]]&lt;/br&gt;&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="2" name="Talk_Cyril" tags="_back_" position="225,100" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
Cyril is here.&lt;/br&gt;
&lt;a0 onclick=&#39;window.gm.giveCyrilFood()&#39;&gt;Give him some food&lt;/a&gt;&lt;/br&gt;
&lt;a0 onclick=&#39;window.gm.printOutput(window.gm.printBodyDescription(window.story.state.Cyril))&#39;&gt;Look at&lt;/a&gt;&lt;/br&gt;
&lt;/br&gt;&lt;div id=&#39;output&#39;&gt;&lt;/div&gt;&lt;/br&gt;   &lt;!--message is rendered here--&gt;
[[Back|_back_]]&lt;/br&gt;&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="3" name="Info_Mom" tags="_back_" position="350,100" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
Your mom is here.&lt;/br&gt;
&lt;% if(window.gm.player.Rel.get(&#39;Mom&#39;).value&gt;10) { %&gt;
She gives you a hug.
&lt;% } else { %&gt;
You can see a disapproving look on her face.
&lt;% }  %&gt;
&lt;/br&gt;
[[Back|_back_]]&lt;/br&gt;&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="4" name="Info_Trent" tags="_back_" position="475,100" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
You walk over to Trent. He is a horse-man.  
&lt;/br&gt;[[Back|_back_]]&lt;/br&gt;&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="5" name="TrentVictory" tags="_nosave_" position="600,100" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;% if(window.gm.quests.getMilestoneState(&quot;qBondageKink&quot;).id&lt;=300) { window.gm.quests.forceQuestMilestone(&quot;qBondageKink&quot;,400,300);%&gt;
Finally you found a weak spot in the defense of the stud. Reluctantly he gives up fighting.  &lt;/br&gt;&lt;!--todo--&gt;
&lt;p class=&quot;dev&quot;&gt;&quot;Fine, you won...this time.&quot;&lt;/p&gt; 
You dont have any breath left to give him a quirky response. &lt;/br&gt;
His comrades strut over to you and you are worried if they will give you some trouble. &lt;/br&gt;
But they just snicker and mock your opponent.&lt;/br&gt;
&lt;p class=&quot;tNPC2&quot;&gt;&quot;Whats up trent ? Did this whimp give your pony-ass a hard spanking.&quot;&lt;/p&gt;
&lt;span class=&quot;dev&quot;&gt;&quot;I&#39;m not a pony you fuckers !&quot;&lt;/span&gt; he yells. Being called a pony seems really to piss him off.&lt;/br&gt;
&lt;p class=&quot;tPC&quot;&gt;&quot;I&#39;m on my way then.&quot;&lt;/p&gt; Better to leave now before things get troublesome.&lt;/br&gt;
&lt;p class=&quot;author&quot;&gt;This is right now the end of the story. As you can see there is need for a lot of polishing.&lt;/p&gt;
[[Forward to new places]]&lt;/br&gt;
&lt;%} else {%&gt;
&quot;You just were lucky to pull that trick. Next time I will show you - SLAVE.&quot;
...
&quot;You are really though.&quot; admits the horse &quot;or I&#39;m just a little out of shape.&quot;
...
[[The winner takes it all]]
&lt;p class=&quot;tPC&quot;&gt;&quot;So horsie how about we go for a ride?&quot;&lt;/p&gt; 
Trent looks up to you, he already knows what that means. | Trent looks up to you with lust in his eyes. You should be careful not to end under his muscular body. | The recent acitivties got him quite pent up. But not that much that he will get involved with you. Maybe if you know each other better...  
&lt;a0 onclick=&#39;window.gm.postVictory();&#39;&gt;Walk away&lt;/a&gt;
&lt;%}%&gt;
&lt;/br&gt;&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="6" name="TrentSubmit" tags="_nosave_" position="725,100" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;% if(window.gm.quests.getMilestoneState(&quot;qBondageKink&quot;).id&lt;=300) { %&gt;
&lt;%} else {%&gt;
&lt;%}%&gt;
That didnt went as planned. That bully delivered a though blow and knocked you out. It didnt felt that lethal but the game has decided that you earned your death. &lt;/br&gt;
&lt;p class=&quot;tPC&quot;&gt;&#39;I need to do some leveling and get stronger or find another way to give myself a head start. Maybe the alchemist could help.&#39;&lt;/p&gt;
&lt;a0 onclick=&#39;window.gm.postDefeat();&#39;&gt;Black out&lt;/a&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="7" name="YouDiedOnce" tags="" position="850,100" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;
window.gm.quests.forceQuestMilestone(&quot;qDiedAgain&quot;,100,2);%&gt;
Darkness... &lt;/br&gt;
After some moments your vision fades in. &lt;/br&gt; 
&lt;p class=&#39;tPC&#39;&gt;&quot;What happend? Why I&#39;m sitting in a pool of ...goo?&quot;&lt;/p&gt;
&quot;Choosen one, this is a shrine of restoration! ...&quot; a priestess in a white robe with purple borders approachs you.
&lt;!--todo--&gt;
&lt;p class=&#39;tPC&#39;&gt;&quot;So I died? And after death I return here?&quot;&lt;/p&gt;
&quot;Those choosen by the goods might be revived in a shrine of restoration after their death or collaps of mind.&quot;
&lt;p class=&#39;tPC&#39;&gt;&quot;Collaps of mind? I just need to get stunned and will be sent back here?&quot;&lt;/p&gt;
&lt;p class=&#39;dev&#39;&gt;As a safeguard against mental trauma (*1) the players neural activity is supervised. If a certain amount of stress is detected (*2), the safeguard is triggered.
&lt;/br&gt;*1): This applys not just to painful trauma but also marvelous sensations to avoid addictive states (*3).
&lt;/br&gt;*2): Chances that the trigger is delayed or supressed might decrease if the user is inclined to the situation and has the proper mindset.
&lt;/br&gt;*3): According to user agreement §34-f2, the service-provider is not responsible for addiction caused by the use of the game.
&lt;/p&gt;
&lt;p class=&#39;tPC&#39;&gt;&quot;Addictive states? I&#39;m pretty sure I will not get addicted on getting killed.&quot;&lt;/p&gt;
You decide that you have been sitting in this sizzling pool of mysterious liquid long enough and rise to your feet to step out of it.
You notice that you are naked and try to hide your privates with your hands. 
&lt;p class=&#39;tPC&#39;&gt;&quot;Uhm...where is my gear?&quot;&lt;/p&gt;
&quot;The gods restored your body and mind but your gear is nowwhere to be found.&quot;
&lt;p class=&#39;tPC&#39;&gt;&quot;Oh come on should I ran around in my birthday suite?&quot;&lt;/p&gt;
&quot;Please take this cloth and staff as they are blessed by the gods to help you to live up to your goal.&quot;
&lt;p class=&#39;dev&#39;&gt; For testing purpose the game is set to rougelike mode: on death you will loose your equipment and get the starter-gear. 
But you keep your stats and skills (*1).  
&lt;/br&gt;*1): It might occur that the questline has to be started from the beginning. We are doing our best to solve the problem in the next updates. 
&lt;/p&gt; 
&lt;p class=&#39;tPC&#39;&gt;&quot;Start the questline from the beginning? I really hope they get that fixed soon.&quot;&lt;/p&gt;
&lt;div&gt;&lt;a0 onclick=&#39;window.story.show(&quot;ServerDisconnected&quot;);&#39;&gt;Next&lt;/a&gt;&lt;/br&gt;&lt;/div&gt;  &lt;!--todo forward time to evenning--&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="8" name="ServerDisconnected" tags="_nosave_" position="975,100" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.leaveVR();%&gt;
&lt;p class=&#39;div_alarm&#39;&gt;Server connection error&lt;/p&gt;
&lt;/br&gt;&lt;p class=&quot;tPC&quot;&gt;&quot;Great, I lost connection to the game server. Maybe it does reconnect...&quot; &lt;/p&gt;
You wait for some time but nothing happens,
&lt;p class=&quot;tPC&quot;&gt;&quot;I&#39;m tired anyway. I will check tomorrow if I can reconnect.&quot; &lt;/p&gt;
&lt;div&gt;&lt;/br&gt;[[Next|Your Bedroom]]&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="9" name="YouDiedWithCursedGear" tags="" position="1100,100" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&quot;Choosen one, this is a shrine of restoration!&quot; ... the acolyte starts heir rant.&lt;/br&gt;
&lt;p class=&quot;tPC&quot;&gt;&quot;Yeah, I know. I just got ass kicked again. At least I got rid of that freaking cursed... &quot;&lt;/p&gt;&lt;/br&gt;
But that damned thing is still there!&lt;/br&gt;
&lt;p class=&quot;tPC&quot;&gt;&quot;Hey, why is everthing gone except this?&quot;&lt;/p&gt;
&quot;At times the heros burden is increased by evil deeds and his epic story is extended further by finding closure for his curse.&quot; the priestess chants, holding out heir hands upward to heir gods.&lt;/br&gt;
&lt;p class=&quot;tPC&quot;&gt;&quot;So I&#39;m stuck with cursed gear but have to let go the good one?&quot;&lt;/p&gt;
&lt;p class=&#39;dev&#39;&gt;Some gear will stick to you. That doesnt need to be cursed one. In fact you can buy special gear that is bonded to you.&lt;/p&gt;
&lt;/br&gt;&lt;a0 id=&#39;1&#39; onclick=&#39;foo(this)&#39;&gt;This sucks&lt;/a&gt; &lt;a0 id=&#39;2&#39; onclick=&#39;foo(this)&#39;&gt;Would have been to easy&lt;/a&gt; &lt;a0 id=&#39;3&#39; onclick=&#39;foo(this)&#39;&gt;Its an incentive to not die&lt;/a&gt;&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt; function foo(select) {
    window.gm.quests.forceQuestMilestone(&quot;qDiedAgain&quot;,200,100);
    window.story.show(&quot;ServerDisconnected&quot;);
}
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="10" name="YouDiedBeforeOrgasm" tags="" position="1225,100" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
Delicate sensations builds in your nethers. 
&#39;Uh..yeah.. thats nice. &#39;
Longing for the carnal pleasure that this is promissing, you lose your eyes. But as you open them, the stimulation is gone and your surrounding is still black.
&quot;Whut ?!  What happend?&quot;
&quot;Choosen one, this is a shrine of restoration!&quot; 
&quot;Noo, the fun was just starting. Why are I&#39;m suddenly at the respawn again.&quot;
&quot;The gods saved you before your mind was breaking apart by onslaught of unsettling feelings.&quot;
&quot;Unsettling feelings? I didnt feel unsettleed by the prospect of getting fucked in the slightest!&quot;
&#39;Didn&#39;t they say that they supervise my stress-level and trigger a safeguard?&#39;
&quot;Hey dev !&quot; you scream out &quot;Can you hear me?&quot;
&quot;Anyone there listening? I want some adjustments here please.&quot;
As it seems dev-gods are right now not around or dont bother to answer to you.
&#39;Damit, I will just quit for now.&#39; 
[[Leave game]]  &lt;!--todo--&gt;
... receive chat from dev
&quot;Its difficult to separate the good stress from the bad one. Every persons has a different tolerance and it can change over time. Currently its in general set to be more on the safe side.&quot;
There isnt a slider controller or switch to simply adjust the setting to your liking. I can try to tweak it in a way.
...
I got kicked out again. 
&quot;That I expected. I wasnt able to change the setting directly. But I could activate the auto-tuning.&quot;
&quot;auto-tuning?.&quot;
&quot;Yes, the game will learn your individual excitation. Just calm yourself when you get in a situation you would like to hold on. It might be necessary to rerun a situation to improve the reaction.&quot;
&quot;OK, I will try it again.&quot;
&quot;Be careful, though. This can also lead to the fact that you have to endure unpleasant experiences longer.&quot;
&quot;I will keep that in mind.&quot; 
&lt;p class=&#39;author&#39;&gt;Scenes might gradually unlock depending how often you see them and how you react (also to other situations). &lt;/p&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="11" name="Skills" tags="" position="100,225" size="100,100">Disrobe: cast on Self or other; does not remove jewellery, enhanted or summoned armor
a naked body is less protected but might increase tease damage; exhibitionist streak increases targets arousal 
&quot;Why the fuck should I want to disrobe mids in combat?&quot;

Reduce Suffering: cast on Self or other; reduces willpower damage by physical pain but also makes you less sensitiv to other physical stimulation
lets you endure stressful situations better and reduces blackout chance;increases masochism tendency;
&quot;other physical stimulation means sex?&quot;

Animal Comprehension: cast on self or other; silently understand what animals say
having a chorus of thrilled animals in your mind might cause headache 
&quot;Now I can discuss the hen-egg-problem with chicken&quot;

Regeneration: cast on self or other; healing over time ; might increase fertility/virility for a limited time
overhealing friendly target might get them randy
&quot;Those side effects dont appear that terrible.&quot;

Hedgehog Eyes: you can see in the dark - a little bit better then most humans but far as good as a common cat
&quot;I would prefer cat-eyes. Spider-senses would be even better. But you have to take what you get.&quot;</tw-passagedata><tw-passagedata pid="12" name="SpecialItems" tags="" position="225,225" size="100,100">Orb of Tremor: a floating orb of variyng size and mass that slings itself against an enemy to deal blunt damage;
training allows to give better control about the motion and to navigate tight spaces
upgraded version can be used as spydrone
&quot;What could it be good for to squeeze a solid ball into a tight?.&quot;

SnakeRope: a leathery rope that is at least a dozen meters; it can move on its own and this movement can be controlled by whom held  
useful as climbing aid or to bind something up
&quot;Somehow this remmebers me at Indys whip.&quot;

Vial of slipery: a small vial with an unending supply of some slimy, greasy liquid of most likely organic origin.
can be used as grease for machinery or other parts that need lubrication. 
upgraded version can change color and taste
&quot;Unending huh? Will the world drown in goo if i put it upside down?&quot;</tw-passagedata><tw-passagedata pid="13" name="HowWillKnow" tags="" position="350,225" size="100,100">Its not like you do hand out blowjobs in real. This is virtual, right? No one will know beause this dude is just a mob.</tw-passagedata><tw-passagedata pid="14" name="PostDefeatCombat" tags="" position="475,225" size="100,100">&lt;devnote&gt;&quot;We are happy to announce that we have extended combat with exceptional new possibilities to allow more variety in tactics and better chances for certain character builds.
We would like to thank our player for the constructive criticism and are intent on your feedback.
Here is a short description what we changed:
Until now you had 2 options to defeat someone: kill them or fill up their arousal-meter.
If you get your health drowned but the foe is horny enough, there is a chance that combat switches over to sexual innuendo mode.
If you are able to wear out the foe before you do (*1), you score a win. 
So get out their and do some loving!
*1) balancing is still in progress&quot;&lt;/devnote&gt;
&quot;OOhKKeyyy. So this is now a rape-game?&quot;</tw-passagedata><tw-passagedata pid="15" name="PostDefeatCombat2" tags="" position="600,225" size="100,100">&quot;That brute is just to though. My staff doesnt deal enough damage.&quot;
You dodge another attack barely.
&quot;And he has that salacious grin on his face.&quot;
... You tease him until is meter is nearly full. But this just gets him enraged further.
You try to block him with your staff, but the smash just pushed the breath out of you.
He uses just that short moment and is on you, ripping your clothes away.
&quot;Ieekh&quot; you black out
&quot;Ieekh&quot; you are pretty sure that you already had this situation before and expect the safeguard to get you out of this. But it doesnt trigger.
...</tw-passagedata><tw-passagedata pid="16" name="GetPrincessBackSafe" tags="" position="725,225" size="100,100">Your task is to escort Princess Eve safely back to her step-mother, the queen regent.
She made clear that save means healthy with all body parts attached and - that she mentioned three times - as a virgin.
So you not only have to defend her against foes, but also the advances of suitors. The princess trys hard to be not a burden and to stay chaste.
But the primal urges of a youg girl in her age grow stronger...</tw-passagedata><tw-passagedata pid="17" name="RockFlowers" tags="" position="850,225" size="100,100">You have to collect a bunch of flowers growing on Mt.Scree for the local alchemist.
While this seems to be easy at first, it gets quickly difficult:
- climbing is not your thing; you need to borrow that snakerope for a favor
- harpies are trying to mate with you as does an oversized eagle
- Rams ram you 
- a snow-leopard-lady is prowling around for some nice, hard meat to stuff herself full with
Maybe you can play those 4 partys against each other</tw-passagedata><tw-passagedata pid="18" name="PantyPantsy" tags="" position="975,225" size="100,100">&lt;Trader&gt;&quot;No thanks, Im not wasting my good money for some useless scrap.&quot;&lt;/Trader&gt;
&quot;But those arent useless! Everyone here needs an sword.&quot;
&lt;Trader&gt;&quot;Everyone here already HAS as sword. Except those that cant afford one.&quot;&lt;/Trader&gt;
&quot;Oh come on. Sell them to a smith so that he can forge them into something useful then.&quot;
&lt;Trader&gt;&quot;Hmm, just because you are so persistant about this I offer you this: 1 coin for each.&quot;&lt;/Trade&gt;
&quot;1 coin! You sell them for 20!&quot;
&lt;Trader&gt;&quot;Yes, but I have to refurbish them you know.&quot;&lt;/Trader&gt;
&lt;Trader&gt;&quot;... scrap the blood and gore off them, polish them, put a price-label on each...But just keep them if you are fond of them&quot;&lt;/Trader&gt;
&#39;I can&#39;t even use those on my own.&#39;
[[Fine. I sell them]][[Nope]]
...
&lt;Trader&gt;&quot;A pleasure to make business with you. If you are really interested in making money, I have a job for you.&lt;/Trader&gt;
&lt;Trader&gt;I got some request for slips.&lt;/Trader&gt;
&quot;Slips? You mean underwear?&quot;
&lt;Trader&gt;Yes. Some fine female underwear. They just have to be ... used.&lt;/Trader&gt;
&quot;Used. Who on earth would want to buy dirty underwear?&quot;
&lt;Trader&gt;Not dirty! Not really dirty. Well, its kinda odd I agree. But that request was from a trader from the eastern sea. Nut sure what kind of customers he has. Those eastern guys are strange anyway.&lt;/Trader&gt;
&quot;If - and I&#39;m just saying IF - I would do that, what would you pay me?&quot;
&lt;Trader&gt;Lets see, I can pay you half of what I get. Thats around 500 coins but only if you gather at least 5. &lt;/Trader&gt;
&quot;Only half? I do all the work and only get 50% of your profit?&quot;
&lt;Trader&gt;Hey I have work with this too. Filling out papers, ordering shipment, alculating taxes...&lt;/Trader&gt;
&quot;And just some random underwear?&quot;
&lt;Trader&gt;Oh no. They have to be worn by dryads.&lt;/Trader&gt;
&quot;Dryads? Where can I find dryads? ..And do they really wear cloths at all?&quot;
&lt;Trader&gt;Dryads should live in forests I assume. If they wear cloths I &#39;m not sure of&#39;.&lt;/Trader&gt;
[[I will do it]]
&quot;So did you sell those slips?&quot;
&lt;Trader&gt;&quot;Yes and no. I sold them, but only for 5.&quot;&lt;/Trader&gt;
&quot;Only 5 each?&quot;
&lt;Trader&gt;&quot;No 5 in total. He rumbled something about that they werent smelly enough. Its diffiult with those guys you know. They barely cut to the point.&quot;&lt;/Trader&gt;
&quot;Oh man, all the work for nothing.&quot;
&lt;Trader&gt;He still wants 5 soaked dryad panties.&lt;/Trader&gt;
&quot;Soaked dryad panties. Could you please improve my understanding of the term soaked.&quot;
&lt;Trader&gt;&quot;A panty has a chance to aquire the soaked-state when its wearer - the dryad in this matter - is so horny that her own mumu produces enough stickiness.&quot;&lt;/Trade&gt;
&quot;Doubt it or not but I guessed that.&quot;
&lt;Trader&gt;Shouldnt be a big issue for a pretty boy like you. Heard they are horny all the time anyway.&lt;/Trade&gt;
...
&lt;Trader&gt;&quot;Unfortunatly the trader left. So you should travel after him to bring those messy slips to him. I already placed them here on this cart in a strongbox.&quot;&lt;/Trader&gt;
&quot;A strongbox? Maybe I&#39;m wrong but couldn&#39;t a strongbox rise suspicion that I&#39;m delivering some valuables.&quot;
&lt;Trader&gt;&quot;They are valuables, at least to someone. And we put so much work in it, would be a shame to let it go to waste, right?
Just make sure that you get as fast as possible to westport.&quot;&lt;/Trader&gt;
&quot;Because of the bandits that will go after me because they think I have some gold in that strongboX?&quot;
&lt;Trader&gt;Bandits aybe. But also other things might interested if they pickup the scent of horny dryad cunt crossing their territory.&lt;/Trader&gt;
&quot;Other things?&quot;
...
&lt;Trader2&gt;&quot;I appreciate your servitude and would like to give you one of those as a bonus.&quot;&lt;Trader2&gt;
&quot;I would prefer somme coin instead.&quot;
&lt;Trader2&gt;&quot;But really I would like you to have that one. And I will give you 10 as a tip or 100 if you wear them.&quot;&lt;Trader2&gt;
&quot;Just give me the 10.&quot;
&quot;Hey thats to much&quot;
&lt;Trader2&gt;So you have to wear them, a deal is a deal.&lt;/Trader2&gt;</tw-passagedata><tw-passagedata pid="19" name="PantyPantsy2" tags="" position="1100,225" size="100,100">&quot;Are you still in pantie-business? I got some more request here. Someone asks for panties from a dragoness.&quot;
&quot;I doubt dragons wear panties. They are animals right? Animals dont wear cloths.&quot;
&quot;Ahh. prejudice.... &quot;
&quot;And who in the world would want that anyway?&quot;
&quot;Even more prejudice. Anyway. Find a dragon and get those panties. And if it doesnt have some, obtain some and get her to wear them. And then get them back. Easy peasy right?
I mean, I dont ask to get me 3 pieces again, just one.&quot;
&quot;I dont even know where I could find a dragon. And if knew, I would stay away from there.&quot;
&#39;I could just get some oversized pantys and make him believe its from a dragon.&#39;
&quot;I will do it.&quot;
&quot;Very good&quot; you seal the contract by hand. &quot;I&#39;m really sure you get this done.&quot; 
...
&quot;You got pantys? That cocksure grin tells me: for sure you do. &quot;
&quot;Well I can tell...&quot; before you can even start to narrate your devised story the trader bubbles on.
&quot;That was much faster then the other guys. Just show me what you got and I will get my detector to proof it.&quot;
&quot;detector?&quot; you are dumbfounded and deeple worried at the same time.
&quot;Yeah thats some awesome gadget I spent a lot of money in. You wont believe how many people tried to rip me off telling this for that. A mage sold it to me, showed how it can be used to detect different sort of things.
As I said some guys brought me that crude slip just a short while ago. Swush - I used the detector - didnt show dragon. They were really surprised as the guards led them to the gallows.&quot;
&quot;Gallows?!&quot;
&quot;They take it really serious now with faking things. Order from top management: no business with fake-items, be it gold-coin or dragon-pantys. Just visit them, maybe you saw them when entering the market, dancing happily in the air.&quot;
&quot;Uhm...I..I just wanted to tell you that I will need some more time OK. Its...its...I&#39;m on it yes?&quot;
&quot;Oh sure sure&quot;
You quickly hurry off &#39;a detector that can detect dragons?! Who in the world would be in need for that. I mean, you see a dragon or not.&#39;
No cheating here, get that mission done.
...
&#39;Thats a dragon, question is, is it male or female.&#39;
You try to peek undertail from your hiding spot.
&#39;Is that a slit?&#39; you are not really an expert for dragon genitalia - and for sure doesnt want to become one.
So you found a dragon, a female one you guess. 
&#39;That was the easy part. But how to get to wear that thing underwear, without beeing eaten. And where would I get something fitting anyway.&#39;
Get some of those gobbled up spiderweb from the cave. Those are stretchy and durable and might be useful as cloth-replacement. &#39;Its spidersilk fashion, I will tell them.&#39;
...
The dragon is now resting lazily on its side and watches you.
You circle around but keep your eyes peeled on that muzzle that is filled with dagger-sized teeth. As you pass by it slowly raises that hindleg not resting on the ground.
Your gaze is attracted to that movement and you blush deeply as you find yourself staring at whats inbetween those legs. 
&#39;She did that on cause. Oh my, I really thought SHE. I should think - IT - not she! &#39;
...</tw-passagedata><tw-passagedata pid="20" name="DemonVisitant" tags="" position="1225,225" size="100,100">...
With on hand on the wall and a torch in another you walk forward down another corridor of that labyrinthian place.
A uncareful step on a old, wodden plank that is to rotten to bear your wight and your foot crashs through the floor. Not far but enough to let you trip. With both hands you catch your fall.
Unfortunatly you let go of the torch that falls down to the ground, sending out firey sparks as it rolls around.
At first you fear that this will set the whole place at fire. But that fear is soon replaced with another one as you see it rolling to the edge of the ballustrade. 
Quickly dashing forward you try to grab it before it vanishs, but its to late. 
The torch falls over the edge and all the light is gone.
&#39;This is really bad.&#39;
...
Just before you hear it you an feel wood splittering again. And how you fall through the air. 
And you think: &quot;If I&#39;m lucky I die and I get out of here.&quot;
And dying you do as your body hits the paved ground 2 dozen meters below.
And you are back. As usual sitting in that restoration-pool.
But something is wrong. Its still dark except the dim glow caused by the fluid in the pool. This is for sure not the usual shrine that you had now enough chances to wake up in.
You climb out of it and look around as far as you can see with that little light.
&#39;Hello?...Priestess are you here?&#39;
There is just some echo. An echo that indicates that you are somewhere in a building - or underground.
&#39;Oh fuck where am I?&#39; You rush another turn around the shrine, looking everywhere for some hints where you are. And for something to dress in.
You are still naked. 

&lt;Demon&gt;You arent going to make it from here. Just try and you will see.&lt;/Demon&gt;
While you cannot see any trace of whoever is speaking to you, your imagination shows you a face with a sardonic grin plasterd on it.

You need to find a way out of here. But the further you strive a way from the shrine the darker it gets until you cant see your hand in front your eyes.
&quot;This sucks.&quot;

&lt;Demon&gt;Come on, lets help each other. I wanna leave that hellhole just like you.&lt;/Demon&gt;
&quot;Help you? You keep me prison here and dare to ask for help!&quot;

&lt;Demon&gt;It wasnt me that trapped you here. This place is either a well thougth snare or an accident.&lt;/Demon&gt;
&quot;How could I trust you, I dont know how you are and cannot even see you.&quot;

&lt;Demon&gt;Thats a point my. But is it to much to ask for a little bit o trust nowadays?&lt;/Demon&gt;
&quot;Stay away. I will find a way, believe me.&quot;
&lt;Demon&gt;Fine. Suit yourself.&lt;/Demon&gt;

&quot;Hello?...Hello voice. Are you still there?&quot;
Silence
&quot;Can we talk again?...About helping each other&quot;
Silence
&quot;HEY...can you here me?&quot;
Silence
[[Plead some more]]
Still now answer. You crouch down on your knees, feeling helpless and left-behind. 
&lt;Demon&gt;So you going to listen now?&lt;/Demon&gt;
&quot;Huh..you are still here&quot;
&lt;Demon&gt;Nope&lt;/Demon&gt;
&quot;You said we should help each other. So, how could I help you and you me.&quot;
&lt;Demon&gt;I&#39;m stuck here similiar to you. Except that I dont have the variety to die and be revived. 
I could grant you a skill, that lets say, make you see in the dark.&lt;/Demon&gt;
&quot;See in the dark!&quot; you blurt out. &#39;That would really be o help.&#39;
&lt;Demon&gt;Just to be clear. Its not like walking in bright daylight.&lt;/Demon&gt;
&quot;Sure. But what do you want for this.&quot;
&lt;Demon&gt;As you can see - or better not see. I lack a suitable body at the moment. Which makes it difficult to get anywhere. &lt;/Demon&gt;
&quot;How did that happen? I guess a bug made your avatar glitch.&quot;
&lt;Demon&gt;I&#39;m not sure what you mean with glitch, but it wasn&#39;t a bug that caused my loss. No, it was a bunch of zombies that ripped that body appart &lt;/Demon&gt;
&quot;Zombies!?&quot; 
&lt;Demon&gt;Yes. Those stinky, shuffling, brain slurping meatpiles. They usually are not a big issue. But..well I got a little careless and they overrun us.&lt;/Demon&gt;
&quot;Us? You mean there are others here to.&quot;
&lt;Demon&gt;Only one. And I&#39;m pretty sure he switched sides in the meantime. Just try to be silent for a moment. Maybe then you are able to hear them stirring up. &lt;/Demon&gt;
You hold your breath and try to listen as intense as possible. Are there some shuffling noises from the oposite of the room?
Right now you feel even more in a hurry to get out of here.
&quot;So, what exactly do you want from me?&quot;
&lt;Demon&gt;If you check those dirtpile other there, you will notice several mushrooms. Somewhere there has to be an amulett with a small figurine. Just pick up and wear it.&lt;/Demon&gt;
&quot;Do I really have to wear it? I had some bad experiences with cursed gear.&quot;
&lt;Demon&gt;Oh. Well I think its good enough if you just hold it in your hands or put it in a pocket. Sorry, I forgot. Pockets are actual out of scope.&lt;/Demon&gt;
&quot;And how do you grant me that skill?&quot;
&lt;Demon&gt;Please pickup the amulet first, then I will tell you&lt;/Demon&gt;
&lt;Demon&gt;Fine, please dont loose it. So, you see those fungus all around. Some of them are white as a bone. I recommend to not even touch those. But you should also see some more bluish color.&lt;/Demon&gt;
You check the fungus. &#39;White,white, shitbrown, white,white,coalblack...hm not sure if this would count as blue&#39;
&quot;I only see a single stalk here that could be called bluish. Is it that kind?&quot;
&lt;Demon&gt;Yes, yes very good. You have to eat it, make sure to consume the entire stalk. &lt;/Demon&gt;
&quot;And you sure that isnt poisenous to me?&quot;
&lt;Demon&gt;Guarantee. Everything will be fine. And you will be able to see in the dark, but just for an amount of limited time.&lt;/Demon&gt;
[[Eat the fungus]]
...</tw-passagedata><tw-passagedata pid="21" name="GroupActivities" tags="" position="100,350" size="100,100">...
While Brad is talking with that huntress, the other 2 members are whispering to each other and you try to catch some of ther talk.
But you only catch &#39;...could be useful...&#39; and &#39;...distraction...&#39;. At least you think that you heard.</tw-passagedata><tw-passagedata pid="22" name="VirtualPregnancy" tags="" position="225,350" size="100,100">...
As you drift of into afterglow, a sudden thought crosses your mind: &quot;You cant get pregnant here do you?&quot;
&quot;But no. At least not reallife pregnant. Virtual pregnant is a complete different issue.&quot;
&quot;Virtual pregnant?&quot;
&quot;Yeah, I heard they are working on that. Not sure if I would like that. Hope they add an option to switch it off.&quot;
&quot;You mean, you can get children here?&quot;
&quot;Those guys go where the money is. If people want to grow a family here, I&#39;m sure they will do something about it.&quot;</tw-passagedata><tw-passagedata pid="23" name="FreedomOfArt" tags="" position="350,350" size="100,100">&quot;we are curently working to upgrade our servers that should help improving performance and accessibility from more locations. More content will be added once we have finished with this operation.&quot;
...
&quot;Breaking news:We are happy to announce that we found a solution for our increasing server-capacity-demand by teaming up with the national hosting service of the VR northkorea.
The offizielle Verantwortliche unterstützt das Abkomen mit folgenden Worten (*automatische Übersetzung): ...der Missbrauch und Ausbeutung ihrer eigenen Bevölkerung kümmert uns wenig. Dies wird sogar den Prozess beschleunigen ihnen die Augen zu öffnen wie sie von kapitalistischen Ausbeutern unterdrückt werden. 
So lange werden wir ihr Geld nehmen und für unsere eigenen Zwecke einsetzen um die degenerierten Elemente zu bekämpfen.
Der CEO von brachte seine Wertschätzung gegenüber der so positiv eingestellten Regierung des Landes zu Ausdruck: Allen jenen die behaupten es handle sich bei VR NK um ein rückständiges, unterentwickeltes Land, dessen korrupte Offizielle die eigene Bevölkerung  in Lagern einsperrt und dort elendlich verhungern lässt entgegne ich:
das mag schon sein aber mit dem nun abgeschlossenen Vertrag haben wir weitaus besser Konditionen und rechtliche Freiheiten als dies in unseren eigenen Heimatländern ja möglich wäre. Dieses Geschäft verspricht enorme Renditen bei gleichzeitig minimierter Verantwortung durch die Geschäftsführung von VR. &quot;</tw-passagedata><tw-passagedata pid="24" name="MeettheDev#2" tags="" position="475,350" size="100,100">&quot;Sure, since the command-input of the game is done via your body motion instead of a simple button press, its much more difficult to solve some skills.&quot;
&quot;Maybe you it can help if you improve your skills by training them in realworld.&quot;
&quot;So I should run around and hit people on the head with a bat?&quot;
&quot;Nah, that could cause some trouble of course. But for example dancing or other non threatening skills.&quot;</tw-passagedata><tw-passagedata pid="25" name="MeettheDev#3" tags="" position="600,350" size="100,100">&quot;I have to say I&#39;m not so happy about all your complaints. In fact it cast a slur on our department.&quot;
&quot;But its my job as a betatester to point out issues in the game.&quot;
&quot;You need to understand that we have to check everyone of your findings and this causes even more work in our crunch-phase and delays our schedule. And if we dont met our schedule the bosses will reprimand us.&quot;
&quot;Isn&#39;t the main goal to have the best game quality for the customers?&quot;
&quot;Thats the priority of the quality guys, our priority is to meet the schedule. If anyone is to find some bugs after the game is released, its the problem of the quality department, not ours. Thats the reason they force those betatesting un us.&quot;
&quot;But the tests are running autonomous anymway, I cannot influence them.&quot;
&quot;Enough of your complains. I see I have to find a way to make you less an annoyence.&quot;</tw-passagedata><tw-passagedata pid="26" name="MetttheDev#4" tags="" position="725,350" size="100,100">&quot;I got an idea how to get us some extra money. Do you know something called bitcoin&quot;
...
&quot;So, maybe someone found a way to reroute some processing power from the servers to do the calculation. They would still face the risk that this is detected by the supervising dispatch processors. So as an countermeasure it would be necessary to keep those supervisors distracted with other things... &quot;
&quot;And here you come into view.&quot;</tw-passagedata><tw-passagedata pid="27" name="PureMedical" tags="" position="850,350" size="100,100">&quot;VRGames will cooperate with Impert, a developer of equipment for sport and medical application. Impert brings in a deep scientific knowledge about how to greatly improve the physical and mental condition that we will try to use to add an additional benefit to the games mechanic.&quot;
&quot;for consumer safety testing purpose, you will be required to wear those gadgets for a duration we see fit. To encourage your engagement in the game we will raise additional penaltys when not meeting the required conditions.&quot;
Unlock VR headset with muzzle+gag, crotch cover, fuckmachine, drugapplicators, estim-devices</tw-passagedata><tw-passagedata pid="28" name="ClairesPotionDisaster" tags="" position="975,350" size="100,100">Clair isnt allowed to visit the forest anymore because the apothecary is angry with her.
&quot;I need your help. I made a mistake and accidently dropped something in the waterhole in the deep forest. Now those wolves seem to act more aggressively.
Please help me to straighten out this error.&quot;
&quot;What did you drop into the waterhole?&quot; &quot;Its some kind of charm.&quot;
&quot;So you want this charm back? And that solves the problem and she wont be angry with you anymore?&quot;
&quot;I&#39;m not sure if it resolves the situation immediatly but at least its a start. Please dont speak to her about this.&quot;
[[Promise]] [[Not sure]]
The apothecary is here. Maybe you should ask for more information even if you promissed to not talk about the issue.
&quot;She is really a bad girl.&quot; &quot;But it was an accident.&quot;
&quot;An accident? For sure not. She made that charm by herself and placed it at the waterhole on intent.&quot;
&quot;What intent?&quot; &quot;Well, by what I was able to squeeze out of her, she tried to create a love incentive.&quot;
&quot;Huh. Why would she do that.&quot;
&quot;I think she has taken some interest at those damn wolves and tried to befriend them.&quot;
&quot;Watch your back and keep your pants up.&quot;
The idea of being hunted down by randy wolves [[worrys you]][[gives you a thrill]].</tw-passagedata><tw-passagedata pid="29" name="HippieSlaver" tags="" position="1100,350" size="100,100">Du triffst auf eine friedfertige Gruppe
Unterwegs triffst du einen verwundeten Krieger den du zur Gruppe bringst damit sie ihn aufpäppeln.
Er freundet sich mit ihnen an.
Später bringt er noch einen Freund mit und sie bandeln mit einigen Frauen an.
Als noch mehr auftauchen wird es problematisch.
Entscheide was zu tun ist: a) stelle dich gegen die Eindringlinge oder b) bringe die Gruppe dazu sich aufzuteilen
a) die Fremden ziehen ab aber du verlierst wegen deiner Gewalt das Vertrauen der Gruppe; die Krieger nehmen sich dich ins Korn happy Gangrape
b) einige Frauen gehen mit den Kriergern mit; sie werden versklavt; später wird dann auch der Rest der geschwächten Gruppe hopsgenommen</tw-passagedata><tw-passagedata pid="30" name="ManOfGoats" tags="" position="1225,350" size="100,100">Eine Bauernfamilie hat mehrere Ziegen und stellen Ziegenkäse her von dessen erkauf sie leben.
Allerdings ist der Geisbock weggelaufen und wenn die Geissen keine Junge haben geben sie keine Milch. 
Ohne genug Geld kann kein neuer Bock gekauft werden.
1a) finde den alten Bock
1b) seine libido muss etwas aufgefrischt werden
1c) now he is eager for anyone
2a) oder überzeuge einen Satyr auszuhelfen 
2b) damit die Geissen ihn ranlassen brauchen sie einen Liebestrank</tw-passagedata><tw-passagedata pid="31" name="FastForward" tags="" position="100,475" size="100,100">Depending if you played the game already you might skip to a certain point:
[[Create avatar]]</tw-passagedata><tw-passagedata pid="32" name="GameInvite" tags="" position="225,475" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
As you skim through your email, you notice a letter from a Gaming-service where you have your Online-Roleplaying-Account for Dominion-of-Slayers registered.&lt;/br&gt;
&lt;p class=&#39;tNPC2&#39;&gt;&quot;Dear sir or madam, we are happy to announce that your starter subscription will end soon and you will be automatically upgraded to an experienced-member account for free*. 
If you are no longer interested in our service, click the link below to cancel your membership. However, canceling your membership now would lead to unrecoverable loss of your avatars game-progress, stats and inventory.
Note*: the upgrade from starter to experienced-member is free of cost; monthly subscription cost will be only 30$ instead of 2$ for your actual starter-membership.&quot;&lt;/p&gt;

&#39;WTF...they are going to charge me 30 bucks a month! Those fuckers. I cant afford that. There wasn&#39;t much good content update recently anyway. &#39;
&lt;div id=&#39;select1&#39; &gt;
&lt;a0 onclick=&#39;window.gm.printTalkLink($(&quot;div#select1&quot;)[0],&quot;div#choice1a&quot;)&#39;&gt;Call your friend Brad&lt;/a&gt;
&lt;/div&gt;
&lt;div id=&#39;choice1a&#39; hidden&gt;
&lt;p class=&#39;tPC&#39;&gt;&quot;Hey Brad, did you also receive that mail from GameWorld with account-change?&quot;&lt;/p&gt;
&quot;Yeah, I just wanted to talk about it with you too. What do you think?&quot;
&lt;p class=&#39;tPC&#39;&gt;&quot;We put so much work into this, I wouldnt like to get all of this to waste. But 30$ is really a lot of money for someone studying.&quot;&lt;/p&gt;
&quot;Even for someone who is working regulary this is alot of money dude. If you leave the game I will leave too.&quot;
&lt;p class=&#39;tPC&#39;&gt;&quot;To tell you the truth, it wasnt that fun to play recently. Somehow they messed up the games balancing with those updates.&quot;&lt;/p&gt;
&quot;Thats on purpose. They just want you to buy those boosters for real money!&quot;
&lt;p class=&#39;tPC&#39;&gt;&quot;Yep. So its set. Lets pull them a finger and quit.&quot;&lt;/p&gt;
&quot;Lets do it together 3..2..1..Sent&quot;
&lt;p class=&#39;tPC&#39;&gt;&quot;Me too. Maybe we should try one of those free-to-play games next? I heard SandyBeachBattle is worth a look.&quot;&lt;/p&gt;
&quot;Im not sure. ..Hey wait I got a mail. But its not from DoS. Its some kind of Invite to a different game... Lets see...&quot;
Just in that moment you got mail too: &lt;/br&gt;  
[[Check mail|GameInvite1b]]&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="33" name="GameInvite1b" tags="" position="350,475" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
&lt;p class=&#39;tNPC2&#39;&gt;Dear &lt;%=window.gm.player.name%&gt;,&lt;/br&gt;
you got selected by ServiceAsGame to receive an invite as beta-tester for our new, MOBDSMRP-Game MiracoulusMultiplayerAlwaysOnlineVirtualReallityMassiveServiceRougue-Game.
Be part of a growing gaming community and get involved in exciting quests and rakish adventures. 
Please note that the content rating of the game is pending and is therefore restricted to adult audience only.
Click the personalized link below to sign up for a free selected account in &lt;/br&gt;Season-Quest&lt;/br&gt;
Because of the high demands on this new generation service-game, only thoose that act quickly will get a chance to parttake on the program. So hurry up!&lt;/p&gt;
&lt;/br&gt;
&#39;A new game, huh? I would really like to see what this is about. If its free of charge, that would be nice. &#39;
&lt;p class=&#39;tPC&#39;&gt;&quot;I got an invite too. For something called Season-Quest. Never heard of that.&quot;&lt;/p&gt;
&quot;Thats the same I got! If thats just a coincidence ?! But its from a different company.&quot;
&lt;p class=&#39;tPC&#39;&gt;&quot;Should we try this? Its adult only, so no annoying kiddos fucking up our game.&quot;&lt;/p&gt;
&quot;Yeah lets sign in together. I always wanted to see what beta-testing is about!&quot;&lt;/br&gt;
Clicking the link you got forwared to a registration page where you have to enter personal information.
&lt;p class=&#39;tPC&#39;&gt;&quot;Uhm, they want the passportnumber&quot;&lt;/p&gt;
&quot;Of course, because age-checking&quot;&lt;/br&gt;
Entering the required information you press Next and are presented a window with densly scribbled text that is barely readable and even less understandable: the user-agreement.&lt;/br&gt;
&lt;span class=&quot;tPC&quot;&gt;&#39;I should check this...&#39;&lt;/span&gt; you start reading but soon just scroll trhough the text.&lt;/br&gt;
&lt;span class=&quot;tPC&quot;&gt;&#39;Looks standard for me&#39;&lt;/span&gt; you click next and are presented another window with similiar advocat scribbling.&lt;/br&gt;
&lt;span class=&quot;tPC&quot;&gt;&#39;Come on now&#39;&lt;/span&gt; you groan, just scrolling down endless text and hitting next.&lt;/br&gt;
&quot;Congratulations. You are now registered in our beta-test-program and will receive login-credentials and gaming equipment.&quot;
&lt;span class=&quot;tPC&quot;&gt;&#39;What gaming equipment?&#39;&lt;/span&gt;
&lt;p class=&#39;tPC&#39;&gt;&quot;Hey Brad did you finish registration? I got a confirmation about receiving gaming equipment.&quot;&lt;/p&gt;
&quot;Oh yes, I think I saw something about that there is some new generation MoCap-equipment required to play.&quot;
&lt;p class=&#39;tPC&#39;&gt;&quot;MoCap?&quot;&lt;/p&gt;
&quot;Motion-Capturing dude. Seems you need something more than just your ordinary VR-googles to play this.&quot;
&lt;p class=&#39;tPC&#39;&gt;&quot;Do we have to pay.&quot;&lt;/p&gt;
&quot;They just stated they lent it for the test....uhm .I forgot I have to leave. see ya later.&quot;
&lt;p class=&#39;tPC&#39;&gt;&quot;Sure.&quot;&lt;/p&gt;
&#39;Im really tired now. Lets see when the equipment shows up.&#39;&lt;/p&gt;
&lt;a0 onclick=&#39;start()&#39;&gt;Close Browser&lt;/a&gt;

&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt; function start() {
    window.gm.quests.addQuest(&quot;qDLCMain&quot;,100);
    window.gm.quests.addQuest(&quot;qDiedAgain&quot;,1);
    window.gm.quests.addQuest(&quot;qFixLaptop&quot;,1);
    window.gm.quests.addQuest(&quot;qBeastKink&quot;,1);
    window.gm.quests.addQuest(&quot;qBondageKink&quot;,1);
    window.story.show(&quot;Your Bedroom&quot;);
}
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="34" name="ReceiveVREquipment" tags="" position="475,475" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.quests.forceQuestMilestone(&quot;qDLCMain&quot;,500,100)%&gt;
As you got home from your daily chores and fiddling with the keys to your dorm, you find a parcel at the door step.&lt;/br&gt;
By the label on it you guess it might contain the gear from the game.&lt;/br&gt; 
&#39;Lets get started with that.&#39;&lt;/br&gt;
[[Next|SetupVREquipment]]&lt;/div&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="35" name="SetupVREquipment" tags="" position="600,475" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.quests.forceQuestMilestone(&quot;qDLCMain&quot;,600,500)%&gt;
The package contains a VR-headset, some papers and something that looks like gloves for your hands. They have some cables worked into them, so you guess they are used instead of controllers.&lt;/br&gt;
[[Call Brad]]&lt;/br&gt;
You pull out your phone and choose Brads number. But he doesnt answer the call. Maybe he is still at work.&lt;/br&gt;
[[Check the papers]]&lt;/br&gt;
The first piece of paper welcomes you as to the beta-tester-program for Season-quest and also contains your login credentials.&lt;/br&gt;
The other paper contains a list of the delivery and to your horror sums up a bill at the end.&lt;/br&gt; 
&#39;2300$ ! I will send this right back. They never said I have to buy that.&#39;&lt;/br&gt;
You read some more:&lt;/br&gt;
&quot;...the delivered equipment will be lent free of charge for the participation in beta-test. At the end of the test, the equipment might be handed over to the user.&quot;&lt;/br&gt;
&#39;Phew. So I dont have to pay it &#39; Reading some more &lt;/br&gt; 
&quot;...compensation fines might be raised on contract violation as of example:&lt;/br&gt; 
* preliminary abort of the participation by the user
* damage or misuse of the provided equipment
* obstruction of beta-test-program or the game itself
* disclosure of game-related information&quot;
&lt;/br&gt;&#39;Ok, no problem yet. I think thats just reasonable for something like a beta-test.&#39;&lt;/br&gt;
&quot;Please note that you are responsible to regulary check your test-schedule for your assigned pending task.
Tasks noted as required have to be fullfilled within the given time window. Continous failing to do so might count as obstruction of the test-program... &quot;&lt;/br&gt;
&#39;Damit, what did I get mmyself into. Lets check online about this schedule.&#39;&lt;/br&gt;
You login with your credentials on the PC and are greeted by a welcome screen:&lt;/br&gt;
&quot;Welcome &lt;%=window.gm.player.name%&gt;, this is your actual profile:&quot; &lt;/br&gt; 
* no avatar
Tasks:&lt;/br&gt;
* Setup equipment to game
* Create avatar
* Finish Game introduction
&lt;/br&gt;
Adorning the gloves and the VR-googles, you first have to run introductory tutorial. &lt;/br&gt;
You get some info how to use your hands movement for navigationg the screen and you even can use speech-control to do so.&lt;/br&gt;
You are eager to create your avatar and get a look at the game. On the other side, you would like to talk about your current experience with Brad first and see if he has gotten as far as you.&lt;/br&gt;
Besides its already gotten late.&lt;/br&gt;
[[Logout]]
You remove the headset. Still in the suite you call Brad again. This time he responds after some time.&lt;/br&gt;
&quot;Heya whatsup?&quot;
&lt;p class=&#39;tPC&#39;&gt;&quot;I got that equipment, you too? Isnt it awesome?&quot;&lt;/p&gt;
&quot;Yeah. You already got it working dude?&quot;
&lt;p class=&#39;tPC&#39;&gt;&quot;It took me over an hour. Did you already login?&quot;&lt;/p&gt;
&quot;Uh no, I&#39;m still struggling with the gear. Maybe there is something missing here.&quot;&lt;/br&gt;
You chuckle to yourself &#39;So Mr.IKnowEverything failed on the mechanical part already&#39;&lt;/br&gt;
[[Offer your help]]
&lt;p class=&#39;tPC&#39;&gt;&quot;I can help you tomorrow to get it setup if you want.&quot;&lt;/p&gt;
&quot;I will just give it a try tommorow morning on my own. I&#39;m just to tired from work, you know.&quot;
&lt;p class=&#39;tPC&#39;&gt;&quot;So you have a day off tomorrow? Just wait for me before doing quests. Its not fair if you get a head start just because I&#39;m busy all day.&quot;
&quot;Dont worry. As usual I will help your lazy ass leveling up to catch up with me.&quot;
&lt;p class=&#39;tPC&#39;&gt;&quot;For sure&quot;&lt;/p&gt; &#39;I should have already started the game to get a head start.&#39;
You can hear him yawning &quot;I&#39;m going to sleep now.&quot;
&lt;p class=&#39;tPC&#39;&gt;&quot;Me too. See you tomorrow then, bro.&quot;&lt;/p&gt;
&quot;Yup. See ya.&quot;
You put your phone away. A shower and some sleep would be nice.&lt;/br&gt;
[[Next|Your Bedroom]]
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="36" name="VREquipment2" tags="" position="725,475" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
The email reads:
&quot;Dear tester, we just noticed that a part of the game equipment was not delivered to you. We will make another attempt to send it to you within short time.&quot;
&#39;But I have equipment received. I didnt notice anything missing.&#39;
[[Next]]&lt;/div&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="37" name="ReceiveVREquipment2" tags="" position="850,475" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.quests.forceQuestMilestone(&quot;qDLCMain&quot;,500,100)%&gt;
As you got home from your daily chores and fiddling with the keys to your dorm, you find a sticky note on your door:&lt;/br&gt;
&quot;Pickup parcel from Melanie&quot;&lt;/br&gt;
&#39;Melanie? parcel?&#39; You slap your forehead &#39;Ah yes, that might be the gaming equipment.&#39;&lt;/br&gt;
&lt;div id=&#39;select1&#39; &gt;
&lt;a0 onclick=&#39;window.gm.printTalkLink($(&quot;div#select1&quot;)[0],&quot;div#choice1a&quot;)&#39;&gt;knock at her door&lt;/a&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div id=&#39;choice1a&#39; hidden&gt;
Melanie opens. You guess she is around 20-something. She alway seemed to be annoyed by something.&lt;/br&gt;
Just like now.&lt;/br&gt;
&quot;Hello &lt;%=window.gm.player.name%&gt;. &quot; &lt;/br&gt;
&lt;p class=&#39;tPC&#39;&gt;&quot;Hi. I&#39;m sorry to disturb you but I found this note on my door.&quot;&lt;/p&gt;
&quot;There was some delivery for you.&quot; she really seems pissed.
&lt;p class=&#39;tPC&#39;&gt;&quot;I hope it wasnt any trouble for you to receive it while I&#39;m...&quot;&lt;/p&gt;
&quot;If I had known its some furniture delivery I would have rejected it.&quot;
&lt;p class=&#39;tPC&#39;&gt;&quot;Furniture?&quot; you ask puzzled. You didnt order any furniture, did you.&lt;/p&gt;
She opens the door and you can now see a large parcel the size of a washer and a smaller one, blocking nearly all of the space after the entrance.
&lt;!--todo--&gt;
You are eager to get the equipment into your dorm and setup everything. So you move the boxes out of Melanies room into your own.&lt;/br&gt;
[[Next|SetupVREquipment2]]&lt;/div&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="38" name="SetupVREquipment2" tags="" position="975,475" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
You unpack the heavier one of the large parcels. It contains a number of metal pipes and plates, cables and screws.
The other package contains something that looks like a diver&#39;s suite made from neoprene and another VR-headset. 

&#39;I first need to figure out how that equipment needs to be setup.&#39;
You grab the assembly-instructions. Those metal-pipes and plates have to be assembled together to form a kind of scaffolding where the user hangs inside in the air. 
That way he can move his hands and feet around and the MoCap-suite can be used to generate steering commands.
&#39;I dont have enough space here for such a large gear.&#39;
But where else could you place it?
There is this room in the basement that was planned to be changed over into a party cellar.&lt;/br&gt;
But that plan was never finished and the room is unused right now.
[[Move everything into the cellar]]
[[Assemble the rack]]
[[Connect VR-Headset]]
That VR-Headset seems a lot better than your old one. Its not as heavy as your old one and can be better adapt to your skull-shape. There are also several cameras that have to be assembled to the rig. You guess they are used to detect the position of the mocap-suite. 
You connect the cables harness to your PC. There is a message from operating system: &quot;installing drivers...&#39;
[[put MoCap-suite on]]
That mocap-suite is, of course, skin thight. You dont want to risk tearing it appart by pulling it above your trousers and shirt. So you strip down except of your undies of course.
&lt;!--todo--&gt;Its still really difficult to get inside. Maybe they send it in a size to small.
Finally you got your arms in an close it shut by pulling up the zipper from the groin to its collar.
&#39;Thats a snuggly fit.&#39; You walk around some more and check yourself in the wardrobes mirror &#39;I really loolk like a surfer boy now&#39;
There are also some gloves with cables attached to each finger. So there are no controllers required?
You slip your hands into the gloves and connect the plugs of the cables to the matching one in the suite.
But how to get yourself hung into that scaffolding?
[[check parcels again]]
Rummaging through the large parcel again you find a large paper bag that at first you had put off as package material. Inside the bag you find several carabiners, velcrostraps and something that looks like a climbing harness with additional straps for the upperbody up to the neck.
[[adorn the harness]]
&#39;I think those carabiners are meant to connect the harness to the rack here and here...&#39;
In the meantime the drivers for the system got installed successfully and the headset already shows an screen. You still have to get yourself into the rack before you adorn it. 
You step into the harness and thighten the straps. &#39;But how do I get myself up far enough to connect the harness to the carabiners?&#39;  
You have a flat stool without backrest. You move it below the rack and climb on top of it; now its easy to connect the carabiners.
[[adorn headset]]
The headset that you have hung at one of the bars of the rack is within reach. You pull it over your head and secure it with the strap.
But there is a error message: &quot;Please remove object&quot;
&#39;Ah yes the stool&#39; The screen show a picture of you standing on it and the stool has a red outline. 
So now what?
[[push the stool away]]
You bent your knees to check if the rack can support your weight.
Its not giving: check.
You give the stool a small push with a feet just to move it out of the racks space but not to far. You might need it to undo yourself from the rack.
The screen confirms the sucessful removal and proceeds to the &#39;introductory-screen&#39;. You get some info how to use your hands movement for navigationg the screen and you even can use speech-control to do so.
You are eager to create your avatar and get a look at the game. On the other side, you would like to talk about your current experience with Brad first and see if he has gotten as far as you.
Besides its already gotten late.
[[get out of the rack]]
You remove the headset and fish with one feet for the stool. Gladly you didnt push it to far away.
You can undock yourself and disconnect the cables.
You put your phone away. Stripping out of the suite is as difficult as getting inside. That rubbery fabric is painfully pulling at each hair on your body.
A shower and some sleep would be nice.
[[Next|Your Bedroom]]
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="39" name="RL_Day1" tags="" position="1100,475" size="100,100">In 2 days most of your intramural courses are done and you will have more free time. Just lets get the day started and get to university.
[[Attend studys]]
&lt;!--todo--&gt;
[[Lunch with Ariane&amp;friends]]
[[Attend studys]]
[[Go home]]

You grab a snack from the fridge and call Brad.
Brad doesnt respond on the phone. &#39;Maybe he is already in game. I should get started too..&#39;

&quot;Welcome back. Lets just clarify some things about the beta-testing process. In most cases you just have to play the game as you like. We will track your actions and progress to adapt and improve the experience of the finished game.
However, at times you might be requested to do certain things and do it in a certain way.  
Remember that this is not the final game. We continously modify aspects to get the best experience for the players.  
&quot;
You say &#39;Create new avatar&#39;. The screen switches to those kind of screens that are common to other RPGs.
You can select class, race, character-traits and some visual aspects.
&#39;Lets see what classes we have...Staff Zealot..never heard of that one  &#39;
As you try to flip through the classes you got a message &quot;For testing purpose the following condition is applied: character-class and race restricted&quot;
&#39;Oh man, I&#39;m stuck with that class? I would at least know what other classes are available.&#39; You try to change race, but find that you are stuck to some kind of elf-youngling. 
You can toggle between male and female though the difference between the androgyne male and the female seem just to be some perky but small titts.
The description of the class is sparse. The picture you see indicates that this class uses a 2-handed staff and light armor. You expect also some magic abilities - its an elf, isn&#39;t it?.
&#39;I will choose male. Brad would make fun of me all time if I would choose any other option. On the other hand, it is roleplay right?&#39;
[[male elf]] [[female elf]]</tw-passagedata><tw-passagedata pid="40" name="AIAwesome" tags="" position="1225,475" size="100,100">...&quot;Actually we dont design everything manually. That would be much to tedious.&quot;&lt;/br&gt;
&quot;Instead we use an AI that learns while the game is played.&quot;
&quot;You mean an artificial intelligence? But doesnt most games have some AI to control the NPCs?&quot;
&quot;I didnt talk about AI to control the behaviour of some mobs. And for sure the fewest games have anything near to an AI. Most often its just some logic. Maybe complex logic but still predefined logic.&quot;
&quot;First: our AI is utilized to build the game-world and keep the ecosystem running. But actually most of the NPC aren&#39;t really driven by AI. But the logic they follow was created with the help of it.&quot;
&quot;Second: we call it AI because its able to learn. It keeps track what it is doing and if the result isn&#39;t like we want it, it changes its doing.&quot;
&quot;That sounds like the game is creating itslef on its own.&quot;
&quot;Better dont tell the management. They might think they just dont need devs anymore.&quot;
&quot;Anyway, its still required that someone supervises the AI and correct the goals.&quot;
...
&quot;Those darn AI! How can we do qualitychecking if everything can change at every time.&quot;
&quot;I spent 1 week to verify that all trees are growing upside down and then the AI decides to overhaul the entire growth-system and I have to redo it again and again.&quot;
&quot;The problem is, the AI doesnt tell you whats going to change and how it is doing it.&quot;
&quot;And I dont trust it. What if its decide to just delete the game and itself?&quot;</tw-passagedata><tw-passagedata pid="41" name="SisterInTown" tags="" position="100,600" size="100,100">Your mother informs you that your sister has business in town.
Sis seems to be instructed to watch over you. Lets hope she doesnt find out what game you are playing.</tw-passagedata><tw-passagedata pid="42" name="ForceFeedback" tags="" position="225,600" size="100,100">...
Als du aus dem Suite kletterst bist du hundemüde und deine Muskeln schmerzen als hättest du an einem Ironman-Lauf teilgenommen. Was du vom prinzip ja hast zumindest virtuel.
&#39;Diese Forcefeedback ist echt krass. Jetzt muss ich kein schlechtes Gewissen mehr haben wenn ich zocke das ich besser Sport machen sollte. Jetzt kann ich beides gleichzeitig!&#39;</tw-passagedata><tw-passagedata pid="43" name="AnalAddict" tags="" position="350,600" size="100,100">As you walk through the city, a thought crosses your mind again and again.
Its about that situation in the game where a foe had you pushed against the wall pressing his front against your lower back to keep you in place.
That sensation was rather edgy. But would have been much worse if one of you had their pants down. 
Of course that werent the case and even then it wouldnt automatically implicate that some butt-rape is imminent.
Getting your butt ravaged is [[a No-No]] [[an odd idea ]].
...   
...Your butt feels kinda empty. Like it needs to be filled with some...some... ugh you dont know.
Would you really try to stick something up your hole? [[Yeah]] [[No way]] [[not sure]]</tw-passagedata><tw-passagedata pid="44" name="DLCShopWelcome" tags="_back_" position="475,600" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
Welcome to the games Shop where you can buy Quality-of-life-service and equipment for your travel in our game.&lt;/br&gt;
Please note that you need vouchers to buy something. They can be bougth for real money or they can be earned in the game or granted by the content managers. 

[[Buy 100 Bronze-Token for 50$]]
[[Buy 1000 Bronze-Token for 500$]]

Options to retain equipment after death:&lt;/br&gt;
[[up to 2 health potions - 100 BT]]
[[up to 100gld - 100 BT]]
[[starter gear - 300 BT]]
There might also be some pay-by-use offers at respawn like: removal of status alignment and deseases

&lt;div&gt;&lt;/br&gt;
[[Checkout|_back_]]&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="45" name="EncounterOBSOLETE" tags="" position="500,25" size="100,100">&lt;!--this passage is entry-point for combat-statemachine (use together with combat.initCombat) --&gt;
&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;%window.story.show(&quot;EncounterStartTurn&quot;)%&gt;&lt;!--skipping ahead--&gt;
A &lt;%=window.story.state.combat.enemyParty[0].name%&gt; appears ! &lt;/br&gt;
[[Next|EncounterStartTurn]]
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="46" name="EncounterStartTurn" tags="" position="650,25" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;!--todo multiple enemys--&gt;
&lt;div id=&#39;combatCanvas&#39; style=&#39;background: url(&lt;%=s.combat.enemyParty[0].pic%&gt;) no-repeat center/contain,url(&lt;%=s.combat.scenePic%&gt;) no-repeat center;color:black;&#39;&gt;&lt;/div&gt;&lt;/br&gt;
&lt;div id=&quot;panel&quot;&gt;&lt;/div&gt;&lt;/br&gt;&lt;/br&gt; &lt;!--filled by statspanel--&gt;
&lt;div id=&quot;choice&quot;&gt;&lt;/div&gt;&lt;/br&gt;&lt;/br&gt; &lt;!--filled by combat-statemachine--&gt;
&lt;/br&gt;&lt;div id=&#39;output&#39;&gt;&lt;/div&gt;&lt;/br&gt;   &lt;!--message is rendered here--&gt;
&lt;div id=&quot;choice2&quot;&gt;&lt;/div&gt;&lt;/br&gt;&lt;/br&gt; &lt;!--filled by combat-statemachine--&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;
&lt;/section&gt;
&lt;script&gt;
window.gm.printOutput(window.gm.Encounter.battle().msg);
renderToSelector(&quot;#panel&quot;, &quot;statspanel&quot;);
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="47" name="statspanel" tags="" position="850,600" size="100,100">&lt;!--subpanel--&gt;
&lt;%=window.gm.Encounter.printStats()%&gt;</tw-passagedata><tw-passagedata pid="48" name="GameOver" tags="" position="200,275" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
Game Over. Better luck next time.&lt;/br&gt;
&lt;/br&gt;[[New Game|Start]]
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="49" name="Mole Submit" tags="" position="500,175" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
The mole took you down into his cave. &lt;/br&gt;
Which was very difficult since you are far to large - you know?&lt;/br&gt;
&lt;a0 onclick=&#39;window.gm.postDefeat();&#39;&gt;Black out&lt;/a&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;
&lt;/section&gt;</tw-passagedata><tw-passagedata pid="50" name="sidebar" tags="" position="375,500" size="100,100">&lt;h3&gt;&lt;%=window.story.name%&gt;&lt;/h3&gt;&lt;h3&gt;V&lt;%=window.gm.getSaveVersion().toString().replaceAll(&quot;,&quot;,&quot;.&quot;)%&gt;&lt;/h3&gt;
&lt;img src=&#39;&lt;%=window.gm.getSidebarPic()%&gt;&#39; width=&quot;256&quot; height=&quot;256&quot;&gt;
&lt;hr&gt;
&lt;div style=&quot;font-size: smaller;&quot;&gt;&lt;%=window.gm.util.printLocationName(window.gm.player.location)%&gt;&lt;/br&gt; &lt;!--this looks often weird, extract [name:Forest] instead ??--&gt;
&lt;%=window.gm.getTimeString()%&gt; &lt;%=window.gm.getDateString()%&gt;&lt;/br&gt;
&lt;hr&gt;
&lt;%=window.gm.player.name%&gt;&lt;/br&gt;
Energy: &lt;%=window.gm.player.energy().value%&gt;/&lt;%=window.gm.player.energy().max%&gt;&lt;/br&gt;
Health: &lt;%=window.gm.player.health().value%&gt;/&lt;%=window.gm.player.health().max%&gt;&lt;/br&gt;
Will: &lt;%=window.gm.player.will().value%&gt;/&lt;%=window.gm.player.will().max%&gt;&lt;/br&gt;
Money: &lt;%=window.gm.player.Inv.countItem(&#39;Money&#39;) %&gt; &lt;div &lt;%=window.gm.player.canLevelUp?&quot;class=\&quot;green\&quot;&quot;:&quot;&quot;%&gt;&gt;XP/Level: &lt;%=window.gm.player._data.XP+&quot;/&quot;+window.gm.player._data.level%&gt;&lt;/div&gt;&lt;/br&gt;
&lt;/div&gt;
&lt;hr&gt;
&lt;form&gt;
&lt;label&gt;Info:    &lt;output&gt;&lt;/output&gt;  &lt;/label&gt;&lt;/br&gt;
&lt;button type=&quot;button&quot; id=&quot;status&quot;&gt;Status&lt;/button&gt;
&lt;button type=&quot;button&quot; id=&quot;inv&quot;&gt;Inventory&lt;/button&gt;
&lt;button type=&quot;button&quot; id=&quot;quests&quot;&gt;Quests&lt;/button&gt;
&lt;button type=&quot;button&quot; id=&quot;dashboard&quot;&gt;More&lt;/button&gt;
&lt;!--&lt;button type=&quot;button&quot; id=&quot;wait&quot; style=&quot;width: 100%&quot;&gt;Rest 45min&lt;/button&gt;--&gt;
&lt;hr&gt;
&lt;button type=&quot;button&quot; id=&quot;save&quot; style=&quot;width: 80%&quot;&gt;Save/load&lt;/button&gt;
&lt;button type=&quot;button&quot; id=&quot;help&quot; style=&quot;width: 80%&quot;&gt;Help&lt;/button&gt;
&lt;button type=&quot;button&quot; id=&quot;settings&quot; style=&quot;width: 80%&quot;&gt;Settings&lt;/button&gt;
&lt;button type=&quot;button&quot; id=&quot;achievements&quot; onclick=&#39;window.story.show(&quot;Achievements&quot;);&#39; style=&quot;width: 80%&quot;&gt;Achievements&lt;/button&gt;
&lt;%if(s._gm.debug&amp; 0x1&gt;0){%&gt;
&lt;button type=&quot;button&quot; id=&quot;debug&quot; style=&quot;width: 80%&quot;&gt;Debug&lt;/button&gt;
&lt;script&gt;document.querySelector(&#39;#debug&#39;).addEventListener(&#39;click&#39;, function(){window.story.show(&#39;debug&#39;);});&lt;/script&gt;
&lt;%}%&gt;
&lt;/form&gt;
&lt;script&gt;
//document.querySelector(&#39;#wait&#39;).addEventListener(&#39;click&#39;, function(){window.gm.addTime(45);window.gm.refreshAllPanel();}); 
document.querySelector(&#39;#inv&#39;).addEventListener(&#39;click&#39;, function(){window.story.show(&#39;Inventory&#39;);});
document.querySelector(&#39;#quests&#39;).addEventListener(&#39;click&#39;, function(){window.story.show(&#39;QuestList&#39;);});
document.querySelector(&#39;#dashboard&#39;).addEventListener(&#39;click&#39;, function(){window.story.show(&#39;Player_Dashboard&#39;);});
document.querySelector(&#39;#status&#39;).addEventListener(&#39;click&#39;, function(){window.story.show(&#39;Status&#39;);});
document.querySelector(&#39;#save&#39;).addEventListener(&#39;click&#39;, function(){window.gm.toggleDialog(&#39;#dialog_save&#39;);});
document.querySelector(&#39;#help&#39;).addEventListener(&#39;click&#39;, function(){window.story.show(&#39;Help_Index&#39;);}); 
document.querySelector(&#39;#settings&#39;).addEventListener(&#39;click&#39;, function(){window.story.show(&#39;Settings&#39;);}); 
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="51" name="CenterDialogs" tags="" position="100,725" size="100,100">&lt;!--called to include important dialogs; mainly the save-Dialog because of special behaviour--&gt;
&lt;%=window.story.render(&quot;SaveDialog&quot;) %&gt;&lt;/br&gt;</tw-passagedata><tw-passagedata pid="52" name="LogPanel" tags="" position="225,725" size="100,100">&lt;!--&lt;button type=&quot;button&quot; id=&quot;toggleview&quot; onclick=toggleview()&gt;&lt;i class=&quot;fa fa-compress&quot;&gt;&lt;/i&gt;&lt;/button&gt;
&lt;button type=&quot;button&quot; id=&quot;clearview&quot; onclick=clearview()&gt;&lt;i class=&quot;fa fa-trash-alt&quot;&gt;&lt;/i&gt;&lt;/button&gt;--&gt;
&lt;div&gt;&lt;a0 onclick=toggleview()&gt;toggle view&lt;/a&gt;&lt;a0 onclick=clearview()&gt;clear log&lt;/a&gt;&lt;/div&gt;
&lt;div class=&quot;scroll&quot; style=&quot;font-size: smaller;&quot;&gt;&lt;%=window.gm.getLog()%&gt;&lt;/br&gt;&lt;/div&gt;
&lt;script&gt;
function toggleview(){
  document.querySelector(&quot;section&quot;).classList.toggle(&quot;section_swap&quot;);
}
function clearview(){
  window.gm.clearLog();window.gm.refreshAllPanel();
}
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="53" name="SaveDialog" tags="" position="350,725" size="100,100">&lt;dialog role=&quot;dialog&quot; id=&#39;dialog_save&#39; aria-labelledby=&quot;dialog-heading&quot;&gt;
    &lt;button id=&quot;close-dialog&quot;&gt;Back&lt;/button&gt; &lt;div&gt;&lt;%=(window.story.state._gm.nosave?&quot;save disabled in this scene&quot;:&quot;&quot;)%&gt;&lt;/div&gt;
    &lt;form&gt;
    &lt;label&gt;&lt;output&gt;&lt;/output&gt;&lt;/label&gt;&lt;/br&gt;
    &lt;button type=&quot;button&quot; id=&quot;saveAuto&quot; hidden&gt; &lt;/button&gt;&lt;button type=&quot;button&quot; id=&quot;loadAuto&quot;&gt;load Auto&lt;/button&gt;
    &lt;button type=&quot;button&quot; id=&quot;deleteAuto&quot;&gt;delete Auto&lt;/button&gt;&lt;label&gt;&lt;outputAuto&gt;&lt;/outputAuto&gt;&lt;/label&gt;&lt;/br&gt;
    &lt;button type=&quot;button&quot; id=&quot;save1&quot; &lt;%=(window.story.state._gm.nosave?&quot;disabled&quot;:&quot;&quot;)%&gt;&gt;save 1&lt;/button&gt;&lt;button type=&quot;button&quot; id=&quot;load1&quot;&gt;load 1&lt;/button&gt;
    &lt;button type=&quot;button&quot; id=&quot;delete1&quot;&gt;delete 1&lt;/button&gt;&lt;label&gt;&lt;output1&gt;&lt;/output1&gt;&lt;/label&gt;&lt;/br&gt;
    &lt;button type=&quot;button&quot; id=&quot;save2&quot; &lt;%=(window.story.state._gm.nosave?&quot;disabled&quot;:&quot;&quot;)%&gt;&gt;save 2&lt;/button&gt;&lt;button type=&quot;button&quot; id=&quot;load2&quot;&gt;load 2&lt;/button&gt;
    &lt;button type=&quot;button&quot; id=&quot;delete2&quot;&gt;delete 2&lt;/button&gt;&lt;label&gt;&lt;output2&gt;&lt;/output2&gt;&lt;/label&gt;&lt;/br&gt;
    &lt;button type=&quot;button&quot; id=&quot;save3&quot; &lt;%=(window.story.state._gm.nosave?&quot;disabled&quot;:&quot;&quot;)%&gt;&gt;save 3&lt;/button&gt;&lt;button type=&quot;button&quot; id=&quot;load3&quot;&gt;load 3&lt;/button&gt;
    &lt;button type=&quot;button&quot; id=&quot;delete3&quot;&gt;delete 3&lt;/button&gt;&lt;label&gt;&lt;output3&gt;&lt;/output3&gt;&lt;/label&gt;&lt;/br&gt;
    &lt;button type=&quot;button&quot; id=&quot;save4&quot; &lt;%=(window.story.state._gm.nosave?&quot;disabled&quot;:&quot;&quot;)%&gt;&gt;save 4&lt;/button&gt;&lt;button type=&quot;button&quot; id=&quot;load4&quot;&gt;load 4&lt;/button&gt;
    &lt;button type=&quot;button&quot; id=&quot;delete4&quot;&gt;delete 4&lt;/button&gt;&lt;label&gt;&lt;output4&gt;&lt;/output4&gt;&lt;/label&gt;&lt;/br&gt;
    &lt;button type=&quot;button&quot; id=&quot;save5&quot; &lt;%=(window.story.state._gm.nosave?&quot;disabled&quot;:&quot;&quot;)%&gt;&gt;save 5&lt;/button&gt;&lt;button type=&quot;button&quot; id=&quot;load5&quot;&gt;load 5&lt;/button&gt;
    &lt;button type=&quot;button&quot; id=&quot;delete5&quot;&gt;delete 5&lt;/button&gt;&lt;label&gt;&lt;output5&gt;&lt;/output5&gt;&lt;/label&gt;&lt;/br&gt;
    &lt;button type=&quot;button&quot; id=&quot;save6&quot; &lt;%=(window.story.state._gm.nosave?&quot;disabled&quot;:&quot;&quot;)%&gt;&gt;save 6&lt;/button&gt;&lt;button type=&quot;button&quot; id=&quot;load6&quot;&gt;load 6&lt;/button&gt;
    &lt;button type=&quot;button&quot; id=&quot;delete6&quot;&gt;delete 6&lt;/button&gt;&lt;label&gt;&lt;output6&gt;&lt;/output6&gt;&lt;/label&gt;&lt;/br&gt;
    &lt;button type=&quot;button&quot; id=&quot;save7&quot; &lt;%=(window.story.state._gm.nosave?&quot;disabled&quot;:&quot;&quot;)%&gt;&gt;save 7&lt;/button&gt;&lt;button type=&quot;button&quot; id=&quot;load7&quot;&gt;load 7&lt;/button&gt;
    &lt;button type=&quot;button&quot; id=&quot;delete7&quot;&gt;delete 7&lt;/button&gt;&lt;label&gt;&lt;output7&gt;&lt;/output7&gt;&lt;/label&gt;&lt;/br&gt;
    &lt;button type=&quot;button&quot; id=&quot;save8&quot; &lt;%=(window.story.state._gm.nosave?&quot;disabled&quot;:&quot;&quot;)%&gt;&gt;save 8&lt;/button&gt;&lt;button type=&quot;button&quot; id=&quot;load8&quot;&gt;load 8&lt;/button&gt;
    &lt;button type=&quot;button&quot; id=&quot;delete8&quot;&gt;delete 8&lt;/button&gt;&lt;label&gt;&lt;output8&gt;&lt;/output8&gt;&lt;/label&gt;&lt;/br&gt;
    &lt;button type=&quot;button&quot; id=&quot;saveFile&quot; &lt;%=(window.story.state._gm.nosave?&quot;disabled&quot;:&quot;&quot;)%&gt;&gt;save file...&lt;/button&gt;
    &lt;input type=&quot;file&quot; id=&quot;loadFile&quot; name=&quot;image_uploads&quot; onchange=readFile(this)&gt;&lt;/br&gt;
    &lt;/form&gt;
&lt;/dialog&gt;
&lt;script&gt;
var infodisp = &#39;dialog form label output&#39;; //Url to output according nesting node classes; see structure of dialog below
var x = 1; 
var _slots = [&#39;Auto&#39;,&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;5&#39;,&#39;6&#39;,&#39;7&#39;,&#39;8&#39;]; //number saveslots available; has to fit save form
for(var i=0; i&lt; _slots.length;i++) {
  const _x = _slots[i];
  const slot = &#39;save&#39;.concat(_x);
  document.querySelector(&#39;#save&#39;.concat(_x)).addEventListener(&#39;click&#39;, function(){
    document.querySelector(infodisp).textContent=&#39;&#39;;
    window.storage.saveBrowser(slot);
    refresh(_x);
    document.querySelector(infodisp).textContent=slot;
    });
  document.querySelector(&#39;#load&#39;.concat(_x)).addEventListener(&#39;click&#39;, function(){
    window.storage.loadBrowser(slot);
    div = document.querySelector(&#39;#backdrop&#39;);
    div.parentNode.removeChild(div);
    });
  document.querySelector(&#39;#delete&#39;.concat(_x)).addEventListener(&#39;click&#39;, function(){
      window.storage.delete(slot);
      refresh(_x);
      });
  document.querySelector(infodisp).textContent=&#39;&#39;;
   refresh(_x);
}
document.querySelector(&#39;#saveFile&#39;).addEventListener(&#39;click&#39;, function(){
    document.querySelector(infodisp).textContent=&#39;&#39;;
    window.storage.saveFile();
});
function refresh(slot){
    var ok = window.storage.getSaveInfo(&#39;save&#39;.concat(slot));
    document.querySelector(&#39;#load&#39;.concat(slot)).disabled=(ok===&#39;&#39;);
    var out = document.querySelector(&#39;dialog form output&#39;.concat(slot));
    if(out) out.textContent = ok;
}
function readFile(input) {
    var OK = window.storage.loadFile(input);  //TODO this runs asynchron
    if(!OK){ 
      return;
    } //aborted by user
}
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="54" name="Inventory" tags="_back_" position="475,725" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
[[Back|_back_]]&lt;/br&gt;
&lt;%=window.gm.player.name%&gt; inventory: &lt;/br&gt;&lt;/br&gt;
&lt;%
var x = 0, id=&#39;&#39;; 
var inv = window.gm.player.Inv;
var maxSlots = inv.count(); 
for(var i=0;i&lt;maxSlots;i++){
  id=inv.getItemId(i);
  %&gt;&lt;%=window.gm.printItem(id,inv.countItem(id).toString()+&#39;x &#39;+inv.getItem(id).desc+&#39; &#39;+inv.getItem(id).usable(inv).msg,window.gm.player)%&gt;&lt;%
} 
%&gt;
&lt;div id=&#39;output&#39;&gt;&lt;/div&gt;&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="55" name="Relations" tags="_back_" position="600,725" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
[[Back|_back_]]&lt;/br&gt;
&lt;%=window.gm.player.name%&gt; relations: &lt;/br&gt;&lt;/br&gt;
&lt;%=window.gm.printRelationSummary()%&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="56" name="Achievements" tags="_back_" position="725,725" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
[[Back|_back_]]&lt;/br&gt;
&lt;%=window.gm.printAchievements()%&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="57" name="Player_Dashboard" tags="_back_" position="850,725" size="100,100">&lt;!--a dashboard where the player can check his other stuff--&gt;
&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
Here you can check and modify several options: &lt;/br&gt;
Your outfit can only be changed by using a wardrobe.&lt;/br&gt;
Your party consist of &lt;%=(function(){var msg=[];for(el of window.story.state._gm.playerParty){msg.push(window.story.state[el].name);}return(msg);}()).join(&#39;,&#39;)%&gt;&lt;/br&gt;
[[Back|_back_]] [[Status]] [[Levelup]] [[View|Mirror]] [[Inventory]] [[Relations]] [[QuestList]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="58" name="QuestList" tags="_back_" position="975,725" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
[[Back|_back_]]&lt;/br&gt;
&lt;%=window.gm.printQuestList()%&gt;
&lt;/br&gt;[[Back|_back_]]
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="59" name="Mirror" tags="_back_" position="1100,725" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
Checking out &lt;%=window.gm.player.name%&gt;:   [[Back|_back_]]&lt;/br&gt;
&lt;div id=&#39;output&#39;&gt;&lt;%=window.gm.printBodyDescription(window.gm.player)%&gt;&lt;div&gt;
&lt;!--todo: set height depending on browsersize--&gt;
&lt;!--&lt;div id=&#39;Canvas&#39; style=&#39;height: 30em;background: url(&quot;assets/doll/doll_small_xcf-Skirt.png&quot;) no-repeat center,url(&quot;assets/doll/doll_small_xcf-Body.png&quot;) no-repeat center, url(&lt;%=window.gm.getScenePic(window.gm.player.location)%&gt;)no-repeat center;color:black;&#39;&gt;&lt;/div&gt;--&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="60" name="Wardrobe" tags="_back_" position="1225,725" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
[[Back|_back_]]&lt;/br&gt;
&lt;%=window.gm.player.name%&gt; has equipped: &lt;%=window.gm.printEquipmentSummary()%&gt;&lt;/br&gt;&lt;/br&gt;
(Tools and weapons can be changed via Inventory.)&lt;/br&gt;&lt;/br&gt;
In &lt;%=window.gm.player.name%&gt; wardrobe you find: &lt;/br&gt;&lt;/br&gt;
&lt;!--assumption: every outfit item (worn or not) is present in the wardrobe--&gt;
&lt;%
var x = 0, id=&#39;&#39;; 
var inv = window.gm.player.Wardrobe;
var maxSlots = inv.count(); 
for(var i=0;i&lt;maxSlots;i++){
  id=inv.getItemId(i);
  %&gt;&lt;%=window.gm.printEquipment(id,inv.getItem(id).desc)%&gt;&lt;%
} 
%&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="61" name="Settings" tags="_back_" position="100,850" size="100,100">&lt;section&gt; &lt;!--&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;--&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
[[Back|_back_]]&lt;/br&gt;
&lt;p class=&quot;author&quot;&gt;settings are stored in save-game until I find a way to store them in cookies.&lt;/p&gt;
Theme:
&lt;a href=&quot;javascript:window.styleSwitcher.setStyle(&#39;default&#39;);window.gm.refreshAllPanel();&quot;&gt;default&lt;/a&gt;
&lt;a href=&quot;javascript:window.styleSwitcher.setStyle(&#39;dark&#39;);window.gm.refreshAllPanel();&quot;&gt;dark&lt;/a&gt;&lt;/br&gt;
&lt;!--TODO what settings ?--&gt;
*  Disable over-penetration &lt;/br&gt;
A lot of female are not happy about the fact that many erotic fiction or imagery picture the penetration of cervix because its pretty painful. You might disable this here therefore. &lt;/br&gt;
On the other hand a lot of males have some kind of fetish for this. &lt;/br&gt;

*  Less-sex-mode
If you enable this your route to bad end by sex-related action is much shorter. This should enforce a more chaste play.&lt;/br&gt;

&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="62" name="Settings2" tags="_back_" position="225,850" size="100,100">&lt;!--just test--&gt;
&lt;section&gt;&lt;!--&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;--&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;div&gt;&lt;canvas id=&quot;exampleCanvas&quot; width=&quot;240&quot; height=&quot;225&quot;&gt;Your browser doesn&#39;t support the canvas tag.    &lt;/canvas&gt;&lt;/div&gt;
&lt;button onclick=&#39;window.gm.printCombatScreen()&#39;&gt;test a&lt;/button&gt;
&lt;button onclick=&#39;onimage(&quot;assets/favicon.png&quot;)&#39;&gt;test b&lt;/button&gt;
    &lt;script&gt;
      function onimage(imgsrc) {
        var canvas = document.getElementById(&quot;exampleCanvas&quot;);
        var ctx = canvas.getContext(&quot;2d&quot;);
        //var img = document.getElementById(&quot;photo&quot;);
var img = new Image(); // Create new img element
img.src = imgsrc;//&#39;https://twinery.org/homepage/img/logo.svg&#39;;   //todo the loading o image takes a while and it will not refreh automatically
        ctx.drawImage(img, 0, 0);
      };
      onimage(&quot;assets/bird.gif&quot;);
    &lt;/script&gt;
[[Back|_back_]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="63" name="Status" tags="_back_" position="350,850" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;%let char=window.gm.player;%&gt;
Status of &lt;%=char.name%&gt;:   [[Back|_back_]]&lt;/br&gt;
&lt;a0 onclick=&#39;window.gm.printOutput(window.gm.printEffectSummary(&quot;&lt;%=char.id%&gt;&quot;,true,false,false));&#39;&gt;Stats&lt;/a&gt;
&lt;a0 onclick=&#39;window.gm.printOutput(window.gm.printEffectSummary(&quot;&lt;%=char.id%&gt;&quot;,false,false,true));&#39;&gt;Resistance&lt;/a&gt;
&lt;a0 onclick=&#39;window.gm.printOutput(window.gm.printEffectSummary(&quot;&lt;%=char.id%&gt;&quot;,false,true,false));&#39;&gt;Fetish&lt;/a&gt;
&lt;/br&gt;&lt;div id=&#39;output&#39;&gt;&lt;/div&gt;&lt;/br&gt;   &lt;!--message is rendered here--&gt;
[[Back|_back_]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt;
window.gm.printOutput(window.gm.printEffectSummary(window.gm.player.id,true,false));
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="64" name="Levelup" tags="_back_ _nosave_" position="475,850" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
[[Back|_back_]]&lt;/br&gt;
&lt;% let char=window.gm.player;if(char.canLevelUp){%&gt;
&lt;%=char.name%&gt; has enough XP to &lt;a0 onclick=&#39;levelUp(&quot;&lt;%=char.id%&gt;&quot;)&#39;&gt;Level up&lt;/a&gt;!&lt;/br&gt;
&lt;% }else{%&gt;
&lt;%=char.name%&gt; need more XP to level up.&lt;/br&gt;
&lt;% }%&gt;
&lt;div id=&#39;output&#39;&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt;function levelUp(char) {
  window.story.state[char].levelUp(1);
  window.gm.refreshAllPanel();
}
function statUp(statid,charname) {
  let char =window.story.state[charname];
  char.Stats.increment(statid,1);
  char._data.unspentStat-=1; //todo ugly
  window.gm.refreshAllPanel();
}
function showStats(charname) {
  let char =window.story.state[charname];
  let _wheights = char.autolevelWheight();
  let msg=&#39;&#39;;
  if(char._data.unspentStat&gt;0) {
    msg=char._data.unspentStat+&#39; points can be distributed on stats:&lt;/br&gt;&lt;table&gt;&#39;;
    for(el of _wheights) {
      msg+=&quot;&lt;tr&gt;&lt;td&gt;&lt;a href=\&quot;javascript:void(0)\&quot; onclick=&#39;statUp(\&quot;&quot;+el.id+&quot;\&quot;,\&quot;&quot;+char.id+&quot;\&quot;)&#39;&gt;&quot;+el.id+&quot;&lt;/a&gt;&lt;/td&gt;&lt;td&gt;is &quot;+char.Stats.getItem(el.id).base+&quot;&lt;/td&gt;&lt;/tr&gt;&quot;;
    }
    msg+=&#39;&lt;/table&gt;&#39;;
  }
  window.gm.printOutput(msg);
}
showStats(&lt;%=&quot;\&quot;&quot;+char.id+&quot;\&quot;&quot;%&gt;);
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="65" name="listsell" tags="" position="600,850" size="100,100">&lt;!--this fragment can be used to setup a list of items to sell:
add into passage: &lt;div id=&quot;choice&quot;&gt;&lt;/div&gt;&lt;/br&gt;&lt;/br&gt; &lt;div id=&quot;panel&quot;&gt;&lt;/div&gt;&lt;/br&gt;&lt;/br&gt;   
in &lt;script&gt; define variable _Entrys and specify wares to sell
and run renderToSelector(&quot;#panel&quot;, &quot;listsell&quot;); 
--&gt;
&lt;script&gt;
//define _Entrys in your passage lile this:
//var _Entrys = [{id:&quot;Crowbar&quot;,count:1,cost:25})];
for(var i=0;_Entrys.length&gt;i;i++) {
    var entry=_Entrys[i];
    let _id = entry.id;
    let _cost=entry.cost;
    window.gm.printShopSellEntry(_id,entry.count,
    cbCanBuy=(function(itemid){return window.gm.defaultCanSell(itemid,_cost)}),
    cbPostBuy=(function(itemid){window.gm.defaultPostSell(itemid,_cost)}));
}
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="66" name="listbuy" tags="" position="725,850" size="100,100">&lt;!--this fragment can be used to setup a list of items to buy:
add into passage: &lt;div id=&quot;choice&quot;&gt;&lt;/div&gt;&lt;/br&gt;&lt;/br&gt; &lt;div id=&quot;panel&quot;&gt;&lt;/div&gt;&lt;/br&gt;&lt;/br&gt;   
in &lt;script&gt; define variable _Entrys and specify wares to buy
and run renderToSelector(&quot;#panel&quot;, &quot;listbuy&quot;); 
--&gt;
&lt;script&gt;
//define _Entrys in your passage lile this:
//var _Entrys = [{id:&quot;Dildo_small&quot;,count:1,cost:25,costPerv:14}];
for(var i=0;_Entrys.length&gt;i;i++) {
    var entry=_Entrys[i];
    let _id = entry.id;
    let _cost=entry.cost;
    let _costPerv = entry.costPerv;
    window.gm.printShopBuyEntry(_id,entry.count,
    cbCanBuy=(function(itemid){return window.gm.cbCanBuyPerverse(itemid,_cost,_costPerv)}),
    cbPostBuy=(function(itemid){window.gm.defaultPostBuy(itemid,_cost)}));
}
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="67" name="_back_" tags="" position="850,850" size="100,100">&lt;!--this just exists because Back-links would rendered as non existent--&gt;</tw-passagedata><tw-passagedata pid="68" name="PassageTemplate" tags="template" position="250,500" size="100,100">The page should be setup like this:
&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
content here !
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="69" name="SubpanelTemplate" tags="_back_" position="75,600" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
If this is a subpanel you can use back-tag and _back_-Link
[[Back|_back_]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="70" name="_SaveAndRestore_" tags="" position="1225,850" size="100,100">&lt;script&gt;
var x = 1; 
var maxSlots = 4; //number saveslots available; has to fit form below
 do {
   const _x = x;
   const slot = &#39;save&#39;.concat(x);
  document.querySelector(&#39;#save&#39;.concat(x)).addEventListener(&#39;click&#39;, function(){window.storage.saveBrowser(slot)});
  document.querySelector(&#39;#load&#39;.concat(x)).addEventListener(&#39;click&#39;, function(){window.storage.loadBrowser(slot)});
  document.querySelector(&#39;#delete&#39;.concat(x)).addEventListener(&#39;click&#39;, function(){window.storage.delete(slot)});
  document.querySelector(&#39;#save&#39;.concat(x)).addEventListener(&#39;click&#39;, function(){refresh(_x)});
  document.querySelector(&#39;#load&#39;.concat(x)).addEventListener(&#39;click&#39;, function(){refresh(_x)});
  document.querySelector(&#39;#delete&#39;.concat(x)).addEventListener(&#39;click&#39;, function(){refresh(_x)});
   refresh(x);
   x = x + 1;
 } while (x &lt;= maxSlots);
function refresh(slot){
  var ok = window.storage.getSaveInfo(&#39;save&#39;.concat(slot));
   document.querySelector(&#39;output&#39;.concat(slot)).textContent = ok;
}
&lt;/script&gt;
&lt;form&gt;
&lt;label&gt;Info:&lt;output&gt;&lt;/output&gt;&lt;/label&gt;&lt;/br&gt;
&lt;button type=&quot;button&quot; id=&quot;save1&quot;&gt;save 1&lt;/button&gt;&lt;button type=&quot;button&quot; id=&quot;load1&quot;&gt;load 1&lt;/button&gt;
&lt;button type=&quot;button&quot; id=&quot;delete1&quot;&gt;delete 1&lt;/button&gt;&lt;label&gt;Info:&lt;output1&gt;&lt;/output1&gt;&lt;/label&gt;&lt;/br&gt;
&lt;button type=&quot;button&quot; id=&quot;save2&quot;&gt;save 2&lt;/button&gt;&lt;button type=&quot;button&quot; id=&quot;load2&quot;&gt;load 2&lt;/button&gt;
&lt;button type=&quot;button&quot; id=&quot;delete2&quot;&gt;delete 2&lt;/button&gt;&lt;label&gt;Info:&lt;output2&gt;&lt;/output2&gt;&lt;/label&gt;&lt;/br&gt;
&lt;button type=&quot;button&quot; id=&quot;save3&quot;&gt;save 3&lt;/button&gt;&lt;button type=&quot;button&quot; id=&quot;load3&quot;&gt;load 3&lt;/button&gt;
&lt;button type=&quot;button&quot; id=&quot;delete3&quot;&gt;delete 3&lt;/button&gt;&lt;label&gt;Info:&lt;output3&gt;&lt;/output3&gt;&lt;/label&gt;&lt;/br&gt;
&lt;button type=&quot;button&quot; id=&quot;save4&quot;&gt;save 4&lt;/button&gt;&lt;button type=&quot;button&quot; id=&quot;load4&quot;&gt;load 4&lt;/button&gt;
&lt;button type=&quot;button&quot; id=&quot;delete4&quot;&gt;delete 4&lt;/button&gt;&lt;label&gt;Info:&lt;output4&gt;&lt;/output4&gt;&lt;/label&gt;&lt;/br&gt;
&lt;/form&gt;
[[Start]]</tw-passagedata><tw-passagedata pid="71" name="_SuperSimpleStory_" tags="" position="1200,125" size="100,100">&lt;%if(visited(window.passage.name)&lt;=1) {%&gt;
Welcome to this short story.&lt;/br&gt;&lt;/br&gt;
&lt;%}%&gt;
&lt;mark&gt;The previous part is an example how to conditional build the html output &lt;/br&gt;&lt;/mark&gt;
You are lying in your bed.&lt;/br&gt;
What would you like to do.&lt;/br&gt;
[[Sleep|SleepALittle]]&lt;/br&gt;
[[Wakeup]] &lt;/br&gt;</tw-passagedata><tw-passagedata pid="72" name="SleepALittle" tags="" position="400,825" size="100,100">You are sleeping some more. &lt;/br&gt;
&lt;mark&gt;The folowing is an example how to print a javascript calculation to html:&lt;/br&gt;&lt;/mark&gt;
It is now &lt;%= 5*visited(window.passage.name)%&gt; minutes later.&lt;/br&gt;
[[Continue|_SuperSimpleStory_]]</tw-passagedata><tw-passagedata pid="73" name="Wakeup" tags="" position="575,825" size="100,100">You groan as you wake up. &#39;Damn life&#39;&lt;/br&gt;
[[Start]]</tw-passagedata><tw-passagedata pid="74" name="_ImagesAndOtherMedia_" tags="" position="1075,125" size="100,100">&lt;mark&gt;embed images in the following way:&lt;/mark&gt;&lt;/br&gt;
stored on a server:&lt;/br&gt;
&lt;img alt=&quot;twinerylogo&quot; src=&quot;https://twinery.org/homepage/img/logo.svg&quot; width=&quot;256&quot; height=&quot;256&quot;&gt;&lt;/br&gt;
stored in .dist/assets:&lt;/br&gt;
&lt;img alt=&quot;tweegoicon&quot; src=&quot;assets/favicon.png&quot; &gt;&lt;/br&gt;
animated gif:&lt;/br&gt;
&lt;img alt=&quot;bird.gif&quot; src=&quot;assets/bird.gif&quot; &gt;&lt;/br&gt;
audio with manual control:&lt;/br&gt; 
&lt;audio id=&quot;audio_with_controls&quot; controls src=&quot;assets/drink.ogg&quot; type=&quot;audio/ogg&quot; &gt;&lt;/audio&gt;
audio autoplay:&lt;/br&gt;
&lt;audio id=&quot;audio_autoplay&quot; autoplay src=&quot;assets/chimes.ogg&quot; type=&quot;audio/ogg&quot; &gt;&lt;/audio&gt;
video with autoplay:&lt;/br&gt;
&lt;video id=&quot;player2&quot; autoplay &gt;
  &lt;source src=&quot;assets/Comedy.mp4&quot; type=&quot;video/mp4&quot;&gt;
&lt;/video&gt;

video with integrated and separate controls:&lt;/br&gt;
&lt;video id=&quot;player&quot; controls&gt;
  &lt;source src=&quot;assets/Comedy.mp4&quot; type=&quot;video/mp4&quot;&gt;
&lt;/video&gt;

&lt;button id=&quot;play&quot;&gt;Play&lt;/button&gt;
&lt;button id=&quot;pause&quot;&gt;Pause&lt;/button&gt;
&lt;button id=&quot;duration&quot;&gt;Länge anzeigen&lt;/button&gt;
&lt;p id=&quot;ausgabe&quot;&gt;&lt;/p&gt;
 
&lt;script&gt;
  var song = document.getElementById(&#39;player&#39;);
  document.getElementById(&#39;play&#39;).addEventListener(&#39;click&#39;, function() { song.play(); }, false);
  document.getElementById(&#39;pause&#39;).addEventListener(&#39;click&#39;, function() { song.pause(); }, false);
  document.getElementById(&#39;duration&#39;).addEventListener(&#39;click&#39;, function() { 
  document.getElementById(&#39;ausgabe&#39;).innerHTML = &#39;Die Dauer des Videos beträgt: &#39;+ song.duration; +&#39; Sekunden.&#39;}, false);
&lt;/script&gt;
[[Start]]</tw-passagedata><tw-passagedata pid="75" name="_ControlElements_" tags="" position="1200,25" size="100,100">&lt;div id=&quot;choice&quot;&gt;
&lt;p&gt;click on image to show related text and border&lt;/p&gt;
&lt;table&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;img id=&quot;1&quot; src=&quot;https://twinery.org/homepage/img/logo.svg&quot; width=&quot;256&quot; height=&quot;256&quot; onclick=&#39;window.gm.onSelect(this,&quot;div#choice table tbody tr td *&quot;,&quot;div#info&quot;);&#39;&gt;&lt;/td&gt;
&lt;td&gt;&lt;img id=&quot;2&quot; src=&quot;https://twinery.org/homepage/img/logo.svg&quot; width=&quot;256&quot; height=&quot;256&quot; onclick=&#39;window.gm.onSelect(this,&quot;div#choice table tbody tr td *&quot;,&quot;div#info&quot;);&#39;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;img id=&quot;3&quot; src=&quot;https://twinery.org/homepage/img/logo.svg&quot; width=&quot;256&quot; height=&quot;256&quot; onclick=&#39;window.gm.onSelect(this,&quot;div#choice table tbody tr td *&quot;,&quot;div#info&quot;);&#39;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;div id=&quot;info&quot;&gt;
&lt;p id=&quot;1&quot; hidden&gt;Text 1&lt;/p&gt;&lt;p id=&quot;2&quot; hidden&gt;[[Start]]&lt;/p&gt;&lt;p id=&quot;3&quot; hidden&gt;Text 3&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Geben Sie Ihre Zahlungsweise an:&lt;/p&gt;
  &lt;fieldset&gt; &lt;legend&gt;creditcard&lt;/legend&gt;
    &lt;input type=&quot;radio&quot; id=&quot;mc&quot; name=&quot;Zahlmethode&quot; value=&quot;Mastercard&quot; disabled&gt;
    &lt;label for=&quot;mc&quot;&gt; Mastercard&lt;/label&gt; 
    &lt;input type=&quot;radio&quot; id=&quot;vi&quot; name=&quot;Zahlmethode&quot; value=&quot;Visa&quot; checked&gt;
    &lt;label for=&quot;vi&quot;&gt; Visa&lt;/label&gt;
    &lt;input type=&quot;radio&quot; id=&quot;ae&quot; name=&quot;Zahlmethode&quot; value=&quot;AmericanExpress&quot;&gt;
    &lt;label for=&quot;ae&quot;&gt; American Express&lt;/label&gt; 
  &lt;/fieldset&gt;
&lt;label&gt;static dropdown:
		&lt;select id=&quot;person&quot; onchange=&#39;selectperson(this)&#39;&gt;
			&lt;option value=&quot;23&quot;&gt;Albers, Alfred&lt;/option&gt;
			&lt;option value=&quot;24&quot; selected&gt;Braun, Berta&lt;/option&gt;
      &lt;option value=&quot;25&quot;&gt;Zeta, Bort&lt;/option&gt;
		&lt;/select&gt;
&lt;/label&gt;
&lt;form name=&quot;terminauswahl&quot;&gt;
	&lt;label&gt;Professor:
		&lt;select id=&quot;professor&quot;&gt;
			&lt;option value=&quot;&quot;&gt;Bitte wählen:&lt;/option&gt;
      &lt;option value=&quot;P23&quot;&gt;Albers, Alfred&lt;/option&gt;
			&lt;option value=&quot;P24&quot;&gt;Braun, Berta&lt;/option&gt;
			&lt;option value=&quot;P25&quot;&gt;Drachenzaun, Doris&lt;/option&gt;
			&lt;option value=&quot;P26&quot;&gt;Münz, Stephan&lt;/option&gt;
			&lt;option value=&quot;P27&quot;&gt;Meier, Manfred&lt;/option&gt;
		&lt;/select&gt;
	&lt;/label&gt;
	&lt;label&gt;Lesung:
		&lt;select id=&quot;vorlesung&quot; disabled&gt;
			&lt;option value=&quot;&quot;&gt;------&lt;/option&gt;
		&lt;/select&gt;
	&lt;/label&gt;
	&lt;label&gt;Termin:
		&lt;select id=&quot;termin&quot; disabled&gt;
			&lt;option value=&quot;&quot;&gt;------&lt;/option&gt;
		&lt;/select&gt;
	&lt;/label&gt;
  	&lt;output id=&quot;auswahl&quot;&gt;&lt;/output&gt;
&lt;/form&gt;
&lt;div id=&#39;output&#39;&gt;&lt;/div&gt;
&lt;script&gt;
function selectperson(elmnt) {
		var menu = document.getElementById(elmnt.id);
		document.querySelector(&#39;div#output&#39;).innerHTML = menu.value +&quot;&quot;+menu.options[menu.selectedIndex].label+&quot; &quot;+menu.options[menu.selectedIndex].value;		
}
/*class SelectionController extends EventTarget {
    constructor(selectElement, datasource, parentNode = null) {
        super(); // Pflicht: Konstruktor der Superklasse aufrufen
        if (!(selectElement instanceof HTMLSelectElement)) {
            throw new Error(
                &quot;Controller-Objekt benötigt ein select Element als ersten Parameter&quot;);
        }
        if (parentNode &amp;&amp; !(parentNode instanceof SelectionController)) {
            throw new Error(
                &quot;Controller-Objekt benötigt einen SelectionController als zweiten Parameter&quot;
            );
        }
        this.selectElement = selectElement;
        this.parentNode = parentNode;
        this.dataSource = dataSource;
        this.selectElement.addEventListener(&quot;change&quot;, event =&gt; this._handleChangeEvent(event))
        if (parentNode) {
            parentNode.addEventListener(&quot;change&quot;, event =&gt; this.mapData(event.selectedObject)); //?? event =&gt; this.mapData(event.selectedObject));
        }
    }
    // Ordnet dem select Element eine Datenquelle zu. 
    // dataSource ist ein Objekt, aus dem die getValueList die Daten für die
    // select-Optionen ermitteln kann, oder null, um das select-Element zu disablen
    mapData(dataSource) {
        // Quelldaten-Objekt im Controller speichern.
        this.dataSource = dataSource;
        // Optionen nur anfassen, wenn eine getValueList Methode vorhanden ist.
        //  Andernfalls davon ausgehen, dass die options durch das HTML
        // bereitgestellt werden.
        if (typeof this.getValueList == &quot;function&quot;) {
            // Existierende Optionen entfernen
            removeOptions(this.selectElement);
            // Wenn dataSource nicht null war, die neuen Optionen daraus beschaffen
            // Andernfalls das select-Element deaktivieren
            const options = dataSource &amp;&amp; this.getValueList(dataSource(this.selectElement.id,this.selectElement.value))//??this.getValueList(dataSource);
            if (!options || !options.length) {
                setToDisabled(this.selectElement)
            } else {
                setToEnabled(this.selectElement, options);
            }
        }
        // Zum Abschluss ein change-Event auf dem select-Element feuern, damit
        // jeder weiß, dass hier etwas passiert ist
        this.selectElement.dispatchEvent(new Event(&quot;change&quot;));
        // Helper: Entferne alle options aus einem select Element	
        function removeOptions(selectElement) {
                while (selectElement.length &gt; 0) selectElement.remove(0);
            }
            // Helper: select-Element auf disabled setzen und eine Dummy-Option 
            // eintragen. Eine Variante wäre: das selectElement auf hidden setzten
        function setToDisabled(selectElement) {
                addOption(selectElement, &quot;&quot;, &quot;------&quot;);
                selectElement.disabled = true;
            }
            // Helper: disabled-Zustand vom select-Element entfernen und die
            // übergebenen Optionen eintragen. Vorweg eine Dummy-Option &quot;Bitte wählen&quot;.
        function setToEnabled(selectElement, options) {
                addOption(selectElement, &quot;&quot;, &quot;Bitte wählen:&quot;);
                for (var optionData of options) {
                    addOption(selectElement, optionData.value, optionData.text);
                }
                selectElement.disabled = false;
            }
            // Helper: Option-Element erzeugen, ausfüllen und im select-Element eintragen
        function addOption(selectElement, value, text) {
            let option = document.createElement(&quot;option&quot;);
            option.value = value;
            option.text = text
            selectElement.add(option);
        }
    }
    // Abstrakte Methode! Wird sie nicht überschrieben, wird der TypeError geworfen
    getValue(key) {
      this.datasource(this.selectElement.id,key);
        //throw new TypeError(&quot;Die abstrakte Methode &#39;getValue&#39; wurde nicht implementiert!&quot;);
    }
    // Stellt den im select Element ausgewählten Optionswert zur Verfügung
    get selectedKey() {
        return this.selectElement.value;
    }
    // Liefert das Datenobjekt zum ausgewählten Optionswert
    get selectedObject() {
            return this.dataSource ? this.getValue(this.selectElement.value) : null;
    }
    // privat
    // Die Methode reagiert auf das change-Event des select-Elements
    // und stellt es als eigenes change-Event des Controllers zur Verfügung
    _handleChangeEvent(event) {
        let nodeChangeEvent = new Event(&quot;change&quot;);
        nodeChangeEvent.selectedObject = this.selectedObject;
        this.dispatchEvent(nodeChangeEvent);
    }
}*/
/*class ProfessorController extends SelectionController {
  constructor(selectElement) {
    super(selectElement, null);
  }
  getValue(quelle, profId) {
    return quelle.find(prof =&gt; prof.id == profId);
  }
}
class VorlesungController extends SelectionController {
  constructor(selectElement, parentController) {
    super(selectElement, parentController);
  }
  getValueList(professor) {
    return professor.vorlesungen.map(vorlesung =&gt; ({
      value: vorlesung.nummer,
      text: vorlesung.thema
    }));
  }
  getValue(professor, vorlesungNr) {
    return professor.vorlesungen.find(vorlesung =&gt; vorlesung.nummer ==
      vorlesungNr);
  }
}
class TerminController extends SelectionController {
  constructor(selectElement, parentController) {
    super(selectElement, parentController);
  }
  getValueList(vorlesung) {
    return vorlesung.termine.map(termin =&gt; ({
      value: termin.id,
      text: termin.zeit
    }));
  }
  getValue(vorlesung, terminId) {
    return vorlesung.termine.find(termin =&gt; termin.id == terminId);
  }
}*/
function datasource(category,key) {
    if(category===&quot;professor&quot;) {
      return([{ value: &quot;V1&quot;, text: &quot;vorlesung1&quot;}]);
    } else if (category===&quot;vorlesung&quot;) {
      return([{ value: &quot;T1&quot;, text: &quot;termin11&quot;}]);
    } else {
      return([{ value: &quot;P1&quot;, text: &quot;professor1&quot;}]);
    }
}/*
//document.addEventListener(&#39;DOMContentLoaded&#39;, 
(function () {
  const form = document.forms.terminauswahl;
  const profCtrl = new SelectionController(form.professor);
  const vorlesungCtrl = new SelectionController(form.vorlesung, profCtrl);
  const terminCtrl = new SelectionController(form.termin, vorlesungCtrl);
  terminCtrl.addEventListener(&quot;change&quot;, terminChanged)
  profCtrl.mapData(data)
  function terminChanged(event) {
    let terminCtrl = event.target;
    let vorlesungCtrl = terminCtrl.parentNode;
    let profCtrl = vorlesungCtrl.parentNode;
    let ausgabe = document.getElementById(&#39;auswahl&#39;);
    ausgabe.textContent = terminCtrl.selectedKey != &quot;&quot; ?
      `${profCtrl.selectedKey}:${profCtrl.selectedObject.name} / ` +
      `${vorlesungCtrl.selectedKey}:${vorlesungCtrl.selectedObject.thema} / ` +
      `${terminCtrl.selectedKey}:${terminCtrl.selectedObject.zeit}` : &quot;&quot;;
  }
})();//);*/
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="76" name="_ControlElements2_" tags="" position="1200,25" size="100,100">&lt;div id=&quot;choice&quot;&gt;
&lt;p&gt;click on image to show related text and border&lt;/p&gt;
&lt;table&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;img id=&quot;1&quot; src=&quot;https://twinery.org/homepage/img/logo.svg&quot; width=&quot;256&quot; height=&quot;256&quot; onclick=&#39;window.gm.onSelect(this,&quot;div#choice table tbody tr td *&quot;,&quot;div#info&quot;);&#39;&gt;&lt;/td&gt;
&lt;td&gt;&lt;img id=&quot;2&quot; src=&quot;https://twinery.org/homepage/img/logo.svg&quot; width=&quot;256&quot; height=&quot;256&quot; onclick=&#39;window.gm.onSelect(this,&quot;div#choice table tbody tr td *&quot;,&quot;div#info&quot;);&#39;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;img id=&quot;3&quot; src=&quot;https://twinery.org/homepage/img/logo.svg&quot; width=&quot;256&quot; height=&quot;256&quot; onclick=&#39;window.gm.onSelect(this,&quot;div#choice table tbody tr td *&quot;,&quot;div#info&quot;);&#39;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;div id=&quot;info&quot;&gt;
&lt;p id=&quot;1&quot; hidden&gt;Text 1&lt;/p&gt;&lt;p id=&quot;2&quot; hidden&gt;[[Start]]&lt;/p&gt;&lt;p id=&quot;3&quot; hidden&gt;Text 3&lt;/p&gt;
&lt;/div&gt;
&lt;label&gt;static dropdown:
		&lt;select id=&quot;person&quot; onchange=&#39;selectperson(this)&#39;&gt;
			&lt;option value=&quot;23&quot;&gt;Albers, Alfred&lt;/option&gt;
			&lt;option value=&quot;24&quot; selected&gt;Braun, Berta&lt;/option&gt;
      &lt;option value=&quot;25&quot;&gt;Zeta, Bort&lt;/option&gt;
		&lt;/select&gt;
&lt;/label&gt;
&lt;form name=&quot;terminauswahl&quot;&gt;
	&lt;label&gt;Professor:
		&lt;select id=&quot;professor&quot;&gt;
			&lt;option value=&quot;&quot;&gt;Bitte wählen:&lt;/option&gt;
      &lt;option value=&quot;P23&quot;&gt;Albers, Alfred&lt;/option&gt;
			&lt;option value=&quot;P24&quot;&gt;Braun, Berta&lt;/option&gt;
			&lt;option value=&quot;P25&quot;&gt;Drachenzaun, Doris&lt;/option&gt;
			&lt;option value=&quot;P26&quot;&gt;Münz, Stephan&lt;/option&gt;
			&lt;option value=&quot;P27&quot;&gt;Meier, Manfred&lt;/option&gt;
		&lt;/select&gt;
	&lt;/label&gt;
	&lt;label&gt;Lesung:
		&lt;select id=&quot;vorlesung&quot; disabled&gt;
			&lt;option value=&quot;&quot;&gt;------&lt;/option&gt;
		&lt;/select&gt;
	&lt;/label&gt;
	&lt;label&gt;Termin:
		&lt;select id=&quot;termin&quot; disabled&gt;
			&lt;option value=&quot;&quot;&gt;------&lt;/option&gt;
		&lt;/select&gt;
	&lt;/label&gt;
  	&lt;output id=&quot;auswahl&quot;&gt;&lt;/output&gt;
&lt;/form&gt;
&lt;div id=&#39;output&#39;&gt;&lt;/div&gt;
&lt;script&gt;
function selectperson(elmnt) {
		var menu = document.getElementById(elmnt.id);
		document.querySelector(&#39;div#output&#39;).innerHTML = menu.value +&quot;&quot;+menu.options[menu.selectedIndex].label+&quot; &quot;+menu.options[menu.selectedIndex].value;		
}
var data = [
	{
		id: &quot;P23&quot;,
		name: &quot;Albers, Alfred&quot;,
		vorlesungen: [
			{
				nummer: &quot;L55&quot;,
				thema: &quot;Katzen in der freien Wildbahn&quot;,
				termine: [
					{
						id: &quot;T123&quot;,
						zeit: &quot;freitags 10 - 12&quot;
					},
					{
						id: &quot;T124&quot;,
						zeit: &quot;sonntags 18 - 20&quot;
					}
				]
			},
			{
				nummer: &quot;L56&quot;,
				thema: &quot;Katzen im Gefängnis&quot;,
				termine: [
					{
						id: &quot;T125&quot;,
						zeit: &quot;montags 12 - 14&quot;
					},
					{
						id: &quot;T126&quot;,
						zeit: &quot;dienstags 8 - 10&quot;
					}
				]
			},
			{
				nummer: &quot;L57&quot;,
				thema: &quot;Katzen in Musicals&quot;,
				termine: [
					{
						id: &quot;T127&quot;,
						zeit: &quot;dienstags 10 - 12&quot;
					},
					{
						id: &quot;T128&quot;,
						zeit: &quot;mittwochs 13 - 15&quot;
					}
				]
			}
		]
	},
	{
		id: &quot;P24&quot;,
		name: &quot;Braun, Berta&quot;,
		vorlesungen: [
			{
				nummer: &quot;L65&quot;,
				thema: &quot;Hunde im Himmel&quot;,
				termine: [
					{
						id: &quot;T163&quot;,
						zeit: &quot;freitags 10 - 12&quot;
					},
					{
						id: &quot;T164&quot;,
						zeit: &quot;sonntags 18 - 20&quot;
					}
				]
			},
			{
				nummer: &quot;L66&quot;,
				thema: &quot;Hunde in der Hölle&quot;,
				termine: [
					{
						id: &quot;T165&quot;,
						zeit: &quot;montags 12 - 14&quot;
					},
					{
						id: &quot;T166&quot;,
						zeit: &quot;dienstags 8 - 10&quot;
					}
				]
			},
			{
				nummer: &quot;L67&quot;,
				thema: &quot;Höllenhunde&quot;,
				termine: [
					{
						id: &quot;T167&quot;,
						zeit: &quot;dienstags 10 - 12&quot;
					},
					{
						id: &quot;T168&quot;,
						zeit: &quot;mittwochs 13 - 15&quot;
					}
				]
		}
	  ]
	},
	{
		id: &quot;P25&quot;,
		name: &quot;Drachenzaun, Doris&quot;,
		vorlesungen: [
			{
				nummer: &quot;L75&quot;,
				thema: &quot;Wirtschaftskram I&quot;,
				termine: [
					{
						id: &quot;T171&quot;,
						zeit: &quot;freitags 10 - 12&quot;
					},
					{
						id: &quot;T172&quot;,
						zeit: &quot;sonntags 18 - 20&quot;
					}
				]
			},
			{
				nummer: &quot;L76&quot;,
				thema: &quot;Wirtschaftskram II&quot;,
				termine: [
					{
						id: &quot;T173&quot;,
						zeit: &quot;montags 12 - 14&quot;
					},
					{
						id: &quot;T174&quot;,
						zeit: &quot;dienstags 8 - 10&quot;
					}
				]
			},
			{
				nummer: &quot;L77&quot;,
				thema: &quot;Wirtschaftskram III&quot;,
				termine: [
					{
						id: &quot;T175&quot;,
						zeit: &quot;dienstags 10 - 12&quot;
					},
					{
						id: &quot;T176&quot;,
						zeit: &quot;mittwochs 13 - 15&quot;
					}
				]
			}
		]
	},
	{
		id: &quot;P26&quot;,
		name: &quot;Münz, Stefan&quot;,
		vorlesungen: [
			{
				nummer: &quot;L85&quot;,
				thema: &quot;Webdesign in den 90ern&quot;,
				termine: [
					{
						id: &quot;T181&quot;,
						zeit: &quot;freitags 10 - 12&quot;
					},
					{
						id: &quot;T182&quot;,
						zeit: &quot;sonntags 18 - 20&quot;
					}
				]
			},
			{
				nummer: &quot;L86&quot;,
				thema: &quot;Webdesign nach der Jahrtausendwende&quot;,
				termine: [
					{
						id: &quot;T183&quot;,
						zeit: &quot;montags 12 - 14&quot;
					},
					{
						id: &quot;T184&quot;,
						zeit: &quot;dienstags 8 - 10&quot;
					}
				]
			},
			{
				nummer: &quot;L87&quot;,
				thema: &quot;Responsives Webdesign&quot;,
				termine: [
					{
						id: &quot;T185&quot;,
						zeit: &quot;dienstags 10 - 12&quot;
					},
					{
						id: &quot;T186&quot;,
						zeit: &quot;mittwochs 13 - 15&quot;
					}
				]
			}
		],
	},
	{
		id: &quot;P27&quot;,
		name: &quot;Meier, Manfred&quot;,
		vorlesungen: [
			{
				nummer: &quot;L95&quot;,
				thema: &quot;Althochdeutsch&quot;,
				termine: [
					{
						id: &quot;T191&quot;,
						zeit: &quot;freitags 10 - 12&quot;
					},
					{
						id: &quot;T192&quot;,
						zeit: &quot;sonntags 18 - 20&quot;
					}
				]
			},
			{
				nummer: &quot;L96&quot;,
				thema: &quot;Mittelhochdeutsch&quot;,
				termine: [
					{
						id: &quot;T193&quot;,
						zeit: &quot;montags 12 - 14&quot;
					},
					{
						id: &quot;T194&quot;,
						zeit: &quot;dienstags 8 - 10&quot;
					}
				]
			},
			{
				nummer: &quot;L97&quot;,
				thema: &quot;Deutsch für Angefangene&quot;,
				termine: [
					{
						id: &quot;T195&quot;,
						zeit: &quot;dienstags 10 - 12&quot;
					},
					{
						id: &quot;T196&quot;,
						zeit: &quot;mittwochs 13 - 15&quot;
					}
				]
			}
		]
	}
];
class SelectionController extends EventTarget {
    constructor(selectElement, parentNode = null) {
        super(); // Pflicht: Konstruktor der Superklasse aufrufen
        if (!(selectElement instanceof HTMLSelectElement)) {
            throw new Error(
                &quot;Controller-Objekt benötigt ein select Element als ersten Parameter&quot;);
        }
        if (parentNode &amp;&amp; !(parentNode instanceof SelectionController)) {
            throw new Error(
                &quot;Controller-Objekt benötigt einen SelectionController als zweiten Parameter&quot;
            );
        }
        this.selectElement = selectElement;
        this.parentNode = parentNode;
        this.selectElement.addEventListener(&quot;change&quot;, event =&gt; this._handleChangeEvent(
            event))
        if (parentNode) {
            parentNode.addEventListener(&quot;change&quot;, event =&gt; this.mapData(event.selectedObject));
        }
    }
    // Ordnet dem select Element eine Datenquelle zu. 
    // dataSource ist ein Objekt, aus dem die getValueList die Daten für die
    // select-Optionen ermitteln kann, oder null, um das select-Element zu disablen
    mapData(dataSource) {
        // Quelldaten-Objekt im Controller speichern.
        this.dataSource = dataSource;
        // Optionen nur anfassen, wenn eine getValueList Methode vorhanden ist.
        //  Andernfalls davon ausgehen, dass die options durch das HTML
        // bereitgestellt werden.
        if (typeof this.getValueList == &quot;function&quot;) {
            // Existierende Optionen entfernen
            removeOptions(this.selectElement);
            // Wenn dataSource nicht null war, die neuen Optionen daraus beschaffen
            // Andernfalls das select-Element deaktivieren
            const options = dataSource &amp;&amp; this.getValueList(dataSource);
            if (!options || !options.length) {
                setToDisabled(this.selectElement)
            } else {
                setToEnabled(this.selectElement, options);
            }
        }
        // Zum Abschluss ein change-Event auf dem select-Element feuern, damit
        // jeder weiß, dass hier etwas passiert ist
        this.selectElement.dispatchEvent(new Event(&quot;change&quot;));
        // Helper: Entferne alle options aus einem select Element	
        function removeOptions(selectElement) {
                while (selectElement.length &gt; 0) selectElement.remove(0);
            }
            // Helper: select-Element auf disabled setzen und eine Dummy-Option 
            // eintragen. Eine Variante wäre: das selectElement auf hidden setzten
        function setToDisabled(selectElement) {
                addOption(selectElement, &quot;&quot;, &quot;------&quot;);
                selectElement.disabled = true;
            }
            // Helper: disabled-Zustand vom select-Element entfernen und die
            // übergebenen Optionen eintragen. Vorweg eine Dummy-Option &quot;Bitte wählen&quot;.
        function setToEnabled(selectElement, options) {
                addOption(selectElement, &quot;&quot;, &quot;Bitte wählen:&quot;);
                for (var optionData of options) {
                    addOption(selectElement, optionData.value, optionData.text);
                }
                selectElement.disabled = false;
            }
            // Helper: Option-Element erzeugen, ausfüllen und im select-Element eintragen
        function addOption(selectElement, value, text) {
            let option = document.createElement(&quot;option&quot;);
            option.value = value;
            option.text = text
            selectElement.add(option);
        }
    }
    // Abstrakte Methode! Wird sie nicht überschrieben, wird der TypeError geworfen
    getValue(key) {
        throw new TypeError(
            &quot;Die abstrakte Methode &#39;getValue&#39; wurde nicht implementiert!&quot;);
    }
    // Stellt den im select Element ausgewählten Optionswert zur Verfügung
    get selectedKey() {
        return this.selectElement.value;
    }
    // Liefert das Datenobjekt zum ausgewählten Optionswert
    get selectedObject() {
            return this.dataSource ? this.getValue(this.dataSource, this.selectElement.value) : null;
    }
    // privat
    // Die Methode reagiert auf das change-Event des select-Elements
    // und stellt es als eigenes change-Event des Controllers zur Verfügung
    _handleChangeEvent(event) {
        let nodeChangeEvent = new Event(&quot;change&quot;);
        nodeChangeEvent.selectedObject = this.selectedObject;
        this.dispatchEvent(nodeChangeEvent);
    }
}
class ProfessorController extends SelectionController {
  constructor(selectElement) {
    super(selectElement, null);
  }
  getValue(quelle, profId) {
    return quelle.find(prof =&gt; prof.id == profId);
  }
}
class VorlesungController extends SelectionController {
  constructor(selectElement, parentController) {
    super(selectElement, parentController);
  }
  getValueList(professor) {
    return professor.vorlesungen.map(vorlesung =&gt; ({
      value: vorlesung.nummer,
      text: vorlesung.thema
    }));
  }
  getValue(professor, vorlesungNr) {
    return professor.vorlesungen.find(vorlesung =&gt; vorlesung.nummer ==
      vorlesungNr);
  }
}</tw-passagedata><tw-passagedata pid="77" name="_VariablesAndScript_" tags="" position="1075,25" size="100,100">&lt;script&gt;
function getBanana(elmnt,val) {
    window.story.state.vars.bananas +=val;
    //window.story.show(window.passage.name); this would reload the passage but would overwrite the elmnt-replace
    elmnt.replaceWith(&quot;took bananas &quot;+val); //replace the calling link with simple text to it a one-timer. But it will be restored if passage is reloaded 
}
&lt;/script&gt;
&lt;%
//initialise game state
//s is window.story.state from snowman!
//create a vars-container and define startvalues for some variables
if (!s.vars) { 
	s.vars = {
    bananas : 0
  }; 
}
%&gt;
&lt;% if(visited(window.passage.name)&lt;=1) {
    s.vars.bananas+=2;}
%&gt;
You have &lt;%=s.vars.bananas%&gt; bananas. &lt;/br&gt;
&lt;mark&gt;If you want to call functions in this way you have to add them to a global object.This is done in the StoryScrip-passage. See there. &lt;/br&gt;&lt;/mark&gt;
You droped a banana and have now &lt;%-window.gm.dropBanana()%&gt;. &lt;/br&gt;

&lt;mark&gt;This is a empty link that is used to trigger a function that is defined in the page-script &lt;/br&gt;&lt;/mark&gt;
&lt;a0 onclick=getBanana(this,5)&gt;Get more banana&lt;/a&gt; &lt;/br&gt;
&lt;mark&gt;or calling a anonymous function (take notice how alert-string is escaped):&lt;/br&gt;&lt;/mark&gt;
&lt;a0 id=&#39;money&#39; onclick=&#39;(function ( $event ) { alert(&quot;alert &quot;.concat($event.id)); })(this);&#39;&gt;Get much money&lt;/a&gt;
&lt;mark&gt;Press refreh to update page display &lt;/br&gt;&lt;/mark&gt;
[[Refresh|_VariablesAndScript_]] &lt;/br&gt;
[[Start]]</tw-passagedata><tw-passagedata pid="78" name="debug_cheat" tags="_back_" position="975,975" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
Some things for debugging:&lt;/br&gt;
&lt;/br&gt;[[MemoryGame]] [[HangmanGame]] [[MinesweeperAscii]] [[Evade]]&lt;/br&gt; &lt;!--todo--&gt;
&lt;/br&gt;[[NewGamePlus]]&lt;/br&gt; &lt;!--todo--&gt;
[[Cheats|debug]]&lt;/br&gt;
[[Back|_back_]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="79" name="debug" tags="_back_" position="1100,975" size="100,100">&lt;section&gt; &lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
[[Back|_back_]] [[DebugTransform]] [[Styletest]] [[Emergency-Wardrobe|Wardrobe]] [[dont use!|debug_cheat]]&lt;/br&gt;
Cheat buttons: those are meant for debugging and might break your game&lt;/br&gt;
&lt;a0  onclick=&#39;window.gm.player.Inv.addItem(new window.storage.constructors[&quot;Money&quot;](),200);window.gm.refreshAllPanel();&#39;&gt;Get 200$&lt;/a&gt;&lt;/br&gt;
&lt;/br&gt;
&lt;a0  onclick=&#39;unhideStats();window.gm.refreshAllPanel();&#39;&gt;unhide player stats&lt;/a&gt;&lt;/br&gt;
&lt;%if(window.story.state._gm.dbgShowCombatRoll) {%&gt;
&lt;a0  onclick=&#39;window.story.state._gm.dbgShowCombatRoll=false;window.gm.refreshAllPanel();&#39;&gt;disable combat debug&lt;/a&gt;
&lt;%} else {%&gt;
&lt;a0  onclick=&#39;window.story.state._gm.dbgShowCombatRoll=true;window.gm.refreshAllPanel();&#39;&gt;enable combat debug (log combat calculations)&lt;/a&gt;
&lt;%}%&gt;
&lt;%if(window.story.state._gm.dbgShowQuestInfo) {%&gt;
&lt;a0  onclick=&#39;window.story.state._gm.dbgShowQuestInfo=false;window.gm.refreshAllPanel();&#39;&gt;disable extended questinfo&lt;/a&gt;
&lt;%} else {%&gt;
&lt;a0  onclick=&#39;window.story.state._gm.dbgShowQuestInfo=true;window.gm.refreshAllPanel();&#39;&gt;enable ext. questinfo&lt;/a&gt;
&lt;%}%&gt;
&lt;label for=&quot;addXP&quot;&gt;addXP:&lt;input type=&quot;text&quot; id=&quot;addXP&quot; name=&quot;addXP&quot;&gt;&lt;/label&gt;&lt;a0  onclick=&#39;window.gm.player.addXP(parseInt(document.getElementById(&quot;addXP&quot;).value));window.gm.refreshAllPanel();&#39;&gt;GO&lt;/a&gt;&lt;/br&gt;
&lt;a0  onclick=&#39;window.gm.player.Stats.increment(&quot;health&quot;,25);window.gm.refreshAllPanel();&#39;&gt;Health +25&lt;/a&gt;&lt;/br&gt;
&lt;a0  onclick=&#39;window.gm.player.Stats.increment(&quot;energy&quot;,25);window.gm.refreshAllPanel();&#39;&gt;Energy +25&lt;/a&gt;&lt;/br&gt;
&lt;a0  onclick=&#39;window.gm.player.Stats.increment(&quot;corruption&quot;,25);window.gm.refreshAllPanel();&#39;&gt;corruption +25&lt;/a&gt;
&lt;a0  onclick=&#39;window.gm.player.Stats.increment(&quot;corruption&quot;,-25);window.gm.refreshAllPanel();&#39;&gt;corruption -25&lt;/a&gt;&lt;/br&gt;
&lt;a0  onclick=&#39;window.gm.player.Stats.increment(&quot;arousal&quot;,25);window.gm.refreshAllPanel();&#39;&gt;Arousal +25&lt;/a&gt;
&lt;a0  onclick=&#39;window.gm.player.Stats.increment(&quot;arousal&quot;,-25);window.gm.refreshAllPanel();&#39;&gt;Arousal -25&lt;/a&gt;&lt;/br&gt;
Crash if you enter wrong things below !&lt;/br&gt;
&lt;label for=&quot;passage&quot;&gt;passage:&lt;input type=&quot;text&quot; id=&quot;passage&quot; name=&quot;passage&quot;&gt;&lt;/label&gt;&lt;a0  onclick=&#39;window.story.show(document.getElementById(&quot;passage&quot;).value)&#39;&gt;Go&lt;/a&gt;&lt;/br&gt;
&lt;label for=&quot;additem&quot;&gt;add item:&lt;input type=&quot;text&quot; id=&quot;additem&quot; name=&quot;additem&quot;&gt;&lt;/label&gt;&lt;a0  onclick=&#39;window.gm.player.Inv.addItem(new window.storage.constructors[document.getElementById(&quot;additem&quot;).value]())&#39;&gt;Go&lt;/a&gt;&lt;/br&gt;
(only non-wardrobe-items except weapons!)&lt;/br&gt;
&lt;label for=&quot;addoutfit&quot;&gt;add wardrobe:&lt;input type=&quot;text&quot; id=&quot;addoutfit&quot; name=&quot;addoutfit&quot;&gt;&lt;/label&gt;&lt;a0  onclick=&#39;window.gm.player.Wardrobe.addItem(new window.storage.constructors[document.getElementById(&quot;addoutfit&quot;).value]())&#39;&gt;Go&lt;/a&gt;&lt;/br&gt;
(only wardrobe-items except weapons! You need to equip them in wardrobe.)&lt;/br&gt;
&lt;label for=&quot;startfight&quot;&gt;start fight:&lt;input type=&quot;text&quot; id=&quot;startfight&quot; name=&quot;startfight&quot;&gt;&lt;/label&gt;&lt;a0  onclick=&#39;window.gm.encounters[document.getElementById(&quot;startfight&quot;).value]()&#39;&gt;Go&lt;/a&gt;&lt;/br&gt;
(use Encounter-name, might sent you to certain events on defeat/victory)&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt; function unhideStats() {
    var ids = window.gm.player.Stats.getAllIds();
    for(var i=0; ids.length&gt;i;i++) {
        window.gm.player.Stats.modifyHidden(ids[i],0);
    }
}
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="80" name="DebugTransform" tags="_back_" position="1225,975" size="100,100">&lt;section&gt; &lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;div&gt;&lt;/br&gt;[[Back|_back_]]&lt;/br&gt;
Test transformation events. Because they are deffered-events you need to return to story and move between rooms.&lt;/br&gt;
Anthros:&lt;/br&gt;
&lt;a0 onclick=&#39;window.gm.pushDeferredEvent(&quot;MutateCat&quot;,[1])&#39;&gt;Cat&lt;/a&gt;
&lt;a0 onclick=&#39;window.gm.pushDeferredEvent(&quot;MutateWolf&quot;,[1])&#39;&gt;Wolf&lt;/a&gt;&lt;/br&gt;
&lt;a0 onclick=&#39;window.gm.pushDeferredEvent(&quot;MutateHorse&quot;,[1])&#39;&gt;Horse&lt;/a&gt;&lt;/br&gt;
&lt;hr&gt;
Ferals:&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="81" name="Styletest" tags="_back_" position="100,1100" size="100,100">&lt;section&gt; &lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;div&gt;&lt;/br&gt;[[Back|_back_]]
Theme:
&lt;a href=&quot;javascript:window.styleSwitcher.setStyle(&#39;default&#39;);window.gm.refreshAllPanel();&quot;&gt;default&lt;/a&gt;
&lt;a href=&quot;javascript:window.styleSwitcher.setStyle(&#39;dark&#39;);window.gm.refreshAllPanel();&quot;&gt;dark&lt;/a&gt;&lt;/br&gt;&lt;/div&gt;
&lt;/br&gt;&lt;hr&gt;
&lt;p class=&#39;tPC&#39;&gt;PC-talk&lt;/p&gt;&lt;p class=&#39;tNPC1&#39;&gt;NPC1-talk&lt;/p&gt;&lt;p class=&#39;tNPC2&#39;&gt;NPC2-talk&lt;/p&gt;
&lt;p class=&#39;dev&#39;&gt;notes from developer.&lt;/p&gt;
&lt;p class=&#39;author&#39;&gt;notes from author.&lt;/p&gt;
&lt;form&gt;&lt;ul style=&quot;list-style-type: none; padding-inline-start: 0px;&quot; &gt;&lt;legend&gt;List&lt;/legend&gt;
&lt;button type=&quot;button&quot; id=&quot;button1&quot;&gt;Button1&lt;/button&gt;
&lt;div class=&quot;meter&quot;&gt;&lt;div class=&quot;bar&quot; style=&quot;width:23%&quot;&gt;&lt;/div&gt;&lt;div style=&quot;position:absolute; top:0; left:0; width:100%&quot;&gt;5/45&lt;/div&gt;&lt;/div&gt;
&lt;li style=&quot;padding-bottom: 0.5em;&quot;&gt;&lt;input type=&quot;checkbox&quot; name=&quot;y&quot; value=&quot;x&quot; readonly disabled&gt;&lt;label&gt;chekbox disabled&lt;/label&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/form&gt;&lt;/br&gt;
&lt;statup&gt;Statup&lt;/statup&gt;  &lt;statdown&gt;Statdown&lt;/statdown&gt; &lt;span class=&#39;red&#39;&gt;RED&lt;/span&gt;&lt;span class=&#39;green&#39;&gt;GREEN&lt;/span&gt;
&lt;p class=&#39;div_alarm&#39;&gt;ALARM&lt;/p&gt;
&lt;hr&gt;
&lt;div class=&quot;progress-bar-striped&quot;&gt;
			&lt;div style=&quot;width: 100%;&quot;&gt;&lt;b&gt;&lt;p&gt;100%&lt;/p&gt;&lt;/b&gt;&lt;/div&gt;
		&lt;/div&gt;
		&lt;div&gt;
			&lt;input id=&quot;progress-value&quot; type=&quot;number&quot; placeholder=&quot;Enter desired percentage&quot; min=&quot;0&quot; max=&quot;100&quot; value=&quot;7&quot; /&gt;
			&lt;input type=&quot;button&quot; value=&quot;Change&quot; onclick=&quot;change()&quot;/&gt;
		&lt;/div&gt;
&lt;hr&gt;
&lt;label&gt;[hint]&lt;input type=&quot;checkbox&quot;  style=&quot;display: none;&quot; &gt;
  &lt;span role=&#39;tooltip&#39;&gt;hkljj  fdggfdsf gf   dfsd afsdafgdae sgfegf&lt;/span&gt;
&lt;/label&gt;       &lt;label&gt; &lt;input type=&quot;checkbox&quot; &gt;
  &lt;span role=&#39;tooltip&#39;&gt;hkljj  fdggfdsf gf   dfsd afsdafgdae sgfegf&lt;/span&gt;
&lt;/label&gt;
&lt;div class=&quot;popup&quot;&gt;[hover here]
  &lt;span class=&quot;popuptext&quot; id=&quot;myPopup2&quot;&gt;A Simple window.gm.printPickupAndClear(&#39;Crowbar&#39;,&#39;A crowbar is lying other there.&#39;&lt;/span&gt;
&lt;/div&gt;
&lt;div class=&quot;popup&quot;&gt;[hover here]
  &lt;span class=&quot;popuptext&quot; id=&quot;myPopup2&quot;&gt;A Simple window.gm.printPickupAndClear(&#39;Crowbar&#39;,&#39;A crowbar is lying other there.&#39;&lt;/span&gt;
&lt;/div&gt;
&lt;label&gt; &lt;input type=&quot;checkbox&quot; &gt;
  &lt;span role=&#39;tooltip&#39;&gt;hkljj  fdggfdsf gf   dfsd afsdafgdae sgfegf&lt;/span&gt;
&lt;/label&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt;
function change(){
				var selectedValue = document.querySelector(&quot;#progress-value&quot;).value;
				document.querySelector(&quot;.progress-bar-striped &gt; div&quot;).textContent = selectedValue + &quot;%&quot;;
				document.querySelector(&quot;.progress-bar-striped &gt; div&quot;).style.width = selectedValue + &quot;%&quot;;
			}
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="82" name="NOP" tags="_back_" position="225,1100" size="100,100">&lt;section&gt; &lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;p class=&#39;author&#39;&gt;Sorry, this loation is curently not implemented.&lt;/p&gt; &lt;!--todo  implement passages pointing to this--&gt;
&lt;div&gt; &lt;/br&gt;
[[Back|_back_]]&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="83" name="Deffered1" tags="" position="350,1100" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
Deffered1
[[Home]]
&lt;a0 onclick= window.story.show(&quot;&quot;)&gt;Next&lt;/a&gt;&lt;/br&gt;&lt;/br&gt;
&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="84" name="Deffered2" tags="" position="475,1100" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
Deffered2
[[Home]]
&lt;a0 onclick=&#39;window.gm.pushDeferredEvent(&quot;Deffered3&quot;,[13],true)&#39;&gt;Deffered3&lt;/a&gt;&lt;/br&gt;
&lt;a0 onclick= window.story.show(&quot;&quot;)&gt;go on&lt;/a&gt;&lt;/br&gt;&lt;/br&gt;
&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="85" name="Deffered3" tags="" position="600,1100" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
Deffered3
[[Home]]
&lt;a0 onclick=&#39;window.gm.pushDeferredEvent(&quot;Deffered3&quot;,[13])&#39;&gt;Deffered1&lt;/a&gt;&lt;/br&gt;
&lt;a0 onclick= window.story.show(&quot;&quot;)&gt;go on&lt;/a&gt;&lt;/br&gt;&lt;/br&gt;
&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="86" name="ForestAlchemistTalk" tags="_nosave_" position="725,1100" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;% if(!window.gm.quests.hasActiveQuest(&quot;qPurpleBerry&quot;) || window.gm.quests.getMilestoneState(&quot;qPurpleBerry&quot;).id&lt;1) { 
    window.story.render(&quot;AlchTalkStartPurpleBerry&quot;); %&gt;
&lt;% } else if(window.gm.quests.getMilestoneState(&quot;qPurpleBerry&quot;).id===1 &amp;&amp; window.gm.player.Inv.countItem(&quot;PurpleBerry&quot;)&gt;=5) { 
    window.story.render(&quot;AlchTalkFinishPurpleBerry&quot;); %&gt;
&lt;% } else if(window.gm.quests.getMilestoneState(&quot;qBondageKink&quot;).id===300) {
    window.story.render(&quot;AlchTalkFinishPurpleBerry&quot;); %&gt;
&lt;% } else if(window.gm.quests.getMilestoneState(&quot;qCarlia&quot;).id===700) {
    window.story.render(&quot;AlchTalkShelterCarlia&quot;); %&gt;
&lt;%} else {%&gt; He seems busy right now. [[Back|ForestAlchemistHut]] &lt;%}%&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="87" name="AlchTalkShelterCarlia" tags="" position="850,1100" size="100,100">todo  Convince Alchemist to take Carlia in.
&lt;p class=&quot;tPC&quot;&gt;&quot;I&#39;m pretty sure she can help you around; fetching ingredients from the forest, keeping you company...&quot;&lt;/p&gt;
&quot;Well yes.&quot; the alchemist scratches his chin in thought &quot;Sometimes it gets really lonely here and if someone others collects the ingredients, I can spent more time with potion-making..&quot;&lt;/br&gt;
&quot;Just bring her here and we will see if we can workout something.&quot;&lt;/br&gt;
&lt;&lt;p class=&quot;tPC&quot;&gt;&#39;That went smoother then I thought.&#39;&lt;/p&gt;&gt;
&lt;a0 onclick=&#39;window.gm.quests.forceQuestMilestone(&quot;qCarlia&quot;,800,700);window.story.show(&quot;ForestAlchemistHut&quot;);&#39;&gt;Leave&lt;/a&gt;&lt;/br&gt;</tw-passagedata><tw-passagedata pid="88" name="AlchTalkBridgeThugs" tags="" position="975,1100" size="100,100">As you stumble into the hut, the alchemists greets you: &quot;Ah, nice to see you again. You fine so far?&quot;
&lt;p class=&quot;tPC&quot;&gt;&quot;Nope. There are some thugs at the bridge, they dont let me pass.&quot;&lt;/p&gt;
&quot;Thugs? Did they rob you?&quot;
&lt;p class=&quot;tPC&quot;&gt;&quot;I got away before they got that idea. Is there an alternative to get over the canyon.&quot;&lt;/p&gt;
He shakes his head &quot;Not that I know. Cant you sneak around them or trick them somehow to let you pass?&quot;
&lt;p class=&quot;tPC&quot;&gt;&quot;Well, thats what I wanted to ask you. You dont have an elixier or something that makes me hardier and stronger?&quot;&lt;/p&gt; 
&quot;Huff, no. I&#39;m still out of stock. I can give you those berry-potions if you bring me enough berries. It wouldnt take much to improve it though...&quot;
&quot;If you can get me 4 purple berries, 2 apoca flowers and 2 leeches I can mix up some potion to boost your strength.&quot;
&lt;p class=&quot;tPC&quot;&gt;&quot;Thats exactly what I need ! But where can I find them?&quot;&lt;/p&gt;
&quot;The flowers grow in the forest too. They have colorful blue and yellow blossoms. But those leeches...they lurk in dark,humid places, swamps and such.&quot;
&lt;p class=&quot;tPC&quot;&gt;&quot;I will see to get some.&quot;&lt;/p&gt;
&lt;a0 onclick=&#39;window.gm.quests.forceQuestMilestone(&quot;qPurpleBerry&quot;,200,100);window.story.show(&quot;ForestBorder&quot;);&#39;&gt;Leave&lt;/a&gt;&lt;/br&gt;</tw-passagedata><tw-passagedata pid="89" name="AlchTalkFinishPurpleBerry" tags="" position="1100,1100" size="100,100">&lt;div id=&#39;select1&#39; &gt; You got enough purple berries to trade in for the alchemist. Will you do so?
&lt;a0 onclick=&#39;window.gm.player.Inv.removeItem(&quot;PurpleBerry&quot;,5);window.gm.player.Inv.addItem(new window.gm.ItemsLib[&quot;HealthPotion(small)&quot;](),2);window.gm.quests.forceQuestMilestone(&quot;qPurpleBerry&quot;,100,1);window.gm.printTalkLink($(&quot;div#select1&quot;)[0],&quot;div#choice1a&quot;);&#39;&gt;Yes&lt;/a&gt;
&lt;a0 onclick=&#39;window.story.show(&quot;ForestBorder&quot;);&#39;&gt;Leave&lt;/a&gt;
&lt;/div&gt;
&lt;div id=&#39;choice1a&#39; hidden&gt;
&lt;p class=&#39;tPC&#39;&gt;&quot;I&#39;ve got those berries for you.&quot;&lt;/p&gt; You place them on the desk and wait for the approval of the alchemist.&lt;/br&gt;
&quot;Very good. Like I said I will give you 2 potions for those.&quot;
&lt;a0 onclick=&#39;window.gm.refreshAllPanel();&#39;&gt;Next&lt;/a&gt;
&lt;/div&gt;&lt;div id=&#39;choice1b&#39; hidden&gt;&lt;/div&gt;
&lt;% } else if(window.gm.quests.getMilestoneState(&quot;qBondageKink&quot;).id===100) {%&gt;
&lt;p class=&quot;tPC&quot;&gt;&quot;Hello. sorry to bother you again but can you take a look at this.&quot;&lt;/p&gt;
You tilt your head to a side and point at the choker.&lt;/br&gt;
&quot;Fancy. You are in this sort of thing?&quot;&lt;/br&gt;
&lt;p class=&quot;tPC&quot;&gt;&quot;What? No! This somehow attached itself on me. I want to get it off!&lt;/p&gt;
&quot;Let me see. Hm.. I&#39;m not sure if this here is a locking mechanic.. I think I cant help you with that one. A locksmith might be the right person to ask.&quot;
&lt;p class=&quot;tPC&quot;&gt;&quot;And do you know where to find one?&quot;&lt;/p&gt;
&quot;There is a town east of here, called Elderant. You might be able to find someone that can unlock this thing there.&quot;
&lt;p class=&quot;tPC&quot;&gt;&quot;There is a town nearby?&quot;&lt;/p&gt;
&quot;Nearby is relative. Its about a 3 or 4 days walk I guess. As I think over it, maybe you shouldnt go. It can be dangerous traveling alone.&quot;
&lt;p class=&quot;tPC&quot;&gt;&quot;More dangerous than the forest? I died on the first visit of this damn forest ... by an stupid accident !&quot;&lt;/p&gt;
&quot;The forest isnt dangerous. I never had any issues. Maybe you just had a little bad luck.&quot;
An idea forms in your mind: &lt;span class=&quot;tPC&quot;&gt;&#39;when I die, I lose the equipment&#39;&lt;/span&gt;&lt;/br&gt;
Of ourse dying would be bad if it causes a large loss. But right now you just have little to no gear and will be replenished with a new set.
You smirk to yourself for your ingenuity.&lt;/br&gt; 
&lt;p class=&quot;tPC&quot;&gt;&#39;So if I dont have any other option, I still just need to find a way to die to get rid of that thing.&#39;&lt;/p&gt;
&lt;a0 onclick=&#39;window.gm.quests.forceQuestMilestone(&quot;qBondageKink&quot;,200,100);window.story.show(&quot;ForestAlchemistHut&quot;);&#39;&gt;Death is a solution&lt;/a&gt;
&lt;a0 onclick=&#39;window.gm.quests.forceQuestMilestone(&quot;qBondageKink&quot;,200,100);window.story.show(&quot;ForestAlchemistHut&quot;);&#39;&gt;Its not worth dieing to get rid of it&lt;/a&gt;
&lt;a0 onclick=&#39;window.gm.quests.forceQuestMilestone(&quot;qBondageKink&quot;,200,100);window.story.show(&quot;ForestAlchemistHut&quot;);&#39;&gt;Strangely, it doesnt bother me that much anymore&lt;/a&gt;&lt;!--todo increase submissive--&gt;</tw-passagedata><tw-passagedata pid="90" name="AlchTalkStartPurpleBerry" tags="" position="1225,1100" size="100,100">&lt;p class=&#39;tPC&#39;&gt;&quot;Hello? Anyone there?&quot;&lt;/p&gt;
A man appears from a door at the side of the room. Worn old clothing adorns his skinny frame. 
&lt;p class=&#39;tPC&#39;&gt;&quot;I would like to ask if you have a quest for me.&quot;&lt;/p&gt;
&quot;A quest? Thats an odd question. Do you mean a job?&quot;
&lt;p class=&#39;tPC&#39;&gt;&quot;Not a job. Something that is really important to you but you cant do it yourself.&quot;&lt;/p&gt;
Ah, you mean cake. I like cake but I cant bake a deent one myself.
&lt;p class=&#39;tPC&#39;&gt;&quot;What?! No I mean something that is a matter of life.&quot;&lt;/p&gt;
&quot;Cake is important for my life. Its a tasty treat that sweetens my existance.&quot;
&lt;p class=&#39;tPC&#39;&gt;&quot;No listen. Do you need help with some task? I could help you and you give me something. Except for baking a cake.&quot;
&quot;I should give you something? What could I give you? A potion maybe. I dont have much else I could give away.&quot;
&lt;p class=&#39;tPC&#39;&gt;&quot;What potions do you create.&quot;&lt;/p&gt;
&quot;Oh hoho now we are talking my language. I could make a lot of useful potions. Unfortunatly my alembic is broken so I can only do the basic stuff.
Now that I think about it, we could make a trade: you get me some purple berrys, and you get some berry juice I create from it.&quot;
&lt;p class=&#39;tPC&#39;&gt;&quot;I could crush them myself and have all of the juice for myself!&quot;&lt;/p&gt;
&quot;Uhm.. but you cant do it like I do .. I have special equipment for that. It empowers the natural healing benefit.&quot;
&lt;p class=&#39;tPC&#39;&gt;&quot;So that juice is some kind of health potion?&quot;&lt;/p&gt;
&quot;For sure it is. Therefore I say: bring me 5 handful of berries and you get to 2 bottles of potion.&quot;
&lt;p class=&#39;tPC&#39;&gt;&quot;Sigh. Whatever. Seems to be the only possible quest I an get right now.&quot;&lt;/p&gt;
&quot;Are they with caramel? I like caramel. And choclat.&quot;
&lt;p class=&#39;tPC&#39;&gt;&quot;Please? What do you talk about?&quot;&lt;/p&gt;
&quot;About the cakes. What kind of cake are we speaking about.&quot;
&lt;p class=&#39;tPC&#39;&gt;&quot;I will get you your berries now.&quot;&lt;/p&gt;
&lt;a0 onclick=&#39;window.gm.quests.addQuest(&quot;qPurpleBerry&quot;,1);window.story.show(&quot;ForestBorder&quot;);&#39;&gt;Leave&lt;/a&gt;</tw-passagedata><tw-passagedata pid="91" name="TFCanineCock" tags="" position="100,1225" size="100,100">getCockType &amp; Rating
if Type!=this decrease rating
else increase rating
if rating drops below 0 ??  &quot;Something in your nethers is changing, you can feel it. Your once average sized human dong has changed its shape. At least that what you think.&quot;
if rating increases just above 0 &quot;You &quot;</tw-passagedata><tw-passagedata pid="92" name="GenericDeffered" tags="_isdeffered_" position="225,1225" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;div id=&#39;output&#39;&gt;&lt;%=window.story.state.tmp.args[0]%&gt;&lt;/div&gt;&lt;/br&gt;   &lt;!--message is rendered here--&gt;
&lt;a0 onclick= &#39;window.story.show(&quot;&quot;)&#39;&gt;Next&lt;/a&gt;&lt;/br&gt;
&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="93" name="CatHabit" tags="_isdeffered_" position="350,1225" size="100,100">&lt;section&gt; &lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
You feel the urge to sit down and give yourself a good licking...&lt;/br&gt;
&lt;a0 onclick= window.story.show(&quot;&quot;)&gt;Next&lt;/a&gt;&lt;/br&gt;
&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="94" name="MutateBreast" tags="_isdeffered_" position="475,1225" size="100,100">&lt;section&gt; &lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;div id=&#39;output&#39;&gt;&lt;/div&gt;&lt;/br&gt;   &lt;!--message is rendered here--&gt;
&lt;a0 onclick=&#39;window.story.state.msg=&quot;&quot;;window.story.show(&quot;&quot;)&#39;&gt;Next&lt;/a&gt;&lt;/br&gt;
&lt;/article&gt;&lt;/section&gt;
&lt;script&gt;
function mutate() {
    if(window.gm.player.Outfit.countItem(&quot;BreastHuman&quot;)&gt;0) {
        var growth = window.gm.player.Outfit.getItem(&quot;BreastHuman&quot;).growth+=0.1;
        var maxGrowth = 0.3;//window.gm.player.Outfit.getItem(&quot;TailWolf&quot;).maxGrowth;
        if(growth &gt;= 1) {
            window.gm.printOutput(&quot;Your teats are as big as they can get.&lt;/br&gt;&quot;);
        } else {
            window.gm.player.Outfit.getItem(&quot;BreastHuman&quot;).growth=growth;
            window.gm.printOutput(&quot;Your breasts seems to have enlarged again to a size of &quot;+growth*maxGrowth*100+&quot; cm.&lt;/br&gt;&quot;);
        }
    } else {
        window.gm.player.Outfit.addItem(new window.storage.constructors[&#39;BreastHuman&#39;]());
        window.gm.printOutput(&quot;As you feel up your pecks you notice that they seem to be softer than before !&lt;/br&gt;&quot;);
    }
}
mutate();
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="95" name="MutateBreastEnd" tags="_isdeffered_" position="600,1225" size="100,100">&lt;section&gt; &lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
Somehow you know your breast stopped changing ...&lt;/br&gt;
&lt;a0 onclick=&#39;window.story.state.msg=&quot;&quot;;window.story.show(&quot;&quot;)&#39;&gt;Next&lt;/a&gt;&lt;/br&gt;
&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="96" name="MutateVulva" tags="_isdeffered_" position="725,1225" size="100,100">&lt;section&gt; &lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;div id=&#39;output&#39;&gt;&lt;/div&gt;&lt;/br&gt;   &lt;!--message is rendered here--&gt;
&lt;a0 onclick=&#39;window.story.state.msg=&quot;&quot;;window.story.show(&quot;&quot;)&#39;&gt;Next&lt;/a&gt;&lt;/br&gt;
&lt;/article&gt;&lt;/section&gt;
&lt;script&gt;
function mutate() {
    let vulva = window.gm.player.Outfit.getItemForSlot(window.gm.OutfitSlotLib.bVulva);
    let msg = &#39;Everything is ok, nothing unusual.&lt;/br&gt;&#39;;
    if(vulva) {
        msg =&quot;An unusual feeling lets you move your hand down to your nethers.&lt;/br&gt;&quot;
        if(vulva.data.clitsize&gt;0.9) {
            vulva.data.stretch+=0.5;
            msg+= &quot;Your muff seems to be more loose then before !&lt;/br&gt;&quot;;
        } else {
            vulva.data.clitsize+=0.5;
            msg+= &quot;You arent quite sure but could it be possible that your clitoris is larger then before?&lt;/br&gt;&quot;;
        }
        msg += &quot;&lt;/br&gt;&quot;+vulva.descLong()+&quot;&lt;/br&gt;&quot;;
    }
    window.gm.printOutput(msg);
}
mutate();
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="97" name="MutateVulvaEnd" tags="_isdeffered_" position="850,1225" size="100,100">&lt;section&gt; &lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
Your cunt didnt change since some time now. At least you cant see any... &lt;/br&gt;
&lt;a0 onclick= window.story.show(&quot;&quot;)&gt;Next&lt;/a&gt;&lt;/br&gt;
&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="98" name="Masturbate" tags="_nosave_" position="975,1225" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;div id=&#39;select1&#39; &gt;
&lt;a0 onclick=&#39;window.gm.printTalkLink($(&quot;div#select1&quot;)[0],&quot;div#choice1a&quot;)&#39;&gt;Pinch your own nipples.&lt;/a&gt;&lt;/br&gt;
&lt;/div&gt;
&lt;div id=&#39;choice1a&#39; hidden&gt;&lt;/br&gt;
Tweasing your [small] nipples between thumb and index finger until it nearly gets painful.&lt;/br&gt;
&lt;div id=&#39;select2&#39; &gt;
&lt;a0 id=&#39;tweazeNipple&#39; onclick=&#39;window.gm.printTalkLink($(&quot;div#select2&quot;)[0],&quot;div#choice2a&quot;, fondlebreast)&#39;&gt;Just some more&lt;/a&gt;
&lt;a0 onclick=&#39;window.gm.printTalkLink($(&quot;div#select2&quot;)[0],&quot;div#choice2b&quot;)&#39;&gt;Stop it&lt;/a&gt;
&lt;/div&gt;
&lt;div id=&#39;choice2a&#39; hidden&gt;&lt;/br&gt;
Now you increase the pressure until there is pain.
&#39;I think thats enough right now.&#39; [[Next|&lt;%=window.gm.player.location%&gt;]]&lt;/br&gt; 
&lt;/div&gt;
&lt;div id=&#39;choice2b&#39; hidden&gt;&lt;/br&gt;
Releasing the pressure on your nubs, they just feel numb right now.
&#39;I think thats enough right now.&#39; [[Next|&lt;%=window.gm.player.location%&gt;]]&lt;/br&gt; 
&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt;
function fondlebreast(elmnt) {
    elmnt.replaceWith(&quot;You nipple stiffens under this attention.&quot;);
    window.gm.player.addEffect(&quot;effGrowBreast&quot;,window.storage.constructors[&#39;effGrowBreast&#39;]());
    window.gm.quests.forceQuestMilestone(&quot;qMyPleasure&quot;,100,1);
}
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="99" name="WolfSubmit" tags="" position="1100,1225" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
The wolf raises a hind leg and gives your prone form a good amount of watering.
After a final sniff it runs of into the woods.
&lt;div&gt;&lt;/br&gt;&lt;a0 onclick=&#39;window.gm.player.addEffect(&quot;effMutateWolf&quot;,new window.storage.constructors[&quot;effMutateWolf&quot;]());window.gm.postDefeat()&#39;);&#39;&gt;Black out&lt;/a&gt;&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="100" name="WolfSubmitLewd" tags="" position="1225,1225" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
The wolf isn&#39;t aroused enough and leaves you alone.
---
The wolf is quite in the mood to fool around.
---
Stiffleged the wolf is strutting over to you. From your point of view you can easily see a red tip poking out of the sheath below his belly.
You get on all 4 to crawl away, but he quickly jumps on your lower back, pushing you further down with his mass.
---
As soon as you can feel his tip hitting your backdoor you pass out.
[[Pass out]]  
---
That bitch seems to be aggresive and submissive at the same time. Does she expect you to take care of her needs?
[[Lick her]] [[Get behind her]]
---
Again she growls baring her teeth as you get behind her. But she also raises her tail giving you a good view of her sex. The black lips of her pussy already swelling in that canine like manner.
[[Enter her]]
--- 
That hot pussy of her is squeezing down on you. 
You cant hold any longer and shoot your jizzm inside her.
---
&lt;div&gt;&lt;/br&gt;&lt;a0 onclick=&#39;window.gm.respawn();&#39;&gt;Black out&lt;/a&gt;&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="101" name="WolfVictory" tags="" position="100,1350" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;div id=&#39;panel&#39;&gt;&lt;/div&gt;&lt;!--description is rendered here--&gt;
&lt;div id=&#39;choice&#39;&gt;&lt;/div&gt; &lt;!--choice is rendered here--&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt;window.gm.sex.wolfOnPlayer({state:0, battleResult:&#39;victory&#39;});
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="102" name="WolffightIntermezzo" tags="" position="225,1350" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
Wolf snarls at you.
&lt;div&gt; [[Next|EncounterStartTurn]]&lt;/br&gt;&lt;/div&gt; 
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;div&gt;&lt;/br&gt;
[[Next|&lt;%=window.gm.player.location%&gt;]]&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="103" name="HuntressSubmit" tags="" position="350,1350" size="100,100">&quot;You are a worthy opponent. Lets see if you have some stamina left.&quot;
She is stradeling your prone form. Gyrating her hips around, she guides your hard pecker between her wet folds. After she grows tired on teasing you and herself, she plunges dowm, engulfing your rigid member in one smooth stroke.
Riding you like a pro, you have considerable difficulty to not just shoot your load into her.</tw-passagedata><tw-passagedata pid="104" name="HuntressVictory" tags="" position="475,1350" size="100,100">&quot;Lets sate that appetite of yours.&quot;
...
Take it all in slut. I hope you bear some big soulgems for me when I met you again.</tw-passagedata><tw-passagedata pid="105" name="Arousalchange" tags="" position="600,1350" size="100,100">&lt;!--deffered event--&gt;
You are so horny ! If you ran into a virile stud right now, you wouldnt be able to resist his advances.</tw-passagedata><tw-passagedata pid="106" name="SoulCrystalGrowth" tags="" position="725,1350" size="100,100">&lt;!--deffered event--&gt;
As you get comfortable to rest for a while, you get some warm, blissful feeling from your stomach.
...
Something is growing in you.
...
You guess a soul crystal absorbs fertile sperm slushing around in your uterus, converting it to arcane essence.
...
For sure that hungry soul crystal is busy absorbing seed and your own life preserving fluids to grow its power. Its essence concetration, you guess, is tiny/small/medium/large/massive/grand.
...
You gain the impression that the soul crystal has reached the maximum size that your body is able to sustain. Time to get it out form the oven.</tw-passagedata><tw-passagedata pid="107" name="SoulcrystalKnowledge" tags="" position="850,1350" size="100,100">&quot;Soul crystals are arcane essence contained in a crystalin sphere. They are commonly used as a source of power for crafts of the arcana.&quot;
&quot;Soul crystal, also called soul gems by some, can be sometimes found at locations with a strong etheral crossroads.&quot;
&quot;It was stated that soul gems can also form in-uteri of special aligned individuals. The process of forming the crystal seems to be bound to sexual interaction. Various studies have led to the view that the crystal feds on the live-force of the received sperm and also the hosts ovary.
&quot;A developing soul gem interferes and supresses normal pregnancys. There are different cases known where host used this effect as alternative to other birth control measures.&quot; 
Several religious directions state that this is against natures law and has to be prohibited. However, the high demand for crystals encourages unofficial experimentation.&quot;</tw-passagedata><tw-passagedata pid="108" name="ReactionTest" tags="" position="975,1350" size="100,100">&lt;p&gt;Click Start and then click somewhere on the bar to stop the green rectangle in the yellow hit-area.&lt;/p&gt;
&lt;div class=&quot;progress-bar&quot; id=&#39;clickHere&#39; style=&#39;height:1em; width: 100%;&#39;&gt;&lt;div id=&#39;bar&#39; style=&quot;position:relative; width:5%; height:100%; background-color:green;&quot;&gt;&lt;/div&gt;&lt;/div&gt;
&lt;a0 id=&#39;btStart&#39;&gt;Start&lt;/a&gt;&lt;p id=&#39;result&#39;&gt;&lt;/p&gt;
&lt;script&gt;
function onStop(value) {
document.getElementById(&#39;result&#39;).innerHTML=&#39;scored &#39;+value;
}
var _game = window.gm.startReactTest(&#39;bar&#39;,2000,onStop,null,[{a:40,b:60,color:&#39;orange&#39;},{a:90,b:100,color:&#39;yellow&#39;}]);
document.getElementById(&#39;btStart&#39;).addEventListener(&quot;click&quot;, _game.start);
document.getElementById(&#39;clickHere&#39;).addEventListener(&quot;click&quot;, _game.click);
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="109" name="ReactionTest2" tags="" position="1100,1350" size="100,100">&lt;p&gt;Click Start and then keypress A/D to fill meter.&lt;/p&gt;
&lt;div class=&quot;progress-bar&quot; id=&#39;clickHere&#39; style=&#39;height:1em; width: 100%;&#39;&gt;&lt;div id=&#39;bar&#39; style=&quot;position:relative; width:5%; height:100%; background-color:green;&quot;&gt;&lt;/div&gt;&lt;/div&gt;
&lt;a0 id=&#39;btStart&#39;&gt;Start&lt;/a&gt;&lt;p id=&#39;result&#39;&gt;&lt;/p&gt;
&lt;p&gt;&lt;output id=&quot;losgelassen&quot;&gt;&lt;output&gt;&lt;/output&gt;&lt;/p&gt;
&lt;script&gt;
function onStop(value) {
  document.getElementById(&#39;result&#39;).innerHTML=&#39;scored &#39;+value;
}
var _game = window.gm.startReactTest2(&#39;bar&#39;,100,onStop,null,[{a:40,b:60,color:&#39;orange&#39;},{a:90,b:100,color:&#39;yellow&#39;}]);
document.getElementById(&#39;btStart&#39;).addEventListener(&quot;click&quot;, _game.start);
document.querySelector(&#39;body&#39;).addEventListener(&quot;keyup&quot;, _game.click);
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="110" name="Evade" tags="" position="1225,1350" size="100,100">&lt;!-- präsentiert von kostenlose-javascripts.de (c) Copyright By N00b1000--&gt;
&lt;script type=&#39;text/javascript&#39;&gt;
//&lt;!--
//alert(&quot;Versuche den herunterfallenden Objekten so lange wie möglich auszuweichen.nSteuere die Figur mit den Pfeiltasten.nDrücke &#39;N&#39; für ein neues Spiel.&quot;)
var bilderpfad = &quot;http://www.eurehomepage.tld/bilder&quot;;
var up=0;
var down=0;
var left=0;
var right=0;
var a=0;
var b=0;
var d=0;
var z=0;
var life=1;
var c=Math.round(Math.random()*5);
var starttime = new Date();


document.write(&#39;&lt;div id=&quot;feld&quot; style=&quot;position:relative; left:0px; top:0px; background-color: black; width: 300px; height: 350px;&quot;&gt;&lt;/div&gt;&#39;);
document.write(&#39;&lt;div id=&quot;spieler&quot; style=&quot;position:absolute; left:0px; top:0px&quot;&gt;&#39;);
document.write(&#39;	&lt;img width=&quot;50&quot; id=&quot;imgplayer&quot; height=&quot;50&quot; src=&quot;&#39;+bilderpfad+&#39;/spieler0.gif&quot; alt=&quot;&quot; /&gt;&#39;);
document.write(&#39;&lt;/div&gt;&#39;);
document.write(&#39;&lt;div id=&quot;auto&quot; style=&quot;position:absolute; left:0px; top:0px&quot;&gt;&#39;);
document.write(&#39;	&lt;img width=&quot;50&quot; id=&quot;imgkristall&quot; height=&quot;50&quot; src=&quot;&#39;+bilderpfad+&#39;/kristall0.gif&quot; alt=&quot;&quot; /&gt;&#39;);
document.write(&#39;&lt;/div&gt;&#39;);


function move() {

	spieler0 = new Image();
	spieler0.src = bilderpfad+&quot;/spieler0.gif&quot;;
	spieler1 = new Image();
	spieler1.src = bilderpfad+&quot;/spieler1.gif&quot;;

	if (life==1) {
	zaehler();
	if (a&gt;5) a=5;
	document.getElementById(&#39;spieler&#39;).style.left = (a*50)+&quot;px&quot;;
	document.getElementById(&#39;spieler&#39;).style.top = &quot;300px&quot;;
	d++;
	document.getElementById(&#39;auto&#39;).style.top = (d*z/200)+&quot;px&quot;;
	document.getElementById(&#39;auto&#39;).style.left = (c*50)+&quot;px&quot;;
	hit();

	if (d*z/200&gt;300) {d=0; c=Math.round(Math.random()*5);} }
	window.setTimeout (&#39;move()&#39;, 10);
}

function keyleft(y) {
	if (y==37) { left++; a-- }
}

function keyright(y) {
	if (y==39) { right++; a++ }
}

function hit() {
	if (a==c &amp;&amp; d*z/200&gt;250 &amp;&amp; life==1) {
		wechsel(&#39;imgplayer&#39;,spieler1);
		alert(&quot;Getroffen!!!nDu hast &quot; + (new Date()-starttime)/1000 + &quot; Sekunden überlebt.&quot;);
		life=0;
	}
}

function zaehler() {
	z=z+1
}

function keycheck(e) {
	y = (e) ? e.which : window.event.keyCode;
	if ( y == 78 ) {
		restart();
	}

	keyleft(y);
	keyright(y);
	if (a&lt;0) a=0;
	if (b&lt;0) b=0;
}

function restart() {
	a=0; b=0; c=Math.round(Math.random()*5);
	d=0; z=0; life=1; starttime=new Date();
	wechsel(&#39;imgplayer&#39;,spieler0);
}

function wechsel(Bildnr,Bildobjekt) {
	document.getElementById(Bildnr).src = Bildobjekt.src;
}
document.onkeydown = keycheck;
move();
//--&gt;
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="111" name="MinesweeperAscii" tags="" position="100,1475" size="100,100">&lt;!-- präsentiert von kostenlose-javascripts.de --&gt;
&lt;script type=&#39;text/javascript&#39;&gt;
//&lt;!--
function neu(){
minen=3;
minen1=0;
verloren=false;
verdeckt=new Array();
aufgedeckt=new Array();
for (i=0;i&lt;16;i++)
{
a = 1 + 6*(Math.random());
a = Math.round(a);
if(a==6 &amp;&amp; minen!=0||a==2 &amp;&amp; minen!=0){
verdeckt[i]=&quot;mine&quot;;
aufgedeckt[i]=&quot;mine&quot;;
minen1+=1;
}
else{
verdeckt[i]=&quot;leer&quot;;
aufgedeckt[i]=&quot;leer&quot;;
}
aktuell=&quot;feld&quot;+i;
document.getElementById(aktuell).innerHTML = &quot;( )&quot;;
}
document.getElementById(&#39;smiley&#39;).innerHTML=&#39;&lt;font color=&quot;lime&quot; onclick=&quot;neu();&quot;&gt;:)&lt;/font&gt;&#39;;
}
neu();
function klick(feld){
ausgabe=&quot;&lt;b&gt;( )&lt;/b&gt;&quot;
if(verloren==false){

checken=&quot;feld&quot;+feld;
if(verdeckt[feld]==&quot;mine&quot;){
verloren=true;
document.getElementById(checken).innerHTML=&quot;(&lt;font color=&#39;red&#39;&gt;*&lt;/font&gt;)&quot;;
document.getElementById(&#39;smiley&#39;).innerHTML=&#39;&lt;font color=&quot;red&quot; onclick=&quot;neu();&quot;&gt;:(&lt;/font&gt;&#39;;
}
else{
ausgabe=0;
aufgedeckt[feld]=&quot;&quot;;
if(verdeckt[feld+1]==&quot;mine&quot; &amp;&amp; feld!=3 || verdeckt[feld-1]==&quot;mine&quot; &amp;&amp; feld!=7 ||verdeckt[feld-1]==&quot;mine&quot; &amp;&amp; feld!=11 ||verdeckt[feld-1]==&quot;mine&quot; &amp;&amp; feld!=15){
ausgabe+=1
}
if(verdeckt[feld-1]==&quot;mine&quot; &amp;&amp; feld!=0 || verdeckt[feld-1]==&quot;mine&quot; &amp;&amp; feld!=4 || verdeckt[feld-1]==&quot;mine&quot; &amp;&amp; feld!=8 ||verdeckt[feld-1]==&quot;mine&quot; &amp;&amp; feld!=12){
ausgabe+=1
}
if(verdeckt[feld-4]==&quot;mine&quot;){
ausgabe+=1
}
if(verdeckt[feld+4]==&quot;mine&quot;){
ausgabe+=1
}
if(ausgabe==0){
ausgabe=&quot;( )&quot;;
}
test=0;
for (i=0;i&lt;16;i++)
{
if(aufgedeckt[i]==&quot;&quot;){
test+=1;

}
if(test==16-minen1){
alert(&quot;Sie haben gewonnen.&quot;);
}

}
ausgaben=&quot;&lt;font color=&#39;green&#39;&gt; &quot;+ausgabe+&quot;&lt;/font&gt;&quot;;
document.getElementById(checken).innerHTML=ausgaben;
}}}
neu();
//--&gt;
&lt;/script&gt;
&lt;div style=&quot;font-size: 30px;&quot; align=&quot;center&quot;&gt;&lt;span id=&quot;smiley&quot; style=&quot;background-color:yellow;&quot;&gt;&lt;font color=&quot;lime&quot; onclick=&quot;neu();&quot;&gt;:)&lt;/font&gt;&lt;/span&gt;&lt;span style=&quot;background-color:yellow;&quot;&gt;&lt;font color=&quot;lime&quot;&gt;
&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;
&lt;p align=&quot;center&quot;&gt;&lt;span id=&quot;feld0&quot; onclick=&quot;klick(0)&quot;&gt;()&lt;/span&gt; &lt;span id=&quot;feld1&quot;  onclick=&quot;klick(1)&quot;&gt;()&lt;/span&gt; &lt;span id=&quot;feld2&quot; onclick=&quot;klick(2)&quot;&gt;()&lt;/span&gt; &lt;span id=&quot;feld3&quot; onclick=&quot;klick(3)&quot;&gt;()&lt;/span&gt; &lt;/p&gt;
&lt;p align=&quot;center&quot;&gt;&lt;span id=&quot;feld4&quot; onclick=&quot;klick(4)&quot;&gt;()&lt;/span&gt; &lt;span id=&quot;feld5&quot; onclick=&quot;klick(5)&quot;&gt;()&lt;/span&gt; &lt;span id=&quot;feld6&quot; onclick=&quot;klick(6)&quot;&gt;()&lt;/span&gt; &lt;span id=&quot;feld7&quot; onclick=&quot;klick(7)&quot;&gt;()&lt;/span&gt; &lt;/p&gt;

&lt;p align=&quot;center&quot;&gt;&lt;span id=&quot;feld8&quot; onclick=&quot;klick(8)&quot;&gt;()&lt;/span&gt; &lt;span id=&quot;feld9&quot; onclick=&quot;klick(9)&quot;&gt;()&lt;/span&gt; &lt;span id=&quot;feld10&quot; onclick=&quot;klick(10)&quot;&gt;()&lt;/span&gt; &lt;span id=&quot;feld11&quot; onclick=&quot;klick(11)&quot;&gt;()&lt;/span&gt; &lt;/p&gt;
&lt;p align=&quot;center&quot;&gt;&lt;span id=&quot;feld12&quot; onclick=&quot;klick(12)&quot;&gt;()&lt;/span&gt; &lt;span id=&quot;feld13&quot; onclick=&quot;klick(13)&quot;&gt;()&lt;/span&gt; &lt;span id=&quot;feld14&quot; onclick=&quot;klick(14)&quot;&gt;()&lt;/span&gt; &lt;span id=&quot;feld15&quot;  onclick=&quot;klick(15)&quot;&gt;()&lt;/span&gt; &lt;/p&gt;
&lt;br /&gt;</tw-passagedata><tw-passagedata pid="112" name="HangmanGame" tags="" position="225,1475" size="100,100">&lt;!--adapted from https://remybeumier.be/#creations-anchor--&gt;
&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article class=&quot;main&quot;&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;main&gt;&lt;div class=&quot;alphabet&quot; style=&quot;&quot;&gt;
    &lt;span class=&quot;&quot;&gt;a&lt;/span&gt;
    &lt;span class=&quot;&quot;&gt;b&lt;/span&gt;
    &lt;span class=&quot;&quot;&gt;c&lt;/span&gt;
    &lt;span class=&quot;&quot;&gt;d&lt;/span&gt;
    &lt;span class=&quot;&quot;&gt;e&lt;/span&gt;
    &lt;span class=&quot;&quot;&gt;f&lt;/span&gt;
    &lt;span class=&quot;&quot;&gt;g&lt;/span&gt;
    &lt;span class=&quot;&quot;&gt;h&lt;/span&gt;
    &lt;span class=&quot;&quot;&gt;i&lt;/span&gt;
    &lt;span class=&quot;&quot;&gt;j&lt;/span&gt;
    &lt;span class=&quot;&quot;&gt;k&lt;/span&gt;
    &lt;span class=&quot;&quot;&gt;l&lt;/span&gt;
    &lt;span class=&quot;&quot;&gt;m&lt;/span&gt;
    &lt;span class=&quot;&quot;&gt;n&lt;/span&gt;
    &lt;span class=&quot;&quot;&gt;o&lt;/span&gt;
    &lt;span class=&quot;&quot;&gt;p&lt;/span&gt;
    &lt;span class=&quot;&quot;&gt;q&lt;/span&gt;
    &lt;span class=&quot;&quot;&gt;r&lt;/span&gt;
    &lt;span class=&quot;&quot;&gt;s&lt;/span&gt;
    &lt;span class=&quot;&quot;&gt;t&lt;/span&gt;
    &lt;span class=&quot;&quot;&gt;u&lt;/span&gt;
    &lt;span class=&quot;&quot;&gt;v&lt;/span&gt;
    &lt;span class=&quot;&quot;&gt;w&lt;/span&gt;
    &lt;span class=&quot;&quot;&gt;x&lt;/span&gt;
    &lt;span class=&quot;&quot;&gt;y&lt;/span&gt;
    &lt;span class=&quot;green&quot;&gt;z&lt;/span&gt;
  &lt;/div&gt;
  &lt;div class=&quot;word&quot;&gt;&lt;span class=&quot;z found&quot;&gt;z&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;m&lt;/span&gt;&lt;/div&gt;
  &lt;button&gt;Restart&lt;/button&gt;&lt;/main&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt;
var words = {
  w3: [&quot;car&quot;, &quot;bus&quot;, &quot;red&quot;, &quot;fun&quot;, &quot;arm&quot;, &quot;leg&quot;, &quot;hat&quot;, &quot;dog&quot;, &quot;cat&quot;, &quot;pie&quot;, &quot;egg&quot;, &quot;cow&quot;, &quot;pen&quot;, &quot;key&quot;, &quot;mug&quot;, &quot;tea&quot;, &quot;air&quot;, &quot;ant&quot;, &quot;ape&quot;, &quot;ash&quot;, &quot;add&quot;, &quot;art&quot;, &quot;awn&quot;, &quot;bat&quot;, &quot;bee&quot;, &quot;bug&quot;, &quot;bad&quot;, &quot;bet&quot;, &quot;box&quot;, &quot;big&quot;, &quot;bag&quot;, &quot;bay&quot;, &quot;bed&quot;, &quot;beg&quot;, &quot;bet&quot;, &quot;bra&quot;, &quot;bun&quot;, &quot;cap&quot;, &quot;car&quot;, &quot;cut&quot;, &quot;cup&quot;, &quot;cry&quot;, &quot;dot&quot;, &quot;dye&quot;, &quot;die&quot;, &quot;dip&quot;, &quot;ear&quot;, &quot;ewe&quot;, &quot;egg&quot;, &quot;eel&quot;, &quot;era&quot;, &quot;fan&quot;, &quot;fry&quot;, &quot;fax&quot;, &quot;for&quot;, &quot;flu&quot;, &quot;fur&quot;, &quot;gel&quot;, &quot;gym&quot;, &quot;god&quot;, &quot;ham&quot;, &quot;hen&quot;, &quot;hot&quot;, &quot;hit&quot;, &quot;ice&quot;, &quot;ink&quot;, &quot;inn&quot;, &quot;jam&quot;, &quot;jar&quot;, &quot;joy&quot;, &quot;lap&quot;, &quot;law&quot;, &quot;let&quot;, &quot;mat&quot;, &quot;man&quot;, &quot;mix&quot;, &quot;net&quot;, &quot;nib&quot;, &quot;now&quot;, &quot;not&quot;, &quot;oak&quot;, &quot;odd&quot;, &quot;oil&quot;, &quot;ode&quot;, &quot;pan&quot;, &quot;pet&quot;, &quot;rag&quot;, &quot;red&quot;, &quot;row&quot;, &quot;set&quot;, &quot;sun&quot;, &quot;six&quot;, &quot;tea&quot;, &quot;toe&quot;, &quot;tip&quot;, &quot;urn&quot;, &quot;van&quot;, &quot;vet&quot;, &quot;web&quot;, &quot;wax&quot;, &quot;why&quot;, &quot;yam&quot;, &quot;yak&quot;, &quot;yet&quot;, &quot;zip&quot;, &quot;zoo&quot;],
  w4: [&quot;boat&quot;, &quot;ball&quot;, &quot;blue&quot;, &quot;rose&quot;, &quot;hero&quot;, &quot;city&quot;, &quot;shoe&quot;, &quot;hand&quot;, &quot;sock&quot;, &quot;head&quot;, &quot;back&quot;, &quot;foot&quot;, &quot;bear&quot;, &quot;beer&quot;, &quot;duck&quot;, &quot;lion&quot;, &quot;wine&quot;, &quot;milk&quot;, &quot;meat&quot;, &quot;rice&quot;, &quot;kiwi&quot;, &quot;peer&quot;, &quot;salt&quot;, &quot;fish&quot;, &quot;rock&quot;, &quot;bike&quot;, &quot;book&quot;, &quot;fire&quot;, &quot;tree&quot;, &quot;acid&quot;, &quot;acne&quot;, &quot;anti&quot;, &quot;away&quot;, &quot;beat&quot;, &quot;beef&quot;, &quot;blur&quot;, &quot;bomb&quot;, &quot;cage&quot;, &quot;camp&quot;, &quot;clue&quot;, &quot;cube&quot;, &quot;curl&quot;, &quot;dark&quot;, &quot;dead&quot;, &quot;dial&quot;, &quot;demo&quot;, &quot;disk&quot;, &quot;dorm&quot;, &quot;dose&quot;, &quot;dumb&quot;, &quot;dump&quot;, &quot;duty&quot;, &quot;eyes&quot;, &quot;exam&quot;, &quot;evil&quot;, &quot;epic&quot;, &quot;fate&quot;, &quot;fear&quot;, &quot;film&quot;, &quot;find&quot;, &quot;flag&quot;, &quot;flea&quot;, &quot;fund&quot;, &quot;gain&quot;, &quot;game&quot;, &quot;gift&quot;, &quot;girl&quot;, &quot;gold&quot;, &quot;golf&quot;, &quot;grow&quot;, &quot;hail&quot;, &quot;heal&quot;, &quot;help&quot;, &quot;hide&quot;, &quot;hill&quot;, &quot;hike&quot;, &quot;high&quot;, &quot;hunt&quot;, &quot;join&quot;, &quot;jute&quot;, &quot;junk&quot;, &quot;jump&quot;, &quot;kick&quot;, &quot;kite&quot;, &quot;knit&quot;, &quot;knob&quot;, &quot;kiss&quot;, &quot;lamp&quot;, &quot;land&quot;, &quot;loaf&quot;, &quot;lump&quot;, &quot;math&quot;, &quot;mend&quot;, &quot;mint&quot;, &quot;mode&quot;, &quot;mute&quot;, &quot;myth&quot;, &quot;nest&quot;, &quot;next&quot;, &quot;news&quot;, &quot;noon&quot;, &quot;nerd&quot;, &quot;oats&quot;, &quot;oven&quot;, &quot;oval&quot;, &quot;open&quot;, &quot;pest&quot;, &quot;pick&quot;, &quot;pale&quot;, &quot;palm&quot;, &quot;plot&quot;, &quot;plug&quot;, &quot;rank&quot;, &quot;read&quot;, &quot;real&quot;, &quot;rate&quot;, &quot;rain&quot;, &quot;risk&quot;, &quot;rise&quot;, &quot;seat&quot;, &quot;salt&quot;, &quot;ship&quot;, &quot;side&quot;, &quot;soil&quot;, &quot;stem&quot;, &quot;sure&quot;, &quot;swap&quot;, &quot;tree&quot;, &quot;toad&quot;, &quot;tape&quot;, &quot;tone&quot;, &quot;tyre&quot;, &quot;urge&quot;, &quot;vale&quot;, &quot;vary&quot;, &quot;vote&quot;, &quot;wage&quot;, &quot;warm&quot;, &quot;wilt&quot;, &quot;womb&quot;, &quot;yawn&quot;, &quot;yeti&quot;, &quot;zero&quot;, &quot;zoom&quot;, &quot;zinc&quot;],
  w5: [&quot;green&quot;, &quot;black&quot;, &quot;white&quot;, &quot;house&quot;, &quot;world&quot;, &quot;space&quot;, &quot;earth&quot;, &quot;night&quot;, &quot;shirt&quot;, &quot;boxer&quot;, &quot;scarf&quot;, &quot;glove&quot;, &quot;sheep&quot;, &quot;snake&quot;, &quot;horse&quot;, &quot;water&quot;, &quot;juice&quot;, &quot;pasta&quot;, &quot;apple&quot;, &quot;mango&quot;, &quot;melon&quot;, &quot;salad&quot;, &quot;candy&quot;, &quot;bread&quot;, &quot;ruler&quot;, &quot;phone&quot;, &quot;paper&quot;, &quot;plane&quot;, &quot;train&quot;, &quot;mouse&quot;, &quot;chair&quot;, &quot;align&quot;, &quot;actor&quot;, &quot;agony&quot;, &quot;clean&quot;, &quot;cloak&quot;, &quot;curve&quot;, &quot;drain&quot;, &quot;drape&quot;, &quot;dwell&quot;, &quot;eager&quot;, &quot;erect&quot;, &quot;erase&quot;, &quot;faith&quot;, &quot;fight&quot;, &quot;flirt&quot;, &quot;genie&quot;, &quot;goose&quot;, &quot;grant&quot;, &quot;graph&quot;, &quot;haiku&quot;, &quot;heavy&quot;, &quot;hello&quot;, &quot;humid&quot;, &quot;humor&quot;, &quot;ideal&quot;, &quot;index&quot;, &quot;input&quot;, &quot;judge&quot;, &quot;joker&quot;, &quot;jeans&quot;, &quot;knife&quot;, &quot;knock&quot;, &quot;labor&quot;, &quot;level&quot;, &quot;latte&quot;, &quot;leach&quot;, &quot;lyric&quot;, &quot;lodge&quot;, &quot;major&quot;, &quot;maths&quot;, &quot;music&quot;, &quot;myths&quot;, &quot;night&quot;, &quot;novel&quot;, &quot;noble&quot;, &quot;nudes&quot;, &quot;often&quot;, &quot;organ&quot;, &quot;ozone&quot;, &quot;panda&quot;, &quot;paper&quot;, &quot;peach&quot;, &quot;phase&quot;, &quot;plans&quot;, &quot;power&quot;, &quot;queen&quot;, &quot;quick&quot;, &quot;quill&quot;, &quot;ramen&quot;, &quot;rants&quot;, &quot;react&quot;, &quot;saint&quot;, &quot;sauce&quot;, &quot;skill&quot;, &quot;spike&quot;, &quot;small&quot;, &quot;story&quot;, &quot;swags&quot;, &quot;tease&quot;, &quot;towel&quot;, &quot;tower&quot;, &quot;truck&quot;, &quot;twice&quot;, &quot;veins&quot;, &quot;vital&quot;, &quot;verge&quot;, &quot;watch&quot;, &quot;water&quot;, &quot;wheel&quot;, &quot;widow&quot;, &quot;xylem&quot;, &quot;yatch&quot;, &quot;yours&quot;, &quot;zebra&quot;],
  w6: [&quot;yellow&quot;, &quot;pencil&quot;, &quot;finger&quot;, &quot;street&quot;, &quot;jacket&quot;, &quot;rabbit&quot;, &quot;monkey&quot;, &quot;cookie&quot;, &quot;banana&quot;, &quot;potato&quot;, &quot;orange&quot;, &quot;carrot&quot;, &quot;tomato&quot;, &quot;cheese&quot;, &quot;pepper&quot;, &quot;letter&quot;, &quot;cisors&quot;, &quot;wallet&quot;, &quot;bottle&quot;, &quot;coffee&quot;, &quot;laptop&quot;, &quot;screen&quot;, &quot;garden&quot;, &quot;toilet&quot;, &quot;behalf&quot;, &quot;behind&quot;, &quot;belief&quot;, &quot;belong&quot;, &quot;berlin&quot;, &quot;better&quot;, &quot;beyond&quot;, &quot;bishop&quot;, &quot;border&quot;, &quot;bottle&quot;, &quot;bottom&quot;, &quot;bought&quot;, &quot;branch&quot;, &quot;breath&quot;, &quot;bridge&quot;, &quot;bright&quot;, &quot;broken&quot;, &quot;budget&quot;, &quot;burden&quot;, &quot;bureau&quot;, &quot;button&quot;, &quot;camera&quot;, &quot;cancer&quot;, &quot;cannot&quot;, &quot;carbon&quot;, &quot;career&quot;, &quot;castle&quot;, &quot;casual&quot;, &quot;caught&quot;, &quot;center&quot;, &quot;center&quot;, &quot;chance&quot;, &quot;change&quot;, &quot;charge&quot;, &quot;choice&quot;, &quot;choose&quot;, &quot;chosen&quot;, &quot;church&quot;, &quot;circle&quot;, &quot;client&quot;, &quot;closed&quot;, &quot;closer&quot;, &quot;coffee&quot;, &quot;column&quot;, &quot;combat&quot;, &quot;coming&quot;, &quot;common&quot;, &quot;comply&quot;, &quot;copper&quot;, &quot;corner&quot;, &quot;costly&quot;, &quot;county&quot;, &quot;couple&quot;, &quot;course&quot;, &quot;covers&quot;, &quot;create&quot;, &quot;credit&quot;, &quot;crisis&quot;, &quot;custom&quot;, &quot;damage&quot;, &quot;danger&quot;, &quot;dealer&quot;, &quot;debate&quot;, &quot;decade&quot;, &quot;decide&quot;, &quot;defeat&quot;, &quot;defend&quot;, &quot;define&quot;, &quot;degree&quot;, &quot;demand&quot;, &quot;depend&quot;, &quot;deputy&quot;, &quot;desert&quot;, &quot;design&quot;, &quot;desire&quot;, &quot;detail&quot;, &quot;detect&quot;, &quot;device&quot;, &quot;differ&quot;, &quot;dinner&quot;, &quot;direct&quot;, &quot;doctor&quot;, &quot;dollar&quot;, &quot;domain&quot;, &quot;double&quot;, &quot;driven&quot;, &quot;driver&quot;, &quot;during&quot;, &quot;easily&quot;, &quot;eating&quot;, &quot;editor&quot;, &quot;effect&quot;, &quot;effort&quot;, &quot;eighth&quot;, &quot;either&quot;, &quot;eleven&quot;, &quot;emerge&quot;, &quot;empire&quot;, &quot;employ&quot;, &quot;enable&quot;, &quot;ending&quot;, &quot;energy&quot;, &quot;engage&quot;, &quot;engine&quot;, &quot;enough&quot;, &quot;ensure&quot;, &quot;entire&quot;, &quot;entity&quot;, &quot;equity&quot;, &quot;escape&quot;, &quot;estate&quot;, &quot;ethnic&quot;, &quot;exceed&quot;, &quot;except&quot;, &quot;excess&quot;, &quot;expand&quot;, &quot;expect&quot;, &quot;expert&quot;, &quot;export&quot;, &quot;extend&quot;, &quot;extent&quot;, &quot;fabric&quot;, &quot;facing&quot;, &quot;factor&quot;, &quot;failed&quot;, &quot;fairly&quot;, &quot;fallen&quot;, &quot;family&quot;, &quot;famous&quot;, &quot;father&quot;, &quot;fellow&quot;, &quot;female&quot;, &quot;figure&quot;, &quot;filing&quot;, &quot;finger&quot;, &quot;finish&quot;, &quot;fiscal&quot;, &quot;flight&quot;, &quot;flying&quot;, &quot;follow&quot;, &quot;forced&quot;, &quot;forest&quot;, &quot;forget&quot;, &quot;formal&quot;, &quot;format&quot;, &quot;former&quot;, &quot;foster&quot;, &quot;fought&quot;, &quot;fourth&quot;, &quot;French&quot;, &quot;friend&quot;, &quot;future&quot;, &quot;garden&quot;, &quot;gather&quot;, &quot;gender&quot;, &quot;german&quot;, &quot;global&quot;, &quot;golden&quot;, &quot;ground&quot;, &quot;growth&quot;, &quot;guilty&quot;, &quot;handed&quot;, &quot;handle&quot;, &quot;happen&quot;, &quot;hardly&quot;, &quot;headed&quot;, &quot;health&quot;, &quot;height&quot;, &quot;hidden&quot;, &quot;holder&quot;, &quot;honest&quot;, &quot;impact&quot;, &quot;import&quot;, &quot;income&quot;, &quot;indeed&quot;, &quot;injury&quot;, &quot;inside&quot;, &quot;intend&quot;, &quot;intent&quot;, &quot;invest&quot;, &quot;island&quot;, &quot;itself&quot;, &quot;jersey&quot;, &quot;joseph&quot;, &quot;junior&quot;, &quot;killed&quot;, &quot;labour&quot;, &quot;latest&quot;, &quot;latter&quot;, &quot;launch&quot;, &quot;lawyer&quot;, &quot;leader&quot;, &quot;league&quot;, &quot;leaves&quot;, &quot;legacy&quot;, &quot;length&quot;, &quot;lesson&quot;, &quot;letter&quot;, &quot;lights&quot;, &quot;likely&quot;, &quot;linked&quot;, &quot;liquid&quot;, &quot;listen&quot;, &quot;little&quot;, &quot;living&quot;, &quot;losing&quot;, &quot;lucent&quot;, &quot;luxury&quot;, &quot;mainly&quot;, &quot;making&quot;, &quot;manage&quot;, &quot;manner&quot;, &quot;manual&quot;, &quot;margin&quot;, &quot;marine&quot;, &quot;marked&quot;, &quot;market&quot;, &quot;martin&quot;, &quot;master&quot;, &quot;matter&quot;, &quot;mature&quot;, &quot;medium&quot;, &quot;member&quot;, &quot;memory&quot;, &quot;mental&quot;, &quot;merely&quot;, &quot;merger&quot;, &quot;method&quot;, &quot;middle&quot;, &quot;miller&quot;, &quot;mining&quot;, &quot;minute&quot;, &quot;mirror&quot;, &quot;mobile&quot;, &quot;modern&quot;, &quot;modest&quot;, &quot;module&quot;, &quot;moment&quot;, &quot;morris&quot;, &quot;mostly&quot;, &quot;mother&quot;, &quot;motion&quot;, &quot;moving&quot;, &quot;murder&quot;, &quot;museum&quot;, &quot;mutual&quot;, &quot;myself&quot;, &quot;narrow&quot;, &quot;nation&quot;, &quot;native&quot;, &quot;nature&quot;, &quot;nearby&quot;, &quot;nearly&quot;, &quot;nights&quot;, &quot;nobody&quot;, &quot;normal&quot;, &quot;notice&quot;, &quot;notion&quot;, &quot;number&quot;, &quot;object&quot;, &quot;obtain&quot;, &quot;office&quot;, &quot;offset&quot;, &quot;online&quot;, &quot;option&quot;, &quot;orange&quot;, &quot;origin&quot;, &quot;output&quot;, &quot;oxford&quot;, &quot;packed&quot;, &quot;palace&quot;, &quot;parent&quot;, &quot;partly&quot;, &quot;patent&quot;, &quot;people&quot;, &quot;period&quot;, &quot;permit&quot;, &quot;person&quot;, &quot;phrase&quot;, &quot;picked&quot;, &quot;planet&quot;, &quot;player&quot;, &quot;please&quot;, &quot;plenty&quot;, &quot;pocket&quot;, &quot;police&quot;, &quot;policy&quot;, &quot;prefer&quot;, &quot;pretty&quot;, &quot;prince&quot;, &quot;prison&quot;, &quot;profit&quot;, &quot;proper&quot;, &quot;proven&quot;, &quot;public&quot;, &quot;pursue&quot;, &quot;raised&quot;, &quot;random&quot;, &quot;rarely&quot;, &quot;rather&quot;, &quot;rating&quot;, &quot;reader&quot;, &quot;really&quot;, &quot;reason&quot;, &quot;recall&quot;, &quot;recent&quot;, &quot;record&quot;, &quot;reduce&quot;, &quot;reform&quot;, &quot;regard&quot;, &quot;regime&quot;, &quot;region&quot;, &quot;relate&quot;, &quot;relief&quot;, &quot;remain&quot;, &quot;remote&quot;, &quot;remove&quot;, &quot;repair&quot;, &quot;repeat&quot;, &quot;replay&quot;, &quot;report&quot;, &quot;rescue&quot;, &quot;resort&quot;, &quot;result&quot;, &quot;retail&quot;, &quot;retain&quot;, &quot;return&quot;, &quot;reveal&quot;, &quot;review&quot;, &quot;reward&quot;, &quot;riding&quot;, &quot;rising&quot;, &quot;robust&quot;, &quot;ruling&quot;, &quot;safety&quot;, &quot;salary&quot;, &quot;sample&quot;, &quot;saving&quot;, &quot;saying&quot;, &quot;scheme&quot;, &quot;school&quot;, &quot;screen&quot;, &quot;search&quot;, &quot;season&quot;, &quot;second&quot;, &quot;secret&quot;, &quot;sector&quot;, &quot;secure&quot;, &quot;seeing&quot;, &quot;select&quot;, &quot;seller&quot;, &quot;senior&quot;, &quot;series&quot;, &quot;server&quot;, &quot;settle&quot;, &quot;severe&quot;, &quot;sexual&quot;, &quot;should&quot;, &quot;signal&quot;, &quot;signed&quot;, &quot;silent&quot;, &quot;silver&quot;, &quot;simple&quot;, &quot;simply&quot;, &quot;single&quot;, &quot;sister&quot;, &quot;slight&quot;, &quot;smooth&quot;, &quot;social&quot;, &quot;solely&quot;, &quot;sought&quot;, &quot;source&quot;, &quot;soviet&quot;, &quot;speech&quot;, &quot;spirit&quot;, &quot;spoken&quot;, &quot;spread&quot;, &quot;spring&quot;, &quot;square&quot;, &quot;stable&quot;, &quot;status&quot;, &quot;steady&quot;, &quot;stolen&quot;, &quot;strain&quot;, &quot;stream&quot;, &quot;street&quot;, &quot;stress&quot;, &quot;strict&quot;, &quot;strike&quot;, &quot;string&quot;, &quot;strong&quot;, &quot;struck&quot;, &quot;studio&quot;, &quot;submit&quot;, &quot;sudden&quot;, &quot;suffer&quot;, &quot;summer&quot;, &quot;summit&quot;, &quot;supply&quot;, &quot;surely&quot;, &quot;survey&quot;, &quot;switch&quot;, &quot;symbol&quot;, &quot;system&quot;, &quot;taking&quot;, &quot;talent&quot;, &quot;target&quot;, &quot;taught&quot;, &quot;tenant&quot;, &quot;tender&quot;, &quot;tennis&quot;, &quot;thanks&quot;, &quot;theory&quot;, &quot;thirty&quot;, &quot;though&quot;, &quot;threat&quot;, &quot;thrown&quot;, &quot;ticket&quot;, &quot;timely&quot;, &quot;timing&quot;, &quot;tissue&quot;, &quot;toward&quot;, &quot;travel&quot;, &quot;treaty&quot;, &quot;trying&quot;, &quot;twelve&quot;, &quot;twenty&quot;, &quot;unable&quot;, &quot;unique&quot;, &quot;united&quot;, &quot;unless&quot;, &quot;unlike&quot;, &quot;update&quot;, &quot;useful&quot;, &quot;valley&quot;, &quot;varied&quot;, &quot;vendor&quot;, &quot;versus&quot;, &quot;victim&quot;, &quot;vision&quot;, &quot;visual&quot;, &quot;volume&quot;, &quot;walker&quot;, &quot;wealth&quot;, &quot;weekly&quot;, &quot;weight&quot;, &quot;wholly&quot;, &quot;window&quot;, &quot;winner&quot;, &quot;winter&quot;, &quot;within&quot;, &quot;wonder&quot;, &quot;worker&quot;, &quot;wright&quot;, &quot;writer&quot;, &quot;yellow&quot;],
  w7: [&quot;morning&quot;, &quot;sweater&quot;, &quot;coconut&quot;, &quot;ketchup&quot;, &quot;mostard&quot;, &quot;chicken&quot;, &quot;country&quot;, &quot;kitchen&quot;, &quot;ability&quot;, &quot;absence&quot;, &quot;academy&quot;, &quot;account&quot;, &quot;accused&quot;, &quot;achieve&quot;, &quot;acquire&quot;, &quot;address&quot;, &quot;advance&quot;, &quot;adverse&quot;, &quot;advised&quot;, &quot;adviser&quot;, &quot;against&quot;, &quot;airline&quot;, &quot;airport&quot;, &quot;alcohol&quot;, &quot;alleged&quot;, &quot;already&quot;, &quot;analyst&quot;, &quot;ancient&quot;, &quot;another&quot;, &quot;anxiety&quot;, &quot;anxious&quot;, &quot;anybody&quot;, &quot;applied&quot;, &quot;arrange&quot;, &quot;arrival&quot;, &quot;article&quot;, &quot;assault&quot;, &quot;assumed&quot;, &quot;assured&quot;, &quot;attempt&quot;, &quot;attract&quot;, &quot;auction&quot;, &quot;average&quot;, &quot;backing&quot;, &quot;balance&quot;, &quot;banking&quot;, &quot;barrier&quot;, &quot;battery&quot;, &quot;bearing&quot;, &quot;beating&quot;, &quot;because&quot;, &quot;bedroom&quot;, &quot;believe&quot;, &quot;beneath&quot;, &quot;benefit&quot;, &quot;besides&quot;, &quot;between&quot;, &quot;billion&quot;, &quot;binding&quot;, &quot;brother&quot;, &quot;brought&quot;, &quot;burning&quot;, &quot;cabinet&quot;, &quot;caliber&quot;, &quot;calling&quot;, &quot;capable&quot;, &quot;capital&quot;, &quot;captain&quot;, &quot;caption&quot;, &quot;capture&quot;, &quot;careful&quot;, &quot;carrier&quot;, &quot;caution&quot;, &quot;ceiling&quot;, &quot;central&quot;, &quot;centric&quot;, &quot;century&quot;, &quot;certain&quot;, &quot;chamber&quot;, &quot;channel&quot;, &quot;chapter&quot;, &quot;charity&quot;, &quot;charlie&quot;, &quot;charter&quot;, &quot;checked&quot;, &quot;chicken&quot;, &quot;chronic&quot;, &quot;circuit&quot;, &quot;classes&quot;, &quot;classic&quot;, &quot;climate&quot;, &quot;closing&quot;, &quot;closure&quot;, &quot;clothes&quot;, &quot;collect&quot;, &quot;college&quot;, &quot;combine&quot;, &quot;comfort&quot;, &quot;command&quot;, &quot;comment&quot;, &quot;compact&quot;, &quot;company&quot;, &quot;compare&quot;, &quot;compete&quot;, &quot;complex&quot;, &quot;concept&quot;, &quot;concern&quot;, &quot;concert&quot;, &quot;conduct&quot;, &quot;confirm&quot;, &quot;connect&quot;, &quot;consent&quot;, &quot;consist&quot;, &quot;contact&quot;, &quot;contain&quot;, &quot;content&quot;, &quot;contest&quot;, &quot;context&quot;, &quot;control&quot;, &quot;convert&quot;, &quot;correct&quot;, &quot;council&quot;, &quot;counsel&quot;, &quot;counter&quot;, &quot;country&quot;, &quot;crucial&quot;, &quot;crystal&quot;, &quot;culture&quot;, &quot;current&quot;, &quot;cutting&quot;, &quot;dealing&quot;, &quot;decided&quot;, &quot;decline&quot;, &quot;default&quot;, &quot;defence&quot;, &quot;deficit&quot;, &quot;deliver&quot;, &quot;density&quot;, &quot;deposit&quot;, &quot;desktop&quot;, &quot;despite&quot;, &quot;destroy&quot;, &quot;develop&quot;, &quot;devoted&quot;, &quot;diamond&quot;, &quot;digital&quot;, &quot;discuss&quot;, &quot;disease&quot;, &quot;display&quot;, &quot;dispute&quot;, &quot;distant&quot;, &quot;diverse&quot;, &quot;divided&quot;, &quot;drawing&quot;, &quot;driving&quot;, &quot;dynamic&quot;, &quot;eastern&quot;, &quot;economy&quot;, &quot;edition&quot;, &quot;elderly&quot;, &quot;element&quot;, &quot;engaged&quot;, &quot;enhance&quot;, &quot;essence&quot;, &quot;evening&quot;, &quot;evident&quot;, &quot;exactly&quot;, &quot;examine&quot;, &quot;example&quot;, &quot;excited&quot;, &quot;exclude&quot;, &quot;exhibit&quot;, &quot;expense&quot;, &quot;explain&quot;, &quot;explore&quot;, &quot;express&quot;, &quot;extreme&quot;, &quot;factory&quot;, &quot;faculty&quot;, &quot;failing&quot;, &quot;failure&quot;, &quot;fashion&quot;, &quot;feature&quot;, &quot;federal&quot;, &quot;feeling&quot;, &quot;fiction&quot;, &quot;fifteen&quot;, &quot;filling&quot;, &quot;finance&quot;, &quot;finding&quot;, &quot;fishing&quot;, &quot;fitness&quot;, &quot;foreign&quot;, &quot;forever&quot;, &quot;formula&quot;, &quot;fortune&quot;, &quot;forward&quot;, &quot;founder&quot;, &quot;freedom&quot;, &quot;further&quot;, &quot;gallery&quot;, &quot;gateway&quot;, &quot;general&quot;, &quot;genetic&quot;, &quot;genuine&quot;, &quot;gigabit&quot;, &quot;greater&quot;, &quot;hanging&quot;, &quot;heading&quot;, &quot;healthy&quot;, &quot;hearing&quot;, &quot;heavily&quot;, &quot;helpful&quot;, &quot;helping&quot;, &quot;herself&quot;, &quot;highway&quot;, &quot;himself&quot;, &quot;history&quot;, &quot;holding&quot;, &quot;holiday&quot;, &quot;housing&quot;, &quot;however&quot;, &quot;hundred&quot;, &quot;husband&quot;, &quot;illegal&quot;, &quot;illness&quot;, &quot;imagine&quot;, &quot;imaging&quot;, &quot;improve&quot;, &quot;include&quot;, &quot;initial&quot;, &quot;inquiry&quot;, &quot;insight&quot;, &quot;install&quot;, &quot;instant&quot;, &quot;instead&quot;, &quot;intense&quot;, &quot;interim&quot;, &quot;involve&quot;, &quot;jointly&quot;, &quot;journal&quot;, &quot;journey&quot;, &quot;justice&quot;, &quot;justify&quot;, &quot;keeping&quot;, &quot;killing&quot;, &quot;kingdom&quot;, &quot;kitchen&quot;, &quot;knowing&quot;, &quot;landing&quot;, &quot;largely&quot;, &quot;lasting&quot;, &quot;leading&quot;, &quot;learned&quot;, &quot;leisure&quot;, &quot;liberal&quot;, &quot;liberty&quot;, &quot;library&quot;, &quot;license&quot;, &quot;limited&quot;, &quot;listing&quot;, &quot;logical&quot;, &quot;loyalty&quot;, &quot;machine&quot;, &quot;manager&quot;, &quot;married&quot;, &quot;massive&quot;, &quot;maximum&quot;, &quot;meaning&quot;, &quot;measure&quot;, &quot;medical&quot;, &quot;meeting&quot;, &quot;mention&quot;, &quot;message&quot;, &quot;million&quot;, &quot;mineral&quot;, &quot;minimal&quot;, &quot;minimum&quot;, &quot;missing&quot;, &quot;mission&quot;, &quot;mistake&quot;, &quot;mixture&quot;, &quot;monitor&quot;, &quot;monthly&quot;, &quot;morning&quot;, &quot;musical&quot;, &quot;mystery&quot;, &quot;natural&quot;, &quot;neither&quot;, &quot;nervous&quot;, &quot;network&quot;, &quot;neutral&quot;, &quot;notable&quot;, &quot;nothing&quot;, &quot;nowhere&quot;, &quot;nuclear&quot;, &quot;nursing&quot;, &quot;obvious&quot;, &quot;offense&quot;, &quot;officer&quot;, &quot;ongoing&quot;, &quot;opening&quot;, &quot;operate&quot;, &quot;opinion&quot;, &quot;optical&quot;, &quot;organic&quot;, &quot;outcome&quot;, &quot;outdoor&quot;, &quot;outlook&quot;, &quot;outside&quot;, &quot;overall&quot;, &quot;pacific&quot;, &quot;package&quot;, &quot;painted&quot;, &quot;parking&quot;, &quot;partial&quot;, &quot;partner&quot;, &quot;passage&quot;, &quot;passing&quot;, &quot;passion&quot;, &quot;passive&quot;, &quot;patient&quot;, &quot;pattern&quot;, &quot;payable&quot;, &quot;payment&quot;, &quot;penalty&quot;, &quot;pending&quot;, &quot;pension&quot;, &quot;percent&quot;, &quot;perfect&quot;, &quot;perform&quot;, &quot;perhaps&quot;, &quot;phoenix&quot;, &quot;picking&quot;, &quot;picture&quot;, &quot;pioneer&quot;, &quot;plastic&quot;, &quot;pointed&quot;, &quot;popular&quot;, &quot;portion&quot;, &quot;poverty&quot;, &quot;precise&quot;, &quot;predict&quot;, &quot;premier&quot;, &quot;premium&quot;, &quot;prepare&quot;, &quot;present&quot;, &quot;prevent&quot;, &quot;primary&quot;, &quot;printer&quot;, &quot;privacy&quot;, &quot;private&quot;, &quot;problem&quot;, &quot;proceed&quot;, &quot;process&quot;, &quot;produce&quot;, &quot;product&quot;, &quot;profile&quot;, &quot;program&quot;, &quot;project&quot;, &quot;promise&quot;, &quot;promote&quot;, &quot;protect&quot;, &quot;protein&quot;, &quot;protest&quot;, &quot;provide&quot;, &quot;publish&quot;, &quot;purpose&quot;, &quot;pushing&quot;, &quot;qualify&quot;, &quot;quality&quot;, &quot;quarter&quot;, &quot;radical&quot;, &quot;railway&quot;, &quot;readily&quot;, &quot;Reading&quot;, &quot;reality&quot;, &quot;realize&quot;, &quot;receipt&quot;, &quot;receive&quot;, &quot;recover&quot;, &quot;reflect&quot;, &quot;regular&quot;, &quot;related&quot;, &quot;release&quot;, &quot;remains&quot;, &quot;removal&quot;, &quot;removed&quot;, &quot;replace&quot;, &quot;request&quot;, &quot;require&quot;, &quot;reserve&quot;, &quot;resolve&quot;, &quot;respect&quot;, &quot;respond&quot;, &quot;restore&quot;, &quot;retired&quot;, &quot;revenue&quot;, &quot;reverse&quot;, &quot;rollout&quot;, &quot;routine&quot;, &quot;running&quot;, &quot;satisfy&quot;, &quot;science&quot;, &quot;section&quot;, &quot;segment&quot;, &quot;serious&quot;, &quot;service&quot;, &quot;serving&quot;, &quot;session&quot;, &quot;setting&quot;, &quot;seventh&quot;, &quot;several&quot;, &quot;shortly&quot;, &quot;showing&quot;, &quot;silence&quot;, &quot;silicon&quot;, &quot;similar&quot;, &quot;sitting&quot;, &quot;sixteen&quot;, &quot;skilled&quot;, &quot;smoking&quot;, &quot;society&quot;, &quot;somehow&quot;, &quot;someone&quot;, &quot;speaker&quot;, &quot;special&quot;, &quot;species&quot;, &quot;sponsor&quot;, &quot;station&quot;, &quot;storage&quot;, &quot;strange&quot;, &quot;stretch&quot;, &quot;student&quot;, &quot;studied&quot;, &quot;subject&quot;, &quot;succeed&quot;, &quot;success&quot;, &quot;suggest&quot;, &quot;summary&quot;, &quot;support&quot;, &quot;suppose&quot;, &quot;supreme&quot;, &quot;surface&quot;, &quot;surgery&quot;, &quot;surplus&quot;, &quot;survive&quot;, &quot;suspect&quot;, &quot;sustain&quot;, &quot;teacher&quot;, &quot;telecom&quot;, &quot;telling&quot;, &quot;tension&quot;, &quot;theatre&quot;, &quot;therapy&quot;, &quot;thereby&quot;, &quot;thought&quot;, &quot;through&quot;, &quot;tonight&quot;, &quot;totally&quot;, &quot;touched&quot;, &quot;towards&quot;, &quot;traffic&quot;, &quot;trouble&quot;, &quot;turning&quot;, &quot;typical&quot;, &quot;uniform&quot;, &quot;unknown&quot;, &quot;unusual&quot;, &quot;upgrade&quot;, &quot;upscale&quot;, &quot;utility&quot;, &quot;variety&quot;, &quot;various&quot;, &quot;vehicle&quot;, &quot;venture&quot;, &quot;version&quot;, &quot;veteran&quot;, &quot;victory&quot;, &quot;viewing&quot;, &quot;village&quot;, &quot;violent&quot;, &quot;virtual&quot;, &quot;visible&quot;, &quot;waiting&quot;, &quot;walking&quot;, &quot;wanting&quot;, &quot;warning&quot;, &quot;warrant&quot;, &quot;wearing&quot;, &quot;weather&quot;, &quot;webcast&quot;, &quot;website&quot;, &quot;wedding&quot;, &quot;weekend&quot;, &quot;welcome&quot;, &quot;welfare&quot;, &quot;western&quot;, &quot;whereas&quot;, &quot;whereby&quot;, &quot;whether&quot;, &quot;willing&quot;, &quot;winning&quot;, &quot;without&quot;, &quot;witness&quot;, &quot;working&quot;, &quot;writing&quot;, &quot;written&quot;],
  w8: [&quot;elephant&quot;, &quot;zucchini&quot;, &quot;eggplant&quot;, &quot;computer&quot;, &quot;keyboard&quot;, &quot;bathroom&quot;, &quot;basement&quot;, &quot;breaking&quot;, &quot;breeding&quot;, &quot;building&quot;, &quot;bulletin&quot;, &quot;business&quot;, &quot;calendar&quot;, &quot;campaign&quot;, &quot;capacity&quot;, &quot;casualty&quot;, &quot;catching&quot;, &quot;category&quot;, &quot;Catholic&quot;, &quot;cautious&quot;, &quot;cellular&quot;, &quot;ceremony&quot;, &quot;chairman&quot;, &quot;champion&quot;, &quot;chemical&quot;, &quot;children&quot;, &quot;circular&quot;, &quot;civilian&quot;, &quot;clearing&quot;, &quot;clinical&quot;, &quot;clothing&quot;, &quot;collapse&quot;, &quot;colonial&quot;, &quot;colorful&quot;, &quot;commence&quot;, &quot;commerce&quot;, &quot;complain&quot;, &quot;complete&quot;, &quot;composed&quot;, &quot;compound&quot;, &quot;comprise&quot;, &quot;computer&quot;, &quot;conclude&quot;, &quot;concrete&quot;, &quot;conflict&quot;, &quot;confused&quot;, &quot;congress&quot;, &quot;consider&quot;, &quot;constant&quot;, &quot;consumer&quot;, &quot;continue&quot;, &quot;contract&quot;, &quot;contrary&quot;, &quot;contrast&quot;, &quot;convince&quot;, &quot;corridor&quot;, &quot;coverage&quot;, &quot;covering&quot;, &quot;creation&quot;, &quot;creative&quot;, &quot;criminal&quot;, &quot;critical&quot;, &quot;crossing&quot;, &quot;cultural&quot;, &quot;currency&quot;, &quot;customer&quot;, &quot;database&quot;, &quot;daughter&quot;, &quot;daylight&quot;, &quot;deadline&quot;, &quot;deciding&quot;, &quot;decision&quot;, &quot;decrease&quot;, &quot;deferred&quot;, &quot;definite&quot;, &quot;delicate&quot;, &quot;delivery&quot;, &quot;describe&quot;, &quot;designer&quot;, &quot;detailed&quot;, &quot;diabetes&quot;, &quot;dialogue&quot;, &quot;diameter&quot;, &quot;directly&quot;, &quot;director&quot;, &quot;disabled&quot;, &quot;disaster&quot;, &quot;disclose&quot;, &quot;discount&quot;, &quot;discover&quot;, &quot;disorder&quot;, &quot;disposal&quot;, &quot;distance&quot;, &quot;distinct&quot;, &quot;district&quot;, &quot;dividend&quot;, &quot;division&quot;, &quot;doctrine&quot;, &quot;document&quot;, &quot;domestic&quot;, &quot;dominant&quot;, &quot;dominate&quot;, &quot;doubtful&quot;, &quot;dramatic&quot;, &quot;dressing&quot;, &quot;dropping&quot;, &quot;duration&quot;, &quot;dynamics&quot;, &quot;earnings&quot;, &quot;economic&quot;, &quot;educated&quot;, &quot;efficacy&quot;, &quot;eighteen&quot;, &quot;election&quot;, &quot;electric&quot;, &quot;eligible&quot;, &quot;emerging&quot;, &quot;emphasis&quot;, &quot;employee&quot;, &quot;endeavor&quot;, &quot;engaging&quot;, &quot;engineer&quot;, &quot;enormous&quot;, &quot;entirely&quot;, &quot;entrance&quot;, &quot;envelope&quot;, &quot;equality&quot;, &quot;equation&quot;, &quot;estimate&quot;, &quot;evaluate&quot;, &quot;eventual&quot;, &quot;everyday&quot;, &quot;everyone&quot;, &quot;evidence&quot;, &quot;exchange&quot;, &quot;exciting&quot;, &quot;exercise&quot;, &quot;explicit&quot;, &quot;exposure&quot;, &quot;extended&quot;, &quot;external&quot;, &quot;facility&quot;, &quot;familiar&quot;, &quot;featured&quot;, &quot;feedback&quot;, &quot;festival&quot;, &quot;finished&quot;, &quot;firewall&quot;, &quot;flagship&quot;, &quot;flexible&quot;, &quot;floating&quot;, &quot;football&quot;, &quot;foothill&quot;, &quot;forecast&quot;, &quot;foremost&quot;, &quot;formerly&quot;, &quot;fourteen&quot;, &quot;fraction&quot;, &quot;franklin&quot;, &quot;frequent&quot;, &quot;friendly&quot;, &quot;frontier&quot;, &quot;function&quot;, &quot;generate&quot;, &quot;generous&quot;, &quot;genomics&quot;, &quot;goodwill&quot;, &quot;governor&quot;, &quot;graduate&quot;, &quot;graphics&quot;, &quot;grateful&quot;, &quot;guardian&quot;, &quot;guidance&quot;, &quot;handling&quot;, &quot;hardware&quot;, &quot;heritage&quot;, &quot;highland&quot;, &quot;historic&quot;, &quot;homeless&quot;, &quot;homepage&quot;, &quot;hospital&quot;, &quot;humanity&quot;, &quot;identify&quot;, &quot;identity&quot;, &quot;ideology&quot;, &quot;imperial&quot;, &quot;incident&quot;, &quot;included&quot;, &quot;increase&quot;, &quot;indicate&quot;, &quot;indirect&quot;, &quot;industry&quot;, &quot;informal&quot;, &quot;informed&quot;, &quot;inherent&quot;, &quot;initiate&quot;, &quot;innocent&quot;, &quot;inspired&quot;, &quot;instance&quot;, &quot;integral&quot;, &quot;intended&quot;, &quot;interact&quot;, &quot;interest&quot;, &quot;interior&quot;, &quot;internal&quot;, &quot;interval&quot;, &quot;intimate&quot;, &quot;intranet&quot;, &quot;invasion&quot;, &quot;involved&quot;, &quot;isolated&quot;, &quot;judgment&quot;, &quot;judicial&quot;, &quot;junction&quot;, &quot;keyboard&quot;, &quot;landlord&quot;, &quot;language&quot;, &quot;laughter&quot;, &quot;learning&quot;, &quot;leverage&quot;, &quot;lifetime&quot;, &quot;lighting&quot;, &quot;likewise&quot;, &quot;limiting&quot;, &quot;literary&quot;, &quot;location&quot;, &quot;magazine&quot;, &quot;magnetic&quot;, &quot;maintain&quot;, &quot;majority&quot;, &quot;marginal&quot;, &quot;marriage&quot;, &quot;material&quot;, &quot;maturity&quot;, &quot;maximize&quot;, &quot;meantime&quot;, &quot;measured&quot;, &quot;medicine&quot;, &quot;medieval&quot;, &quot;memorial&quot;, &quot;merchant&quot;, &quot;midnight&quot;, &quot;military&quot;, &quot;minimize&quot;, &quot;minister&quot;, &quot;ministry&quot;, &quot;minority&quot;, &quot;mobility&quot;, &quot;modeling&quot;, &quot;moderate&quot;, &quot;momentum&quot;, &quot;monetary&quot;, &quot;moreover&quot;, &quot;mortgage&quot;, &quot;mountain&quot;, &quot;mounting&quot;, &quot;movement&quot;, &quot;multiple&quot;, &quot;national&quot;, &quot;negative&quot;, &quot;nineteen&quot;, &quot;northern&quot;, &quot;notebook&quot;, &quot;numerous&quot;, &quot;observer&quot;, &quot;occasion&quot;, &quot;offering&quot;, &quot;official&quot;, &quot;offshore&quot;, &quot;operator&quot;, &quot;opponent&quot;, &quot;opposite&quot;, &quot;optimism&quot;, &quot;optional&quot;, &quot;ordinary&quot;, &quot;organize&quot;, &quot;original&quot;, &quot;overcome&quot;, &quot;overhead&quot;, &quot;overseas&quot;, &quot;overview&quot;, &quot;painting&quot;, &quot;parallel&quot;, &quot;parental&quot;, &quot;patented&quot;, &quot;patience&quot;, &quot;peaceful&quot;, &quot;periodic&quot;, &quot;personal&quot;, &quot;persuade&quot;, &quot;petition&quot;, &quot;physical&quot;, &quot;pipeline&quot;, &quot;platform&quot;, &quot;pleasant&quot;, &quot;pleasure&quot;, &quot;politics&quot;, &quot;portable&quot;, &quot;portrait&quot;, &quot;position&quot;, &quot;positive&quot;, &quot;possible&quot;, &quot;powerful&quot;, &quot;practice&quot;, &quot;precious&quot;, &quot;pregnant&quot;, &quot;presence&quot;, &quot;preserve&quot;, &quot;pressing&quot;, &quot;pressure&quot;, &quot;previous&quot;, &quot;princess&quot;, &quot;printing&quot;, &quot;priority&quot;, &quot;probable&quot;, &quot;probably&quot;, &quot;producer&quot;, &quot;profound&quot;, &quot;progress&quot;, &quot;property&quot;, &quot;proposal&quot;, &quot;prospect&quot;, &quot;protocol&quot;, &quot;provided&quot;, &quot;provider&quot;, &quot;province&quot;, &quot;publicly&quot;, &quot;purchase&quot;, &quot;pursuant&quot;, &quot;quantity&quot;, &quot;question&quot;, &quot;rational&quot;, &quot;reaction&quot;, &quot;received&quot;, &quot;receiver&quot;, &quot;recovery&quot;, &quot;regional&quot;, &quot;register&quot;, &quot;relation&quot;, &quot;relative&quot;, &quot;relevant&quot;, &quot;reliable&quot;, &quot;reliance&quot;, &quot;religion&quot;, &quot;remember&quot;, &quot;renowned&quot;, &quot;repeated&quot;, &quot;reporter&quot;, &quot;republic&quot;, &quot;required&quot;, &quot;research&quot;, &quot;reserved&quot;, &quot;resident&quot;, &quot;resigned&quot;, &quot;resource&quot;, &quot;response&quot;, &quot;restrict&quot;, &quot;revision&quot;, &quot;rigorous&quot;, &quot;romantic&quot;, &quot;sampling&quot;, &quot;scenario&quot;, &quot;schedule&quot;, &quot;scrutiny&quot;, &quot;seasonal&quot;, &quot;secondly&quot;, &quot;security&quot;, &quot;sensible&quot;, &quot;sentence&quot;, &quot;separate&quot;, &quot;sequence&quot;, &quot;sergeant&quot;, &quot;shipping&quot;, &quot;shortage&quot;, &quot;shoulder&quot;, &quot;simplify&quot;, &quot;situated&quot;, &quot;slightly&quot;, &quot;software&quot;, &quot;solution&quot;, &quot;somebody&quot;, &quot;somewhat&quot;, &quot;southern&quot;, &quot;speaking&quot;, &quot;specific&quot;, &quot;spectrum&quot;, &quot;sporting&quot;, &quot;standard&quot;, &quot;standing&quot;, &quot;standout&quot;, &quot;sterling&quot;, &quot;straight&quot;, &quot;strategy&quot;, &quot;strength&quot;, &quot;striking&quot;, &quot;struggle&quot;, &quot;stunning&quot;, &quot;suburban&quot;, &quot;suitable&quot;, &quot;superior&quot;, &quot;supposed&quot;, &quot;surgical&quot;, &quot;surprise&quot;, &quot;survival&quot;, &quot;sweeping&quot;, &quot;swimming&quot;, &quot;symbolic&quot;, &quot;sympathy&quot;, &quot;syndrome&quot;, &quot;tactical&quot;, &quot;tailored&quot;, &quot;takeover&quot;, &quot;tangible&quot;, &quot;taxation&quot;, &quot;taxpayer&quot;, &quot;teaching&quot;, &quot;tendency&quot;, &quot;terminal&quot;, &quot;terrible&quot;, &quot;thinking&quot;, &quot;thirteen&quot;, &quot;thorough&quot;, &quot;thousand&quot;, &quot;together&quot;, &quot;tomorrow&quot;, &quot;touching&quot;, &quot;tracking&quot;, &quot;training&quot;, &quot;transfer&quot;, &quot;traveled&quot;, &quot;treasury&quot;, &quot;triangle&quot;, &quot;tropical&quot;, &quot;turnover&quot;, &quot;ultimate&quot;, &quot;umbrella&quot;, &quot;universe&quot;, &quot;unlawful&quot;, &quot;unlikely&quot;, &quot;valuable&quot;, &quot;variable&quot;, &quot;vertical&quot;, &quot;victoria&quot;, &quot;violence&quot;, &quot;volatile&quot;, &quot;warranty&quot;, &quot;weakness&quot;, &quot;weighted&quot;, &quot;whatever&quot;, &quot;whenever&quot;, &quot;wherever&quot;, &quot;wildlife&quot;, &quot;wireless&quot;, &quot;withdraw&quot;, &quot;woodland&quot;, &quot;workshop&quot;, &quot;yourself&quot;],
  w9: [&quot;aardvarks&quot;, &quot;alligator&quot;, &quot;boulevard&quot;, &quot;hamburger&quot;, &quot;turquoise&quot;, &quot;telephone&quot;, &quot;furniture&quot;, &quot;checklist&quot;, &quot;container&quot;, &quot;professor&quot;, &quot;frequency&quot;, &quot;spaceship&quot;, &quot;scarecrow&quot;, &quot;deodorant&quot;, &quot;cranberry&quot;],
  w10: [&quot;department&quot;, &quot;watermelon&quot;, &quot;strawberry&quot;, &quot;skateboard&quot;, &quot;rainforest&quot;, &quot;helicopter&quot;, &quot;percentage&quot;, &quot;restaurant&quot;, &quot;microscope&quot;, &quot;vegetables&quot;, &quot;university&quot;, &quot;volleyball&quot;, &quot;toothbrush&quot;, &quot;laboratory&quot;, &quot;calculator&quot;, &quot;wheelchair&quot;, &quot;chandelier&quot;, &quot;blackberry&quot;, &quot;binoculars&quot;],
  all: []
};
words.all = words.w3.concat(words.w4, words.w5, words.w6, words.w7, words.w8, words.w9, words.w10);
getRandomWord();
function getRandomWord() {
  var randomWord = words.all[Math.floor(Math.random() * words.all.length)];
  $(&quot;.word&quot;).html(&quot;&quot;);
  console.log(randomWord);
  var randomWordSplitted = randomWord.split(&quot;&quot;);
  randomWordSplitted.forEach(function (x) {
    $(&quot;.word&quot;).append(&quot;&lt;span class=&#39;&quot; + x + &quot;&#39;&gt;&quot; + x + &quot;&lt;/span&gt;&quot;);
  });
  $(&quot;.alphabet span&quot;).on(&quot;click&quot;, function () {
    var letter = $(this).text();
    if (checkLetter(letter, randomWordSplitted)) {
      $(this).addClass(&quot;green&quot;);
      $(&quot;.&quot; + letter).addClass(&quot;found&quot;);
      if (checkWin(randomWordSplitted.length)) {
        $(&quot;.alphabet&quot;).fadeOut();
        // setTimeout(function(){
        //   $(&quot;.word&quot;).hide(400);
        //   gameReset();
        // }, 800); 
      }
    }
    else {
      $(this).addClass(&quot;red2&quot;);
    }
  });
}
$(&quot;button&quot;).on(&quot;click&quot;, function () {
  gameReset();
});
function checkWin(length) {
  if ($(&quot;.found&quot;).length === length) {
    return true;
  }
}
function checkLetter(letter, arr) {
  if (arr.indexOf(letter) !== -1) {
    return true;
  }
  else {
    return false;
  }
}
function gameReset() {
  $(&quot;.alphabet span&quot;).off().removeClass();
  $(&quot;.word span&quot;).removeClass(&quot;found&quot;);
  $(&quot;.alphabet, .word&quot;).fadeIn();
  getRandomWord();
}
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="113" name="MemoryGame" tags="" position="350,1475" size="100,100">&lt;!--adapted from https://remybeumier.be/#creations-anchor--&gt;
&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article class=&quot;main&quot;&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
  &lt;div class=&quot;box play&quot;&gt;&lt;/div&gt;
  &lt;div class=&quot;box play&quot;&gt;&lt;/div&gt;
  &lt;div class=&quot;box play&quot;&gt;&lt;/div&gt;
  &lt;div class=&quot;box play&quot;&gt;&lt;/div&gt;
  &lt;div class=&quot;box play&quot;&gt;&lt;/div&gt;
  &lt;div class=&quot;box play&quot;&gt;&lt;/div&gt;
  &lt;div class=&quot;box play&quot;&gt;&lt;/div&gt;
  &lt;div class=&quot;box play&quot;&gt;&lt;/div&gt;
  &lt;div class=&quot;box play&quot;&gt;&lt;/div&gt;
  &lt;div class=&quot;box play&quot;&gt;&lt;/div&gt;
  &lt;div class=&quot;box play&quot;&gt;&lt;/div&gt;
  &lt;div class=&quot;box play&quot;&gt;&lt;/div&gt;
  &lt;div class=&quot;box play&quot;&gt;&lt;/div&gt;
  &lt;div class=&quot;box play&quot;&gt;&lt;/div&gt;
  &lt;div class=&quot;box play&quot;&gt;&lt;/div&gt;
  &lt;div class=&quot;box play&quot;&gt;&lt;/div&gt;
  &lt;div class=&quot;box play&quot;&gt;&lt;/div&gt;
  &lt;div class=&quot;box play&quot;&gt;&lt;/div&gt;
  &lt;div class=&quot;box play&quot;&gt;&lt;/div&gt;
  &lt;div class=&quot;box play&quot;&gt;&lt;/div&gt;  
  &lt;div id=&quot;state&quot;&gt;
    &lt;span id=&quot;time&quot;&gt;0&lt;/span&gt;
    &lt;span id=&quot;score&quot;&gt;0&lt;/span&gt;
  &lt;/div&gt;
&lt;/article&gt;

&lt;article id=&quot;pre&quot; class=&quot;&quot;&gt;
  &lt;div id=&quot;themes&quot;&gt;
    Chose your theme !
    &lt;p id=&quot;pokemon&quot; class=&quot;themes&quot; title=&quot;Pokemon&quot;&gt;Pokemon&lt;/p&gt;
    &lt;p id=&quot;starwars&quot; class=&quot;themes&quot; title=&quot;Star Wars&quot;&gt;Star Wars&lt;/p&gt;
    &lt;p id=&quot;lotr&quot; class=&quot;themes&quot; title=&quot;Lord of the Ring&quot;&gt;Lord of the Ring&lt;/p&gt;
    &lt;p id=&quot;disney&quot; class=&quot;themes&quot; title=&quot;Disney&quot;&gt;Disney&lt;/p&gt;
    &lt;p id=&quot;pixar&quot; class=&quot;themes&quot; title=&quot;Pixar&quot;&gt;Pixar&lt;/p&gt;
    &lt;p id=&quot;harrypotter&quot; class=&quot;themes&quot; title=&quot;Harry Potter&quot;&gt;Harry Potter&lt;/p&gt;
  &lt;/div&gt;
&lt;/article&gt;
&lt;article id=&quot;post&quot; class=&quot;hidden&quot;&gt;
  &lt;div&gt;
    &lt;p&gt;BRAVO !&lt;/p&gt;
    &lt;p id=&quot;final&quot;&gt;&lt;/p&gt;
    &lt;br&gt;
    &lt;p&gt;
      &lt;a id=&quot;again&quot;&gt;Play Again !&lt;/a&gt;
    &lt;/p&gt;
  &lt;/div&gt;
&lt;/article&gt;
&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt;
var library = {
harrypotter: [
    &#39;https://res.cloudinary.com/beumsk/image/upload/v1547998926/memory/harrypotter/harry.jpg&#39;,
    &#39;https://res.cloudinary.com/beumsk/image/upload/v1547998958/memory/harrypotter/ron.jpg&#39;,
    &#39;https://res.cloudinary.com/beumsk/image/upload/v1547998992/memory/harrypotter/hermione.jpg&#39;,
    &#39;https://res.cloudinary.com/beumsk/image/upload/v1547999106/memory/harrypotter/dumbledore.jpg&#39;,
    &#39;https://res.cloudinary.com/beumsk/image/upload/v1547999032/memory/harrypotter/malfoy.jpg&#39;,
    &#39;https://res.cloudinary.com/beumsk/image/upload/v1547999143/memory/harrypotter/voldemort.jpg&#39;,
    &#39;https://res.cloudinary.com/beumsk/image/upload/v1547999401/memory/harrypotter/rogue.jpg&#39;,
    &#39;https://res.cloudinary.com/beumsk/image/upload/v1547999196/memory/harrypotter/hagrid.jpg&#39;,
    &#39;https://res.cloudinary.com/beumsk/image/upload/v1547999271/memory/harrypotter/sirius.jpg&#39;,
    &#39;https://res.cloudinary.com/beumsk/image/upload/v1547999577/memory/harrypotter/neville.jpg&#39;,
    &#39;https://res.cloudinary.com/beumsk/image/upload/v1547998926/memory/harrypotter/harry.jpg&#39;,
    &#39;https://res.cloudinary.com/beumsk/image/upload/v1547998958/memory/harrypotter/ron.jpg&#39;,
    &#39;https://res.cloudinary.com/beumsk/image/upload/v1547998992/memory/harrypotter/hermione.jpg&#39;,
    &#39;https://res.cloudinary.com/beumsk/image/upload/v1547999106/memory/harrypotter/dumbledore.jpg&#39;,
    &#39;https://res.cloudinary.com/beumsk/image/upload/v1547999032/memory/harrypotter/malfoy.jpg&#39;,
    &#39;https://res.cloudinary.com/beumsk/image/upload/v1547999143/memory/harrypotter/voldemort.jpg&#39;,
    &#39;https://res.cloudinary.com/beumsk/image/upload/v1547999401/memory/harrypotter/rogue.jpg&#39;,
    &#39;https://res.cloudinary.com/beumsk/image/upload/v1547999196/memory/harrypotter/hagrid.jpg&#39;,
    &#39;https://res.cloudinary.com/beumsk/image/upload/v1547999271/memory/harrypotter/sirius.jpg&#39;,
    &#39;https://res.cloudinary.com/beumsk/image/upload/v1547999577/memory/harrypotter/neville.jpg&#39;
  ]
}
var images = [],
    tempElt1 = &quot;&quot;,
    tempElt2 = &quot;&quot;,
    click = -1,
    win = 0,
    score = 0,
    time = 0;
var preElt = document.querySelector(&quot;#pre&quot;),
    themesElt = document.querySelector(&quot;#themes&quot;),
    boxElts = document.getElementsByClassName(&quot;box&quot;),
    mainElt = document.querySelector(&quot;.main&quot;),
    timeElt = document.querySelector(&quot;#time&quot;),
    scoreElt = document.querySelector(&quot;#score&quot;),
    postElt = document.querySelector(&quot;#post&quot;),
    finalElt = document.querySelector(&quot;#final&quot;),
    againElt = document.querySelector(&quot;#again&quot;);
// initiate the game with chosen theme
themesElt.addEventListener(&quot;click&quot;, function(e) {
  if (e.target.classList.contains(&quot;themes&quot;)) {
    activateTheme(e.target.id);
    preElt.classList.add(&quot;hidden&quot;);
  }
});
function activateTheme(theme) {
  // insert theme in images array
  switch (theme) {
    case &quot;pokemon&quot;:
      for (let i=0; i&lt;20; i++) {images.push(library.pokemon[i]);}
      break;
    case &quot;starwars&quot;:
      for (let i=0; i&lt;20; i++) {images.push(library.starwars[i]);}
      break;
    case &quot;lotr&quot;:
      for (let i=0; i&lt;20; i++) {images.push(library.lotr[i]);}
      break;
    case &quot;disney&quot;:
      for (let i=0; i&lt;20; i++) {images.push(library.disney[i]);}
      break;
    case &quot;pixar&quot;:
      for (let i=0; i&lt;20; i++) {images.push(library.pixar[i]);}
      break;
    case &quot;harrypotter&quot;:
      for (let i=0; i&lt;20; i++) {images.push(library.harrypotter[i]);}
      break;
  }
  preElt.classList.add(&quot;hidden&quot;);
  // insert images in memory game
  for (let i=0; i&lt;20; i++) {
    var rand = Math.floor(Math.random() * (images.length-1));
    boxElts[i].innerHTML = &quot;&lt;img src=&#39;&quot; + images[rand] + &quot;&#39; alt=&#39;image&#39; class=&#39;hidden&#39;&gt;&quot;;
    images.splice(rand, 1);
  }
}
// Handle the play
mainElt.addEventListener(&quot;click&quot;, gameLogic);
function gameLogic(e) {
  // make sure the box is playable
  if (e.target.classList.contains(&quot;play&quot;)) {
    e.target.firstChild.classList.remove(&quot;hidden&quot;);
    // first of two click
    if (click &lt; 1) {
      tempElt1 = e.target;
      // timer
      if (click === -1) {
        timer = setInterval(function() {
          time++;
          timeElt.innerHTML = time;
        }, 1000);
      }
      click = 1;
    }
    // second click
    else if (e.target !== tempElt1) {
      tempElt2 = e.target;
      // different images
      if (tempElt1.firstChild.src !== tempElt2.firstChild.src) {
        mainElt.removeEventListener(&quot;click&quot;, gameLogic);
        setTimeout( function() {
          tempElt1.firstChild.classList.add(&quot;hidden&quot;);
          tempElt2.firstChild.classList.add(&quot;hidden&quot;);
          mainElt.addEventListener(&quot;click&quot;, gameLogic);
        }, 400);
        if (score &gt; 0){
          score -= 2;
        }
        scoreElt.innerHTML = score;
      }
      // same images
      else {
        score += 10;
        win += 2;
        tempElt1.firstChild.classList.add(&quot;outlined&quot;);
        tempElt2.firstChild.classList.add(&quot;outlined&quot;);
        tempElt1.classList.remove(&quot;play&quot;);
        tempElt2.classList.remove(&quot;play&quot;);
        scoreElt.innerHTML = score;
        // game won
        if (win === 20) {
          clearTimeout(timer);
          finalElt.innerHTML = &quot;You won &quot; + score + &quot; points &lt;br&gt; in &quot; + time + &quot; seconds&quot;;
          postElt.classList.remove(&quot;hidden&quot;);
        }
      }
      click = 0;
    }
  }
}
againElt.addEventListener(&quot;click&quot;, resetGame);
function resetGame() {
  // reset game
  tempElt1 = &quot;&quot;;
  tempElt2 = &quot;&quot;;
  click = -1;
  win = 0;
  score = 0;
  time = 0;
  postElt.classList.add(&quot;hidden&quot;);
  preElt.classList.remove(&quot;hidden&quot;);
  for (let i=0; i&lt;20; i++) {
    boxElts[i].classList.add(&quot;play&quot;);
    boxElts[i].firstChild.classList.add(&quot;hidden&quot;);
  }
  timeElt.textContent = time;
  scoreElt.textContent = score;
}
activateTheme(&quot;harrypotter&quot;);
// handle focus of the page
// function checkPageFocus() {
//   if (document.hasFocus()) {
//     preElt.classList.remove(&quot;hidden&quot;);
//   }
//   else {
//     preElt.classList.add(&quot;hidden&quot;);
//   }
// }
// var checkPageInterval = setInterval(checkPageFocus, 300);
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="114" name="DogSit" tags="" position="475,1475" size="100,100">&lt;script&gt;
//quest milestones
var qDogSitLib = [ [0,&#39;unknown&#39;],
    [0x100 , &#39;found dogsit annonce&#39; ],
    [0x200 , &#39;called phone, no answer&#39;],
    [0x300 , &#39;callback received, accepted offer&#39;],
    [0x310 , &#39;callback received, delayed decision&#39;],
    [0x400 , &#39;first visit at dogsit-center&#39;],
    [0x500 , &#39;interview run done&#39;],
    [0x550 , &#39;training run done&#39;],
    [0x600 , &#39;job offers lv1&#39;]
];&lt;/script&gt;</tw-passagedata><tw-passagedata pid="115" name="qDogSit_Status" tags="" position="600,1475" size="100,100">&lt;!--called  to print status---&gt;</tw-passagedata><tw-passagedata pid="116" name="Park_DogsitAd" tags="" position="725,1475" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;% window.gm.player.location=window.passage.name;
if(s.vars.qDogSit&lt;0x200) { s.vars.qDogSit=0x100; %&gt;
    A closer look on the paper reveals that it is an advertisment for an agency where you can rent people for dog-sitting.&lt;/br&gt;
    There is also a sidenote that new dog-sitters are hired and payed 20-100$ per hour.&lt;/br&gt;
    That sounds like easy money. Maybe you should call them and see if this is something for you.&lt;/br&gt;
    [[Call|Dogsit_FirstCall]]&lt;/br&gt;
&lt;%} else {%&gt;
    You already got the advertisment of the dog-sitting-agency.&lt;/br&gt;
    [[Call Dogsit|Dogsit_NewCall]]&lt;/br&gt;
&lt;% } %&gt;
[[Ignore the ad|Park]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="117" name="Dogsit_FirstCall" tags="" position="850,1475" size="100,100">&lt;section&gt;
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;% window.gm.player.location=window.passage.name;s.vars.qDogSit=0x200;%&gt;
Using the qr-scanner of your phone you scan the ad and start the call.&lt;/br&gt;
The ringing-sound is repeated several times but there is no one picking up the call.&lt;/br&gt;
After entering the number manually (just to make sure) you again got no connection.&lt;br&gt;
Darn. Maybe they are all busy caring for dogs. &lt;/br&gt;
[[Ignore the ad|Park]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt; 
&lt;/section&gt;</tw-passagedata><tw-passagedata pid="118" name="Dogsit_FirstCallBack" tags="" position="975,1475" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&quot;Yes hello here is Trisha from Dog-Sit-Agency.&quot; a female voice calls out.&lt;br&gt;
&quot;Im calling you back because your number was in our phones unanswered list.&quot; &lt;/br&gt;&lt;/br&gt;
&lt;p class=&quot;tPC&quot;&gt;&quot;Hello, I saw your ad and would like to ask about the job as a dog-sitter.&quot;&lt;/p&gt;&lt;/br&gt;
Todo: explain job&lt;/br&gt;
&quot;If you want to apply just come around at our shop at any time, ok?&quot;  &lt;/br&gt;
&lt;div id=&quot;choice&quot;&gt;
&lt;a href=&quot;javascript:void(0)&quot; id=&quot;yes&quot; onclick=&#39;choice(this,&quot;div#choice&quot;)&#39;&gt;Yes I will come by.&lt;/a&gt;&lt;/br&gt;
&lt;a href=&quot;javascript:void(0)&quot; id=&quot;no&quot; onclick=&#39;choice(this,&quot;div#choice&quot;)&#39;&gt;I not sure about this.&lt;/a&gt;&lt;/br&gt;
&lt;/div&gt;
[[Ignore the ad|&lt;%=window.gm.player.location%&gt;]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt;
function choice(elmt,replaceThis) {
	var msg =&#39;&#39;;
	if(elmt.id===&quot;yes&quot;) {
	window.story.state.vars.qDogSit=0x300;
	msg = &quot;You aggreed to visit them.&lt;/br&gt;&quot;;
	} else {
		window.story.state.vars.qDogSit=0x310;
		msg = &quot;You have to think about this. You can pay them a visit anyway.&lt;/br&gt;&quot;;
	}
	$(replaceThis).replaceWith(msg+window.gm.printPassageLink(&quot;Next&quot;,&quot;Kitchen&quot;));
}
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="119" name="Dogsit_Center" tags="" position="1100,1475" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;% window.gm.player.location=window.passage.name;
if(s.vars.qDogSit&lt;0x400) { s.vars.qDogSit=0x400; %&gt;
&lt;!--intro--&gt;
Walking down the street you finally find the dogsit-center. Its located in the ground floor of an old appartment.
A small name plate showing the outline of a dog and a human states that you have found the dogsit-center.
&quot;Hello how may I help you?&quot; a friendly woman at the reception desk welcoms you as you push trough the entry door.
&lt;p class=&quot;tPC&quot;&gt;&quot;Hello, I&#39;m &lt;%=window.gm.player.name%&gt;. I called before because I saw your ad. &quot;&lt;/p&gt;
&quot;Ah, yes. I remember your call. You said you dont have much experience about dogsitting. 
Please go over there through this door. Micheal is there and he will take care.&quot;&lt;/br&gt;
[[Dogsit_Intro2]]&lt;/br&gt;
&lt;%} else {%&gt;
&lt;!--default--&gt;
&lt;p class=&quot;tPC&quot;&gt;&quot;Hi, Thrisha. How are you.&quot;&lt;/p&gt; 
&quot;Hi, &lt;%=window.gm.player.name%&gt;. Fine. Nice to meet you. Are you here for some job?&quot;&lt;/br&gt;
[[walk a dog|Dogsit_NewJob]]&lt;/br&gt;[[Dogsit_TalkTrisha]] [[Dogsit_TalkMichael]] &lt;/br&gt;
[[Home]]&lt;/br&gt;
&lt;%}%&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="120" name="Dogsit_TalkTrisha" tags="_back_" position="1225,1475" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;!--&lt;% window.gm.player.location=window.passage.name;%&gt;--&gt;
todo
[[Back|_back_]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="121" name="Dogsit_TalkMichael" tags="_back_" position="100,1600" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;!--&lt;% window.gm.player.location=window.passage.name;%&gt;--&gt;
todo
[[Back|_back_]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="122" name="Dogsit_NewCall" tags="" position="225,1600" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;!--&lt;% window.gm.player.location=window.passage.name;%&gt;--&gt;
Ask for a new job.
[[Ignore the ad|Park]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="123" name="Dogsit_NewJob" tags="_back_" position="350,1600" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;!--&lt;% window.gm.player.location=window.passage.name;%&gt;--&gt;
&quot;Let&#39;s see if there what requests we have...&quot; Trisha starts working on the computer&lt;/br&gt;
&quot;Seems there is actually no request. I will message you if we get a new.&quot;

[[Lenny]] A playful and friendly corgi. 
[[Ole]] Golden Retriever. As a family dog this one should not cause much trouble.
[[Dotti]] Young Dalmatian female. Curious and lacks some obedience training.
[[Snow]] Husky-female. This breed needs a lot of action so you better get your workout dress. 
[[Klaus]] That doberman-stud isn&#39;t a easy one. He will question your role as a leader costantly.
[[Victor]] As a Great Dane this matured male is quite a large breed. While usually not the troublemaker, it could be quite difficult to get him in line should he act unruly.

[[None|_back_]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="124" name="qLaptop_Status" tags="" position="475,1600" size="100,100">&lt;!--called  to print status---&gt;
&lt;li&gt;&lt;label&gt;&lt;input type=&quot;checkbox&quot; name=&quot;y&quot; value=&quot;x&quot; readonly disabled&gt;
&lt;%=function(){
    if(s.vars.qLaptop==0) {
       return(&#39;Get a powerconverter for your laptop&#39;);
    } else {
        return(&#39;COMPLETED: Laptop working again&#39;);
    }
}()%&gt;
&lt;/label&gt;&lt;/li&gt;</tw-passagedata><tw-passagedata pid="125" name="_Laptop_" tags="_back_" position="600,1600" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
You seat yourself in front of the laptop. &lt;/br&gt;
&lt;%if(window.gm.quests.getMilestoneState(&quot;qFixLaptop&quot;).id&lt;1000){%&gt;
The battery has run out of power but the powerconverter is missing. You need to get a new one.&lt;/br&gt;
&lt;%} else if(window.gm.quests.getMilestoneState(&quot;qFixLaptop&quot;).id&gt;=1000){%&gt;
After pushing the powerbutton the pc takes ages to start.&lt;/br&gt;
todo mail,Browser&lt;/br&gt;
&lt;%}%&gt;
[[Back|_back_]]</tw-passagedata><tw-passagedata pid="126" name="Marga_Info" tags="" position="725,1600" size="100,100">Margarethe bezeichnet sch selber als Enchanter-Scholar.
Sie verschlingt Bücher und untersucht magische Artefakte um herauszufinden wie man Verzauberungen selber herstellt.
Wie weit fortgeschritten sie ist, ist aber schwer einzuschätzen.</tw-passagedata><tw-passagedata pid="127" name="MargaCursedItemsTalk" tags="_nosave_" position="850,1600" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;% if(!window.gm.quests.hasActiveQuest(&quot;???&quot;) || window.gm.quests.getMilestoneState(&quot;???&quot;).id&lt;1) { 
    window.story.render(&quot;AlchTalkStartPurpleBerry&quot;); %&gt;
&lt;% } else if(window.gm.quests.getMilestoneState(&quot;???&quot;).id===1 &amp;&amp; window.gm.player.Inv.countItem(&quot;???&quot;)&gt;=5) { 
    window.story.render(&quot;AlchTalkFinishPurpleBerry&quot;); %&gt;
&lt;% }  else {%&gt; Margarethe seems busy right now. [[Back|SC_Library]] &lt;%}%&gt;&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="128" name="Marga_Librarian" tags="" position="975,1600" size="100,100">&quot;Oh, I know this and that about arcane arts. If you have some equipment that you are not sure what kind of magic trick it might hide, I can try to rveal it.
I might even be able to enhance its power - for a price and a risk.&quot;
&quot;What risk?&quot;
&quot;If I put a good amount of effort and resources in it, I might be able to improve a certain aspect. But this is quite a lengthy and expensive procedure.&quot;
&quot;With less sophisticated techniques you could get the same or even better results. But its also quite possible to accidently amplify an adverse effect.&quot;
&quot;So, more expenses means less risk for failure.&quot;
&quot;So lets say I have those boots here with some speed-bonus. Could you improve the bonus even further? And what would it cost me?&quot;
&quot;Depends on the level of enchantment the item already has. Lets say it has a Level 3 bonus. To enhance it to Lv4 in a failure-proof way, I would need a medium soulcrystal, 2 sulfur and 500gd.&quot;
&quot;If its already at Lv5, I would need a greater SoulCrystal, 3 sulfur, a blue pearl and 1000gd to make sure its enchanted to Lv6.&quot;
&quot;But if you give me free hand, I would gladly offer an option that also has the possibility to get a stronger enchantment with the smaller cost.&quot;
&quot;Its a win-win, well mostly. I have the possibility to improve my techniques and you might get a even better equipment.&quot;
...
&quot;Oh my, not again. I was pretty sure that this wouldnt occur again.&quot;
&quot;Happen again? Why didnt you warn me about this! I cant remove it.&quot;
&quot;I&#39;m sorry. There has to be a flaw in the item or the soulcrystal wasn&#39;t good enough.That created some resonance that after some time collapses and transmogrifys the item.&quot;
&quot;Or you have no idea what you are doing and have done a sloppy job! How do I get rid of this?&quot;
&quot;Whoa whoa.. keep calm. No reason to get enraged. &quot;
&quot;Now that I think about it. Items that change themself...in benefical ways...or not so benefical...that could be interesting.&quot;</tw-passagedata><tw-passagedata pid="129" name="MargaQuest" tags="" position="1100,1600" size="100,100">&quot;Please bring me some item with a arcane trait. Something like a bracer that is magical reenforced.&quot;
&quot;What would I get for this?&quot;
&quot;My gratitude, really. I cant pay you right now in terms of money or arcana. But when I get some more knowledge about those enchants, I could create some of them myself and that would open up a lot possibilities to help you and me.&quot;
&quot;So I do the dirty work but might not get anything out of it?&quot;
&quot;I would owe you a favour. That could be much more valuable than some plain money, dont you think.&quot; she smiles at you.
&quot;How do I notice if an item has magic on it? Is it glowing blue or something like that.&quot;
&quot;Thats a good question. In fact I once had a dagger that glowed blue when a ham-sandwich was close to it. But often there are no so clear indicators for magical traits. I can feel if something is enchanted and you might be able to develop that sense too. In general the stronger the enchantment is that easier it is to recognize that there is something. Except if someone took some additional precautions to hide it.&quot;
---
&quot;So I found this. I&#39;m not sure but I think it has some magic on it.&quot;
&quot;I see.. yes there is something on it. Did you try to use it?&quot;
&quot;Actually not because I didn&#39;t like to take the risk to fetch another curse.&quot; you nestle at the collar around your neck.
&quot;Hmh, I will first have to determine what kind of magic trait is hidden there..please come back later, that will take some time.&quot; already deep in thought she walks away with the item
&quot;...and keep an eye out there for some more items like this.&quot;
---
&quot;That item you brought me has some magic on it that improves the perception of the wearer&quot;
&quot;Perception? You mean you can see like an eagle or hear like a cat?&quot;
&quot;Well, not as good as that, I assume. Someone would just be more attentive.&quot;
&quot;Thats interesting. Since you are done with your research can you give it back to me? It would be of good use for me.&quot;
&quot;Not yet. Determining the enchantment was only the first step. Now I want to try to improve it. That might indeed amplify the magnitude of the spell.&quot;
&quot;Fine. And then I can use it?&quot;
&quot;Oh yes. But I need some ingredients and tools for that and I would like to ask...&quot;
&quot;... if I can help you another time. Sigh. What do you need?&quot;
&quot;That5s so nice of you to offer your help. I would need some apoca-bloom and a soul-gem, the bigger the better. It should be at least of medium size.&quot;
&quot;I think I know where to find those flowers. But that other thing, I dont have a clue.&quot;</tw-passagedata><tw-passagedata pid="130" name="Help_Index" tags="_back_" position="1225,1600" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
Here you can find some information about the gameplay.&lt;/br&gt;&lt;/br&gt;
[[Your goal|Help_back_ground]]&lt;/br&gt;
[[Basics|Help_Basics]]&lt;/br&gt;
[[What should I do, where should I go|Help_Quest]]&lt;/br&gt;
[[Im stuck!|Help_Fixes]]&lt;/br&gt;
[[Credits]]
[[Back|_back_]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="131" name="Help_back_ground" tags="_back_" position="100,1725" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
Your goal is - to save the earth.&lt;/br&gt;
No, just joking. You are far from a superhero and earth has so many serious problems, you cant do much about it.&lt;/br&gt;
If you can make a living for yourself and find friends then you are on a good way.&lt;/br&gt;  &lt;/br&gt;
Here is a task-list for you: &lt;/br&gt;
1. explore your surroundings to unlock new places and events&lt;/br&gt;
2. check your quest-log regulary
3. talk to others and help them to build your relationship and unlock content&lt;/br&gt;
4. find ways to earn money. Money can unlock things,you know? &lt;/br&gt;
5. dont eat yellow snow&lt;/br&gt;
&lt;/br&gt;
[[Back|_back_]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="132" name="Help_Basics" tags="_back_" position="225,1725" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
Real Life&lt;/br&gt;&lt;hr&gt;&lt;/br&gt;
For many activities you have to spend energy and time. F.e. walking into the city takes some time and effort.&lt;/br&gt;
Energy can be recovered by sleeping. Also some activities, food or drugs can restore energy.&lt;/br&gt;
Use the sleep-option in your own bedroom to rest.&lt;/br&gt;
&lt;/br&gt;Virtual Reallity&lt;/br&gt;&lt;hr&gt;&lt;/br&gt;
Leaving the VR is only possible at the spawn-points, and only if in freeplay. If there is some storyrelevant stage running, you cant leave.&lt;/br&gt;
Entering VR is also only possible if the story-stage is at a certain points and requires it or freeplay is on.&lt;/br&gt;
&lt;/br&gt;
&lt;/br&gt;Combat&lt;/br&gt;&lt;hr&gt;&lt;/br&gt;
You defeat enemys by dammaging their health. If you have the skill, you can tease them until they are to aroused to bother fighting.
Postbattle scenes might differ if the victor is excited !
For some actions you need energy, f.e. a heavy strike or blocking with shield. Energy is recovered slowly on each turn.
Will can be used to cast magic.
Be aware that running out of energy/will might get you in a weakened condition.
&lt;/br&gt;
[[Back|_back_]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="133" name="Help_Quest" tags="_back_" position="350,1725" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
For the beginning:
- you should receive game equipment after 2 days
- try to explore the college i the meantime.&lt;/br&gt;
[[Back|_back_]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="134" name="Help_Fixes" tags="_back_" position="475,1725" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
If you are stuck on a page and you cannot escape. Press this [[Button|NOP]] to get back to your Home.&lt;/br&gt;&lt;/br&gt;
If you are even unable to get to this page because you see a weird plain textmessage in your browser:&lt;/br&gt;
Im sorry but no one can help you. I will try to add some debug-log that shows some more information that you can send me.&lt;/br&gt;
Then I might be abel to backtrack the error.&lt;/br&gt;
[[Back|_back_]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="135" name="Credits" tags="_back_" position="600,1725" size="100,100">&lt;section&gt; &lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
Credits:&lt;/br&gt;

Icons &amp; Images:&lt;/br&gt;
https://www.svgrepo.com/ &lt;/br&gt;
https://www.hiclipart.com/&lt;/br&gt;

[[Back|_back_]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="136" name="StartPage" tags="" position="725,1725" size="100,100">&lt;article&gt;
&lt;h1 align=&quot;center&quot;&gt;DLCseason &lt;%-window.gm.getSaveVersion()%&gt;&lt;/h1&gt;
&lt;h1 align=&quot;center&quot;&gt;DISCLAIMER&lt;/h1&gt;
&lt;h2 align=&quot;center&quot;&gt;Warning: Adult content! Fetishes!&lt;/h2&gt;
&lt;hr&gt;
&lt;div align=&quot;center&quot;&gt;This is a work of fiction; any resemblance to actual persons, places, or events is unintended. All characters in the game are fictional too. All coincidence with reality is random.
All characters in this game are fictional and any similarities to any persons living or dead are purely coincidental.
All explicit images are performed by consenting adults aged 18 or older. Images are for illustrative purposes only.&lt;/div&gt;
&lt;hr&gt;&lt;hr&gt;
&lt;div align=&quot;center&quot;&gt;Are you 21+ years old and want to play?&lt;/div&gt;
&lt;div align=&quot;center&quot;&gt;[[Yes!|Intro]] | [[No|StartPage]]&lt;/div&gt;
&lt;hr&gt;
&lt;/br&gt; &lt;div align=&quot;center&quot;&gt;Note that there is no back-button implemented. Pressing the back button of your browser will get your game aborted. &lt;/div&gt;&lt;/br&gt;
&lt;hr&gt;
This game is powered by twine/tweego and snowman.&lt;/br&gt; 
&lt;img src=&quot;https://twinery.org/homepage/img/logo.svg&quot; width=&quot;256&quot; height=&quot;256&quot;&gt;
&lt;/article&gt;</tw-passagedata><tw-passagedata pid="137" name="Intro" tags="" position="850,1725" size="100,100">&lt;article&gt;&lt;%window.gm.initGame();window.gm.player.location=window.passage.name;%&gt;
&lt;div id=&#39;output&#39;&gt;&lt;/div&gt;
&lt;p&gt;Welcome to Meason, a town somewhere in these days. &lt;/br&gt;
You are a student in the local university and live in a shared house with some other fellows. &lt;/br&gt;&lt;/p&gt;
&lt;p class=&#39;author&#39;&gt;You might see a lot of links that are formated red-strikethrough. Those are currently broken and you shouldnt use them.&lt;/p&gt;
&lt;/br&gt;Press [[Start|Intro2]] to enter the game. 
&lt;p class=&quot;author&quot;&gt;Please note: player name and start gender are currently unchangeable.&lt;/p&gt;
&lt;p class=&#39;author&#39;&gt;Loading of savegame is only possible in game.&lt;/p&gt;
There are also some options to make a fastforward (might behave oddly): &lt;/br&gt;
[[FF VR Character creation]] &lt;/br&gt;
[[FF before the bridge]]&lt;/br&gt;
[[FF Bridge passage unlocked]]&lt;/br&gt;
debug only! :&lt;/br&gt;
[[FF WolfVictory]]&lt;/br&gt;
&lt;/article&gt;</tw-passagedata><tw-passagedata pid="138" name="Intro2" tags="" position="975,1725" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
Here you are: a student in its early twentys sitting around at home, working on the laptop in front.
Progress in studys isnt going as smooth as expected.
To divert yourself, you decide to check your emails. 
&lt;div&gt;&lt;/br&gt;
[[Next|GameInvite]]&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="139" name="FF VR Character creation" tags="" position="1100,1725" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
Start at the character creation screen in the VR-game.
&lt;div&gt;&lt;/br&gt;
[[Back|Intro]] &lt;a0 onclick=&#39;start();window.story.show(&quot;CharacterEditor&quot;);&#39;&gt;Start&lt;/a&gt;&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt; function start() {
    window.gm.quests.addQuest(&quot;qDLCMain&quot;,1);
    window.gm.quests.addQuest(&quot;qDiedAgain&quot;,1);
    window.gm.quests.addQuest(&quot;qFixLaptop&quot;,1);
    window.gm.quests.addQuest(&quot;qBeastKink&quot;,1);
    window.gm.quests.addQuest(&quot;qBondageKink&quot;,1);
    window.gm.quests.forceQuestMilestone(&quot;qDLCMain&quot;,600,1);
    window.gm.quests.forceQuestMilestone(&quot;qFixLaptop&quot;,1000,1);
    window.gm.enterVR();
}
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="140" name="FF before the bridge" tags="" position="1225,1725" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
Start at forest with introductory quest done so far. Roam around and prepare to defeat bridge boss.
&lt;div&gt;&lt;/br&gt;
[[Back|Intro]] &lt;a0 onclick=&#39;start();window.story.show(&quot;ForestSpawn&quot;);&#39;&gt;Start&lt;/a&gt;&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt; function start() {
    window.gm.quests.addQuest(&quot;qBeastKink&quot;,1);
    window.gm.quests.addQuest(&quot;qBondageKink&quot;,200);
    window.gm.quests.addQuest(&quot;qDLCMain&quot;,600);
    window.gm.quests.addQuest(&quot;qFixLaptop&quot;,1000);
    window.gm.quests.addQuest(&quot;qDiedAgain&quot;,300);    //?? 100
    window.gm.quests.addQuest(&quot;qPurpleBerry&quot;,100);
    window.gm.enterVR();
}
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="141" name="FF Bridge passage unlocked" tags="" position="100,1850" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
You can now pass the bridge and leave the forest.
&lt;div&gt;&lt;/br&gt;
[[Back|Intro]] &lt;a0 onclick=&#39;start();window.story.show(&quot;ForestBridge&quot;);&#39;&gt;Start&lt;/a&gt;&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt; function start() {
    window.gm.quests.addQuest(&quot;qBeastKink&quot;,1);
    window.gm.quests.addQuest(&quot;qBondageKink&quot;,400);
    window.gm.quests.addQuest(&quot;qDLCMain&quot;,600);
    window.gm.quests.addQuest(&quot;qFixLaptop&quot;,1000);
    window.gm.quests.addQuest(&quot;qDiedAgain&quot;,300);
    window.gm.quests.addQuest(&quot;qPurpleBerry&quot;,100);
    window.gm.enterVR();
    window.gm.player.Outfit.addItem(new window.gm.ItemsLib[&quot;CollarQuest&quot;]());
}
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="142" name="FF WolfVictory" tags="" position="225,1850" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
&lt;div&gt;&lt;/br&gt;
[[Back|Intro]] &lt;a0 onclick=&#39;start();window.story.show(&quot;WolfVictory&quot;);&#39;&gt;Start&lt;/a&gt;&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt; function start() {
    window.gm.quests.addQuest(&quot;qBeastKink&quot;,1);
    window.gm.quests.addQuest(&quot;qBondageKink&quot;,400);
    window.gm.quests.addQuest(&quot;qDLCMain&quot;,600);
    window.gm.quests.addQuest(&quot;qFixLaptop&quot;,1000);
    window.gm.quests.addQuest(&quot;qDiedAgain&quot;,300);
    window.gm.quests.addQuest(&quot;qPurpleBerry&quot;,100);
    window.gm.enterVR();
    window.gm.MutationsLib[&#39;swapGender&#39;](window.gm.player,window.storage.constructors[&quot;VulvaHuman&quot;]);
    window.gm.player.addEffect(&#39;effLewdMark&#39;,new window.storage.constructors[&#39;effLewdMark&#39;]());
}
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="143" name="Laptop-PS" tags="" position="350,1850" size="100,100">A powersupply for a laptop.
[[Back|&lt;%=window.gm.player.location%&gt;]]</tw-passagedata><tw-passagedata pid="144" name="Into the city" tags="" position="475,1850" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;!-- dont overwrite location --&gt;
&lt;%=window.gm.printPickupAndClear(&#39;Crowbar&#39;,&#39;A crowbar is lying other there.&#39;,window.story.state.vars.crowBarLeft,(function(){window.story.state.vars.crowBarLeft-=1;}))%&gt;
You are actually at [[&lt;%=window.gm.player.location%&gt;]].
Where would you like to go from here?&lt;/br&gt;
&lt;a0 onclick=window.gm.rollExploreCity()&gt;Explore your surroundings&lt;/a&gt; &lt;/br&gt;&lt;/br&gt;
[[Home]]
&lt;%  if(s.vars.qUnlockPark&gt;0) {      %&gt;[[Park]]
&lt;%}; if(s.vars.qUnlockMall&gt;0) {     %&gt;[[Mall]]
&lt;%}; if(s.vars.qUnlockDowntown&gt;0) { %&gt;[[Downtown]]
&lt;%}; if(s.vars.qUnlockBeach&gt;0) {    %&gt;[[Beach]]
&lt;%};%&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="145" name="Mall" tags="" position="600,1850" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;%window.gm.player.location=window.passage.name;
if(s.vars.qUnlockMall==0) {s.vars.qUnlockMall=1;%&gt;
You found the &lt;%=window.passage.name%&gt; ! &lt;/br&gt;&lt;/br&gt;
&lt;%}%&gt;
You are actually at [[&lt;%=window.gm.player.location%&gt;]].
Where would you like to go from here?&lt;/br&gt;
&lt;a0 onclick=window.gm.rollExploreCity()&gt;Explore your surroundings&lt;/a&gt; &lt;/br&gt;&lt;/br&gt;
[[Into the Mall|Mall Floor 0]]&lt;/br&gt; [[Home]]&lt;/br&gt;
&lt;%  if(s.vars.qUnlockPark&gt;0) {      %&gt;[[Park]]&lt;/br&gt;
&lt;%}; if(s.vars.qUnlockBeach&gt;0) {      %&gt;[[Beach]]&lt;/br&gt;
&lt;%};%&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="146" name="Park" tags="" position="725,1850" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;%window.gm.player.location=window.passage.name;
if(s.vars.qUnlockPark==0) {s.vars.qUnlockPark=1;%&gt;
You found the &lt;%=window.passage.name%&gt; ! &lt;/br&gt;&lt;/br&gt;
&lt;%}%&gt;
You are actually at [[&lt;%=window.gm.player.location%&gt;]].&lt;/br&gt;
People in sportswear are jogging around the paths or doing gymnastics on the grassfield. Maybe you should also do some [[sports|Park_Jogging]] &lt;/br&gt; 
&lt;%if(s.vars.qDogSit===0 &amp;&amp; visited(window.passage.name)&gt;=5) {%&gt;
    On a direction sign near the entrance of the park you spot a piece of paper that someone must have placed there.&lt;/br&gt;
    Would you like to check whats up with the [[Sign|Park_DogsitAd]].
&lt;%} else if(s.vars.qDogSit&gt;0) {%&gt;
    [[DogSit-ad|Park_DogsitAd]]
&lt;%}%&gt;
Where would you like to go from here?&lt;/br&gt;
&lt;a0 onclick=window.gm.rollExploreCity()&gt;Explore your surroundings&lt;/a&gt; &lt;/br&gt;&lt;/br&gt;
[[Home]]&lt;/br&gt;
&lt;%  if(s.vars.qUnlockMall&gt;0) {      %&gt;[[Mall]]&lt;/br&gt;
&lt;%};%&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="147" name="Park_Jogging" tags="_back_" position="850,1850" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;%if(window.gm.player.Stats.get(&#39;energy&#39;).value&lt;=50) {%&gt;
You feel you dont have enough energy left to do anything sporty. Maybe another time. &lt;/br&gt;

&lt;%} else {%&gt;
After a quick warmup and stretching you take a fast pace jog around the outer paths of the park.&lt;/br&gt;
&lt;p class=&#39;red&#39;&gt;Energy -50&lt;/p&gt;
&lt;% window.gm.player.Stats.increment(&#39;energy&#39;,-50);
  if(window.gm.player.Stats.get(&#39;endurance&#39;).value&lt;=6 &amp;&amp; visited(window.passage.name)%2) {%&gt;
    After several rounds you are exhausted. But happy.
    This really seems to improve your fitness.
    &lt;p class=&#39;green&#39;&gt;Endurance +1&lt;/p&gt;
    &lt;% window.gm.player.Stats.increment(&#39;endurance&#39;,1);
} else {%&gt;
    This time you didnt feel that kind of exhausted euphoria. Maybe you have to work harder. Or you are as fit as you can get with this workout. &lt;/br&gt; 
&lt;%}}%&gt;
&lt;/br&gt;[[Back|_back_]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="148" name="Beach" tags="" position="975,1850" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;%window.gm.player.location=window.passage.name;
if(s.vars.qUnlockBeach==0) {s.vars.qUnlockBeach=1;%&gt;
You found the &lt;%=window.passage.name%&gt; ! &lt;/br&gt;&lt;/br&gt;
&lt;%}%&gt;
You are actually at [[&lt;%=window.gm.player.location%&gt;]].&lt;/br&gt;&lt;/br&gt;
The splashing waves are inviting but you dont have some proper swimwear with you.
You could wander at the shoreline. Maybe you find some jetsam.&lt;/br&gt;

&lt;/br&gt;
Where would you like to go from here?&lt;/br&gt;
&lt;a0 onclick=window.gm.rollExploreCity()&gt;Explore your surroundings&lt;/a&gt; &lt;/br&gt;&lt;/br&gt;
[[Home]]&lt;/br&gt;
&lt;%  if(s.vars.qUnlockMall&gt;0) {      %&gt;[[Mall]]&lt;/br&gt;
&lt;%};%&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="149" name="Downtown" tags="" position="1100,1850" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;%window.gm.player.location=window.passage.name;
if(s.vars.qUnlockDowntown===0) {s.vars.qUnlockDowntown=1;%&gt;
You found the &lt;%=window.passage.name%&gt; ! &lt;/br&gt;&lt;/br&gt;
&lt;%}%&gt;
You are actually at [[&lt;%=window.gm.player.location%&gt;]].
Where would you like to go from here?&lt;/br&gt;
&lt;a0 onclick=window.gm.rollExploreCity()&gt;Explore your surroundings&lt;/a&gt; &lt;/br&gt;&lt;/br&gt;
[[Home]]&lt;/br&gt;
&lt;%  if(s.vars.qUnlockMall&gt;0) {      %&gt;[[Mall]]&lt;%};%&gt;
[[Harcon_Health]]
&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="150" name="Pawn shop" tags="_back_" position="1225,1850" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
if((s.vars.qUnlockDowntown &amp; 0x2)===0) {s.vars.qUnlockDowntown|=0x2;%&gt;
You found the &lt;%=window.passage.name%&gt; ! &lt;/br&gt;&lt;/br&gt;
&lt;%}%&gt;
You are actually at [[&lt;%=window.gm.player.location%&gt;]].&lt;/br&gt;
A sign denoting &quot;quick money - no questions&quot; sparks your interest. It leads you to a pawn shop where you can trade in your valuables to get some money.&lt;/br&gt;
&lt;div id=&quot;choice&quot;&gt;&lt;/div&gt;&lt;/br&gt;&lt;/br&gt;   &lt;!--display buy message--&gt;
&lt;div id=&quot;panel&quot;&gt;&lt;/div&gt;&lt;/br&gt;&lt;/br&gt;    &lt;!--display wares list--&gt;
Where would you like to go from here?&lt;/br&gt;
&lt;a0 onclick=window.gm.rollExploreCity()&gt;Explore your surroundings&lt;/a&gt; &lt;/br&gt;&lt;/br&gt;
[[Back|_back_]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt;
var _Entrys = [];
_Entrys.push({id:&quot;Crowbar&quot;,count:1,cost:25});
_Entrys.push({id:&quot;Battery&quot;,count:3,cost:2});
renderToSelector(&quot;#panel&quot;, &quot;listsell&quot;);&lt;/script&gt;</tw-passagedata><tw-passagedata pid="151" name="PlainsWest" tags="" position="100,1975" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;window.gm.moveHere();%&gt;
Some large grassland is laid out before you. There are some bushes here and there and even group of trees.&lt;/br&gt;
[[to Forest|ForestBridge]] [[West|PlainsCrossroad]]
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt;&lt;/script&gt;</tw-passagedata><tw-passagedata pid="152" name="PlainsCrossroad" tags="" position="225,1975" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;window.gm.moveHere();%&gt;
The dirtroad branches in different directions and there is also a wodden post with several withered signs on it, pointing in different directions:&lt;/br&gt;
[[West: to Forest|PlainsWest]] [[East: Village|PlainsEast]]  [[NorthWest: TrumpetHills|NOP]]  [[South: Wasteland|NOP]]
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="153" name="PlainsEast" tags="" position="350,1975" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;window.gm.moveHere();%&gt;
Just more grassland. In the distance you can see herds of animals, probably deer or antelope.&lt;/br&gt;
A skilled hunter could certainly earn his living here with [[hunting]].&lt;/br&gt;
[[West: to Crossroads|PlainsCrossroad]] [[East: to Farmland|PlainsFarmland]]
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="154" name="PlainsFarmland" tags="" position="475,1975" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;window.gm.moveHere();%&gt;
Fields with grain and also with vegetables stretch along the road. In between are farms, barns and windmills, most of them more or less run down.&lt;/br&gt;
[[West: Plains|PlainsEast]] [[East: Village|VillageEntranceIntro]]
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="155" name="ForestSpawn" tags="" position="600,1975" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name; window.gm.enterVR();%&gt;
After the VR connects to the server, your avatar appears near the top of a hill in a magic puff. &lt;/br&gt;
A small trail makes it way down the hill to some wooden shed.&quot;&lt;/br&gt;
&lt;/br&gt;Some leather bracers ly on the road.
&lt;a0 onclick=&#39;takeBracers();&#39;&gt;pickup fancy bracers&lt;/a&gt;&lt;/br&gt;
&lt;div&gt;&lt;/br&gt;
[[Settlement|ForestBorder]]&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt;
function takeBracers() {
    let item = new window.storage.constructors[&#39;BracerLeather&#39;]();
    item = window.gm.makeCursedItem(item,{lock:true,energydrain:2});
    item = window.gm.makeBonusItem(item,{statBoost:&#39;agility&#39;, statBonus:3});
    window.gm.player.Wardrobe.addItem(item);
    window.gm.player.Outfit.addItem(item);
    this.disabled=true;
}
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="156" name="ForestRespawnPodExit" tags="" position="725,1975" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
You are in the sanctum of spawn. Its located on top of the hill above the settlement.&lt;/br&gt; 
&lt;/br&gt; There is a path leading downwards to the settlement.&lt;/br&gt;
&lt;div&gt;&lt;/br&gt;
[[Settlement|ForestBorder]] &lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="157" name="ForestBorder" tags="" position="850,1975" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.moveHere();%&gt;
&lt;!--todo--&gt; There is a dirt road here crossing the lush grassland that is bordered by the trees of an forest.&lt;/br&gt; 
One direction leads east, past a hut. The other direction follows the border of the forest but gets out of view quickly.&lt;/br&gt; 
&lt;div&gt;&lt;a0 onclick=&#39;window.gm.addTime(25);window.story.show(window.passage.name);&#39;&gt;Rest&lt;/a&gt;
[[Enter Hut|ForestAlchemistHut]] [[Into the forest|ForestEntrance]] [[follow Road|ForestBridge]] [[Up the hill|ForestSpawn]]&lt;/br&gt;
&lt;a0 onclick=&#39;enterBeehive(); &#39;&gt;Enter Beehive&lt;/a&gt; &lt;a0 onclick=&#39;enterShatteredCity();&#39;&gt;Enter Shattered City&lt;/a&gt;&lt;a0 onclick=&#39;enterArena();&#39;&gt;Enter Arena&lt;/a&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt; function enterBeehive() {
    window.gm.dng = window.gm.dngs.BeeHive();
    window.gm.dng.enterDungeon();
}
function enterShatteredCity() {
    window.gm.dng = window.gm.dngs.ShatteredCity();
    window.gm.dng.enterDungeon();
}
function enterArena() {
    window.gm.dng = window.gm.dngs.ArenaTrialsNo1();
    window.gm.dng.enterDungeon();
}
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="158" name="ForestSearchAround" tags="_back_" position="975,1975" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;% let args = window.story.state.tmp.args; if(args[0]===&#39;PurpleBerry&#39; &amp;&amp; args[1]&gt;0){ window.gm.player.Inv.addItem(window.gm.ItemsLib[args[0]](),args[1]); %&gt;
On a secluded spot you found a batch of berry bushes. Most of them dont have any more berrys but you are able to collect a handful.&lt;/br&gt;
&lt;%} else if(args[0]===&#39;PurpleBerry&#39;){%&gt;
There arent any purple berrys left. You have to search on a different place.&lt;/br&gt;
&lt;%} else if(args[0]===&#39;ApocaFlower&#39; &amp;&amp; args[1]&gt;0){ window.gm.player.Inv.addItem(window.gm.ItemsLib[args[0]](),args[1]);%&gt;
You found some pretty flowers with blue and yellow blossoms.&lt;/br&gt;
&lt;%} else {%&gt;
Unfortunatly you didnt find anything useful.&lt;/br&gt;
&lt;%}%&gt;
&lt;div&gt;&lt;/br&gt;[[Next|_back_]]&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="159" name="ForestWolfEncounter" tags="_back_" position="1100,1975" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;% window.gm.quests.addQuest(&quot;qWolfMate&quot;,1); if(window.gm.quests.getMilestoneState(&quot;qWolfMate&quot;).id&lt;=1) {%&gt;
Distracted by rummaging around in the bushes, you just caught by surprise as you turn around.&lt;/br&gt;
A dog is staring into your face. Its looks very close to a wolf you think. But wolfs would stay away from humans.
&#39;Oh wait, I&#39;m in a game. In games wolves are nether to shy to attack.&#39;
The wolf doesnt do a thing, just stands there and looks at you.
&lt;div id=&#39;select1&#39; &gt;
&lt;a0 onclick=&#39;window.gm.printTalkLink($(&quot;div#select1&quot;)[0],&quot;div#choice1a&quot;)&#39;&gt;First strike&lt;/a&gt;
&lt;a0 onclick=&#39;window.gm.printTalkLink($(&quot;div#select1&quot;)[0],&quot;div#choice1b&quot;)&#39;&gt;Dont move&lt;/a&gt;
&lt;/div&gt;
&lt;div id=&#39;choice1a&#39; hidden&gt;
I&#39;m in this game right now for how long and havent killed anything? &lt;/br&gt;
Lets get started to earn some XP. &lt;/br&gt;
&lt;a0 onclick=&#39;window.gm.encounters.wolf(window.gm.player.location)&#39;&gt;Next&lt;/a&gt;
&lt;/div&gt;
&lt;div id=&#39;choice1b&#39; hidden&gt;
There is nearly no chance in real life to accidently run into a wolf. So lets saviour that thrilling feeling even if this is not reallity.&lt;/br&gt;
That wolf is around 1m large from tip to toe. It has a dark gray fur with some darker areas on its back and feet.&lt;/br&gt;
Dark yellow eyes stare into your own and you stare back.&lt;/br&gt;
...Which provokes the wolf to attack...  
&lt;a0 onclick=&#39;window.gm.encounters.wolf(window.gm.player.location)&#39;&gt;Next&lt;/a&gt;
&lt;/div&gt;
&lt;%} else {%&gt;
There is a wolf again. Or is it the same?&lt;/br&gt;
&lt;a0 onclick=&#39;window.gm.encounters.wolf(window.gm.player.location)&#39;&gt;Next&lt;/a&gt;
&lt;%}%&gt;&lt;/br&gt;
&lt;%=(window.story.state._gm.debug)?(&quot;[[Skip|_back_]]&quot;):(&quot;&quot;)%&gt;&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="160" name="ForestEntrance" tags="" position="1225,1975" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.moveHere();%&gt;
The forest makes a friendly impression.&lt;/br&gt; The trees are still light and are not yet as expansive and large as that no more light can get through the canopy.&lt;/br&gt; 
Maybe you can &lt;a0 onclick=&#39;explore(); &#39;&gt;explore&lt;/a&gt; the surrounding woods and see if you can find anything useful.&lt;/br&gt;
&lt;div&gt;&lt;/br&gt;[[ForestBorder]] [[ForestCliff]] &lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt; function explore() {
    let rnd = _.random(0,100);
    window.gm.pushLog(&quot;rolled &quot;+rnd);
    window.story.state.tmp.args = [];
    if(window.gm.quests.getMilestoneState(&quot;qDiedAgain&quot;).id&lt;=2 &amp;&amp; window.gm.player.Inv.countItem(&#39;PurpleBerry&#39;)&gt;=2) {
        window.story.state.tmp.args = [&#39;PurpleBerry&#39;,0];window.story.show(&#39;ForestSearchAround&#39;); //find nothing !
    } else if(!window.gm.quests.hasActiveQuest(&quot;qCarlia&quot;) &amp;&amp; window.gm.player.Inv.countItem(&#39;PurpleBerry&#39;)&gt;=3) {
        window.story.show(&#39;ForestMeetCarlia1&#39;);
    } else if(window.gm.quests.getMilestoneState(&quot;qCarlia&quot;).id===100 &amp;&amp; window.gm.player.Inv.countItem(&#39;PurpleBerry&#39;)&gt;=4) {
        window.story.show(&#39;ForestMeetCarlia2&#39;);
    } else if(window.gm.quests.getMilestoneState(&quot;qCarlia&quot;).id===500 &amp;&amp; window.gm.player.Inv.countItem(&#39;SquishedLeech&#39;)&gt;=1) {
        window.story.show(&#39;ForestMeetCarlia3&#39;);
    } else if(rnd &gt; 70 ) {
         window.story.show(&#39;ForestWolfEncounter&#39;);
    } else if(rnd &gt; 65 ) {
         window.story.show(&#39;ForestMudGlade&#39;);
    }else if(rnd &gt; 20) { //todo limit berys per day
        let find = [&#39;PurpleBerry&#39;,&#39;PurpleBerry&#39;,&#39;ApocaFlower&#39;];
        let rnd2 = _.random(0,find.length-1);
        window.story.state.tmp.args = [find[rnd2],1]
        window.story.show(&#39;ForestSearchAround&#39;);
    }
    else {
        window.story.show(&#39;ForestSearchAround&#39;); //nothing
    }
}
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="161" name="ForestMeetCarlia1" tags="_nosave_ _back_" position="100,2100" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
Standing around and thinking where to go next, you get the feeling of beeing watched.&lt;/br&gt;
You listen carefully but can&#39;t pickup any unusual noise or other sign that something is sneaking up on you.&lt;/br&gt;&lt;/br&gt;
Then you turn around.&lt;/br&gt;&lt;/br&gt;
Nothing.&lt;/br&gt;
You turn slowly and let your eyes wander. &lt;/br&gt;
That tree there, did you just see something vanishing behind it?&lt;/br&gt;&lt;/br&gt;
&lt;/br&gt;&lt;div&gt; &lt;a0 onclick=&#39;window.gm.quests.addQuest(&quot;qCarlia&quot;,100);window.story.show(&quot;_back_&quot;);&#39;&gt;Next&lt;/a&gt;&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="162" name="ForestMeetCarlia2" tags="_nosave_ _back_" position="225,2100" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
Again you have the feeling on beeing watched, maybe you also heard some rustling in one of those bushes behind you.&lt;/br&gt;
You decide to go onward. Some way ahead are several large trees and as you already know one of them has a large hollow.&lt;/br&gt;
As you make your way through the trees, as soon as you think you are out of line of sight, you hide into the musty opening and fall silent.&lt;/br&gt;
Holding your breath, you listen carefully.The birds are singing and the wind lets the leaves rustle but nothing else.&lt;/br&gt;
You wait a minute and just as you decide to get back on your way, you hear a dry twig breaking some meters back where you came from.&lt;/br&gt;
&lt;div id=&#39;select1&#39; &gt;
&lt;a0 onclick=&#39;window.gm.printTalkLink($(&quot;div#select1&quot;)[0],&quot;div#choice1a&quot;)&#39;&gt;Jump out of your cover&lt;/a&gt;
&lt;/div&gt;&lt;div id=&#39;choice1a&#39; hidden&gt;&lt;/br&gt;
Ejecting yourself out of your cover and facing the direction of the noise, you can discern a figure trying to hide in the shadow of a tree trunk.
Your eyes need to adapt a moment and in that moment the figur starts running away.
&lt;p class=&quot;tPC&quot;&gt;&quot;Hey you wait !&quot;&lt;/p&gt;
But however it was has vanished in the undergrow.
You werent sure what you saw, but it seemed to be around your size and was moving upright. The murky cloak it was wearing preented to see more details.
&lt;p class=&quot;tPC&quot;&gt;&#39;So I were right, someone is hiding around. If I can follow their trail, I might find out who it is.&#39;&lt;/p&gt;
The figure was running into the direction of the cliff. But that might also be a diversion.
&lt;div&gt; &lt;a0 onclick=&#39;window.gm.quests.forceQuestMilestone(&quot;qCarlia&quot;,200,100);window.story.show(&quot;_back_&quot;);&#39;&gt;Next&lt;/a&gt;&lt;/br&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="163" name="ForestMeetCarlia3" tags="_nosave_ _back_" position="350,2100" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
While scrutinizing a bush for further treasues, you hear something plop down on the grassy floor some distance behind you.&lt;/br&gt;
You swirl around to see whats going on and find yourself confronted with that hooded figure that you already tried to catch.&lt;/br&gt;
Now it is leering at you in a half crouching stand.&lt;/br&gt;
&lt;p class=&quot;tPC&quot;&gt;&quot;Hey you, why are you pursuing me ! How are you?&quot;&lt;/p&gt;
&quot;Thief ! You are thief !&quot; the figure shouts and adds a long growl. &lt;/br&gt;
&lt;p class=&quot;tPC&quot;&gt;&#39;Did he just growl at me like a dog? What is this?&#39;&lt;/p&gt;
&quot;Give back what stolen !&quot;&lt;/br&gt;
&lt;p class=&quot;tPC&quot;&gt;&#39;I didnt steal anything !&#39;&lt;/p&gt;
&quot;Liar! You took necklace! Give back!&quot;&lt;/br&gt;
&lt;p class=&quot;tPC&quot;&gt;&quot;That damned collar? I didnt mean to take it! It just got alive and wrapped itself around my neck. What the heck is this?&quot;&lt;/p&gt;
&quot;Its present! Give back!&quot;&lt;/br&gt;
&lt;p class=&quot;tPC&quot;&gt;&quot;I would gladly do so if you an tell me how to get rid of it! Do you have a key?&quot;&lt;/p&gt;
&quot;No key. Just unlatch.&quot;&lt;/br&gt;
&lt;p class=&quot;tPC&quot;&gt;&quot;I already tried but its not giving. The guy from the hut said it might be cursed!&quot;&lt;/p&gt;
&quot;Not unlatch? ...Maybe need magic perfom.&quot; you can here it muttering.&lt;/br&gt;
&lt;p class=&quot;tPC&quot;&gt;&quot;Huh? Is it cursed? With what?&quot;&lt;/p&gt;
&quot;Depends&quot;&lt;/br&gt;
&lt;p class=&quot;tPC&quot;&gt;&quot;Depends? Depends on what? Do you know how to get it off or not?&quot;&lt;/p&gt;
&quot;Wear some time and you will see. Might unlatch if curse finished.&quot;&lt;/br&gt;
&lt;p class=&quot;tPC&quot;&gt;&quot;Aahrg! Listen. You want it back and I want to get rid of it. So why dont we help each other? &quot;&lt;/p&gt;
&quot;No help no. You thief!&quot;&lt;/br&gt;
With that, the figure jumps up and runs away diving through the undergrowth with a good amount of speed.
You hurry after it but its of no use, at some point your target vanishs behind some close standing trees.&lt;/br&gt; 
&lt;div&gt; &lt;a0 onclick=&#39;window.gm.quests.forceQuestMilestone(&quot;qCarlia&quot;,600,500);window.story.show(&quot;_back_&quot;);&#39;&gt;Next&lt;/a&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="164" name="ForestMeetCarlia4" tags="_nosave_" position="475,2100" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
The cloaked pursuer drops from a thick branch just above your head as you pass by below it.&lt;/br&gt;
Pouncing on you, you get knocked over and the figure is stradling you on your back.
You hear a &#39;rawr&#39; and feel the choker been pulled thight. Either it want to choke you or to rip of the collar around your neck.
Trashing around with your legs, you land a diverting hit and prepping yourself up from the ground with one hand, you can push the figure off from you.
You get hold on the cloak while both of you struggle to get up to the feet before the other. 
As you pull hard on the cloth to stop your assailant from getting up, you an feel something give away.
&quot;Thief stealing cloth  RAAWWR!&quot;
You are still on the ground and look up at her. Indeed, its not a he but a she.
She is wearing some kind of bikini bottom made of coarse cloth and a small satchel on a long lether strap dangles at her hip.
Otherwise she is nude, you get a good view of her small bossom from down here.
Her round face has some distinct cat-like features like the snub nose and pointed ears that are now folded against her skull.
She bares several small but sharph looking teeth.
&lt;p class=&quot;tPC&quot;&gt;&quot;What the hell are you?&quot;&lt;/p&gt;
With that, the enraged cat-girl pounces at you with her outstretched hands, adorned with razor-sharph extended claws. 
&lt;div&gt; &lt;a0 onclick=&#39;window.story.show(&quot;_back_&quot;);&#39;&gt;Next&lt;/a&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="165" name="CarliaMakeDeal" tags="_nosave_" position="600,2100" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
You dive under Calias claw as she trys to land another hit.&lt;/br&gt;
At the same time - either because you have some hidden wrestler champion skill or by pure accident - you bring her down face first by tripping a feet.
Now its your time to pounce on her back. Gripping her wrists with your hands and using your legs to keep hers in check, you can keep her face down on all fours.  
&lt;p class=&quot;tPC&quot;&gt;&#39;And now what?&#39;&lt;/p&gt;
As soon as you let go she will either be up and away or give you some nasty scratching. She is struggling against you pinning her down.
&lt;div id=&#39;select1&#39; &gt;
&lt;a0 onclick=&#39;window.gm.printTalkLink($(&quot;div#select1&quot;)[0],&quot;div#choice1a&quot;)&#39;&gt;She is quite in a vulnerable position...&lt;/a&gt;
&lt;a0 onclick=&#39;window.gm.printTalkLink($(&quot;div#select1&quot;)[0],&quot;div#choice1b&quot;)&#39;&gt;Lets try to talk some sense into her.&lt;/a&gt;
&lt;/div&gt;&lt;div id=&#39;choice1a&#39; hidden&gt;
&lt;/br&gt;That bottom of hers rubbing against your groin is quite a diversion.
&lt;p class=&quot;tPC&quot;&gt;&#39;I wonder how far I could go in that game..&#39;&lt;/p&gt;
Maybe she picked up your thoughts or she just run out of endurance. But she stopped struggling for the most and started to snuffle and sob.
&lt;p class=&quot;tPC&quot;&gt;&#39;Damn, those sobs a really getting onto me. Am I realy such a bad guy to force myself onto her?&#39;&lt;/p&gt;
&lt;div id=&#39;choice1a_&#39;&gt;&lt;a0 onclick=&#39;window.gm.printTalkLink($(&quot;div#choice1a_&quot;)[0],&quot;div#choice1b&quot;)&#39;&gt;Be kind&lt;/a&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#39;choice1b&#39; hidden&gt;
&lt;p class=&quot;tPC&quot;&gt;&quot;Hey stop kicking and listen ! I dont want to hurt you.&quot;&lt;/p&gt;
After a minute or so, she indeed reduces her struggeling. 
&quot;You are meany. Let me go&quot;
&lt;p class=&quot;tPC&quot;&gt;&quot;Hey..YOU attacked ME, remember? If I let go, do you promise to not attack me? You can also get your cloak back.&quot;&lt;/p&gt;
Snuffeling she seems to think about this.
&quot;Fine. I promise. But give cloak back yes?&quot;
&lt;p class=&quot;tPC&quot;&gt;&#39;She might tell me anything to get out of the situation. But what other choice do I have.&#39;&lt;/p&gt;
So you let her wrist go, push your self up and hurriedly back away some distance. She rises to her feetquickly but doesnt run away, maybe because you still haver her cloth.
&lt;p class=&quot;tPC&quot;&gt;&quot;Here, I will give you your cloth. But first you explain who you are and why you follow me around.&quot;&lt;/p&gt;
&quot;Name is Carlia.&quot;
....
&lt;p class=&quot;tPC&quot;&gt;&quot;Just as you want that choker back I want to get rid of it. Lets help each other. I will see to get you some home in favor for your trust.&quot;&lt;/p&gt;
&lt;p class=&quot;tPC&quot;&gt;&#39;Maybe the alchemist could help again. Who else could I ask?&#39;&lt;/p&gt; 
With that thought in mind you leave Carlia behind.&lt;/br&gt; 
&lt;a0 onclick=&#39;window.gm.quests.forceQuestMilestone(&quot;qCarlia&quot;,700,600);window.story.show(&quot;ForestCliff&quot;);&#39;&gt;Next&lt;/a&gt;
&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="166" name="ForestMudGlade" tags="" position="725,2100" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
This area of the forest seems to be more watery and sludgy. Your feet sink into the muddy soil.
&lt;a0 onclick=&#39;explore();&#39;&gt;Searching around&lt;/a&gt; might only get you wet and dirty.&lt;/br&gt;
&lt;div&gt;&lt;/br&gt;[[ForestEntrance]] &lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt; function explore() {
    let rnd = _.random(0,100);
    window.gm.pushLog(&quot;rolled &quot;+rnd);
    window.story.state.tmp.args = [];
    if(rnd &gt; 0 ) {
         window.story.show(&#39;ForestLeechEncounter&#39;);
    } else {
        window.story.show(&#39;ForestSearchAround&#39;); //nothing
    }
}
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="167" name="ForestLeechEncounter" tags="_back_" position="850,2100" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;% if(true) {%&gt;
Some sludgy leeches are crawling up your legs, each easily long as a hand !&lt;/br&gt;
&lt;a0 onclick=&#39;window.gm.encounters.leech(window.gm.player.location,_.random(1,3))&#39;&gt;Next&lt;/a&gt;
&lt;%}%&gt;&lt;/br&gt;
&lt;%=(window.story.state._gm.debug)?(&quot;[[Skip|_back_]]&quot;):(&quot;&quot;)%&gt;&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="168" name="ForestCliff" tags="" position="975,2100" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.moveHere();%&gt;
&lt;% if(window.gm.quests.getMilestoneState(&quot;qDiedAgain&quot;).id===2) { %&gt;
You fight your way through the dense undergrowth and realize just in time that you have reached the edge of a cliff.&lt;/br&gt; 
&lt;div id=&#39;select1&#39; &gt;
&lt;a0 onclick=&#39;window.gm.printTalkLink($(&quot;div#select1&quot;)[0],&quot;div#choice1a&quot;)&#39;&gt;Peak into the chasm&lt;/a&gt;
&lt;/div&gt;
&lt;div id=&#39;choice1a&#39; hidden&gt;
There is a slab of rock from which you should be able to look down quite well.&lt;/br&gt;
You look carefully over the edge. It&#39;s not a real abyss, but a pretty steep, rocky slope. &lt;/br&gt;
&#39;I&#39;m not climbing down there now.&#39; you think when you want to go back to the forest. &lt;/br&gt;
&lt;div id=&#39;select2&#39; &gt;
&lt;a0 onclick=&#39;window.gm.printTalkLink($(&quot;div#select2&quot;)[0],&quot;div#choice2a&quot;)&#39;&gt;Next&lt;/a&gt;
&lt;/div&gt;
&lt;div id=&#39;choice2a&#39; hidden&gt;
The rock slab is not so rock-solid and just as you turn around it begins to tip into the abyss. 
Unfortunatly, your jump-ability isn&#39;t quite good enough. The slab drags you down with it.&lt;/br&gt;
At some point you see a massive rock coming onto you, reaching out with your hands to stop it squishing you.
&lt;div id=&#39;select3&#39; &gt;
&lt;a0 onclick=&#39;window.gm.printTalkLink($(&quot;div#select3&quot;)[0],&quot;div#choice3a&quot;)&#39;&gt;Next&lt;/a&gt;
&lt;/div&gt;
&lt;div id=&#39;choice3a&#39; hidden&gt;
But of course its futile trying to catch that crushing weight. &lt;/br&gt;  
You dont feel any pain, everything is just going &lt;a0 onclick=&#39;window.gm.respawn();&#39;&gt;black&lt;/a&gt; as if pulling the cord from a TV.&lt;/br&gt;  
&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;
&lt;% } else if(window.gm.quests.getMilestoneState(&quot;qCarlia&quot;).id===200) { %&gt;
Walking along the edge of the cliff, you check the ground. Maybe you can find some footprints or something that would help you track down the figure that stalked you.
And really you can find one footprint in the muddy leftovers of a rain puddle. 
&lt;p class=&quot;tPC&quot;&gt;&#39;It looks like from a boot - is it my own? No, mine is not as broad but longer&#39; &lt;/p&gt;
You go forward where you would guess someone would be walking, carefully watching not to miss another clue or falling down the cliff. 
&lt;a0 onclick=&#39;window.gm.quests.forceQuestMilestone(&quot;qCarlia&quot;,300,200);window.story.show(&quot;ForestCliff&quot;);&#39;&gt;Next&lt;/a&gt;&lt;/br&gt;
&lt;% } else {%&gt;
&lt;div&gt;
A path leads along the cliff until it vanishs into a [[cave entrance|ForestCliffCave]] .  
Or you might just return to [[ForestEntrance]]. &lt;/br&gt;&lt;/div&gt; 
&lt;%}%&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="169" name="ForestCliffCave" tags="" position="1100,2100" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.moveHere();%&gt;
&lt;% if(window.gm.quests.getMilestoneState(&quot;qBondageKink&quot;).id&lt;=1 &amp;&amp; window.gm.quests.getMilestoneState(&quot;qCarlia&quot;).id===300) { %&gt;
At some point the small path leads further downward the cliff, makes a curve and ends in front of a cave.&lt;/br&gt;
The cave entrance is possibly 5m in width and around 3m at its heighest point. It tapers while it goes inside the cliff but maybe it doesnt end soon, its just to dark to see if it goes on. 
Someone made himself a home here. There is a small fireplace with burned up charcoal and a sleeping mat.&lt;/br&gt;
As you snoop around you find a worn bag or satchel made of leather and fur.&lt;/br&gt;
It could give you some information about its owner if you take a look at it.&lt;/br&gt;
&lt;div id=&#39;select1&#39; &gt;
&lt;a0 onclick=&#39;window.gm.printTalkLink($(&quot;div#select1&quot;)[0],&quot;div#choice1a&quot;)&#39;&gt;Peek inside&lt;/a&gt;
&lt;a0 onclick=&#39;window.gm.printTalkLink($(&quot;div#select1&quot;)[0],&quot;div#choice1b&quot;)&#39;&gt;or dont&lt;/a&gt;
&lt;/div&gt;&lt;div id=&#39;choice1a&#39; hidden&gt;
After undoing the clasp, you carefuly peek inside the bag.
&lt;p class=&quot;tPC&quot;&gt;&#39;I&#39;m not going to stick my hand in it - better safe then sorry.&#39;&lt;/p&gt;
Just as you think those smartass-words, something bursts out of the depths of the satchel into your face.&lt;/br&gt;
You stumble backwards in surprise, letting the bag fall to the ground and trying to grab whatever is now moving around on your front.&lt;/br&gt;
The uneven floor lets you loose your footing and you fall on your back beeing stunned just for an blink of an eye.&lt;/br&gt;
But in this moment, the snake - you guess - squirms up around your neck and ... enclose it ??&lt;/br&gt;
Using both hands to feel up around your neck, trying to get an idea what is now circling it. It doesnt move anymore and thats a good sign, right?&lt;/br&gt;
You feel a ring made from some rigid material, most likely leather. The surface is mostly smooth and flat. Its broad as a thumb but only half a cm thick.&lt;/br&gt;
&#39;Its some kind of choker. How do I get it off ?!&#39; &lt;/br&gt; 
You cant make out a latch or buckle.&lt;/br&gt; Fitting 2 fingers between it and your throat is barely possible without choking yourself&lt;/br&gt;
Maybe you can ask someone for help.&lt;/br&gt;
&lt;a0 onclick=&#39;window.gm.player.Outfit.addItem(new window.gm.ItemsLib[&quot;CollarQuest&quot;]());window.gm.quests.forceQuestMilestone(&quot;qCarlia&quot;,500,300);window.gm.quests.forceQuestMilestone(&quot;qBondageKink&quot;,100,1);window.story.show(&quot;ForestCliff&quot;)&#39;&gt;Leave&lt;/a&gt;
&lt;/div&gt;
&lt;div id=&#39;choice1b&#39; hidden&gt;
Come on, what kind of adventurer are you? How will you ever get good loot if you dont open every chest and jar you find - or stinky old leatherbags.
&lt;a0 onclick=&#39;window.gm.printTalkLink($(&quot;div#choice1b&quot;)[0],&quot;div#choice1a&quot;)&#39;&gt;Peek inside&lt;/a&gt;
&lt;/div&gt;
&lt;% } else {%&gt;
&lt;div&gt;
The path leads up to [[ForestCliff]] or further down to a [[river|NOP]]. &lt;/br&gt;&lt;/div&gt; 
&lt;%}%&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="170" name="ForestStoneCircle" tags="" position="1225,2100" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.moveHere();%&gt;
&lt;!--todo--&gt; Aus dem dichten Unterholz trittst du auf eine Lichtung. Das wäre ein idylischer Ort wenn nicht dieser Steinkreis wäre.&lt;/br&gt; 
&lt;/br&gt; 
&lt;% if(true) { %&gt;
&lt;div id=&#39;select1&#39; &gt;
&lt;a0 onclick=&#39;window.gm.printTalkLink($(&quot;div#select1&quot;)[0],&quot;div#choice1a&quot;)&#39;&gt;Inspect stone circle&lt;/a&gt;
&lt;/div&gt;
&lt;div id=&#39;choice1a&#39; hidden&gt;
Du gehst zu den übermannsgroßen Steinen. Es scheint hier etwas kühler zu sein und etwas Nebel liegt in der Luft.
Ansonsten gibt es hier nichts.&lt;/br&gt;
[[Leave|NOP]]
&lt;/div&gt;
&lt;% } else {%&gt;
&lt;div&gt;
[[ForestEntrance]] &lt;a0 onclick=&#39;enterBeehive(); &#39;&gt;Enter Beehive&lt;/a&gt;&lt;/br&gt; &lt;/br&gt;&lt;/div&gt; 
&lt;%}%&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt; function enterBeehive() {
    window.gm.dng = window.gm.dngs.BeeHive();
    window.gm.dng.enterDungeon();
}</tw-passagedata><tw-passagedata pid="171" name="ForestAlchemistHut" tags="name:shaby_hut" position="100,2225" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.moveHere();%&gt;
&lt;p class=&quot;tPC&quot;&gt;&lt;/p&gt;&#39;Puh, what a stink. I shouldnt stay here for long for I might suffocate&#39;&lt;/p&gt;
&quot;About that cake we talked earlier - what kind of cake are we speaking about.&quot;
&lt;p class=&#39;tPC&#39;&gt;NOO CAKE !&lt;/p&gt;
&lt;a0 onclick=&#39;window.gm.player.Inv.addItem(new window.gm.ItemsLib[&quot;KeyRestraintA&quot;]());&#39;&gt;pickup small key&lt;/a&gt;
&lt;% if(window.gm.quests.getMilestoneState(&quot;qPurpleBerry&quot;).id&gt;=100) {%&gt;
&lt;a0 onclick=&#39;window.gm.player.Inv.removeItem(&quot;PurpleBerry&quot;,5);window.gm.player.Inv.addItem(new window.gm.ItemsLib[&quot;HealthPotion(small)&quot;](),1);window.gm.refreshAllPanel();&#39; &lt;%=(window.gm.player.Inv.countItem(&quot;PurpleBerry&quot;)&gt;=5)?(&quot;&quot;):(&quot;hidden&quot;)%&gt;&gt;Trade 5 purple berries for 1 health-potion&lt;/a&gt;&lt;/br&gt;
&lt;a0 onclick=&#39;window.gm.player.Inv.removeItem(&quot;PurpleBerry&quot;,5);window.gm.player.Inv.addItem(new window.gm.ItemsLib[&quot;HorsePowerPotion&quot;](),1);window.gm.refreshAllPanel();&#39; &lt;%=(true)?(&quot;&quot;):(&quot;hidden&quot;)%&gt;&gt;Trade xxx for 1 HorsePower-Draft&lt;/a&gt;
&lt;%}%&gt;
&lt;div&gt;&lt;/br&gt;[[Outside|ForestBorder]]  [[Alchemist|ForestAlchemistTalk]]&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="172" name="ForestBridge" tags="" position="225,2225" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.moveHere();%&gt;
&lt;% if(window.gm.quests.getMilestoneState(&quot;qBondageKink&quot;).id&lt;100) { %&gt;
Somehow you cant go into this direction. Maybe this route unlocks later.
[[Leave|ForestBorder]]
&lt;% } else if(window.gm.quests.getMilestoneState(&quot;qBondageKink&quot;).id&lt;=200) { %&gt;
&lt;p class=&quot;tPC&quot;&gt;&#39;I guess this road leads to that town the alchemist mentioned.&#39;&lt;/p&gt;
You follow the path until after a curve a wooden bridge comes into view.
The bridge spans about the canyon,a deep chasm between the forest and the eastern area thereof.&lt;/br&gt;
You carefully set a foot on it, so far it looks stable enough to carry ones weight.
&lt;div id=&#39;select1&#39; &gt;
&lt;a0 onclick=&#39;window.gm.printTalkLink($(&quot;div#select1&quot;)[0],&quot;div#choice1a&quot;)&#39;&gt;Go on&lt;/a&gt;
&lt;/div&gt;
&lt;div id=&#39;choice1a&#39; hidden&gt;
When you have half of the bridge behind you, a large figure steps into view.&lt;/br&gt;
&quot;Stop. You have to pay a fee to pass the bridge.&quot; it shouts over to you.
Squinching your eyes and slowing down your steps, you try to get a better view of that hindrance.&lt;/br&gt; &lt;!--todo--&gt;
&lt;p class=&#39;tPC&#39;&gt;&quot;A fee? I didnt see a sign. Who are you?&quot; &lt;/p&gt;
&lt;p class=&quot;tNPC1&quot;&gt;&quot;There is no sign yet beause...we where busy with...bridge repair. You give ...20coin and then you may pass.&quot;&lt;/p&gt;
&lt;span class=&quot;tPC&quot;&gt;&#39;Looks more like highwayman then a craftsman&#39;&lt;/span&gt; you think to yourself. &lt;/br&gt;
&lt;div id=&#39;select2&#39; &gt;
&lt;a0 onclick=&#39;window.gm.printTalkLink($(&quot;div#select2&quot;)[0],&quot;div#choice2a&quot;)&#39;&gt;Cant pay&lt;/a&gt;
&lt;/div&gt;
&lt;div id=&#39;choice2a&#39; hidden&gt;
&lt;p class=&#39;tPC&#39;&gt;&quot;I cant pay you, I have nothing of value.&quot;&lt;/p&gt;
&lt;p class=&quot;tNPC1&quot;&gt;&quot;Then, just turn around and walk back before I force you to do so.&quot;&lt;/p&gt;
&lt;p class=&quot;tPC&quot;&gt;&#39;I could tackle him. I bet he wouldnt take the risk of a fight if he is alone and cant expect some loot from me.&#39;&lt;/p&gt;
&lt;p class=&quot;tNPC1&quot;&gt;&quot;Nice collar. So you are a slave? Maybe you have fled from your master huh? I should just take you into custody for some reward - SLAVE.&quot;&lt;/p&gt;
&lt;div id=&#39;select3&#39; &gt;
&lt;a0 onclick=&#39;window.gm.printTalkLink($(&quot;div#select3&quot;)[0],&quot;div#choice3a&quot;);&#39;&gt;&quot;I&#39;m not a slave!&quot;&lt;/a&gt;
&lt;/div&gt;
&lt;div id=&#39;choice3a&#39; hidden&gt;
While you scream at your offender, he bolts forward trying to knock you over.&lt;/br&gt;
You are in a &lt;a0 onclick=&#39;window.gm.quests.forceQuestMilestone(&quot;qBondageKink&quot;,300,200);window.gm.encounters.Trent(window.gm.player.location)&#39;&gt;fight!&lt;/a&gt;&lt;/br&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;
&lt;% } else if(window.gm.quests.getMilestoneState(&quot;qBondageKink&quot;).id&lt;=300) { %&gt;
Carefully approaching the bridge, you are scanning the surrounding.&lt;/br&gt;
Trent is over there, watching that no one passes the bridge without payment. &lt;/br&gt;
At least two other people are sitting around a firepit near the eastern end of the bridge.&lt;/br&gt;
Maybe you can [[speak up to him|TrentTalk]].&lt;/br&gt;
[[Leave|ForestBorder]] &lt;/br&gt;
&lt;% } else {%&gt;
A large bridge made of wood crosses a deep canyon that separates the forest from the land east of it.&lt;/br&gt;
&lt;div&gt;[[to Forest|ForestBorder]] [[to Plains|PlainsWest]]. &lt;/br&gt;&lt;/div&gt;
&lt;%}%&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="173" name="TrentTalk" tags="" position="350,2225" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
Trent the horse-man is leaning at the handrail of the bridge and says with a smug grin: &lt;/br&gt;
&lt;p class=&quot;tNPC1&quot;&gt;&quot;There you are again. Are you here for another lesson?&quot;&lt;/p&gt;
&lt;div&gt; [[Leave|ForestBridge]] [[offer him something]] &lt;a0 onclick=&#39;window.gm.encounters.Trent(window.gm.player.location);&#39;&gt;wrestle with him(again)&lt;/a&gt;&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="174" name="VillageEntranceIntro" tags="" position="475,2225" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;!--todo--&gt; A neat little village comes into view as you make your way along the dirtroad.&lt;/br&gt;
Someone has painted &#39;Thetain&#39; on the planks above the wooden gate. Most likely thats the name of this commune.
&#39;I wonder if I can really visit those houses or if they are just scenery of the game.&#39;&lt;/br&gt;
&lt;div&gt;&lt;/br&gt;
[[Continue|VillageMarketPlace]]&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="175" name="VillageEntrance" tags="" position="600,2225" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.moveHere();%&gt;
&lt;!--todo--&gt; You are at the entrance to the town Thetain.
&lt;/br&gt;&lt;/br&gt;
&lt;div&gt;&lt;/br&gt;
[[Enter village|VillageMarketPlace]]  [[go to forest|ForestBridge]]&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="176" name="VillageMarketPlace" tags="" position="725,2225" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.moveHere();%&gt;
&lt;!--todo--&gt; There arent many people around the place right now.&lt;/br&gt; There seems to be a smithy, a general store, a Inn and another shop where you cant say what kind of wares - if any - they are trading.&lt;/br&gt;
&lt;/br&gt; Near the entrance of the Inn is also a [[bulletin-board|VillageBlackboard]]. 
&lt;div&gt;&lt;/br&gt;
[[Gate|VillageEntrance]] [[Inn|VillageInn]] [[Smithy|VillageSmithy]] [[Shop|VillagePawnshop]]&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="177" name="VillageBlackboard" tags="_back_" position="850,2225" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
Some tattered notes are pinned to the board: &lt;/br&gt;
&lt;hr&gt; Farmhand needed &lt;/br&gt; Someone is searching for help with their farm work.&lt;/br&gt; &quot;I&#39;m here for adventure,not boring work !&quot;&lt;/br&gt;
&lt;div&gt;&lt;/br&gt;
[[Leave|_back_]]&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="178" name="VillageInn" tags="" position="975,2225" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.moveHere();%&gt;
&lt;!--todo--&gt; &#39;This really looks like they scavenged that place from a typical fantasy story book.&#39;&lt;/br&gt; 
&lt;div&gt;&lt;/br&gt;
[[Square|VillageMarketPlace]] [[Innkeeper]] &lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt; &lt;/script&gt;</tw-passagedata><tw-passagedata pid="179" name="VillagePawnshop" tags="" position="1100,2225" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.moveHere();%&gt;
&lt;!--todo--&gt; If this is a shop, then they sell everything: Shoes, cooking pans, assault ballista and chicken.&lt;/br&gt; 
&lt;!--todo--&gt;On the other side of the room is a large [[Wardrobe]] with a [[Mirror]] where you can take a look at yourself.
&lt;/br&gt; 
&lt;div&gt;&lt;/br&gt;
[[Square|VillageMarketPlace]]  [[Shopkeeper]]&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="180" name="VillageSmithy" tags="" position="1225,2225" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.moveHere();%&gt;
&lt;!--todo--&gt; If this is a shop, then they sell everything: Shoes, cooking pans, assault ballista and chicken.&lt;/br&gt; 
&lt;!--todo--&gt;On the other side of the room is a large [[Wardrobe]] with a [[Mirror]] where you can take a look at yourself.
&lt;/br&gt; 
&lt;div&gt;&lt;/br&gt;
[[Square|VillageMarketPlace]]  [[Shopkeeper]]&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="181" name="VRSuiteUp" tags="" position="100,2350" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;!--todo--&gt; You are eager to try that virtual reallity game. &lt;/br&gt;
&quot;Welcome to the test version of our new game. Lets just clarify some things about the beta-testing process. In most cases you just have to play the game as you like. We will track your actions and progress to adapt and improve the experience of the finished game.
However, at times you might be requested to do certain things and do it in a certain way.  &lt;/br&gt;
Remember that this is not the final game. We continously modify aspects to get the best experience for the players.&quot;   &lt;/br&gt;
&lt;div&gt;&lt;/br&gt;
[[Start the game|CharacterEditor]]&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="182" name="CharacterEditor" tags="" position="225,2350" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
You say &#39;Create new avatar&#39;. The screen switches to those kind of screens that are common to other RPGs.&lt;/br&gt;
You can select class, race, character-traits and some visual aspects.&lt;/br&gt;
&lt;p class=&quot;tPC&quot;&gt;&#39;Lets see what classes we have...Staff Zealot..never heard of that one  &#39;&lt;/p&gt;
As you try to flip through the classes you got a message &quot;For testing purpose the following condition is applied: character-class and race restricted&quot;&lt;/br&gt;
&lt;p class=&quot;tPC&quot;&gt;&#39;Oh man, I&#39;m stuck with that class? I would at least know what other classes are available.&#39;&lt;/p&gt; 
You try to change race, but find that you are stuck to some kind of elf-boy. 
You can toggle between male and female though the difference between the androgyne male and the female seem just to be some perky but small titts.&lt;/br&gt;
The description of the class is sparse. The picture you see indicates that this class uses a 2-handed staff and light armor. You expect also some magic abilities - its an elf, isn&#39;t it?.&lt;/br&gt;
&lt;p class=&quot;tPC&quot;&gt;&#39;I will choose male. Brad would make fun of me all time if I would choose any other option. On the other hand, it is roleplay right?&#39;&lt;/p&gt;&lt;/br&gt;
&lt;div id=&#39;select1&#39; &gt;
&lt;a0 onclick=&#39;window.gm.printTalkLink($(&quot;div#select1&quot;)[0],&quot;div#choice1a&quot;);window.gm.MutationsLib[&quot;swapGender&quot;](window.gm.player,window.storage.constructors[&quot;PenisHuman&quot;]);&#39;&gt;male&lt;/a&gt;
&lt;a0 onclick=&#39;window.gm.printTalkLink($(&quot;div#select1&quot;)[0],&quot;div#choice1b&quot;);window.gm.MutationsLib[&quot;swapGender&quot;](window.gm.player,window.storage.constructors[&quot;VulvaHuman&quot;]);window.gm.player.Outfit.addItem(window.storage.constructors[&quot;BreastHuman&quot;].factory(&quot;human&quot;));&#39;&gt;female&lt;/a&gt;
&lt;/div&gt;&lt;div id=&#39;choice1a&#39; hidden&gt; You selected male.
&lt;/br&gt;[[Ready|StartLocation]]&lt;/br&gt;
&lt;/div&gt;
&lt;div id=&#39;choice1b&#39; hidden&gt; You selected female.
&lt;/br&gt;[[Ready|StartLocation]]&lt;/br&gt;
&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="183" name="StartLocation" tags="" position="350,2350" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;
window.gm.enterVR();%&gt;
&lt;%window.gm.quests.forceQuestMilestone(&quot;qDiedAgain&quot;,2,1);window.gm.quests.forceQuestMilestone(&quot;qDLCMain&quot;,700,600)%&gt;
&lt;!--todo--&gt; &quot;You magically appear near the top of a hill. &lt;/br&gt;
You can see some hut from here. You just need to follow the trail down the hill.&quot;&lt;/br&gt;
&lt;div&gt;&lt;/br&gt;
[[Settlement|ForestBorder]]&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="184" name="Training1" tags="" position="475,2350" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
&lt;!--todo--&gt; The path snakes down the grassy flanks of the hill. As you make your way around a large boulder, something strange happens:&lt;/br&gt;
&lt;devnote&gt;&quot;Welcome to our little world. Just in case you are not used to that kind of game we should get you some training.&quot;&lt;/devnote&gt;&lt;/br&gt;
&lt;div&gt;&lt;/br&gt;
[[Continue|Training1Done]]&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="185" name="Training1Done" tags="" position="600,2350" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
&lt;!--todo--&gt; &lt;/br&gt;
&lt;devnote&gt;&quot;I wish you good luck in exploring this world. May the gods be with you.&quot;&lt;/devnote&gt;&lt;/br&gt;
&lt;div&gt;&lt;/br&gt;
[[Continue|ForestBorder]]&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="186" name="Dungeon" tags="" position="725,2350" size="100,100">&lt;!--dont &quot;show&quot; this! setup the dungeon and call enterDungeon--&gt;
&lt;!--if not explicitly allowed, save is disabled in dungeon--&gt;
&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%= window.gm.dng.name%&gt;-&lt;%= window.gm.dng.actualRoom.floor.name%&gt;-&lt;%= window.gm.dng.actualRoom.name%&gt;&lt;/br&gt; 
&lt;%= window.gm.dng.actualRoom.descr()%&gt;&lt;%= (window.gm.dng.actualRoom.allowSave?&quot; &lt;b&gt;You can save here !&lt;/b&gt;&quot;:&quot;&quot;)%&gt;&lt;/br&gt;
&lt;%= window.gm.dng.Mapper.printMap( window.gm.dng.actualRoom,true)%&gt;&lt;/br&gt;
&lt;/br&gt; 
&lt;div id=&quot;panel&quot;&gt;&lt;/div&gt;&lt;/br&gt;&lt;/br&gt;    &lt;!--display button list--&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt;
window.gm.dng.printButtons()
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="187" name="DungeonMap" tags="_nosave_" position="850,2350" size="100,100">&lt;!--dont &quot;show&quot; this! setup the dungeon and call displayMap--&gt;
&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%= window.gm.dng.Mapper.printMap( window.gm.dng.actualRoom,false)%&gt;&lt;/br&gt;
&lt;/br&gt; 
[[Back|Dungeon]]
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="188" name="DungeonFoundNothing" tags="_nosave_" position="975,2350" size="100,100">&lt;!--example-scene for onenter/onexit event--&gt;
&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%= window.gm.dng.actualRoom.descr()%&gt;&lt;/br&gt;
There are some buckets here, but there is nothing useful inside.&lt;/br&gt;
&lt;/br&gt;
&lt;a0 onclick=&#39;window.gm.dng.resumeRoom();&#39;&gt;Go on&lt;/a&gt;&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="189" name="DungeonGenericEvent" tags="_nosave_" position="1100,2350" size="100,100">&lt;!--example-scene for operation--&gt;
&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;div id=&#39;panel&#39;&gt;&lt;/div&gt;&lt;!--event is rendered here--&gt;
&lt;%= window.gm.dng.renderEvent(window.gm.dng.evtData)%&gt;&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="190" name="DungeonCrashedThroughFloor" tags="_nosave_" position="1225,2350" size="100,100">&lt;!--example-scene for onenter/onexit event--&gt;
&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%= window.gm.dng.actualRoom.descr()%&gt;&lt;/br&gt;
You crash down through the floor and find yourself back on the lowest level of the area.&lt;/br&gt;
&lt;/br&gt;
&lt;a0 onclick=&#39;crashThrough();&#39;&gt;Go on&lt;/a&gt;&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt;
function crashThrough() {
    var floor1 = window.gm.dng.allFloors()[0];
    var Room = floor1.getRoom(window.gm.dng.actualRoom.name);  //room names are the same at same position of floor
    window.gm.dng.teleport(floor1, Room);
}
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="191" name="NOP_VR" tags="_nosave_,_back_" position="100,2475" size="100,100">&lt;!--example-scene for onenter/onexit event--&gt;
&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;p class=&#39;dev&#39;&gt; You cant go that way. Either because its WIP or you need to solve a quest first. &lt;/p&gt;
&lt;/br&gt;
[[Back|_back_]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="192" name="Home" tags="name:your_dorms_hallway" position="225,2475" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
&lt;%window.gm.quests.addQuest(&quot;qFindGarden&quot;,1);window.gm.quests.addQuest(&quot;qStudy&quot;,1); %&gt;
At the doorsteps of your home. &lt;/br&gt;
The following things are on your schedule-list:&lt;/br&gt;
&lt;%=window.gm.printSchedule()%&gt;
&lt;/br&gt;&lt;/br&gt;&lt;div&gt;Where would you like to go?&lt;/br&gt;
[[Living_Room]]   [[Your Bedroom]]  [[Melanies Bedroom]] [[Kitchen]]  [[Garden]] [[Cellar|NOP]] &lt;/br&gt;
[[Into the city]]&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt;
function checkQuest(){
	if(window.story.state._gm.day&gt;1 &amp;&amp; window.gm.getTimeStruct().hour&gt;12 &amp;&amp; window.gm.quests.hasActiveQuest(&quot;qDLCMain&quot;,100)) {
		window.story.show(&#39;ReceiveVREquipment&#39;);
	}
}
checkQuest();
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="193" name="Kitchen" tags="" position="1231,613" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
You are in the kitchen. &lt;/br&gt;
&lt;%=window.gm.printPickupAndClear(&#39;CanOfCoffee&#39;,&#39;get a can of ice-coffee from the fridge&#39;,s.mom.coffeeStore)%&gt;
&lt;%=window.gm.printPickupAndClear(&#39;SimpleFood&#39;,&#39;eat some food mom prepared&#39;,s.mom.foodStore,function(){window.story.state.mom.foodStore=Math.max(0,--window.story.state.mom.foodStore);})%&gt;
Mom will take care to resupply the fridge. But she might be disappointed if you plunder heir fridge without giving something back.&lt;/br&gt;
&lt;% if(s.mom.location===window.passage.name &amp;&amp; s.mom.foodStore===0) { %&gt;
&#39;Sorry hun&#39; , mom responds on your greeetings, &#39;but if you eat all of the food, cant you take care to get some resupply?&#39; &lt;/br&gt;
&lt;% window.gm.player.gainRelation(&#39;Mom&#39;,-2);
}%&gt;
&lt;% if(s.mom.location===window.passage.name) { %&gt;
[[Mom|Info_Mom]] is here. &lt;/br&gt;
&lt;a href=&quot;javascript:void(0)&quot; onclick=&quot;window.gm.player.gainRelation(&#39;Mom&#39;,2);window.gm.refreshSidePanel();&quot; &gt;Greet her&lt;/a&gt;&lt;/br&gt;&lt;/br&gt;
&lt;%}%&gt;
Where would you like to go?&lt;/br&gt;
[[Living_Room]]   [[Hallway|Home]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="194" name="Melanies Bedroom" tags="" position="475,2475" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
This is the bedroom of Melanie.
A double bed is there with [[nightstands|moms_treasure]] on each side. &lt;br&gt;
&lt;%if(window.gm.player.name!==&#39;Cyril&#39;) {%&gt;
&lt;a0 onclick=&#39;window.story.show(&quot;Talk_Cyril&quot;)&#39;&gt;Cyril is here&lt;/a&gt;&lt;/br&gt;
&lt;%}%&gt;
&lt;a0 onclick=&#39;switchChar(this)&#39;&gt;Switch Char&lt;/a&gt;&lt;/br&gt;
&lt;a0 onclick=&#39;inviteChar(this)&#39;&gt;Invite Char&lt;/a&gt;&lt;/br&gt;
&lt;a0 onclick=&#39;window.gm.pushDeferredEvent(&quot;HairGrow&quot;)&#39;&gt;Hair Tonic&lt;/a&gt;&lt;/br&gt;
[[Hallway|Home]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt;
function switchChar(elmnt) {
	if(window.story.state._gm.activePlayer ===&#39;Cyril&#39;) {
		window.gm.switchPlayer(&#39;PlayerRL&#39;);
	} else {
		window.gm.switchPlayer(&#39;Cyril&#39;);
	}
	elmnt.outerHTML=(&quot;&lt;div class=&#39;red&#39;&gt;You are now playing as &quot;+window.story.state._gm.activePlayer+&quot;. &lt;/div&gt;&quot;);
}
function inviteChar(elmnt) {
	if(window.gm.isInParty(&#39;Cyril&#39;)) {
		window.gm.removeFromParty(&#39;Cyril&#39;);
		elmnt.outerHTML=(&quot;&lt;div class=&#39;red&#39;&gt;You kicked Cyril from your team. &lt;/div&gt;&quot;);
	} else {
		window.gm.addToParty(&#39;Cyril&#39;);
		elmnt.outerHTML=(&quot;&lt;div class=&#39;red&#39;&gt;Cyril added to your team. &lt;/div&gt;&quot;);
	}
}
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="195" name="moms_treasure" tags="_back_" position="600,2475" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
In one of the nightstand you find some handcuffs.They look thorough but you think they just might be used for some bedplay.&lt;/br&gt;
&lt;a0 onclick=&#39;useHandcuff(this)&#39;&gt;Play with them&lt;/a&gt;&lt;/br&gt;
[[Back|_back_]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt;
function useHandcuff(elmnt) {
	window.gm.player.Wardrobe.addItem(new Handcuffs());
	window.gm.player.Outfit.addItem(new Handcuffs());
	elmnt.replaceWith(&quot;&lt;div class=&#39;red&#39;&gt;Playing around with the cuffs you suddenly find yourself locked up with them. You panick as you find the locking-mechanic quite tight. You need a key and maybe some help to unlock them!&lt;/div&gt;&quot;);
}
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="196" name="Your Bedroom" tags="" position="1033,470" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;%window.gm.player.location=window.passage.name; 
window.gm.quests.addQuest(&quot;qMyPleasure&quot;,1);%&gt;
This is your Bedroom.
A desk with a wooden chair is setup as workingplace. &lt;br&gt;
Your [[Laptop|_Laptop_]] is placed on it and also a handwritten [[TODO-List|QuestList]]. &lt;/br&gt;
Above the desk is a window facing toward the backside of the house.&lt;/br&gt;
On the other side of the room is a large [[Wardrobe]] with a [[Mirror]] where you can take a look at yourself.
There is a large bed for sleeping with a nightstand aside. &lt;/br&gt;
&lt;!--todoYou are quite horny right now. Maybe you have some time to [[play with yourself|Masturbate]].&lt;/br&gt;--&gt;
&lt;a href=&quot;javascript:void(0)&quot; onclick=&#39;($(&quot;tw-passage&quot;).fadeOut(1000, function() {window.gm.addTime(60);window.story.show(&quot;Sleep&quot;);}));&#39;&gt;Nap 1hour&lt;/a&gt;
&lt;%if(window.gm.getTimeStruct().hour&lt;11) { %&gt;
&lt;a href=&quot;javascript:void(0)&quot; onclick=&#39;($(&quot;tw-passage&quot;).fadeOut(1000, function() {window.gm.player.sleep(1800);window.story.show(&quot;Sleep&quot;);}));&#39;&gt;Sleep Until Evening&lt;/a&gt; 
&lt;%} else {%&gt;
&lt;a href=&quot;javascript:void(0)&quot; onclick=&#39;($(&quot;tw-passage&quot;).fadeOut(1000, function() {window.gm.player.sleep(700);window.story.show(&quot;Sleep&quot;);}));&#39;&gt;Sleep Until Morning&lt;/a&gt;
&lt;%}%&gt;
&lt;div &lt;%=((window.gm.quests.getMilestoneState(&quot;qDLCMain&quot;).id&lt;600)?&quot;hidden&quot;:&quot;&quot;) %&gt; &gt;That bulky VR-scaffold is taking up a lot of space.  
	&lt;%if(window.gm.getTimeStruct().hour&gt;13){%&gt;
	You could &lt;a0 onclick=&#39;if(window.gm.quests.getMilestoneState(&quot;qDLCMain&quot;).id&lt;700) window.story.show(&quot;VRSuiteUp&quot;); else {window.story.show(&quot;ForestSpawn&quot;)}&#39;&gt;Try to enter the VR&lt;/a&gt;&lt;/br&gt; 
	&lt;%} else {%&gt;
	You have other things to do then play with it.&lt;/br&gt;
	&lt;%}%&gt;
&lt;/div&gt;
&lt;% if(window.gm.player.clothLevel()===&quot;naked&quot;) { %&gt;
&lt;div class=&quot;red&quot;&gt;You should at least cover up your unmentionables before leaving your room.&lt;/div&gt;&lt;/br&gt;
&lt;% } else { %&gt;
Where do you want to go ? &lt;/br&gt;
[[Hallway|Home]]&lt;/br&gt; &lt;%}%&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="197" name="Sleep" tags="" position="850,2475" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
You fall into your bedsheets and sleep until your smartphone buzzes you out of your dreams.&lt;/br&gt;
&lt;/br&gt;&lt;div id=&#39;output&#39;&gt;&lt;/div&gt;
&lt;/br&gt;[[Next|&lt;%=window.gm.player.location%&gt;]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt;
function checkJob() {
	let text =&#39;&#39;;
	if(window.gm.getTimeStruct().DoW===1 &amp;&amp; window.gm.quests.hasActiveQuest(&quot;qFindAJob&quot;,200)) { 
		if(window.gm.quests.getQuestState(&quot;qFindAJob&quot;).flags&gt;=2) { 
			window.gm.player.Inv.addItem(new window.gm.ItemsLib.Money(),window.gm.quests.getQuestState(&quot;qFindAJob&quot;).flags*25);
			text+=&#39;You earned &#39;+window.gm.quests.getQuestState(&quot;qFindAJob&quot;).flags*25+&#39; $ for doing shifts at Harcon Medical.&#39;;
		} else {
			text+=&#39;You didnt do enough shifts at Harcon Medical to earn your minimum pay.&#39;;
		}
		window.gm.quests.getQuestState(&quot;qFindAJob&quot;).flags=0;
	}
	return(text);
}
window.gm.printOutput(checkJob());
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="198" name="Living_Room" tags="" position="975,2475" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
The living room that you share with your mom is sparsely decorated (until now).&lt;/br&gt;
An old wooden table with 4 chairs rests on a wornout green carpet.&lt;/br&gt;
Some money is laying on the table. Maybe mom forgot it there.&lt;/br&gt;
There is a brown couch with a television in front of it. A smaller table with a lamp on it is close by.&lt;/br&gt;
&lt;a0 onclick=&#39;window.gm.pushDeferredEvent(&quot;Deffered1&quot;,[1,2])&#39;&gt;Deffered1&lt;/a&gt;&lt;/br&gt;
&lt;a0 onclick=&#39;window.gm.pushDeferredEvent(&quot;Deffered2&quot;,[4,5])&#39;&gt;Deffered2&lt;/a&gt;&lt;/br&gt;
&lt;a0 onclick=&quot;getMoney(this,5)&quot;&gt;Get much money&lt;/a&gt;&lt;/br&gt;
&lt;%if(window.gm.quests.getMilestoneState(&quot;qFixLaptop&quot;).id&lt;1000){%&gt;
&lt;a0 onclick=&#39;window.gm.quests.forceQuestMilestone(&quot;qFixLaptop&quot;,1000,1);window.gm.refreshAllPanel();&#39;&gt;take powerconverter for laptop&lt;/a&gt;
&lt;%}%&gt;
&lt;%if(s.vars.qDogSit==0x200) {%&gt;
Your phone rings with an unknown number. [[Answer call|Dogsit_FirstCallBack]] 
&lt;%}%&gt;
On one of the shelves is a small statue of a striding cat. &lt;a0 onclick=&quot;touchCatIdol(this)&quot;&gt;inspect cat idol&lt;/a&gt;&lt;/br&gt;
Where would you like to go?&lt;/br&gt;
[[Kitchen]] [[Hallway|Home]] &lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;script&gt;
function getMoney(elmnt,val) {
	let msg=&quot;&lt;/br&gt;You shouldnt steal that money, should you?&quot;;
	let vulva = window.gm.player.Outfit.getItemForSlot(window.gm.OutfitSlotLib.bVulva);
	let pierc = window.gm.player.Outfit.getItemForSlot(window.gm.OutfitSlotLib.pClit);
	if(vulva &amp;&amp; vulva instanceof (window.storage.constructors[&#39;VulvaHuman&#39;])) {
		if(pierc===null ) {
			pierc= new window.gm.ItemsLib[&#39;PiercingClit&#39;]();
			pierc.style =100; 
			window.gm.player.Outfit.addItem(pierc,true);
			msg += &#39;You feel a short pain in your most private area. Maybe you should check up yourself.&#39;;
		} else {
			msg += &#39;You feel a tingling in your nethers where your privates are pierced.&#39;;
		}
	}
	elmnt.replaceWith(msg);
}
function touchCatIdol(elmnt) {
	elmnt.replaceWith(&quot;Its just a simple statue.&quot;); //elmnt.replaceWith(&quot;There is a tickling feeling in your hand.&quot;);
	//window.gm.player.addEffect(&quot;effMutateCat&quot;,window.storage.constructors[&#39;effMutateCat&#39;]());
}
&lt;/script&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="199" name="Cabinet" tags="" position="1100,2475" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
There is nothing here
[[Living_Room]]
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="200" name="Garden" tags="" position="1225,2475" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;window.gm.quests.tick();%&gt;
The garden behind the house is not very large. &lt;/br&gt;
&lt;p class=&quot;tPC&quot;&gt;&#39;There are a lot of molehills on the green. I should teach their creator a lesson.&#39;&lt;/p&gt;&lt;/br&gt;
&lt;a href=&quot;javascript:void(0)&quot; onclick=&#39;window.gm.encounters.moleX2(window.gm.player.location);&#39;&gt;Whack a mole&lt;/a&gt; &lt;/br&gt;
You accidently stepped on a mole and killed it. Achievement unlocked ! &lt;%window.gm.achievements.moleKillerGoldMedal=true;%&gt;
&lt;% if(s.mom.location==window.passage.name) { %&gt;
[[Mom|Info_Mom]] is wandering around. Maybe she is planning to setup some flower beds. &lt;/br&gt;
&lt;%}%&gt;
&lt;a0 id=&#39;SkillTease&#39; onclick=&#39;(function($event){window.gm.player.Skills.addItem(new window.storage.constructors[$event.id]());window.gm.refreshSidePanel();}(this))&#39;&gt;Learn to tease&lt;/a&gt;&lt;/br&gt;&lt;/br&gt;
&lt;% if(window.gm.player.Inv.countItem(&#39;Shovel&#39;)&lt;=0) {%&gt;
&lt;a0 id=&#39;Shovel&#39; onclick=&#39;(function($event){window.gm.player.Inv.addItem(new window.storage.constructors[$event.id]());window.gm.refreshAllPanel();}(this))&#39;&gt;take shovel&lt;/a&gt;&lt;/br&gt;
&lt;%} else {%&gt;
You remeber that you took the shovel from here.&lt;/br&gt;
&lt;%}%&gt;
Where would you like to go?&lt;/br&gt;
[[Hallway|Home]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="201" name="Cellar" tags="" position="100,2600" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
The portal is still active. Do you dare to [[enter|Cellar_Portal]] it? &lt;/br&gt;&lt;/br&gt;
Where would you like to go?&lt;/br&gt;
[[Hallway|Home]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="202" name="Cellar_PortalReverse" tags="" position="225,2600" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
The portal spits you out in the dim light of your cellar.&lt;/br&gt;&lt;/br&gt;
[[Next|Cellar]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="203" name="Cellar_Portal" tags="" position="350,2600" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
A blinding light engulfs you just for a second and then a deafening darkness.  &lt;/br&gt;&lt;/br&gt;
Its impossible to tell what else happens or how long the process takes.&lt;/br&gt;&lt;/br&gt;
As you come back to your senses you find yourself cowering on the floor, still croggy from the experience.&lt;/br&gt;
Time to move on.&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;
Where would you like to go?&lt;/br&gt;
[[Home|Cellar_PortalReverse]] [[Mall|Mall Floor 0 (postapocalypse)]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="204" name="HairGrow" tags="deferred" position="475,2600" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
A blinding light engulfs you just for a second and then a deafening darkness.  &lt;/br&gt;&lt;/br&gt;
Its impossible to tell what else happens or how long the process takes.&lt;/br&gt;&lt;/br&gt;
As you come back to your senses you find yourself cowering on the floor, still croggy from the experience.&lt;/br&gt;
Time to move on.&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;
Where would you like to go?&lt;/br&gt;
[[Next|&lt;%=window.gm.player.location%&gt;]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="205" name="Home_Study" tags="" position="600,2600" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;% window.gm.player.Stats.increment(&#39;energy&#39;,-20);window.gm.addTime(120);window.gm.quests.forceQuestMilestone(&quot;qStudy&quot;,100,1);%&gt;
You sit down with your books and scriblings and try to get some sense out of it.&lt;/br&gt;
[[Give up|&lt;%=window.gm.player.location%&gt;]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="206" name="SC_BarbarianMeetup" tags="_nosave_" position="725,2600" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;!--todo--&gt;
&quot;Hey you, what are you doing here ?&quot;&lt;/br&gt;
- you have to prove yourself to gain their trust&lt;/br&gt;
- they might ignore if you arent a threat&lt;/br&gt;
- they might attack if you attacked them before  &lt;/br&gt;
- if you have high trust, they might share a meal, a drink and even a &quot;good time&quot; with you&lt;/br&gt;
- they might take advantage of you if you dont have a good standing or sense your horniness&lt;/br&gt;
&lt;div&gt; &lt;a0 onclick=&#39;window.gm.dng.resumeRoom();&#39;&gt;Leave&lt;/a&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt;&lt;/script&gt;</tw-passagedata><tw-passagedata pid="207" name="Campus" tags="" position="825,825" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
&lt;%if(!window.gm.quests.hasActiveQuest(&quot;qFindAJob&quot;)){  %&gt;
    As you arrive at the campus you check your purse.&lt;/br&gt;
    &#39;I&#39;m running out of money soon if I dont find some job or other possibilities to earn some. &#39;&lt;/br&gt;
    &lt;a0 onclick=&#39;window.gm.quests.addQuest(&quot;qFindAJob&quot;,1); window.story.show(window.passage.name);&#39;&gt;Mental note to yourself&lt;/a&gt;&lt;/br&gt;
&lt;%} else { %&gt;
    This is the campus of the Institute of Technology and Development.&lt;/br&gt;
    A lot of people are hurrying along or stand by in idle chatter.&lt;/br&gt;
    &lt;!--todo--&gt; In den größeren Gebäuden sind die Vorlesungsräume und Labore der Fachabteilungen untergebracht. &lt;/br&gt;
    Natürlich gibt es eine Mensa und auch ein Archiv bzw. Library. In einem Hochhaus ist die Verwaltung und sonstige Dienste für die Studenten untergebracht.  &lt;/br&gt;
    &lt;/br&gt;
    &lt;a0 onclick=&#39;window.story.show(&quot;attend lecture&quot;)&#39;&gt;Attend a lecture&lt;/a&gt;&lt;/br&gt;
    &lt;div&gt;Where would you like to go?&lt;/br&gt;
    [[Electrical &amp; Mechanical Engineering|NOP]]  [Chemistry &amp; Process Engineering] [Micro-Power &amp; Nano-Engineering] [[Dining Hall]]  [[ITD Office]]  Library &lt;/br&gt;
    [[Into the city]]&lt;/br&gt;&lt;/div&gt; 
&lt;%}%&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="208" name="ITD Office" tags="" position="975,2600" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
This is the office-building of the Institute.&lt;/br&gt;
The [[counsellor|NOP]] might be available to give you some guidance about institutional affairs.&lt;/br&gt;
Here in the lobby of the building is also a [[blackboard]]. Maybe you can find some job offers there or informations about upcoming events. &lt;/br&gt;
&lt;div&gt;&lt;/br&gt;
[[Campus]]&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="209" name="Dining Hall" tags="" position="1100,2600" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
Die Mensa ist wahrscheinlich das beliebteste Gebäude des Campus bei den Studenten; es gibt was zu essen und an kann miteinander quatschen.&lt;/br&gt;
Das Essen ist vielleicht nicht gerade das beste auf der Welt aber dafür ist es recht günstig. Hast du Hunger?&lt;/br&gt;
&lt;div&gt;&lt;/br&gt;
[[Campus]]&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="210" name="blackboard" tags="_back_" position="1225,2600" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
&#39;Lets see if there is anything interesting.&#39;&lt;/br&gt;
&lt;%if(window.gm.quests.hasActiveQuest(&quot;qFindAJob&quot;,1)){%&gt;
There is an announce from Harcon Health Inc. for a [[job|Harcon_Logistic_Ad]] in logistics-department.&lt;/br&gt;
&lt;%}%&gt;
&lt;div&gt;&lt;/br&gt;
[[Back|_back_]]&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="211" name="attend lecture" tags="" position="100,2725" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
todo You attend to lectures all morning.&lt;/br&gt;
&lt;div&gt;&lt;/br&gt;
&lt;a0 onclick=&#39;work()&#39;&gt;You are done for today&lt;/a&gt;&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt;
function work() {
    window.gm.player.Stats.increment(&quot;energy&quot;,-40);
    window.gm.forwardTime(1300);
    window.story.show(&quot;Campus&quot;);
}
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="212" name="Harcon_Logistic_Ad" tags="_back_" position="225,2725" size="100,100">&lt;section&gt;&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
The typewritten note advertises a part-time position in the logistics department.&lt;/br&gt;
&lt;p class=&quot;tPC&quot;&gt;&#39;Logistic doesnt sound that interesting and I doubt that position is targeted to an engineer. But maybe I should show up there in person and see what it is about.&#39;&lt;/p&gt;&lt;/br&gt;
The adress points to be somehwere around downtonw.&lt;/br&gt;
&lt;a0 onclick=&#39;window.gm.quests.forceQuestMilestone(&quot;qFindAJob&quot;,100,1); window.story.show(&quot;ITD Office&quot;);&#39;&gt;Note down the adress&lt;/a&gt;&lt;/br&gt;
&lt;div&gt;&lt;/br&gt;
[[Back|_back_]]&lt;/br&gt;&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="213" name="Harcon_Health" tags="" position="350,2725" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
&lt;%if(window.gm.quests.hasActiveQuest(&quot;qFindAJob&quot;,100)){  %&gt;
    Harcon Health Inc. scheint eine Fabrik oder Lagerhalle zu sein die wie so üblich eingezäunt ist. Du läufst also drumherum bis du ein (geschlossenes) Eingangstor findest.&lt;/br&gt;
    Gleich daneben befindet sich ein Gebäude in Form eines kleinen Glaswürfels das wohl den Torwächter beherbergt.&lt;/br&gt;
    &quot;Hallo?.. uhm Ich bin wegen der Stellenazeige hier.&quot;&lt;/br&gt;
    &quot;Stellenanzeige?...gehts etwas genauer...haben Sie einen Termin?&quot;&lt;/br&gt;
    Harcon Health Inc. seems to be a factory or warehouse that is fenced in as usual. So you walk around it until you find a (closed) entrance gate.&lt;/br&gt;
    Right next to it is a building in the form of a small glass cube that probably houses the gatekeeper.&lt;/br&gt;
    &lt;p class=&quot;tPC&quot;&gt;&quot;Hello? ... I am here because of the job offer.&quot;&lt;/p&gt;&lt;/br&gt;
    &quot;Job offer? Well, can you give some more details? Do you have an appointment?&quot;&lt;/br&gt;
    &lt;div id=&#39;select1&#39; &gt;
    &lt;a0 onclick=&#39;window.gm.printTalkLink($(&quot;div#select1&quot;)[0],&quot;div#choice1a&quot;)&#39;&gt;&quot;Unfortunatly not&quot;&lt;/a&gt;
    &lt;/div&gt;
    &lt;div id=&#39;choice1a&#39; hidden&gt;&lt;/br&gt;
    &lt;p class=&quot;tPC&quot;&gt;No. I just saw that ad on the universitys blackboard about a position in your logistics department. So I wanted to show up as soon as possible to see what it is about... &lt;/p&gt;
    The guard frowns as he hears your rumblings. Clearly he doesnt understand how anyone would bother him WITHOUT having setup an appointment.&lt;/br&gt;
    Then he grunt&#39;s because another huge load seems to be put onto his shoulders. He thoughtfully picks up the phone and calls someone.&lt;/br&gt;
    &quot;Yes, hello Elfred this is Frank from the gate. Here is a young man that asks about a position in your department do you know that..&quot;&lt;/br&gt;
    ...&lt;/br&gt;
    &quot;No, he says he is from university and saw an add there.....no, he hasnt bothered for an appointment...&quot;&lt;/br&gt;
    You cringe internally when he says &#39;bothered&#39;. Somehow you know it was lazzy to just come here without announcing yourself before.&lt;/br&gt;
    The guard places the phone back on its holder and looks at you.&lt;/br&gt;
    &quot;So listen, Mr.Erichson , a groupleader from logistics will speak to you. I will let you in. But just that you know there are cameras all over the place and I will see if you try anything stupid.&quot;&lt;/br&gt;
    &lt;p class=&quot;tPC&quot;&gt;&quot;Thank you..of course I will behave myself. So where do I need to go.&quot;&lt;/p&gt;
    &quot;That door other there&quot; he point at a metal door next to a loading ramp &quot;and just right through. There are some office-doors, one of them has his name on it - Erichson.&quot;&lt;/br&gt;
    After a moment where you try to memorize the name he asks mockingly &quot;You can read?&quot;&lt;/br&gt;
    &lt;span class=&quot;tPC&quot;&gt;&#39;Of course I an read you asshole, I&#39;m from university&#39;&lt;/span&gt; - well thats what came into your mind but you just say &lt;span class=&quot;tPC&quot;&gt;&quot;Sure&quot;&lt;/span&gt;&lt;/br&gt;
    He buzzes you through the revolving door adjoining the car gate and you walk to Mr. Erichsons office.&lt;/br&gt;
    &lt;div&gt;&lt;/br&gt;[[Go to logistics|Harcon_Logistic_Intro]]&lt;/br&gt;&lt;/div&gt;
    &lt;/div&gt; 
&lt;% } else {%&gt;
    This seems to be some kind of factory. You have no business here.&lt;/br&gt;
    &lt;div&gt;&lt;/br&gt;[[Downtown]]&lt;/br&gt;&lt;/div&gt;
&lt;%}%&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="214" name="Harcon_Logistic_Intro" tags="" position="475,2725" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
...!--todo--

&quot;Actually Carl needs only some help here and there, so this is only a parttime-job.&quot;&lt;/br&gt;
&quot;If you work at least 2 shifts a week here, you will get 25$ the shift every week.&quot;&lt;/br&gt;
&quot;So, do you want the job?&quot; he looks at you.&lt;/br&gt;
&lt;div id=&#39;select1&#39; &gt;
&lt;a0 onclick=&#39;window.gm.printTalkLink($(&quot;div#select1&quot;)[0],&quot;div#choice1a&quot;, function(){window.gm.quests.forceQuestMilestone(&quot;qFindAJob&quot;,200,100);})&#39;&gt;&quot;Yes, of course.&quot;&lt;/a&gt;
&lt;a0 onclick=&#39;window.gm.printTalkLink($(&quot;div#select1&quot;)[0],&quot;div#choice1b&quot;)&#39;&gt;&quot;I have to think about it&quot;&lt;/a&gt;
&lt;/div&gt;
&lt;div id=&#39;choice1a&#39; hidden&gt;&lt;/br&gt;
    You shake hands to make the deal and you are quite proud of yourself that you got your first employment in a smooth move.&lt;/br&gt;
    &quot;Please remember to be here on time !&quot; are the final words Mr.Erichson as he sees you off.&lt;/br&gt; 
    [[Next|Downtown]]&lt;/br&gt; 
&lt;/div&gt;
&lt;div id=&#39;choice1b&#39; hidden&gt;&lt;/br&gt;
    Mr. Erichson looks quite disappointed.  &lt;/br&gt;
    [[Next|Downtown]]&lt;/br&gt; 
&lt;/div&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="215" name="Harcon_work" tags="" position="600,2725" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;)%&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
&lt;%if(window.gm.quests.hasActiveQuest(&quot;qFindAJob&quot;,200)){  %&gt;
    --todo--  You work your first shift and get stuff explained.&lt;/br&gt;
&lt;% } else {%&gt;
    --todo--Work a shift.&lt;/br&gt;
&lt;%}%&gt;
&lt;a0 onclick=&#39;work()&#39;&gt;Finish the shift&lt;/a&gt;&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt;
function work() {
    window.gm.addTime(4*60);
    window.gm.player.Stats.increment(&quot;energy&quot;,-40);
    window.gm.quests.getQuestState(&quot;qFindAJob&quot;).flags+=1;
    window.story.show(&quot;Downtown&quot;);
}
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="216" name="Mall Floor 0" tags="" position="1250,850" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
You are actually at [[&lt;%=window.gm.player.location%&gt;]].&lt;/br&gt;
As you wander around you find a [[Bookstore]], a fine grocerie , [[Boots and Shoes]].&lt;/br&gt;
If you need some tools for your hobby you should check the [[craft store]].&lt;/br&gt;
There are also [[Restrooms]].&lt;/br&gt;
&lt;div id=&quot;choice&quot;&gt;&lt;/div&gt;&lt;/br&gt;&lt;/br&gt;   &lt;!--display buy message--&gt;
&lt;div id=&quot;panel&quot;&gt;&lt;/div&gt;&lt;/br&gt;&lt;/br&gt;    &lt;!--display wares list--&gt;
Where would you like to go from here?&lt;/br&gt;
[[Mall 1F|Mall Floor 1]]
[[Mall -1F|Mall Floor -1]]
[[Exit|Into the city]]
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;
&lt;script&gt;
var _Entrys = [];
_Entrys.push({id:&quot;Lube&quot;,count:10,cost:4,costPerv:10});
_Entrys.push({id:&quot;Battery&quot;,count:4,cost:4,costPerv:0});
_Entrys.push({id:&quot;Dildo_small&quot;,count:1,cost:25,costPerv:14});
renderToSelector(&quot;#panel&quot;, &quot;listbuy&quot;); 
&lt;/script&gt;</tw-passagedata><tw-passagedata pid="217" name="Mall Floor 1" tags="" position="1125,850" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
&lt;%window.gm.printShopBuyEntry(&quot;Lube&quot;,4,cbCanBuy=(function(itemid){return window.gm.cbCanBuyPerverse(itemid,15,10)}),cbPostBuy=(function(itemid){window.gm.defaultPostBuy(itemid,15)}))%&gt;
&lt;%window.gm.printShopBuyEntry(&quot;Batteries&quot;,40,cbCanBuy=(function(itemid){return window.gm.defaultCanBuy(itemid,6)}),cbPostBuy=(function(itemid){window.gm.defaultPostBuy(itemid,6)}))%&gt;
You are actually at [[&lt;%=window.gm.player.location%&gt;]].&lt;/br&gt;
Several snack bars and smaller shops are cirling around the wall side of the mall.&lt;/br&gt; 
One of them is [[Alice treasures]], a place where women can buy more private cloths.&lt;/br&gt;
In a more shady corner you find a shop whose windows are just coverd with dark red and black foils. 
Its name is &#39;Adult books and tools&#39; and there is an &quot;adults only&quot; sign at the entrance.&lt;/br&gt;
if(window.gm.player.Stats.get(&#39;corruption&#39;).value&lt;=10) {%&gt;
&lt;p class=&#39;tPC&#39;&gt;No way I&#39;m going in to that smut-shop. Only perverts do that. &lt;/p&gt;
&lt;%} else {%&gt; [[Adult books and tools]] &lt;/br&gt; &lt;%} %&gt;
Where would you like to go from here?&lt;/br&gt;
[[Mall 0F|Mall Floor 0]]
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="218" name="Mall Floor -1" tags="" position="1000,825" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
You are actually at [[&lt;%=window.gm.player.location%&gt;]].&lt;/br&gt;
This level of the mall seems to be reserved for the less fancy business. &lt;/br&gt; 
Most of the space is occupied by the usual [[electronics store]] and a [[food store]].
Where would you like to go from here?&lt;/br&gt;
[[Mall 0F|Mall Floor 0]]
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="219" name="Adult books and tools" tags="" position="1025,650" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
You are actually at [[&lt;%=window.gm.player.location%&gt;]].&lt;/br&gt;
Various Items are on sale: &lt;/br&gt;
&lt;div id=&quot;choice&quot;&gt;&lt;/div&gt;
&lt;a href=&quot;javascript:void(0)&quot; id=&quot;lube&quot; onclick=&#39;choice(this,&quot;div#choice&quot;)&#39;&gt;Lube&lt;/a&gt;&lt;/br&gt;
if(window.gm.player.Stats.get(&#39;corruption&#39;).value&lt;=15) {%&gt;
No way I&#39;m going in to that smut-shop. Only perverts do that. &lt;/br&gt;
&lt;%} else {%&gt;
&lt;%} %&gt;
Where would you like to go from here?&lt;/br&gt;
[[Mall 0F|Mall Floor 0]]
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="220" name="Buy" tags="_back_" position="850,350" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;

[[Back|_back_]]&lt;/br&gt;
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="221" name="Mall Floor 0 (postapocalypse)" tags="" position="100,2850" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
You are actually at [[&lt;%=window.gm.player.location%&gt;]].&lt;/br&gt;
You could try to dig through the rubble in the demolished shops. But you doubt that there is much useful left worth to [[scavenge|Mall_scavenge]]. &lt;/br&gt;
The door to the [[Restrooms]] was torn by brute force.&lt;/br&gt;

Where would you like to go from here?&lt;/br&gt;
[[Mall 1F|Mall Floor 1 (postapocalypse)]]
The stairway to the lower floor is blocked by parts of the building that fell down from top. But there might be other options to get there. &lt;/br&gt; 
[[Exit|Into the city]]
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="222" name="Mall Floor 1 (postapocalypse)" tags="" position="225,2850" size="100,100">&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;

Where would you like to go from here?&lt;/br&gt;
[[Mall 0F|Mall Floor 0]]
&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;

[[Mall_scavenge]]
&lt;section&gt; 
&lt;aside id=&quot;sidebar&quot;&gt;&lt;/aside&gt;&lt;article&gt;&lt;%=window.story.render(&quot;CenterDialogs&quot;) %&gt;
&lt;%window.gm.player.location=window.passage.name;%&gt;
You are on the hunt for useful resources as...
&lt;a href=&quot;javascript:void(0)&quot; onclick=&#39;window.gm.encounters.mole(window.gm.player.location);&#39;&gt;Next&lt;/a&gt; &lt;/br&gt;

&lt;/article&gt;&lt;article id=&quot;LogPanel&quot;&gt;&lt;/article&gt;&lt;/section&gt;</tw-passagedata><tw-passagedata pid="223" name="skCooking" tags="" position="825,625" size="100,100">You can create tasty meals from basic ingredients. No need to rely on fastfood.
[[Back|&lt;%=window.gm.player.location%&gt;]]</tw-passagedata><tw-passagedata pid="224" name="skSporty" tags="" position="725,625" size="100,100">You like to do sports.
[[Back|&lt;%=window.gm.player.location%&gt;]]</tw-passagedata><tw-passagedata pid="225" name="skTechy" tags="" position="825,525" size="100,100">Tinkering and repairing gadgets is your thing.
[[Back|&lt;%=window.gm.player.location%&gt;]]</tw-passagedata><tw-passagedata pid="226" name="skMoneymaker" tags="" position="725,525" size="100,100">You often find ways to increase your profit a little bit.
[[Back|&lt;%=window.gm.player.location%&gt;]]</tw-passagedata><tw-passagedata pid="227" name="Start" tags="" position="850,2850" size="100,100">Select a Link:
&lt;ul&gt;
    &lt;li&gt;[[_SuperSimpleStory_]]&lt;/li&gt;
	&lt;li&gt;[[_ImagesAndOtherMedia_]]&lt;/li&gt;
    &lt;li&gt;[[_VariablesAndScript_]]&lt;/li&gt;
	&lt;li&gt;[[_ControlElements_]]&lt;/li&gt;
    &lt;li&gt;[[_Inventory_]]&lt;/li&gt;
    &lt;li&gt;[[_SaveAndRestore_]]&lt;/li&gt;
    &lt;li&gt;[[StartPage]]&lt;/li&gt;
&lt;/ul&gt;</tw-passagedata><tw-passagedata pid="228" name="NewGamePlus" tags="" position="975,2850" size="100,100">You finished the game in some way but maybe you have missed something. &lt;/br&gt;
Would you like to start a new game while taking some of your equipment/skills with you?&lt;/br&gt;
&lt;a0 onclick=&#39;window.gm.newGamePlus()&#39;&gt;Start new game plus&lt;/a&gt;&lt;/br&gt;</tw-passagedata><tw-passagedata pid="229" name="TowerOfKinks" tags="" position="1100,2850" size="100,100">ClitPiercing of Stamina

resistance to   poisoned air, slime, cold

reduce energy drain of 2 items by 1
reduce hunger by 2 but increases thirst by 1

amplifies all items with cold resistance by 33%

reduces mallus-effects from items on legs by 25% 

improves charisma by 2

improves energy-regeneration by 2/h

for each piercing, add 2 to energy-regeneration

improves appearane to bondage-inclined foes but induces bondage-fetish

slowly increaes milk-fetish when worn visible

increases relation to lupines by 1

increases chance to sneak around an enemy 

increases chance of valuables in loot

increases chance of items with stronger effects (good or bad)

requires masochism-fetish of 10

requires 1 energy/h to work

trader to buy tools, items and food
librarian to identify hidden item-enchantments or remove curse
artesan to unlock items, improve items, repair items
medic to remove parasites and addiction, create potions
campfire to rest, fasttravel, storage-chest

every third dungeon is handdrawn and has boss
other dungeons are randomized with same theme like boss-level

you can revisit boss-levels; foe-respawn after 48h

castle:
    archer, knight, nun
    boss: gryphon

desert: hot, dry, quicksand, sandstorm
    naga, cheetah, lizardman
    boss: 

forest: 
    dryad, hunter, wolf
    boss: witch

caves: cold, wet, slippery, dark
    slime, imp, gnoll

jungle: hot, humid, poisonous
    panther, giant-snake, raptor

laboratory: chemicals
    tentacle, golem, alchemmist

pyramids: chaste
    priest, acolythe, anubis, scarab

underworld:
    succubus, hellhound,</tw-passagedata><tw-passagedata pid="230" name="SucubusTrade" tags="" position="1225,2850" size="100,100">&quot;I could help you and increase the size of your load.&quot;
&quot;Whats the catch?&quot;
Your apple-sized gonads are heavy with spunk. Staying blueballed like this might set you at risk to give in to the next person offering you a good fuck.

Even while they are full to the brim, your sperm glands still run their curse, adding more spunk to your swollen scrotum. Your balls have enlarged again and their size and wheight now matches grapefruits.
How much further ould they grow?

After delivering quite a load, your gonads can ease up and shrink back a bit.

Try as you might, but masturbating might get you riled up but you ant sent yourself over the edge. You need a real fuck to find release.</tw-passagedata></tw-storydata>
		<script>
		(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";window.either=function(){for(var n=[],t=0;t<arguments.length;t++)if(arguments[t]instanceof Array)for(var r=0;r<arguments[t].length;r++)n.push(arguments[t][r]);else n.push(arguments[t]);return n[_.random(n.length-1)]},window.hasVisited=function(){var n=null;if(1===arguments.length)return null!=(n=window.story.passage(arguments[0]))&&window.story.history.includes(n.id);for(var t=0;t<arguments.length;t++)if(null===(n=window.story.passage(arguments[t]))||!1===window.story.history.includes(n.id))return!1;return!0},window.visited=function(){for(var n=[],t=[],r=0;r<arguments.length;r++){var e=window.story.passage(arguments[r]);null!==e&&(t=window.story.history.filter(function(n){return n===e.id})),n.push(t.length)}return Math.min.apply(Math,n)},window.renderToSelector=function(n,t){var r=window.story.passage(t);null!==r&&$(n).html(r.render())},window.getStyles=function(){return $.when.apply($,$.map(arguments,function(n){return $.get(n,function(n){$("<style>"+n+"</style>").appendTo("head")})}))};

},{}],2:[function(require,module,exports){
"use strict";function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var a=0;a<r.length;a++){var t=r[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function _createClass(e,r,a){return r&&_defineProperties(e.prototype,r),a&&_defineProperties(e,a),e}var Passage=function(){function e(r,a,t,s){if(_classCallCheck(this,e),"undefined"==typeof $||null===$)throw new Error("Global '$' not defined!");if("undefined"==typeof _||null===_)throw new Error("Global '_' not defined!");if("undefined"==typeof marked||null===marked)throw new Error("Global 'marked' not defined!");this.id=r||1,this.name=a||"Default",this.tags=t||[],this.source=_.unescape(s)}return _createClass(e,[{key:"render",value:function(e){null==e&&(e=this.source);var r="";try{r=_.template(e)({s:window.story.state,$:$})}catch(e){$.event.trigger("sm.story.error",[e,"Passage.render() using _.template()"])}function a(e){for(var r="",a=0;"-"===e[a]||"0"===e[a];a++)switch(e[a]){case"-":r+='style="display:none" ';break;case"0":r+='href="javascript:void(0)" '}for(var t=[],s=null,n=/([#\.])([^#\.]+)/g,i=n.exec(e);null!==i;){switch(i[1]){case"#":s=i[2];break;case".":t.push(i[2])}i=n.exec(e)}return null!==s&&(r+='id="'+s+'" '),t.length>0&&(r+='class="'+t.join(" ")+'"'),r.trim()}r=(r=(r=r.replace(/<([a-z]+)([\.#\-0].*?)(?=[\s>])/gi,function(e,r,t){return"<"+r+" "+a(t)})).replace(/\[\[(.*?)\]\]\{(.*?)\}/g,function(e,r,t){var s=r,n=r.indexOf("|");if(-1!==n)s=r.substr(0,n),r=r.substr(n+1);else{var i=r.indexOf("->");if(-1!==i)s=r.substr(0,i),r=r.substr(i+2);else{var o=r.indexOf("<-");-1!==o&&(s=r.substr(o+2),r=r.substr(0,o))}}return null!==window.story.passage(r)?'<a href="javascript:void(0)" data-passage="'+r+'" '+a(t)+">"+s+"</a>":'<a href="javascript:void(0)" data-passage="'+r+'" '+a(t)+'" style="text-decoration: line-through double red;">!!!'+s+"!!!</a>"})).replace(/\[\[(.*?)\]\]/g,function(e,r){var a=r,t=r.indexOf("|");if(-1!==t)a=r.substr(0,t),r=r.substr(t+1);else{var s=r.indexOf("->");if(-1!==s)a=r.substr(0,s),r=r.substr(s+2);else{var n=r.indexOf("<-");-1!==n&&(a=r.substr(n+2),r=r.substr(0,n))}}return null!==window.story.passage(r)?'<a href="javascript:void(0)" data-passage="'+r+'">'+a+"</a>":'<a href="javascript:void(0)" data-passage="'+r+'" style="text-decoration: line-through double red;">!!!'+a+"!!!</a>"});var t=new marked.Renderer;t.code=function(e){return e},marked.setOptions({smartypants:!0,renderer:t});var s=marked(r);return!r.endsWith("</p>\n")&&s.endsWith("</p>\n")&&(s=s.replace(/^<p>|<\/p>$|<\/p>\n$/g,"")),s}}]),e}();module.exports=Passage;

},{}],3:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var s=0;s<e.length;s++){var r=e[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,s){return e&&_defineProperties(t.prototype,e),s&&_defineProperties(t,s),t}var LZString=require("lz-string"),Passage=require("./Passage.js"),Story=function(){function Story(t){var e=this;if(_classCallCheck(this,Story),"undefined"==typeof $||null===$)throw new Error("Global $ not defined!");if("undefined"==typeof _||null===_)throw new Error("Global _ not defined!");this.dataEl=t,this.name=this.dataEl.attr("name"),this.startPassage=parseInt(this.dataEl.attr("startnode")),this.creator=this.dataEl.attr("creator"),this.creatorVersion=this.dataEl.attr("creator-version"),this.history=[],this.state={},this.checkpointName="",this.ignoreErrors=!1,this.errorMessage="",this.atCheckpoint=!1,this.passages=[];var s=[];t.children("tw-passagedata").each(function(){var t=$(this),e=parseInt(t.attr("pid")),r=t.attr("tags");s[e]=new Passage(e,t.attr("name"),""!==r&&void 0!==r?r.split(" "):[],t.html())}),this.passages=s,this.userScripts=[],$('*[type="text/twine-javascript"]').each(function(t,s){e.userScripts.push($(s).html())}),this.userStyles=[],$('*[type="text/twine-css"]').each(function(t,s){e.userStyles.push($(s).html())}),window.onerror=function(t,e,s,r,a){$.event.trigger("sm.story.error",[a,"Browser"])},$(window).on("sm.story.error",function(t,s,r){e.errorMessage="In "+r+": "+s.name+": "+s.stack,!1===e.ignoreErrors&&$("tw-story").html(e.errorMessage)})}return _createClass(Story,[{key:"start",value:function start(el){var _this2=this;this.$el=$(el),this.$passageEl=$('<tw-passage class="passage" aria-live="polite"></tw-passage>'),this.$el.append(this.$passageEl),$(window).on("popstate",function(t){var e=t.originalEvent.state;e?(_this2.state=e.state,_this2.history=e.history,_this2.checkpointName=e.checkpointName,_this2.show(_this2.history[_this2.history.length-1],!0)):_this2.history.length>1&&(_this2.state={},_this2.history=[],_this2.checkpointName="",_this2.show(_this2.startPassage,!0))}),$(window).on("hashchange",function(){_this2.restore(window.location.hash.replace("#",""))}),this.userStyles.forEach(function(t){_this2.$el.append("<style>"+t+"</style>")}),this.userScripts.forEach(function(script){try{eval(script)}catch(t){$.event.trigger("sm.story.error",[t,"Story JavaScript Eval()"])}}),this.$el.on("click","a[data-passage]",function(t){_this2.show(_.unescape($(t.target).closest("[data-passage]").data("passage")))}),$.event.trigger("sm.story.started",{story:this}),""!==window.location.hash&&this.restore(window.location.hash.replace("#",""))||(this.show(this.startPassage),this.atCheckpoint=!0)}},{key:"passage",value:function(t){var e=null;if(_.isNumber(t))t<this.passages.length&&(e=this.passages[t]);else if(_.isString(t)){var s=this.passages.filter(function(e){return e.name===t});0!==s.length&&(e=s[0])}return e}},{key:"show",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=this.passage(t);if(null===s)throw new Error('There is no passage with the ID or name "'+t+'"');if(this.$passageEl.trigger("sm.passage.hidden",{passage:window.passage}),this.$passageEl.trigger("sm.passage.showing",{passage:s}),!1===e){this.history.push(s.id);try{this.atCheckpoint?window.history.pushState({state:this.state,history:this.history,checkpointName:this.checkpointName},"",""):window.history.replaceState({state:this.state,history:this.history,checkpointName:this.checkpointName},"","")}catch(t){$.event.trigger("sm.checkpoint.failed",{error:t})}$.event.trigger("sm.checkpoint.added",{name:t})}window.passage=s,this.atCheckpoint=!1;try{this.$passageEl.html(s.render())}catch(t){$.event.trigger("sm.story.error",[t,"Story.show()"])}this.$passageEl.trigger("sm.passage.shown",{passage:s})}},{key:"render",value:function(t){var e=this.passage(t);if(!e)throw new Error("There is no passage with the ID or name "+t);return e.render()}},{key:"checkpoint",value:function(t){void 0!==t?(document.title=this.name+": "+t,this.checkpointName=t):this.checkpointName="",this.atCheckpoint=!0,$.event.trigger("sm.checkpoint.adding",{name:t})}},{key:"save",value:function(t){window.location.hash=t,$.event.trigger("sm.story.saved")}},{key:"saveHash",value:function(){return LZString.compressToBase64(JSON.stringify({state:this.state,history:this.history,checkpointName:this.checkpointName}))}},{key:"restore",value:function(t){try{var e=JSON.parse(LZString.decompressFromBase64(t));this.state=e.state,this.history=e.history,this.checkpointName=e.checkpointName,this.show(this.history[this.history.length-1],!0)}catch(t){return $.event.trigger("sm.restore.failed",{error:t}),!1}return $.event.trigger("sm.restore.success"),!0}}]),Story}();module.exports=Story;

},{"./Passage.js":2,"lz-string":312}],4:[function(require,module,exports){
"use strict";var polyfill=require("@babel/polyfill"),$=window.$=window.jQuery=require("jquery"),_=window._=require("underscore"),marked=window.marked=require("marked"),Story=window.Story=require("./Story.js"),Passage=window.Passage=require("./Passage.js");require("./Misc.js"),$(function(){window.story=new Story($("tw-storydata")),window.story.start($("tw-story"))});

},{"./Misc.js":1,"./Passage.js":2,"./Story.js":3,"@babel/polyfill":5,"jquery":311,"marked":313,"underscore":315}],5:[function(require,module,exports){
"use strict";require("./noConflict");var _global=_interopRequireDefault(require("core-js/library/fn/global"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}_global.default._babelPolyfill&&"undefined"!=typeof console&&console.warn&&console.warn("@babel/polyfill is loaded more than once on this page. This is probably not desirable/intended and may have consequences if different versions of the polyfills are applied sequentially. If you do need to load the polyfill more than once, use @babel/polyfill/noConflict instead to bypass the warning."),_global.default._babelPolyfill=!0;

},{"./noConflict":6,"core-js/library/fn/global":19}],6:[function(require,module,exports){
"use strict";require("core-js/es6"),require("core-js/fn/array/includes"),require("core-js/fn/array/flat-map"),require("core-js/fn/string/pad-start"),require("core-js/fn/string/pad-end"),require("core-js/fn/string/trim-start"),require("core-js/fn/string/trim-end"),require("core-js/fn/symbol/async-iterator"),require("core-js/fn/object/get-own-property-descriptors"),require("core-js/fn/object/values"),require("core-js/fn/object/entries"),require("core-js/fn/promise/finally"),require("core-js/web"),require("regenerator-runtime/runtime");

},{"core-js/es6":7,"core-js/fn/array/flat-map":8,"core-js/fn/array/includes":9,"core-js/fn/object/entries":10,"core-js/fn/object/get-own-property-descriptors":11,"core-js/fn/object/values":12,"core-js/fn/promise/finally":13,"core-js/fn/string/pad-end":14,"core-js/fn/string/pad-start":15,"core-js/fn/string/trim-end":16,"core-js/fn/string/trim-start":17,"core-js/fn/symbol/async-iterator":18,"core-js/web":310,"regenerator-runtime/runtime":314}],7:[function(require,module,exports){
require("../modules/es6.symbol"),require("../modules/es6.object.create"),require("../modules/es6.object.define-property"),require("../modules/es6.object.define-properties"),require("../modules/es6.object.get-own-property-descriptor"),require("../modules/es6.object.get-prototype-of"),require("../modules/es6.object.keys"),require("../modules/es6.object.get-own-property-names"),require("../modules/es6.object.freeze"),require("../modules/es6.object.seal"),require("../modules/es6.object.prevent-extensions"),require("../modules/es6.object.is-frozen"),require("../modules/es6.object.is-sealed"),require("../modules/es6.object.is-extensible"),require("../modules/es6.object.assign"),require("../modules/es6.object.is"),require("../modules/es6.object.set-prototype-of"),require("../modules/es6.object.to-string"),require("../modules/es6.function.bind"),require("../modules/es6.function.name"),require("../modules/es6.function.has-instance"),require("../modules/es6.parse-int"),require("../modules/es6.parse-float"),require("../modules/es6.number.constructor"),require("../modules/es6.number.to-fixed"),require("../modules/es6.number.to-precision"),require("../modules/es6.number.epsilon"),require("../modules/es6.number.is-finite"),require("../modules/es6.number.is-integer"),require("../modules/es6.number.is-nan"),require("../modules/es6.number.is-safe-integer"),require("../modules/es6.number.max-safe-integer"),require("../modules/es6.number.min-safe-integer"),require("../modules/es6.number.parse-float"),require("../modules/es6.number.parse-int"),require("../modules/es6.math.acosh"),require("../modules/es6.math.asinh"),require("../modules/es6.math.atanh"),require("../modules/es6.math.cbrt"),require("../modules/es6.math.clz32"),require("../modules/es6.math.cosh"),require("../modules/es6.math.expm1"),require("../modules/es6.math.fround"),require("../modules/es6.math.hypot"),require("../modules/es6.math.imul"),require("../modules/es6.math.log10"),require("../modules/es6.math.log1p"),require("../modules/es6.math.log2"),require("../modules/es6.math.sign"),require("../modules/es6.math.sinh"),require("../modules/es6.math.tanh"),require("../modules/es6.math.trunc"),require("../modules/es6.string.from-code-point"),require("../modules/es6.string.raw"),require("../modules/es6.string.trim"),require("../modules/es6.string.iterator"),require("../modules/es6.string.code-point-at"),require("../modules/es6.string.ends-with"),require("../modules/es6.string.includes"),require("../modules/es6.string.repeat"),require("../modules/es6.string.starts-with"),require("../modules/es6.string.anchor"),require("../modules/es6.string.big"),require("../modules/es6.string.blink"),require("../modules/es6.string.bold"),require("../modules/es6.string.fixed"),require("../modules/es6.string.fontcolor"),require("../modules/es6.string.fontsize"),require("../modules/es6.string.italics"),require("../modules/es6.string.link"),require("../modules/es6.string.small"),require("../modules/es6.string.strike"),require("../modules/es6.string.sub"),require("../modules/es6.string.sup"),require("../modules/es6.date.now"),require("../modules/es6.date.to-json"),require("../modules/es6.date.to-iso-string"),require("../modules/es6.date.to-string"),require("../modules/es6.date.to-primitive"),require("../modules/es6.array.is-array"),require("../modules/es6.array.from"),require("../modules/es6.array.of"),require("../modules/es6.array.join"),require("../modules/es6.array.slice"),require("../modules/es6.array.sort"),require("../modules/es6.array.for-each"),require("../modules/es6.array.map"),require("../modules/es6.array.filter"),require("../modules/es6.array.some"),require("../modules/es6.array.every"),require("../modules/es6.array.reduce"),require("../modules/es6.array.reduce-right"),require("../modules/es6.array.index-of"),require("../modules/es6.array.last-index-of"),require("../modules/es6.array.copy-within"),require("../modules/es6.array.fill"),require("../modules/es6.array.find"),require("../modules/es6.array.find-index"),require("../modules/es6.array.species"),require("../modules/es6.array.iterator"),require("../modules/es6.regexp.constructor"),require("../modules/es6.regexp.exec"),require("../modules/es6.regexp.to-string"),require("../modules/es6.regexp.flags"),require("../modules/es6.regexp.match"),require("../modules/es6.regexp.replace"),require("../modules/es6.regexp.search"),require("../modules/es6.regexp.split"),require("../modules/es6.promise"),require("../modules/es6.map"),require("../modules/es6.set"),require("../modules/es6.weak-map"),require("../modules/es6.weak-set"),require("../modules/es6.typed.array-buffer"),require("../modules/es6.typed.data-view"),require("../modules/es6.typed.int8-array"),require("../modules/es6.typed.uint8-array"),require("../modules/es6.typed.uint8-clamped-array"),require("../modules/es6.typed.int16-array"),require("../modules/es6.typed.uint16-array"),require("../modules/es6.typed.int32-array"),require("../modules/es6.typed.uint32-array"),require("../modules/es6.typed.float32-array"),require("../modules/es6.typed.float64-array"),require("../modules/es6.reflect.apply"),require("../modules/es6.reflect.construct"),require("../modules/es6.reflect.define-property"),require("../modules/es6.reflect.delete-property"),require("../modules/es6.reflect.enumerate"),require("../modules/es6.reflect.get"),require("../modules/es6.reflect.get-own-property-descriptor"),require("../modules/es6.reflect.get-prototype-of"),require("../modules/es6.reflect.has"),require("../modules/es6.reflect.is-extensible"),require("../modules/es6.reflect.own-keys"),require("../modules/es6.reflect.prevent-extensions"),require("../modules/es6.reflect.set"),require("../modules/es6.reflect.set-prototype-of"),module.exports=require("../modules/_core");

},{"../modules/_core":56,"../modules/es6.array.copy-within":158,"../modules/es6.array.every":159,"../modules/es6.array.fill":160,"../modules/es6.array.filter":161,"../modules/es6.array.find":163,"../modules/es6.array.find-index":162,"../modules/es6.array.for-each":164,"../modules/es6.array.from":165,"../modules/es6.array.index-of":166,"../modules/es6.array.is-array":167,"../modules/es6.array.iterator":168,"../modules/es6.array.join":169,"../modules/es6.array.last-index-of":170,"../modules/es6.array.map":171,"../modules/es6.array.of":172,"../modules/es6.array.reduce":174,"../modules/es6.array.reduce-right":173,"../modules/es6.array.slice":175,"../modules/es6.array.some":176,"../modules/es6.array.sort":177,"../modules/es6.array.species":178,"../modules/es6.date.now":179,"../modules/es6.date.to-iso-string":180,"../modules/es6.date.to-json":181,"../modules/es6.date.to-primitive":182,"../modules/es6.date.to-string":183,"../modules/es6.function.bind":184,"../modules/es6.function.has-instance":185,"../modules/es6.function.name":186,"../modules/es6.map":187,"../modules/es6.math.acosh":188,"../modules/es6.math.asinh":189,"../modules/es6.math.atanh":190,"../modules/es6.math.cbrt":191,"../modules/es6.math.clz32":192,"../modules/es6.math.cosh":193,"../modules/es6.math.expm1":194,"../modules/es6.math.fround":195,"../modules/es6.math.hypot":196,"../modules/es6.math.imul":197,"../modules/es6.math.log10":198,"../modules/es6.math.log1p":199,"../modules/es6.math.log2":200,"../modules/es6.math.sign":201,"../modules/es6.math.sinh":202,"../modules/es6.math.tanh":203,"../modules/es6.math.trunc":204,"../modules/es6.number.constructor":205,"../modules/es6.number.epsilon":206,"../modules/es6.number.is-finite":207,"../modules/es6.number.is-integer":208,"../modules/es6.number.is-nan":209,"../modules/es6.number.is-safe-integer":210,"../modules/es6.number.max-safe-integer":211,"../modules/es6.number.min-safe-integer":212,"../modules/es6.number.parse-float":213,"../modules/es6.number.parse-int":214,"../modules/es6.number.to-fixed":215,"../modules/es6.number.to-precision":216,"../modules/es6.object.assign":217,"../modules/es6.object.create":218,"../modules/es6.object.define-properties":219,"../modules/es6.object.define-property":220,"../modules/es6.object.freeze":221,"../modules/es6.object.get-own-property-descriptor":222,"../modules/es6.object.get-own-property-names":223,"../modules/es6.object.get-prototype-of":224,"../modules/es6.object.is":228,"../modules/es6.object.is-extensible":225,"../modules/es6.object.is-frozen":226,"../modules/es6.object.is-sealed":227,"../modules/es6.object.keys":229,"../modules/es6.object.prevent-extensions":230,"../modules/es6.object.seal":231,"../modules/es6.object.set-prototype-of":232,"../modules/es6.object.to-string":233,"../modules/es6.parse-float":234,"../modules/es6.parse-int":235,"../modules/es6.promise":236,"../modules/es6.reflect.apply":237,"../modules/es6.reflect.construct":238,"../modules/es6.reflect.define-property":239,"../modules/es6.reflect.delete-property":240,"../modules/es6.reflect.enumerate":241,"../modules/es6.reflect.get":244,"../modules/es6.reflect.get-own-property-descriptor":242,"../modules/es6.reflect.get-prototype-of":243,"../modules/es6.reflect.has":245,"../modules/es6.reflect.is-extensible":246,"../modules/es6.reflect.own-keys":247,"../modules/es6.reflect.prevent-extensions":248,"../modules/es6.reflect.set":250,"../modules/es6.reflect.set-prototype-of":249,"../modules/es6.regexp.constructor":251,"../modules/es6.regexp.exec":252,"../modules/es6.regexp.flags":253,"../modules/es6.regexp.match":254,"../modules/es6.regexp.replace":255,"../modules/es6.regexp.search":256,"../modules/es6.regexp.split":257,"../modules/es6.regexp.to-string":258,"../modules/es6.set":259,"../modules/es6.string.anchor":260,"../modules/es6.string.big":261,"../modules/es6.string.blink":262,"../modules/es6.string.bold":263,"../modules/es6.string.code-point-at":264,"../modules/es6.string.ends-with":265,"../modules/es6.string.fixed":266,"../modules/es6.string.fontcolor":267,"../modules/es6.string.fontsize":268,"../modules/es6.string.from-code-point":269,"../modules/es6.string.includes":270,"../modules/es6.string.italics":271,"../modules/es6.string.iterator":272,"../modules/es6.string.link":273,"../modules/es6.string.raw":274,"../modules/es6.string.repeat":275,"../modules/es6.string.small":276,"../modules/es6.string.starts-with":277,"../modules/es6.string.strike":278,"../modules/es6.string.sub":279,"../modules/es6.string.sup":280,"../modules/es6.string.trim":281,"../modules/es6.symbol":282,"../modules/es6.typed.array-buffer":283,"../modules/es6.typed.data-view":284,"../modules/es6.typed.float32-array":285,"../modules/es6.typed.float64-array":286,"../modules/es6.typed.int16-array":287,"../modules/es6.typed.int32-array":288,"../modules/es6.typed.int8-array":289,"../modules/es6.typed.uint16-array":290,"../modules/es6.typed.uint32-array":291,"../modules/es6.typed.uint8-array":292,"../modules/es6.typed.uint8-clamped-array":293,"../modules/es6.weak-map":294,"../modules/es6.weak-set":295}],8:[function(require,module,exports){
require("../../modules/es7.array.flat-map"),module.exports=require("../../modules/_core").Array.flatMap;

},{"../../modules/_core":56,"../../modules/es7.array.flat-map":296}],9:[function(require,module,exports){
require("../../modules/es7.array.includes"),module.exports=require("../../modules/_core").Array.includes;

},{"../../modules/_core":56,"../../modules/es7.array.includes":297}],10:[function(require,module,exports){
require("../../modules/es7.object.entries"),module.exports=require("../../modules/_core").Object.entries;

},{"../../modules/_core":56,"../../modules/es7.object.entries":298}],11:[function(require,module,exports){
require("../../modules/es7.object.get-own-property-descriptors"),module.exports=require("../../modules/_core").Object.getOwnPropertyDescriptors;

},{"../../modules/_core":56,"../../modules/es7.object.get-own-property-descriptors":299}],12:[function(require,module,exports){
require("../../modules/es7.object.values"),module.exports=require("../../modules/_core").Object.values;

},{"../../modules/_core":56,"../../modules/es7.object.values":300}],13:[function(require,module,exports){
"use strict";require("../../modules/es6.promise"),require("../../modules/es7.promise.finally"),module.exports=require("../../modules/_core").Promise.finally;

},{"../../modules/_core":56,"../../modules/es6.promise":236,"../../modules/es7.promise.finally":301}],14:[function(require,module,exports){
require("../../modules/es7.string.pad-end"),module.exports=require("../../modules/_core").String.padEnd;

},{"../../modules/_core":56,"../../modules/es7.string.pad-end":302}],15:[function(require,module,exports){
require("../../modules/es7.string.pad-start"),module.exports=require("../../modules/_core").String.padStart;

},{"../../modules/_core":56,"../../modules/es7.string.pad-start":303}],16:[function(require,module,exports){
require("../../modules/es7.string.trim-right"),module.exports=require("../../modules/_core").String.trimRight;

},{"../../modules/_core":56,"../../modules/es7.string.trim-right":305}],17:[function(require,module,exports){
require("../../modules/es7.string.trim-left"),module.exports=require("../../modules/_core").String.trimLeft;

},{"../../modules/_core":56,"../../modules/es7.string.trim-left":304}],18:[function(require,module,exports){
require("../../modules/es7.symbol.async-iterator"),module.exports=require("../../modules/_wks-ext").f("asyncIterator");

},{"../../modules/_wks-ext":155,"../../modules/es7.symbol.async-iterator":306}],19:[function(require,module,exports){
require("../modules/es7.global"),module.exports=require("../modules/_core").global;

},{"../modules/_core":22,"../modules/es7.global":36}],20:[function(require,module,exports){
module.exports=function(o){if("function"!=typeof o)throw TypeError(o+" is not a function!");return o};

},{}],21:[function(require,module,exports){
var isObject=require("./_is-object");module.exports=function(e){if(!isObject(e))throw TypeError(e+" is not an object!");return e};

},{"./_is-object":32}],22:[function(require,module,exports){
var core=module.exports={version:"2.6.11"};"number"==typeof __e&&(__e=core);

},{}],23:[function(require,module,exports){
var aFunction=require("./_a-function");module.exports=function(n,r,t){if(aFunction(n),void 0===r)return n;switch(t){case 1:return function(t){return n.call(r,t)};case 2:return function(t,u){return n.call(r,t,u)};case 3:return function(t,u,e){return n.call(r,t,u,e)}}return function(){return n.apply(r,arguments)}};

},{"./_a-function":20}],24:[function(require,module,exports){
module.exports=!require("./_fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a});

},{"./_fails":27}],25:[function(require,module,exports){
var isObject=require("./_is-object"),document=require("./_global").document,is=isObject(document)&&isObject(document.createElement);module.exports=function(e){return is?document.createElement(e):{}};

},{"./_global":28,"./_is-object":32}],26:[function(require,module,exports){
var global=require("./_global"),core=require("./_core"),ctx=require("./_ctx"),hide=require("./_hide"),has=require("./_has"),PROTOTYPE="prototype",$export=function(e,r,t){var o,n,p,i=e&$export.F,x=e&$export.G,c=e&$export.S,a=e&$export.P,u=e&$export.B,l=e&$export.W,$=x?core:core[r]||(core[r]={}),P=$[PROTOTYPE],s=x?global:c?global[r]:(global[r]||{})[PROTOTYPE];for(o in x&&(t=r),t)(n=!i&&s&&void 0!==s[o])&&has($,o)||(p=n?s[o]:t[o],$[o]=x&&"function"!=typeof s[o]?t[o]:u&&n?ctx(p,global):l&&s[o]==p?function(e){var r=function(r,t,o){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(r);case 2:return new e(r,t)}return new e(r,t,o)}return e.apply(this,arguments)};return r[PROTOTYPE]=e[PROTOTYPE],r}(p):a&&"function"==typeof p?ctx(Function.call,p):p,a&&(($.virtual||($.virtual={}))[o]=p,e&$export.R&&P&&!P[o]&&hide(P,o,p)))};$export.F=1,$export.G=2,$export.S=4,$export.P=8,$export.B=16,$export.W=32,$export.U=64,$export.R=128,module.exports=$export;

},{"./_core":22,"./_ctx":23,"./_global":28,"./_has":29,"./_hide":30}],27:[function(require,module,exports){
module.exports=function(r){try{return!!r()}catch(r){return!0}};

},{}],28:[function(require,module,exports){
var global=module.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=global);

},{}],29:[function(require,module,exports){
var hasOwnProperty={}.hasOwnProperty;module.exports=function(r,e){return hasOwnProperty.call(r,e)};

},{}],30:[function(require,module,exports){
var dP=require("./_object-dp"),createDesc=require("./_property-desc");module.exports=require("./_descriptors")?function(e,r,t){return dP.f(e,r,createDesc(1,t))}:function(e,r,t){return e[r]=t,e};

},{"./_descriptors":24,"./_object-dp":33,"./_property-desc":34}],31:[function(require,module,exports){
module.exports=!require("./_descriptors")&&!require("./_fails")(function(){return 7!=Object.defineProperty(require("./_dom-create")("div"),"a",{get:function(){return 7}}).a});

},{"./_descriptors":24,"./_dom-create":25,"./_fails":27}],32:[function(require,module,exports){
module.exports=function(o){return"object"==typeof o?null!==o:"function"==typeof o};

},{}],33:[function(require,module,exports){
var anObject=require("./_an-object"),IE8_DOM_DEFINE=require("./_ie8-dom-define"),toPrimitive=require("./_to-primitive"),dP=Object.defineProperty;exports.f=require("./_descriptors")?Object.defineProperty:function(e,r,t){if(anObject(e),r=toPrimitive(r,!0),anObject(t),IE8_DOM_DEFINE)try{return dP(e,r,t)}catch(e){}if("get"in t||"set"in t)throw TypeError("Accessors not supported!");return"value"in t&&(e[r]=t.value),e};

},{"./_an-object":21,"./_descriptors":24,"./_ie8-dom-define":31,"./_to-primitive":35}],34:[function(require,module,exports){
module.exports=function(e,r){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:r}};

},{}],35:[function(require,module,exports){
var isObject=require("./_is-object");module.exports=function(t,e){if(!isObject(t))return t;var r,i;if(e&&"function"==typeof(r=t.toString)&&!isObject(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!isObject(i=r.call(t)))return i;if(!e&&"function"==typeof(r=t.toString)&&!isObject(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")};

},{"./_is-object":32}],36:[function(require,module,exports){
var $export=require("./_export");$export($export.G,{global:require("./_global")});

},{"./_export":26,"./_global":28}],37:[function(require,module,exports){
module.exports=function(o){if("function"!=typeof o)throw TypeError(o+" is not a function!");return o};

},{}],38:[function(require,module,exports){
var cof=require("./_cof");module.exports=function(r,e){if("number"!=typeof r&&"Number"!=cof(r))throw TypeError(e);return+r};

},{"./_cof":52}],39:[function(require,module,exports){
var UNSCOPABLES=require("./_wks")("unscopables"),ArrayProto=Array.prototype;null==ArrayProto[UNSCOPABLES]&&require("./_hide")(ArrayProto,UNSCOPABLES,{}),module.exports=function(r){ArrayProto[UNSCOPABLES][r]=!0};

},{"./_hide":76,"./_wks":156}],40:[function(require,module,exports){
"use strict";var at=require("./_string-at")(!0);module.exports=function(t,r,e){return r+(e?at(t,r).length:1)};

},{"./_string-at":133}],41:[function(require,module,exports){
module.exports=function(o,n,r,i){if(!(o instanceof n)||void 0!==i&&i in o)throw TypeError(r+": incorrect invocation!");return o};

},{}],42:[function(require,module,exports){
var isObject=require("./_is-object");module.exports=function(e){if(!isObject(e))throw TypeError(e+" is not an object!");return e};

},{"./_is-object":85}],43:[function(require,module,exports){
"use strict";var toObject=require("./_to-object"),toAbsoluteIndex=require("./_to-absolute-index"),toLength=require("./_to-length");module.exports=[].copyWithin||function(t,e){var o=toObject(this),n=toLength(o.length),i=toAbsoluteIndex(t,n),r=toAbsoluteIndex(e,n),u=arguments.length>2?arguments[2]:void 0,l=Math.min((void 0===u?n:toAbsoluteIndex(u,n))-r,n-i),d=1;for(r<i&&i<r+l&&(d=-1,r+=l-1,i+=l-1);l-- >0;)r in o?o[i]=o[r]:delete o[i],i+=d,r+=d;return o};

},{"./_to-absolute-index":141,"./_to-length":145,"./_to-object":146}],44:[function(require,module,exports){
"use strict";var toObject=require("./_to-object"),toAbsoluteIndex=require("./_to-absolute-index"),toLength=require("./_to-length");module.exports=function(t){for(var e=toObject(this),o=toLength(e.length),r=arguments.length,n=toAbsoluteIndex(r>1?arguments[1]:void 0,o),u=r>2?arguments[2]:void 0,i=void 0===u?o:toAbsoluteIndex(u,o);i>n;)e[n++]=t;return e};

},{"./_to-absolute-index":141,"./_to-length":145,"./_to-object":146}],45:[function(require,module,exports){
var toIObject=require("./_to-iobject"),toLength=require("./_to-length"),toAbsoluteIndex=require("./_to-absolute-index");module.exports=function(e){return function(t,o,r){var n,u=toIObject(t),i=toLength(u.length),f=toAbsoluteIndex(r,i);if(e&&o!=o){for(;i>f;)if((n=u[f++])!=n)return!0}else for(;i>f;f++)if((e||f in u)&&u[f]===o)return e||f||0;return!e&&-1}};

},{"./_to-absolute-index":141,"./_to-iobject":144,"./_to-length":145}],46:[function(require,module,exports){
var ctx=require("./_ctx"),IObject=require("./_iobject"),toObject=require("./_to-object"),toLength=require("./_to-length"),asc=require("./_array-species-create");module.exports=function(e,r){var t=1==e,c=2==e,i=3==e,n=4==e,u=6==e,o=5==e||u,s=r||asc;return function(r,a,f){for(var b,h,j=toObject(r),l=IObject(j),q=ctx(a,f,3),_=toLength(l.length),g=0,v=t?s(r,_):c?s(r,0):void 0;_>g;g++)if((o||g in l)&&(h=q(b=l[g],g,j),e))if(t)v[g]=h;else if(h)switch(e){case 3:return!0;case 5:return b;case 6:return g;case 2:v.push(b)}else if(n)return!1;return u?-1:i||n?n:v}};

},{"./_array-species-create":49,"./_ctx":58,"./_iobject":81,"./_to-length":145,"./_to-object":146}],47:[function(require,module,exports){
var aFunction=require("./_a-function"),toObject=require("./_to-object"),IObject=require("./_iobject"),toLength=require("./_to-length");module.exports=function(e,t,r,o,i){aFunction(t);var n=toObject(e),u=IObject(n),c=toLength(n.length),a=i?c-1:0,f=i?-1:1;if(r<2)for(;;){if(a in u){o=u[a],a+=f;break}if(a+=f,i?a<0:c<=a)throw TypeError("Reduce of empty array with no initial value")}for(;i?a>=0:c>a;a+=f)a in u&&(o=t(o,u[a],a,n));return o};

},{"./_a-function":37,"./_iobject":81,"./_to-length":145,"./_to-object":146}],48:[function(require,module,exports){
var isObject=require("./_is-object"),isArray=require("./_is-array"),SPECIES=require("./_wks")("species");module.exports=function(r){var e;return isArray(r)&&("function"!=typeof(e=r.constructor)||e!==Array&&!isArray(e.prototype)||(e=void 0),isObject(e)&&null===(e=e[SPECIES])&&(e=void 0)),void 0===e?Array:e};

},{"./_is-array":83,"./_is-object":85,"./_wks":156}],49:[function(require,module,exports){
var speciesConstructor=require("./_array-species-constructor");module.exports=function(r,e){return new(speciesConstructor(r))(e)};

},{"./_array-species-constructor":48}],50:[function(require,module,exports){
"use strict";var aFunction=require("./_a-function"),isObject=require("./_is-object"),invoke=require("./_invoke"),arraySlice=[].slice,factories={},construct=function(t,r,e){if(!(r in factories)){for(var i=[],n=0;n<r;n++)i[n]="a["+n+"]";factories[r]=Function("F,a","return new F("+i.join(",")+")")}return factories[r](t,e)};module.exports=Function.bind||function(t){var r=aFunction(this),e=arraySlice.call(arguments,1),i=function(){var n=e.concat(arraySlice.call(arguments));return this instanceof i?construct(r,n.length,n):invoke(r,n,t)};return isObject(r.prototype)&&(i.prototype=r.prototype),i};

},{"./_a-function":37,"./_invoke":80,"./_is-object":85}],51:[function(require,module,exports){
var cof=require("./_cof"),TAG=require("./_wks")("toStringTag"),ARG="Arguments"==cof(function(){return arguments}()),tryGet=function(t,e){try{return t[e]}catch(t){}};module.exports=function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=tryGet(e=Object(t),TAG))?r:ARG?cof(e):"Object"==(n=cof(e))&&"function"==typeof e.callee?"Arguments":n};

},{"./_cof":52,"./_wks":156}],52:[function(require,module,exports){
var toString={}.toString;module.exports=function(t){return toString.call(t).slice(8,-1)};

},{}],53:[function(require,module,exports){
"use strict";var dP=require("./_object-dp").f,create=require("./_object-create"),redefineAll=require("./_redefine-all"),ctx=require("./_ctx"),anInstance=require("./_an-instance"),forOf=require("./_for-of"),$iterDefine=require("./_iter-define"),step=require("./_iter-step"),setSpecies=require("./_set-species"),DESCRIPTORS=require("./_descriptors"),fastKey=require("./_meta").fastKey,validate=require("./_validate-collection"),SIZE=DESCRIPTORS?"_s":"size",getEntry=function(e,t){var r,i=fastKey(t);if("F"!==i)return e._i[i];for(r=e._f;r;r=r.n)if(r.k==t)return r};module.exports={getConstructor:function(e,t,r,i){var n=e(function(e,f){anInstance(e,n,t,"_i"),e._t=t,e._i=create(null),e._f=void 0,e._l=void 0,e[SIZE]=0,null!=f&&forOf(f,r,e[i],e)});return redefineAll(n.prototype,{clear:function(){for(var e=validate(this,t),r=e._i,i=e._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete r[i.i];e._f=e._l=void 0,e[SIZE]=0},delete:function(e){var r=validate(this,t),i=getEntry(r,e);if(i){var n=i.n,f=i.p;delete r._i[i.i],i.r=!0,f&&(f.n=n),n&&(n.p=f),r._f==i&&(r._f=n),r._l==i&&(r._l=f),r[SIZE]--}return!!i},forEach:function(e){validate(this,t);for(var r,i=ctx(e,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(i(r.v,r.k,this);r&&r.r;)r=r.p},has:function(e){return!!getEntry(validate(this,t),e)}}),DESCRIPTORS&&dP(n.prototype,"size",{get:function(){return validate(this,t)[SIZE]}}),n},def:function(e,t,r){var i,n,f=getEntry(e,t);return f?f.v=r:(e._l=f={i:n=fastKey(t,!0),k:t,v:r,p:i=e._l,n:void 0,r:!1},e._f||(e._f=f),i&&(i.n=f),e[SIZE]++,"F"!==n&&(e._i[n]=f)),e},getEntry:getEntry,setStrong:function(e,t,r){$iterDefine(e,t,function(e,r){this._t=validate(e,t),this._k=r,this._l=void 0},function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?step(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,step(1))},r?"entries":"values",!r,!0),setSpecies(t)}};

},{"./_an-instance":41,"./_ctx":58,"./_descriptors":62,"./_for-of":72,"./_iter-define":89,"./_iter-step":91,"./_meta":98,"./_object-create":102,"./_object-dp":103,"./_redefine-all":121,"./_set-species":127,"./_validate-collection":153}],54:[function(require,module,exports){
"use strict";var redefineAll=require("./_redefine-all"),getWeak=require("./_meta").getWeak,anObject=require("./_an-object"),isObject=require("./_is-object"),anInstance=require("./_an-instance"),forOf=require("./_for-of"),createArrayMethod=require("./_array-methods"),$has=require("./_has"),validate=require("./_validate-collection"),arrayFind=createArrayMethod(5),arrayFindIndex=createArrayMethod(6),id=0,uncaughtFrozenStore=function(e){return e._l||(e._l=new UncaughtFrozenStore)},UncaughtFrozenStore=function(){this.a=[]},findUncaughtFrozen=function(e,t){return arrayFind(e.a,function(e){return e[0]===t})};UncaughtFrozenStore.prototype={get:function(e){var t=findUncaughtFrozen(this,e);if(t)return t[1]},has:function(e){return!!findUncaughtFrozen(this,e)},set:function(e,t){var r=findUncaughtFrozen(this,e);r?r[1]=t:this.a.push([e,t])},delete:function(e){var t=arrayFindIndex(this.a,function(t){return t[0]===e});return~t&&this.a.splice(t,1),!!~t}},module.exports={getConstructor:function(e,t,r,n){var a=e(function(e,i){anInstance(e,a,t,"_i"),e._t=t,e._i=id++,e._l=void 0,null!=i&&forOf(i,r,e[n],e)});return redefineAll(a.prototype,{delete:function(e){if(!isObject(e))return!1;var r=getWeak(e);return!0===r?uncaughtFrozenStore(validate(this,t)).delete(e):r&&$has(r,this._i)&&delete r[this._i]},has:function(e){if(!isObject(e))return!1;var r=getWeak(e);return!0===r?uncaughtFrozenStore(validate(this,t)).has(e):r&&$has(r,this._i)}}),a},def:function(e,t,r){var n=getWeak(anObject(t),!0);return!0===n?uncaughtFrozenStore(e).set(t,r):n[e._i]=r,e},ufstore:uncaughtFrozenStore};

},{"./_an-instance":41,"./_an-object":42,"./_array-methods":46,"./_for-of":72,"./_has":75,"./_is-object":85,"./_meta":98,"./_redefine-all":121,"./_validate-collection":153}],55:[function(require,module,exports){
"use strict";var global=require("./_global"),$export=require("./_export"),redefine=require("./_redefine"),redefineAll=require("./_redefine-all"),meta=require("./_meta"),forOf=require("./_for-of"),anInstance=require("./_an-instance"),isObject=require("./_is-object"),fails=require("./_fails"),$iterDetect=require("./_iter-detect"),setToStringTag=require("./_set-to-string-tag"),inheritIfRequired=require("./_inherit-if-required");module.exports=function(e,t,r,i,n,o){var a=global[e],u=a,f=n?"set":"add",s=u&&u.prototype,c={},l=function(e){var t=s[e];redefine(s,e,"delete"==e?function(e){return!(o&&!isObject(e))&&t.call(this,0===e?0:e)}:"has"==e?function(e){return!(o&&!isObject(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return o&&!isObject(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,r){return t.call(this,0===e?0:e,r),this})};if("function"==typeof u&&(o||s.forEach&&!fails(function(){(new u).entries().next()}))){var d=new u,h=d[f](o?{}:-0,1)!=d,q=fails(function(){d.has(1)}),p=$iterDetect(function(e){new u(e)}),g=!o&&fails(function(){for(var e=new u,t=5;t--;)e[f](t,t);return!e.has(-0)});p||((u=t(function(t,r){anInstance(t,u,e);var i=inheritIfRequired(new a,t,u);return null!=r&&forOf(r,n,i[f],i),i})).prototype=s,s.constructor=u),(q||g)&&(l("delete"),l("has"),n&&l("get")),(g||h)&&l(f),o&&s.clear&&delete s.clear}else u=i.getConstructor(t,e,n,f),redefineAll(u.prototype,r),meta.NEED=!0;return setToStringTag(u,e),c[e]=u,$export($export.G+$export.W+$export.F*(u!=a),c),o||i.setStrong(u,e,n),u};

},{"./_an-instance":41,"./_export":66,"./_fails":68,"./_for-of":72,"./_global":74,"./_inherit-if-required":79,"./_is-object":85,"./_iter-detect":90,"./_meta":98,"./_redefine":122,"./_redefine-all":121,"./_set-to-string-tag":128}],56:[function(require,module,exports){
var core=module.exports={version:"2.6.11"};"number"==typeof __e&&(__e=core);

},{}],57:[function(require,module,exports){
"use strict";var $defineProperty=require("./_object-dp"),createDesc=require("./_property-desc");module.exports=function(e,r,t){r in e?$defineProperty.f(e,r,createDesc(0,t)):e[r]=t};

},{"./_object-dp":103,"./_property-desc":120}],58:[function(require,module,exports){
var aFunction=require("./_a-function");module.exports=function(n,r,t){if(aFunction(n),void 0===r)return n;switch(t){case 1:return function(t){return n.call(r,t)};case 2:return function(t,u){return n.call(r,t,u)};case 3:return function(t,u,e){return n.call(r,t,u,e)}}return function(){return n.apply(r,arguments)}};

},{"./_a-function":37}],59:[function(require,module,exports){
"use strict";var fails=require("./_fails"),getTime=Date.prototype.getTime,$toISOString=Date.prototype.toISOString,lz=function(t){return t>9?t:"0"+t};module.exports=fails(function(){return"0385-07-25T07:06:39.999Z"!=$toISOString.call(new Date(-5e13-1))})||!fails(function(){$toISOString.call(new Date(NaN))})?function(){if(!isFinite(getTime.call(this)))throw RangeError("Invalid time value");var t=this,e=t.getUTCFullYear(),i=t.getUTCMilliseconds(),l=e<0?"-":e>9999?"+":"";return l+("00000"+Math.abs(e)).slice(l?-6:-4)+"-"+lz(t.getUTCMonth()+1)+"-"+lz(t.getUTCDate())+"T"+lz(t.getUTCHours())+":"+lz(t.getUTCMinutes())+":"+lz(t.getUTCSeconds())+"."+(i>99?i:"0"+lz(i))+"Z"}:$toISOString;

},{"./_fails":68}],60:[function(require,module,exports){
"use strict";var anObject=require("./_an-object"),toPrimitive=require("./_to-primitive"),NUMBER="number";module.exports=function(r){if("string"!==r&&r!==NUMBER&&"default"!==r)throw TypeError("Incorrect hint");return toPrimitive(anObject(this),r!=NUMBER)};

},{"./_an-object":42,"./_to-primitive":147}],61:[function(require,module,exports){
module.exports=function(o){if(null==o)throw TypeError("Can't call method on  "+o);return o};

},{}],62:[function(require,module,exports){
module.exports=!require("./_fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a});

},{"./_fails":68}],63:[function(require,module,exports){
var isObject=require("./_is-object"),document=require("./_global").document,is=isObject(document)&&isObject(document.createElement);module.exports=function(e){return is?document.createElement(e):{}};

},{"./_global":74,"./_is-object":85}],64:[function(require,module,exports){
module.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",");

},{}],65:[function(require,module,exports){
var getKeys=require("./_object-keys"),gOPS=require("./_object-gops"),pIE=require("./_object-pie");module.exports=function(e){var r=getKeys(e),t=gOPS.f;if(t)for(var o,u=t(e),g=pIE.f,i=0;u.length>i;)g.call(e,o=u[i++])&&r.push(o);return r};

},{"./_object-gops":108,"./_object-keys":111,"./_object-pie":112}],66:[function(require,module,exports){
var global=require("./_global"),core=require("./_core"),hide=require("./_hide"),redefine=require("./_redefine"),ctx=require("./_ctx"),PROTOTYPE="prototype",$export=function(e,o,r){var t,x,p,l,i=e&$export.F,$=e&$export.G,c=e&$export.S,a=e&$export.P,n=e&$export.B,P=$?global:c?global[o]||(global[o]={}):(global[o]||{})[PROTOTYPE],u=$?core:core[o]||(core[o]={}),b=u[PROTOTYPE]||(u[PROTOTYPE]={});for(t in $&&(r=o),r)p=((x=!i&&P&&void 0!==P[t])?P:r)[t],l=n&&x?ctx(p,global):a&&"function"==typeof p?ctx(Function.call,p):p,P&&redefine(P,t,p,e&$export.U),u[t]!=p&&hide(u,t,l),a&&b[t]!=p&&(b[t]=p)};global.core=core,$export.F=1,$export.G=2,$export.S=4,$export.P=8,$export.B=16,$export.W=32,$export.U=64,$export.R=128,module.exports=$export;

},{"./_core":56,"./_ctx":58,"./_global":74,"./_hide":76,"./_redefine":122}],67:[function(require,module,exports){
var MATCH=require("./_wks")("match");module.exports=function(r){var t=/./;try{"/./"[r](t)}catch(c){try{return t[MATCH]=!1,!"/./"[r](t)}catch(r){}}return!0};

},{"./_wks":156}],68:[function(require,module,exports){
module.exports=function(r){try{return!!r()}catch(r){return!0}};

},{}],69:[function(require,module,exports){
"use strict";require("./es6.regexp.exec");var redefine=require("./_redefine"),hide=require("./_hide"),fails=require("./_fails"),defined=require("./_defined"),wks=require("./_wks"),regexpExec=require("./_regexp-exec"),SPECIES=wks("species"),REPLACE_SUPPORTS_NAMED_GROUPS=!fails(function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}),SPLIT_WORKS_WITH_OVERWRITTEN_EXEC=function(){var e=/(?:)/,r=e.exec;e.exec=function(){return r.apply(this,arguments)};var n="ab".split(e);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();module.exports=function(e,r,n){var i=wks(e),t=!fails(function(){var r={};return r[i]=function(){return 7},7!=""[e](r)}),u=t?!fails(function(){var r=!1,n=/a/;return n.exec=function(){return r=!0,null},"split"===e&&(n.constructor={},n.constructor[SPECIES]=function(){return n}),n[i](""),!r}):void 0;if(!t||!u||"replace"===e&&!REPLACE_SUPPORTS_NAMED_GROUPS||"split"===e&&!SPLIT_WORKS_WITH_OVERWRITTEN_EXEC){var c=/./[i],a=n(defined,i,""[e],function(e,r,n,i,u){return r.exec===regexpExec?t&&!u?{done:!0,value:c.call(r,n,i)}:{done:!0,value:e.call(n,r,i)}:{done:!1}}),o=a[0],f=a[1];redefine(String.prototype,e,o),hide(RegExp.prototype,i,2==r?function(e,r){return f.call(e,this,r)}:function(e){return f.call(e,this)})}};

},{"./_defined":61,"./_fails":68,"./_hide":76,"./_redefine":122,"./_regexp-exec":124,"./_wks":156,"./es6.regexp.exec":252}],70:[function(require,module,exports){
"use strict";var anObject=require("./_an-object");module.exports=function(){var e=anObject(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t};

},{"./_an-object":42}],71:[function(require,module,exports){
"use strict";var isArray=require("./_is-array"),isObject=require("./_is-object"),toLength=require("./_to-length"),ctx=require("./_ctx"),IS_CONCAT_SPREADABLE=require("./_wks")("isConcatSpreadable");function flattenIntoArray(r,e,t,i,a,n,o,s){for(var A,c,u=a,_=0,f=!!o&&ctx(o,s,3);_<i;){if(_ in t){if(A=f?f(t[_],_,e):t[_],c=!1,isObject(A)&&(c=void 0!==(c=A[IS_CONCAT_SPREADABLE])?!!c:isArray(A)),c&&n>0)u=flattenIntoArray(r,e,A,toLength(A.length),u,n-1)-1;else{if(u>=9007199254740991)throw TypeError();r[u]=A}u++}_++}return u}module.exports=flattenIntoArray;

},{"./_ctx":58,"./_is-array":83,"./_is-object":85,"./_to-length":145,"./_wks":156}],72:[function(require,module,exports){
var ctx=require("./_ctx"),call=require("./_iter-call"),isArrayIter=require("./_is-array-iter"),anObject=require("./_an-object"),toLength=require("./_to-length"),getIterFn=require("./core.get-iterator-method"),BREAK={},RETURN={},exports=module.exports=function(e,r,t,o,i){var n,a,R,c,l=i?function(){return e}:getIterFn(e),u=ctx(t,o,r?2:1),E=0;if("function"!=typeof l)throw TypeError(e+" is not iterable!");if(isArrayIter(l)){for(n=toLength(e.length);n>E;E++)if((c=r?u(anObject(a=e[E])[0],a[1]):u(e[E]))===BREAK||c===RETURN)return c}else for(R=l.call(e);!(a=R.next()).done;)if((c=call(R,u,a.value,r))===BREAK||c===RETURN)return c};exports.BREAK=BREAK,exports.RETURN=RETURN;

},{"./_an-object":42,"./_ctx":58,"./_is-array-iter":82,"./_iter-call":87,"./_to-length":145,"./core.get-iterator-method":157}],73:[function(require,module,exports){
module.exports=require("./_shared")("native-function-to-string",Function.toString);

},{"./_shared":130}],74:[function(require,module,exports){
var global=module.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=global);

},{}],75:[function(require,module,exports){
var hasOwnProperty={}.hasOwnProperty;module.exports=function(r,e){return hasOwnProperty.call(r,e)};

},{}],76:[function(require,module,exports){
var dP=require("./_object-dp"),createDesc=require("./_property-desc");module.exports=require("./_descriptors")?function(e,r,t){return dP.f(e,r,createDesc(1,t))}:function(e,r,t){return e[r]=t,e};

},{"./_descriptors":62,"./_object-dp":103,"./_property-desc":120}],77:[function(require,module,exports){
var document=require("./_global").document;module.exports=document&&document.documentElement;

},{"./_global":74}],78:[function(require,module,exports){
module.exports=!require("./_descriptors")&&!require("./_fails")(function(){return 7!=Object.defineProperty(require("./_dom-create")("div"),"a",{get:function(){return 7}}).a});

},{"./_descriptors":62,"./_dom-create":63,"./_fails":68}],79:[function(require,module,exports){
var isObject=require("./_is-object"),setPrototypeOf=require("./_set-proto").set;module.exports=function(t,e,o){var r,p=e.constructor;return p!==o&&"function"==typeof p&&(r=p.prototype)!==o.prototype&&isObject(r)&&setPrototypeOf&&setPrototypeOf(t,r),t};

},{"./_is-object":85,"./_set-proto":126}],80:[function(require,module,exports){
module.exports=function(e,r,l){var a=void 0===l;switch(r.length){case 0:return a?e():e.call(l);case 1:return a?e(r[0]):e.call(l,r[0]);case 2:return a?e(r[0],r[1]):e.call(l,r[0],r[1]);case 3:return a?e(r[0],r[1],r[2]):e.call(l,r[0],r[1],r[2]);case 4:return a?e(r[0],r[1],r[2],r[3]):e.call(l,r[0],r[1],r[2],r[3])}return e.apply(l,r)};

},{}],81:[function(require,module,exports){
var cof=require("./_cof");module.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==cof(e)?e.split(""):Object(e)};

},{"./_cof":52}],82:[function(require,module,exports){
var Iterators=require("./_iterators"),ITERATOR=require("./_wks")("iterator"),ArrayProto=Array.prototype;module.exports=function(r){return void 0!==r&&(Iterators.Array===r||ArrayProto[ITERATOR]===r)};

},{"./_iterators":92,"./_wks":156}],83:[function(require,module,exports){
var cof=require("./_cof");module.exports=Array.isArray||function(r){return"Array"==cof(r)};

},{"./_cof":52}],84:[function(require,module,exports){
var isObject=require("./_is-object"),floor=Math.floor;module.exports=function(o){return!isObject(o)&&isFinite(o)&&floor(o)===o};

},{"./_is-object":85}],85:[function(require,module,exports){
module.exports=function(o){return"object"==typeof o?null!==o:"function"==typeof o};

},{}],86:[function(require,module,exports){
var isObject=require("./_is-object"),cof=require("./_cof"),MATCH=require("./_wks")("match");module.exports=function(e){var r;return isObject(e)&&(void 0!==(r=e[MATCH])?!!r:"RegExp"==cof(e))};

},{"./_cof":52,"./_is-object":85,"./_wks":156}],87:[function(require,module,exports){
var anObject=require("./_an-object");module.exports=function(r,t,e,a){try{return a?t(anObject(e)[0],e[1]):t(e)}catch(t){var c=r.return;throw void 0!==c&&anObject(c.call(r)),t}};

},{"./_an-object":42}],88:[function(require,module,exports){
"use strict";var create=require("./_object-create"),descriptor=require("./_property-desc"),setToStringTag=require("./_set-to-string-tag"),IteratorPrototype={};require("./_hide")(IteratorPrototype,require("./_wks")("iterator"),function(){return this}),module.exports=function(r,t,e){r.prototype=create(IteratorPrototype,{next:descriptor(1,e)}),setToStringTag(r,t+" Iterator")};

},{"./_hide":76,"./_object-create":102,"./_property-desc":120,"./_set-to-string-tag":128,"./_wks":156}],89:[function(require,module,exports){
"use strict";var LIBRARY=require("./_library"),$export=require("./_export"),redefine=require("./_redefine"),hide=require("./_hide"),Iterators=require("./_iterators"),$iterCreate=require("./_iter-create"),setToStringTag=require("./_set-to-string-tag"),getPrototypeOf=require("./_object-gpo"),ITERATOR=require("./_wks")("iterator"),BUGGY=!([].keys&&"next"in[].keys()),FF_ITERATOR="@@iterator",KEYS="keys",VALUES="values",returnThis=function(){return this};module.exports=function(e,r,t,i,n,o,s){$iterCreate(t,r,i);var u,a,T,R=function(e){if(!BUGGY&&e in E)return E[e];switch(e){case KEYS:case VALUES:return function(){return new t(this,e)}}return function(){return new t(this,e)}},f=r+" Iterator",A=n==VALUES,c=!1,E=e.prototype,I=E[ITERATOR]||E[FF_ITERATOR]||n&&E[n],p=I||R(n),h=n?A?R("entries"):p:void 0,y="Array"==r&&E.entries||I;if(y&&(T=getPrototypeOf(y.call(new e)))!==Object.prototype&&T.next&&(setToStringTag(T,f,!0),LIBRARY||"function"==typeof T[ITERATOR]||hide(T,ITERATOR,returnThis)),A&&I&&I.name!==VALUES&&(c=!0,p=function(){return I.call(this)}),LIBRARY&&!s||!BUGGY&&!c&&E[ITERATOR]||hide(E,ITERATOR,p),Iterators[r]=p,Iterators[f]=returnThis,n)if(u={values:A?p:R(VALUES),keys:o?p:R(KEYS),entries:h},s)for(a in u)a in E||redefine(E,a,u[a]);else $export($export.P+$export.F*(BUGGY||c),r,u);return u};

},{"./_export":66,"./_hide":76,"./_iter-create":88,"./_iterators":92,"./_library":93,"./_object-gpo":109,"./_redefine":122,"./_set-to-string-tag":128,"./_wks":156}],90:[function(require,module,exports){
var ITERATOR=require("./_wks")("iterator"),SAFE_CLOSING=!1;try{var riter=[7][ITERATOR]();riter.return=function(){SAFE_CLOSING=!0},Array.from(riter,function(){throw 2})}catch(r){}module.exports=function(r,t){if(!t&&!SAFE_CLOSING)return!1;var n=!1;try{var e=[7],u=e[ITERATOR]();u.next=function(){return{done:n=!0}},e[ITERATOR]=function(){return u},r(e)}catch(r){}return n};

},{"./_wks":156}],91:[function(require,module,exports){
module.exports=function(e,n){return{value:n,done:!!e}};

},{}],92:[function(require,module,exports){
module.exports={};

},{}],93:[function(require,module,exports){
module.exports=!1;

},{}],94:[function(require,module,exports){
var $expm1=Math.expm1;module.exports=!$expm1||$expm1(10)>22025.465794806718||$expm1(10)<22025.465794806718||-2e-17!=$expm1(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:Math.exp(e)-1}:$expm1;

},{}],95:[function(require,module,exports){
var sign=require("./_math-sign"),pow=Math.pow,EPSILON=pow(2,-52),EPSILON32=pow(2,-23),MAX32=pow(2,127)*(2-EPSILON32),MIN32=pow(2,-126),roundTiesToEven=function(o){return o+1/EPSILON-1/EPSILON};module.exports=Math.fround||function(o){var n,I,N=Math.abs(o),r=sign(o);return N<MIN32?r*roundTiesToEven(N/MIN32/EPSILON32)*MIN32*EPSILON32:(I=(n=(1+EPSILON32/EPSILON)*N)-(n-N))>MAX32||I!=I?r*(1/0):r*I};

},{"./_math-sign":97}],96:[function(require,module,exports){
module.exports=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:Math.log(1+e)};

},{}],97:[function(require,module,exports){
module.exports=Math.sign||function(n){return 0==(n=+n)||n!=n?n:n<0?-1:1};

},{}],98:[function(require,module,exports){
var META=require("./_uid")("meta"),isObject=require("./_is-object"),has=require("./_has"),setDesc=require("./_object-dp").f,id=0,isExtensible=Object.isExtensible||function(){return!0},FREEZE=!require("./_fails")(function(){return isExtensible(Object.preventExtensions({}))}),setMeta=function(e){setDesc(e,META,{value:{i:"O"+ ++id,w:{}}})},fastKey=function(e,t){if(!isObject(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!has(e,META)){if(!isExtensible(e))return"F";if(!t)return"E";setMeta(e)}return e[META].i},getWeak=function(e,t){if(!has(e,META)){if(!isExtensible(e))return!0;if(!t)return!1;setMeta(e)}return e[META].w},onFreeze=function(e){return FREEZE&&meta.NEED&&isExtensible(e)&&!has(e,META)&&setMeta(e),e},meta=module.exports={KEY:META,NEED:!1,fastKey:fastKey,getWeak:getWeak,onFreeze:onFreeze};

},{"./_fails":68,"./_has":75,"./_is-object":85,"./_object-dp":103,"./_uid":151}],99:[function(require,module,exports){
var global=require("./_global"),macrotask=require("./_task").set,Observer=global.MutationObserver||global.WebKitMutationObserver,process=global.process,Promise=global.Promise,isNode="process"==require("./_cof")(process);module.exports=function(){var e,o,r,a=function(){var a,s;for(isNode&&(a=process.domain)&&a.exit();e;){s=e.fn,e=e.next;try{s()}catch(a){throw e?r():o=void 0,a}}o=void 0,a&&a.enter()};if(isNode)r=function(){process.nextTick(a)};else if(!Observer||global.navigator&&global.navigator.standalone)if(Promise&&Promise.resolve){var s=Promise.resolve(void 0);r=function(){s.then(a)}}else r=function(){macrotask.call(global,a)};else{var t=!0,i=document.createTextNode("");new Observer(a).observe(i,{characterData:!0}),r=function(){i.data=t=!t}}return function(a){var s={fn:a,next:void 0};o&&(o.next=s),e||(e=s,r()),o=s}};

},{"./_cof":52,"./_global":74,"./_task":140}],100:[function(require,module,exports){
"use strict";var aFunction=require("./_a-function");function PromiseCapability(i){var o,r;this.promise=new i(function(i,t){if(void 0!==o||void 0!==r)throw TypeError("Bad Promise constructor");o=i,r=t}),this.resolve=aFunction(o),this.reject=aFunction(r)}module.exports.f=function(i){return new PromiseCapability(i)};

},{"./_a-function":37}],101:[function(require,module,exports){
"use strict";var DESCRIPTORS=require("./_descriptors"),getKeys=require("./_object-keys"),gOPS=require("./_object-gops"),pIE=require("./_object-pie"),toObject=require("./_to-object"),IObject=require("./_iobject"),$assign=Object.assign;module.exports=!$assign||require("./_fails")(function(){var e={},t={},r=Symbol(),s="abcdefghijklmnopqrst";return e[r]=7,s.split("").forEach(function(e){t[e]=e}),7!=$assign({},e)[r]||Object.keys($assign({},t)).join("")!=s})?function(e,t){for(var r=toObject(e),s=arguments.length,i=1,o=gOPS.f,c=pIE.f;s>i;)for(var n,a=IObject(arguments[i++]),g=o?getKeys(a).concat(o(a)):getKeys(a),u=g.length,b=0;u>b;)n=g[b++],DESCRIPTORS&&!c.call(a,n)||(r[n]=a[n]);return r}:$assign;

},{"./_descriptors":62,"./_fails":68,"./_iobject":81,"./_object-gops":108,"./_object-keys":111,"./_object-pie":112,"./_to-object":146}],102:[function(require,module,exports){
var anObject=require("./_an-object"),dPs=require("./_object-dps"),enumBugKeys=require("./_enum-bug-keys"),IE_PROTO=require("./_shared-key")("IE_PROTO"),Empty=function(){},PROTOTYPE="prototype",createDict=function(){var e,t=require("./_dom-create")("iframe"),r=enumBugKeys.length;for(t.style.display="none",require("./_html").appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),createDict=e.F;r--;)delete createDict[PROTOTYPE][enumBugKeys[r]];return createDict()};module.exports=Object.create||function(e,t){var r;return null!==e?(Empty[PROTOTYPE]=anObject(e),r=new Empty,Empty[PROTOTYPE]=null,r[IE_PROTO]=e):r=createDict(),void 0===t?r:dPs(r,t)};

},{"./_an-object":42,"./_dom-create":63,"./_enum-bug-keys":64,"./_html":77,"./_object-dps":104,"./_shared-key":129}],103:[function(require,module,exports){
var anObject=require("./_an-object"),IE8_DOM_DEFINE=require("./_ie8-dom-define"),toPrimitive=require("./_to-primitive"),dP=Object.defineProperty;exports.f=require("./_descriptors")?Object.defineProperty:function(e,r,t){if(anObject(e),r=toPrimitive(r,!0),anObject(t),IE8_DOM_DEFINE)try{return dP(e,r,t)}catch(e){}if("get"in t||"set"in t)throw TypeError("Accessors not supported!");return"value"in t&&(e[r]=t.value),e};

},{"./_an-object":42,"./_descriptors":62,"./_ie8-dom-define":78,"./_to-primitive":147}],104:[function(require,module,exports){
var dP=require("./_object-dp"),anObject=require("./_an-object"),getKeys=require("./_object-keys");module.exports=require("./_descriptors")?Object.defineProperties:function(e,r){anObject(e);for(var t,o=getKeys(r),c=o.length,i=0;c>i;)dP.f(e,t=o[i++],r[t]);return e};

},{"./_an-object":42,"./_descriptors":62,"./_object-dp":103,"./_object-keys":111}],105:[function(require,module,exports){
var pIE=require("./_object-pie"),createDesc=require("./_property-desc"),toIObject=require("./_to-iobject"),toPrimitive=require("./_to-primitive"),has=require("./_has"),IE8_DOM_DEFINE=require("./_ie8-dom-define"),gOPD=Object.getOwnPropertyDescriptor;exports.f=require("./_descriptors")?gOPD:function(e,r){if(e=toIObject(e),r=toPrimitive(r,!0),IE8_DOM_DEFINE)try{return gOPD(e,r)}catch(e){}if(has(e,r))return createDesc(!pIE.f.call(e,r),e[r])};

},{"./_descriptors":62,"./_has":75,"./_ie8-dom-define":78,"./_object-pie":112,"./_property-desc":120,"./_to-iobject":144,"./_to-primitive":147}],106:[function(require,module,exports){
var toIObject=require("./_to-iobject"),gOPN=require("./_object-gopn").f,toString={}.toString,windowNames="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],getWindowNames=function(e){try{return gOPN(e)}catch(e){return windowNames.slice()}};module.exports.f=function(e){return windowNames&&"[object Window]"==toString.call(e)?getWindowNames(e):gOPN(toIObject(e))};

},{"./_object-gopn":107,"./_to-iobject":144}],107:[function(require,module,exports){
var $keys=require("./_object-keys-internal"),hiddenKeys=require("./_enum-bug-keys").concat("length","prototype");exports.f=Object.getOwnPropertyNames||function(e){return $keys(e,hiddenKeys)};

},{"./_enum-bug-keys":64,"./_object-keys-internal":110}],108:[function(require,module,exports){
exports.f=Object.getOwnPropertySymbols;

},{}],109:[function(require,module,exports){
var has=require("./_has"),toObject=require("./_to-object"),IE_PROTO=require("./_shared-key")("IE_PROTO"),ObjectProto=Object.prototype;module.exports=Object.getPrototypeOf||function(t){return t=toObject(t),has(t,IE_PROTO)?t[IE_PROTO]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?ObjectProto:null};

},{"./_has":75,"./_shared-key":129,"./_to-object":146}],110:[function(require,module,exports){
var has=require("./_has"),toIObject=require("./_to-iobject"),arrayIndexOf=require("./_array-includes")(!1),IE_PROTO=require("./_shared-key")("IE_PROTO");module.exports=function(r,e){var a,t=toIObject(r),u=0,O=[];for(a in t)a!=IE_PROTO&&has(t,a)&&O.push(a);for(;e.length>u;)has(t,a=e[u++])&&(~arrayIndexOf(O,a)||O.push(a));return O};

},{"./_array-includes":45,"./_has":75,"./_shared-key":129,"./_to-iobject":144}],111:[function(require,module,exports){
var $keys=require("./_object-keys-internal"),enumBugKeys=require("./_enum-bug-keys");module.exports=Object.keys||function(e){return $keys(e,enumBugKeys)};

},{"./_enum-bug-keys":64,"./_object-keys-internal":110}],112:[function(require,module,exports){
exports.f={}.propertyIsEnumerable;

},{}],113:[function(require,module,exports){
var $export=require("./_export"),core=require("./_core"),fails=require("./_fails");module.exports=function(e,r){var o=(core.Object||{})[e]||Object[e],t={};t[e]=r(o),$export($export.S+$export.F*fails(function(){o(1)}),"Object",t)};

},{"./_core":56,"./_export":66,"./_fails":68}],114:[function(require,module,exports){
var DESCRIPTORS=require("./_descriptors"),getKeys=require("./_object-keys"),toIObject=require("./_to-iobject"),isEnum=require("./_object-pie").f;module.exports=function(e){return function(r){for(var t,o=toIObject(r),u=getKeys(o),i=u.length,c=0,n=[];i>c;)t=u[c++],DESCRIPTORS&&!isEnum.call(o,t)||n.push(e?[t,o[t]]:o[t]);return n}};

},{"./_descriptors":62,"./_object-keys":111,"./_object-pie":112,"./_to-iobject":144}],115:[function(require,module,exports){
var gOPN=require("./_object-gopn"),gOPS=require("./_object-gops"),anObject=require("./_an-object"),Reflect=require("./_global").Reflect;module.exports=Reflect&&Reflect.ownKeys||function(e){var r=gOPN.f(anObject(e)),t=gOPS.f;return t?r.concat(t(e)):r};

},{"./_an-object":42,"./_global":74,"./_object-gopn":107,"./_object-gops":108}],116:[function(require,module,exports){
var $parseFloat=require("./_global").parseFloat,$trim=require("./_string-trim").trim;module.exports=1/$parseFloat(require("./_string-ws")+"-0")!=-1/0?function(r){var t=$trim(String(r),3),a=$parseFloat(t);return 0===a&&"-"==t.charAt(0)?-0:a}:$parseFloat;

},{"./_global":74,"./_string-trim":138,"./_string-ws":139}],117:[function(require,module,exports){
var $parseInt=require("./_global").parseInt,$trim=require("./_string-trim").trim,ws=require("./_string-ws"),hex=/^[-+]?0[xX]/;module.exports=8!==$parseInt(ws+"08")||22!==$parseInt(ws+"0x16")?function(r,e){var t=$trim(String(r),3);return $parseInt(t,e>>>0||(hex.test(t)?16:10))}:$parseInt;

},{"./_global":74,"./_string-trim":138,"./_string-ws":139}],118:[function(require,module,exports){
module.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}};

},{}],119:[function(require,module,exports){
var anObject=require("./_an-object"),isObject=require("./_is-object"),newPromiseCapability=require("./_new-promise-capability");module.exports=function(e,r){if(anObject(e),isObject(r)&&r.constructor===e)return r;var i=newPromiseCapability.f(e);return(0,i.resolve)(r),i.promise};

},{"./_an-object":42,"./_is-object":85,"./_new-promise-capability":100}],120:[function(require,module,exports){
module.exports=function(e,r){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:r}};

},{}],121:[function(require,module,exports){
var redefine=require("./_redefine");module.exports=function(e,r,n){for(var i in r)redefine(e,i,r[i],n);return e};

},{"./_redefine":122}],122:[function(require,module,exports){
var global=require("./_global"),hide=require("./_hide"),has=require("./_has"),SRC=require("./_uid")("src"),$toString=require("./_function-to-string"),TO_STRING="toString",TPL=(""+$toString).split(TO_STRING);require("./_core").inspectSource=function(e){return $toString.call(e)},(module.exports=function(e,i,t,r){var n="function"==typeof t;n&&(has(t,"name")||hide(t,"name",i)),e[i]!==t&&(n&&(has(t,SRC)||hide(t,SRC,e[i]?""+e[i]:TPL.join(String(i)))),e===global?e[i]=t:r?e[i]?e[i]=t:hide(e,i,t):(delete e[i],hide(e,i,t)))})(Function.prototype,TO_STRING,function(){return"function"==typeof this&&this[SRC]||$toString.call(this)});

},{"./_core":56,"./_function-to-string":73,"./_global":74,"./_has":75,"./_hide":76,"./_uid":151}],123:[function(require,module,exports){
"use strict";var classof=require("./_classof"),builtinExec=RegExp.prototype.exec;module.exports=function(e,r){var t=e.exec;if("function"==typeof t){var o=t.call(e,r);if("object"!=typeof o)throw new TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==classof(e))throw new TypeError("RegExp#exec called on incompatible receiver");return builtinExec.call(e,r)};

},{"./_classof":51}],124:[function(require,module,exports){
"use strict";var regexpFlags=require("./_flags"),nativeExec=RegExp.prototype.exec,nativeReplace=String.prototype.replace,patchedExec=nativeExec,LAST_INDEX="lastIndex",UPDATES_LAST_INDEX_WRONG=function(){var e=/a/,a=/b*/g;return nativeExec.call(e,"a"),nativeExec.call(a,"a"),0!==e[LAST_INDEX]||0!==a[LAST_INDEX]}(),NPCG_INCLUDED=void 0!==/()??/.exec("")[1],PATCH=UPDATES_LAST_INDEX_WRONG||NPCG_INCLUDED;PATCH&&(patchedExec=function(e){var a,t,E,c,l=this;return NPCG_INCLUDED&&(t=new RegExp("^"+l.source+"$(?!\\s)",regexpFlags.call(l))),UPDATES_LAST_INDEX_WRONG&&(a=l[LAST_INDEX]),E=nativeExec.call(l,e),UPDATES_LAST_INDEX_WRONG&&E&&(l[LAST_INDEX]=l.global?E.index+E[0].length:a),NPCG_INCLUDED&&E&&E.length>1&&nativeReplace.call(E[0],t,function(){for(c=1;c<arguments.length-2;c++)void 0===arguments[c]&&(E[c]=void 0)}),E}),module.exports=patchedExec;

},{"./_flags":70}],125:[function(require,module,exports){
module.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t};

},{}],126:[function(require,module,exports){
var isObject=require("./_is-object"),anObject=require("./_an-object"),check=function(t,e){if(anObject(t),!isObject(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};module.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,c){try{(c=require("./_ctx")(Function.call,require("./_object-gopd").f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,r){return check(t,r),e?t.__proto__=r:c(t,r),t}}({},!1):void 0),check:check};

},{"./_an-object":42,"./_ctx":58,"./_is-object":85,"./_object-gopd":105}],127:[function(require,module,exports){
"use strict";var global=require("./_global"),dP=require("./_object-dp"),DESCRIPTORS=require("./_descriptors"),SPECIES=require("./_wks")("species");module.exports=function(e){var r=global[e];DESCRIPTORS&&r&&!r[SPECIES]&&dP.f(r,SPECIES,{configurable:!0,get:function(){return this}})};

},{"./_descriptors":62,"./_global":74,"./_object-dp":103,"./_wks":156}],128:[function(require,module,exports){
var def=require("./_object-dp").f,has=require("./_has"),TAG=require("./_wks")("toStringTag");module.exports=function(e,r,o){e&&!has(e=o?e:e.prototype,TAG)&&def(e,TAG,{configurable:!0,value:r})};

},{"./_has":75,"./_object-dp":103,"./_wks":156}],129:[function(require,module,exports){
var shared=require("./_shared")("keys"),uid=require("./_uid");module.exports=function(e){return shared[e]||(shared[e]=uid(e))};

},{"./_shared":130,"./_uid":151}],130:[function(require,module,exports){
var core=require("./_core"),global=require("./_global"),SHARED="__core-js_shared__",store=global[SHARED]||(global[SHARED]={});(module.exports=function(r,e){return store[r]||(store[r]=void 0!==e?e:{})})("versions",[]).push({version:core.version,mode:require("./_library")?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"});

},{"./_core":56,"./_global":74,"./_library":93}],131:[function(require,module,exports){
var anObject=require("./_an-object"),aFunction=require("./_a-function"),SPECIES=require("./_wks")("species");module.exports=function(e,n){var r,t=anObject(e).constructor;return void 0===t||null==(r=anObject(t)[SPECIES])?n:aFunction(r)};

},{"./_a-function":37,"./_an-object":42,"./_wks":156}],132:[function(require,module,exports){
"use strict";var fails=require("./_fails");module.exports=function(l,n){return!!l&&fails(function(){n?l.call(null,function(){},1):l.call(null)})};

},{"./_fails":68}],133:[function(require,module,exports){
var toInteger=require("./_to-integer"),defined=require("./_defined");module.exports=function(e){return function(r,t){var n,i,d=String(defined(r)),o=toInteger(t),u=d.length;return o<0||o>=u?e?"":void 0:(n=d.charCodeAt(o))<55296||n>56319||o+1===u||(i=d.charCodeAt(o+1))<56320||i>57343?e?d.charAt(o):n:e?d.slice(o,o+2):i-56320+(n-55296<<10)+65536}};

},{"./_defined":61,"./_to-integer":143}],134:[function(require,module,exports){
var isRegExp=require("./_is-regexp"),defined=require("./_defined");module.exports=function(e,r,i){if(isRegExp(r))throw TypeError("String#"+i+" doesn't accept regex!");return String(defined(e))};

},{"./_defined":61,"./_is-regexp":86}],135:[function(require,module,exports){
var $export=require("./_export"),fails=require("./_fails"),defined=require("./_defined"),quot=/"/g,createHTML=function(e,r,t,i){var n=String(defined(e)),o="<"+r;return""!==t&&(o+=" "+t+'="'+String(i).replace(quot,"&quot;")+'"'),o+">"+n+"</"+r+">"};module.exports=function(e,r){var t={};t[e]=r(createHTML),$export($export.P+$export.F*fails(function(){var r=""[e]('"');return r!==r.toLowerCase()||r.split('"').length>3}),"String",t)};

},{"./_defined":61,"./_export":66,"./_fails":68}],136:[function(require,module,exports){
var toLength=require("./_to-length"),repeat=require("./_string-repeat"),defined=require("./_defined");module.exports=function(e,r,t,n){var i=String(defined(e)),g=i.length,l=void 0===t?" ":String(t),a=toLength(r);if(a<=g||""==l)return i;var d=a-g,h=repeat.call(l,Math.ceil(d/l.length));return h.length>d&&(h=h.slice(0,d)),n?h+i:i+h};

},{"./_defined":61,"./_string-repeat":137,"./_to-length":145}],137:[function(require,module,exports){
"use strict";var toInteger=require("./_to-integer"),defined=require("./_defined");module.exports=function(e){var r=String(defined(this)),t="",n=toInteger(e);if(n<0||n==1/0)throw RangeError("Count can't be negative");for(;n>0;(n>>>=1)&&(r+=r))1&n&&(t+=r);return t};

},{"./_defined":61,"./_to-integer":143}],138:[function(require,module,exports){
var $export=require("./_export"),defined=require("./_defined"),fails=require("./_fails"),spaces=require("./_string-ws"),space="["+spaces+"]",non="​",ltrim=RegExp("^"+space+space+"*"),rtrim=RegExp(space+space+"*$"),exporter=function(e,r,t){var i={},p=fails(function(){return!!spaces[e]()||non[e]()!=non}),n=i[e]=p?r(trim):spaces[e];t&&(i[t]=n),$export($export.P+$export.F*p,"String",i)},trim=exporter.trim=function(e,r){return e=String(defined(e)),1&r&&(e=e.replace(ltrim,"")),2&r&&(e=e.replace(rtrim,"")),e};module.exports=exporter;

},{"./_defined":61,"./_export":66,"./_fails":68,"./_string-ws":139}],139:[function(require,module,exports){
module.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff";

},{}],140:[function(require,module,exports){
var defer,channel,port,ctx=require("./_ctx"),invoke=require("./_invoke"),html=require("./_html"),cel=require("./_dom-create"),global=require("./_global"),process=global.process,setTask=global.setImmediate,clearTask=global.clearImmediate,MessageChannel=global.MessageChannel,Dispatch=global.Dispatch,counter=0,queue={},ONREADYSTATECHANGE="onreadystatechange",run=function(){var e=+this;if(queue.hasOwnProperty(e)){var t=queue[e];delete queue[e],t()}},listener=function(e){run.call(e.data)};setTask&&clearTask||(setTask=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return queue[++counter]=function(){invoke("function"==typeof e?e:Function(e),t)},defer(counter),counter},clearTask=function(e){delete queue[e]},"process"==require("./_cof")(process)?defer=function(e){process.nextTick(ctx(run,e,1))}:Dispatch&&Dispatch.now?defer=function(e){Dispatch.now(ctx(run,e,1))}:MessageChannel?(port=(channel=new MessageChannel).port2,channel.port1.onmessage=listener,defer=ctx(port.postMessage,port,1)):global.addEventListener&&"function"==typeof postMessage&&!global.importScripts?(defer=function(e){global.postMessage(e+"","*")},global.addEventListener("message",listener,!1)):defer=ONREADYSTATECHANGE in cel("script")?function(e){html.appendChild(cel("script"))[ONREADYSTATECHANGE]=function(){html.removeChild(this),run.call(e)}}:function(e){setTimeout(ctx(run,e,1),0)}),module.exports={set:setTask,clear:clearTask};

},{"./_cof":52,"./_ctx":58,"./_dom-create":63,"./_global":74,"./_html":77,"./_invoke":80}],141:[function(require,module,exports){
var toInteger=require("./_to-integer"),max=Math.max,min=Math.min;module.exports=function(e,t){return(e=toInteger(e))<0?max(e+t,0):min(e,t)};

},{"./_to-integer":143}],142:[function(require,module,exports){
var toInteger=require("./_to-integer"),toLength=require("./_to-length");module.exports=function(e){if(void 0===e)return 0;var r=toInteger(e),t=toLength(r);if(r!==t)throw RangeError("Wrong length!");return t};

},{"./_to-integer":143,"./_to-length":145}],143:[function(require,module,exports){
var ceil=Math.ceil,floor=Math.floor;module.exports=function(o){return isNaN(o=+o)?0:(o>0?floor:ceil)(o)};

},{}],144:[function(require,module,exports){
var IObject=require("./_iobject"),defined=require("./_defined");module.exports=function(e){return IObject(defined(e))};

},{"./_defined":61,"./_iobject":81}],145:[function(require,module,exports){
var toInteger=require("./_to-integer"),min=Math.min;module.exports=function(e){return e>0?min(toInteger(e),9007199254740991):0};

},{"./_to-integer":143}],146:[function(require,module,exports){
var defined=require("./_defined");module.exports=function(e){return Object(defined(e))};

},{"./_defined":61}],147:[function(require,module,exports){
var isObject=require("./_is-object");module.exports=function(t,e){if(!isObject(t))return t;var r,i;if(e&&"function"==typeof(r=t.toString)&&!isObject(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!isObject(i=r.call(t)))return i;if(!e&&"function"==typeof(r=t.toString)&&!isObject(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")};

},{"./_is-object":85}],148:[function(require,module,exports){
"use strict";if(require("./_descriptors")){var LIBRARY=require("./_library"),global=require("./_global"),fails=require("./_fails"),$export=require("./_export"),$typed=require("./_typed"),$buffer=require("./_typed-buffer"),ctx=require("./_ctx"),anInstance=require("./_an-instance"),propertyDesc=require("./_property-desc"),hide=require("./_hide"),redefineAll=require("./_redefine-all"),toInteger=require("./_to-integer"),toLength=require("./_to-length"),toIndex=require("./_to-index"),toAbsoluteIndex=require("./_to-absolute-index"),toPrimitive=require("./_to-primitive"),has=require("./_has"),classof=require("./_classof"),isObject=require("./_is-object"),toObject=require("./_to-object"),isArrayIter=require("./_is-array-iter"),create=require("./_object-create"),getPrototypeOf=require("./_object-gpo"),gOPN=require("./_object-gopn").f,getIterFn=require("./core.get-iterator-method"),uid=require("./_uid"),wks=require("./_wks"),createArrayMethod=require("./_array-methods"),createArrayIncludes=require("./_array-includes"),speciesConstructor=require("./_species-constructor"),ArrayIterators=require("./es6.array.iterator"),Iterators=require("./_iterators"),$iterDetect=require("./_iter-detect"),setSpecies=require("./_set-species"),arrayFill=require("./_array-fill"),arrayCopyWithin=require("./_array-copy-within"),$DP=require("./_object-dp"),$GOPD=require("./_object-gopd"),dP=$DP.f,gOPD=$GOPD.f,RangeError=global.RangeError,TypeError=global.TypeError,Uint8Array=global.Uint8Array,ARRAY_BUFFER="ArrayBuffer",SHARED_BUFFER="Shared"+ARRAY_BUFFER,BYTES_PER_ELEMENT="BYTES_PER_ELEMENT",PROTOTYPE="prototype",ArrayProto=Array[PROTOTYPE],$ArrayBuffer=$buffer.ArrayBuffer,$DataView=$buffer.DataView,arrayForEach=createArrayMethod(0),arrayFilter=createArrayMethod(2),arraySome=createArrayMethod(3),arrayEvery=createArrayMethod(4),arrayFind=createArrayMethod(5),arrayFindIndex=createArrayMethod(6),arrayIncludes=createArrayIncludes(!0),arrayIndexOf=createArrayIncludes(!1),arrayValues=ArrayIterators.values,arrayKeys=ArrayIterators.keys,arrayEntries=ArrayIterators.entries,arrayLastIndexOf=ArrayProto.lastIndexOf,arrayReduce=ArrayProto.reduce,arrayReduceRight=ArrayProto.reduceRight,arrayJoin=ArrayProto.join,arraySort=ArrayProto.sort,arraySlice=ArrayProto.slice,arrayToString=ArrayProto.toString,arrayToLocaleString=ArrayProto.toLocaleString,ITERATOR=wks("iterator"),TAG=wks("toStringTag"),TYPED_CONSTRUCTOR=uid("typed_constructor"),DEF_CONSTRUCTOR=uid("def_constructor"),ALL_CONSTRUCTORS=$typed.CONSTR,TYPED_ARRAY=$typed.TYPED,VIEW=$typed.VIEW,WRONG_LENGTH="Wrong length!",$map=createArrayMethod(1,function(r,e){return allocate(speciesConstructor(r,r[DEF_CONSTRUCTOR]),e)}),LITTLE_ENDIAN=fails(function(){return 1===new Uint8Array(new Uint16Array([1]).buffer)[0]}),FORCED_SET=!!Uint8Array&&!!Uint8Array[PROTOTYPE].set&&fails(function(){new Uint8Array(1).set({})}),toOffset=function(r,e){var t=toInteger(r);if(t<0||t%e)throw RangeError("Wrong offset!");return t},validate=function(r){if(isObject(r)&&TYPED_ARRAY in r)return r;throw TypeError(r+" is not a typed array!")},allocate=function(r,e){if(!(isObject(r)&&TYPED_CONSTRUCTOR in r))throw TypeError("It is not a typed array constructor!");return new r(e)},speciesFromList=function(r,e){return fromList(speciesConstructor(r,r[DEF_CONSTRUCTOR]),e)},fromList=function(r,e){for(var t=0,a=e.length,i=allocate(r,a);a>t;)i[t]=e[t++];return i},addGetter=function(r,e,t){dP(r,e,{get:function(){return this._d[t]}})},$from=function(r){var e,t,a,i,o,n,s=toObject(r),c=arguments.length,u=c>1?arguments[1]:void 0,l=void 0!==u,f=getIterFn(s);if(null!=f&&!isArrayIter(f)){for(n=f.call(s),a=[],e=0;!(o=n.next()).done;e++)a.push(o.value);s=a}for(l&&c>2&&(u=ctx(u,arguments[2],2)),e=0,t=toLength(s.length),i=allocate(this,t);t>e;e++)i[e]=l?u(s[e],e):s[e];return i},$of=function(){for(var r=0,e=arguments.length,t=allocate(this,e);e>r;)t[r]=arguments[r++];return t},TO_LOCALE_BUG=!!Uint8Array&&fails(function(){arrayToLocaleString.call(new Uint8Array(1))}),$toLocaleString=function(){return arrayToLocaleString.apply(TO_LOCALE_BUG?arraySlice.call(validate(this)):validate(this),arguments)},proto={copyWithin:function(r,e){return arrayCopyWithin.call(validate(this),r,e,arguments.length>2?arguments[2]:void 0)},every:function(r){return arrayEvery(validate(this),r,arguments.length>1?arguments[1]:void 0)},fill:function(r){return arrayFill.apply(validate(this),arguments)},filter:function(r){return speciesFromList(this,arrayFilter(validate(this),r,arguments.length>1?arguments[1]:void 0))},find:function(r){return arrayFind(validate(this),r,arguments.length>1?arguments[1]:void 0)},findIndex:function(r){return arrayFindIndex(validate(this),r,arguments.length>1?arguments[1]:void 0)},forEach:function(r){arrayForEach(validate(this),r,arguments.length>1?arguments[1]:void 0)},indexOf:function(r){return arrayIndexOf(validate(this),r,arguments.length>1?arguments[1]:void 0)},includes:function(r){return arrayIncludes(validate(this),r,arguments.length>1?arguments[1]:void 0)},join:function(r){return arrayJoin.apply(validate(this),arguments)},lastIndexOf:function(r){return arrayLastIndexOf.apply(validate(this),arguments)},map:function(r){return $map(validate(this),r,arguments.length>1?arguments[1]:void 0)},reduce:function(r){return arrayReduce.apply(validate(this),arguments)},reduceRight:function(r){return arrayReduceRight.apply(validate(this),arguments)},reverse:function(){for(var r,e=validate(this).length,t=Math.floor(e/2),a=0;a<t;)r=this[a],this[a++]=this[--e],this[e]=r;return this},some:function(r){return arraySome(validate(this),r,arguments.length>1?arguments[1]:void 0)},sort:function(r){return arraySort.call(validate(this),r)},subarray:function(r,e){var t=validate(this),a=t.length,i=toAbsoluteIndex(r,a);return new(speciesConstructor(t,t[DEF_CONSTRUCTOR]))(t.buffer,t.byteOffset+i*t.BYTES_PER_ELEMENT,toLength((void 0===e?a:toAbsoluteIndex(e,a))-i))}},$slice=function(r,e){return speciesFromList(this,arraySlice.call(validate(this),r,e))},$set=function(r){validate(this);var e=toOffset(arguments[1],1),t=this.length,a=toObject(r),i=toLength(a.length),o=0;if(i+e>t)throw RangeError(WRONG_LENGTH);for(;o<i;)this[e+o]=a[o++]},$iterators={entries:function(){return arrayEntries.call(validate(this))},keys:function(){return arrayKeys.call(validate(this))},values:function(){return arrayValues.call(validate(this))}},isTAIndex=function(r,e){return isObject(r)&&r[TYPED_ARRAY]&&"symbol"!=typeof e&&e in r&&String(+e)==String(e)},$getDesc=function(r,e){return isTAIndex(r,e=toPrimitive(e,!0))?propertyDesc(2,r[e]):gOPD(r,e)},$setDesc=function(r,e,t){return!(isTAIndex(r,e=toPrimitive(e,!0))&&isObject(t)&&has(t,"value"))||has(t,"get")||has(t,"set")||t.configurable||has(t,"writable")&&!t.writable||has(t,"enumerable")&&!t.enumerable?dP(r,e,t):(r[e]=t.value,r)};ALL_CONSTRUCTORS||($GOPD.f=$getDesc,$DP.f=$setDesc),$export($export.S+$export.F*!ALL_CONSTRUCTORS,"Object",{getOwnPropertyDescriptor:$getDesc,defineProperty:$setDesc}),fails(function(){arrayToString.call({})})&&(arrayToString=arrayToLocaleString=function(){return arrayJoin.call(this)});var $TypedArrayPrototype$=redefineAll({},proto);redefineAll($TypedArrayPrototype$,$iterators),hide($TypedArrayPrototype$,ITERATOR,$iterators.values),redefineAll($TypedArrayPrototype$,{slice:$slice,set:$set,constructor:function(){},toString:arrayToString,toLocaleString:$toLocaleString}),addGetter($TypedArrayPrototype$,"buffer","b"),addGetter($TypedArrayPrototype$,"byteOffset","o"),addGetter($TypedArrayPrototype$,"byteLength","l"),addGetter($TypedArrayPrototype$,"length","e"),dP($TypedArrayPrototype$,TAG,{get:function(){return this[TYPED_ARRAY]}}),module.exports=function(r,e,t,a){var i=r+((a=!!a)?"Clamped":"")+"Array",o="get"+r,n="set"+r,s=global[i],c=s||{},u=s&&getPrototypeOf(s),l=!s||!$typed.ABV,f={},y=s&&s[PROTOTYPE],d=function(r,t){dP(r,t,{get:function(){return function(r,t){var a=r._d;return a.v[o](t*e+a.o,LITTLE_ENDIAN)}(this,t)},set:function(r){return function(r,t,i){var o=r._d;a&&(i=(i=Math.round(i))<0?0:i>255?255:255&i),o.v[n](t*e+o.o,i,LITTLE_ENDIAN)}(this,t,r)},enumerable:!0})};l?(s=t(function(r,t,a,o){anInstance(r,s,i,"_d");var n,c,u,l,f=0,y=0;if(isObject(t)){if(!(t instanceof $ArrayBuffer||(l=classof(t))==ARRAY_BUFFER||l==SHARED_BUFFER))return TYPED_ARRAY in t?fromList(s,t):$from.call(s,t);n=t,y=toOffset(a,e);var h=t.byteLength;if(void 0===o){if(h%e)throw RangeError(WRONG_LENGTH);if((c=h-y)<0)throw RangeError(WRONG_LENGTH)}else if((c=toLength(o)*e)+y>h)throw RangeError(WRONG_LENGTH);u=c/e}else u=toIndex(t),n=new $ArrayBuffer(c=u*e);for(hide(r,"_d",{b:n,o:y,l:c,e:u,v:new $DataView(n)});f<u;)d(r,f++)}),y=s[PROTOTYPE]=create($TypedArrayPrototype$),hide(y,"constructor",s)):fails(function(){s(1)})&&fails(function(){new s(-1)})&&$iterDetect(function(r){new s,new s(null),new s(1.5),new s(r)},!0)||(s=t(function(r,t,a,o){var n;return anInstance(r,s,i),isObject(t)?t instanceof $ArrayBuffer||(n=classof(t))==ARRAY_BUFFER||n==SHARED_BUFFER?void 0!==o?new c(t,toOffset(a,e),o):void 0!==a?new c(t,toOffset(a,e)):new c(t):TYPED_ARRAY in t?fromList(s,t):$from.call(s,t):new c(toIndex(t))}),arrayForEach(u!==Function.prototype?gOPN(c).concat(gOPN(u)):gOPN(c),function(r){r in s||hide(s,r,c[r])}),s[PROTOTYPE]=y,LIBRARY||(y.constructor=s));var h=y[ITERATOR],p=!!h&&("values"==h.name||null==h.name),T=$iterators.values;hide(s,TYPED_CONSTRUCTOR,!0),hide(y,TYPED_ARRAY,i),hide(y,VIEW,!0),hide(y,DEF_CONSTRUCTOR,s),(a?new s(1)[TAG]==i:TAG in y)||dP(y,TAG,{get:function(){return i}}),f[i]=s,$export($export.G+$export.W+$export.F*(s!=c),f),$export($export.S,i,{BYTES_PER_ELEMENT:e}),$export($export.S+$export.F*fails(function(){c.of.call(s,1)}),i,{from:$from,of:$of}),BYTES_PER_ELEMENT in y||hide(y,BYTES_PER_ELEMENT,e),$export($export.P,i,proto),setSpecies(i),$export($export.P+$export.F*FORCED_SET,i,{set:$set}),$export($export.P+$export.F*!p,i,$iterators),LIBRARY||y.toString==arrayToString||(y.toString=arrayToString),$export($export.P+$export.F*fails(function(){new s(1).slice()}),i,{slice:$slice}),$export($export.P+$export.F*(fails(function(){return[1,2].toLocaleString()!=new s([1,2]).toLocaleString()})||!fails(function(){y.toLocaleString.call([1,2])})),i,{toLocaleString:$toLocaleString}),Iterators[i]=p?h:T,LIBRARY||p||hide(y,ITERATOR,T)}}else module.exports=function(){};

},{"./_an-instance":41,"./_array-copy-within":43,"./_array-fill":44,"./_array-includes":45,"./_array-methods":46,"./_classof":51,"./_ctx":58,"./_descriptors":62,"./_export":66,"./_fails":68,"./_global":74,"./_has":75,"./_hide":76,"./_is-array-iter":82,"./_is-object":85,"./_iter-detect":90,"./_iterators":92,"./_library":93,"./_object-create":102,"./_object-dp":103,"./_object-gopd":105,"./_object-gopn":107,"./_object-gpo":109,"./_property-desc":120,"./_redefine-all":121,"./_set-species":127,"./_species-constructor":131,"./_to-absolute-index":141,"./_to-index":142,"./_to-integer":143,"./_to-length":145,"./_to-object":146,"./_to-primitive":147,"./_typed":150,"./_typed-buffer":149,"./_uid":151,"./_wks":156,"./core.get-iterator-method":157,"./es6.array.iterator":168}],149:[function(require,module,exports){
"use strict";var global=require("./_global"),DESCRIPTORS=require("./_descriptors"),LIBRARY=require("./_library"),$typed=require("./_typed"),hide=require("./_hide"),redefineAll=require("./_redefine-all"),fails=require("./_fails"),anInstance=require("./_an-instance"),toInteger=require("./_to-integer"),toLength=require("./_to-length"),toIndex=require("./_to-index"),gOPN=require("./_object-gopn").f,dP=require("./_object-dp").f,arrayFill=require("./_array-fill"),setToStringTag=require("./_set-to-string-tag"),ARRAY_BUFFER="ArrayBuffer",DATA_VIEW="DataView",PROTOTYPE="prototype",WRONG_LENGTH="Wrong length!",WRONG_INDEX="Wrong index!",$ArrayBuffer=global[ARRAY_BUFFER],$DataView=global[DATA_VIEW],Math=global.Math,RangeError=global.RangeError,Infinity=global.Infinity,BaseBuffer=$ArrayBuffer,abs=Math.abs,pow=Math.pow,floor=Math.floor,log=Math.log,LN2=Math.LN2,BUFFER="buffer",BYTE_LENGTH="byteLength",BYTE_OFFSET="byteOffset",$BUFFER=DESCRIPTORS?"_b":BUFFER,$LENGTH=DESCRIPTORS?"_l":BYTE_LENGTH,$OFFSET=DESCRIPTORS?"_o":BYTE_OFFSET;function packIEEE754(t,e,r){var n,a,i,f=new Array(r),o=8*r-e-1,u=(1<<o)-1,s=u>>1,E=23===e?pow(2,-24)-pow(2,-77):0,c=0,I=t<0||0===t&&1/t<0?1:0;for((t=abs(t))!=t||t===Infinity?(a=t!=t?1:0,n=u):(n=floor(log(t)/LN2),t*(i=pow(2,-n))<1&&(n--,i*=2),(t+=n+s>=1?E/i:E*pow(2,1-s))*i>=2&&(n++,i/=2),n+s>=u?(a=0,n=u):n+s>=1?(a=(t*i-1)*pow(2,e),n+=s):(a=t*pow(2,s-1)*pow(2,e),n=0));e>=8;f[c++]=255&a,a/=256,e-=8);for(n=n<<e|a,o+=e;o>0;f[c++]=255&n,n/=256,o-=8);return f[--c]|=128*I,f}function unpackIEEE754(t,e,r){var n,a=8*r-e-1,i=(1<<a)-1,f=i>>1,o=a-7,u=r-1,s=t[u--],E=127&s;for(s>>=7;o>0;E=256*E+t[u],u--,o-=8);for(n=E&(1<<-o)-1,E>>=-o,o+=e;o>0;n=256*n+t[u],u--,o-=8);if(0===E)E=1-f;else{if(E===i)return n?NaN:s?-Infinity:Infinity;n+=pow(2,e),E-=f}return(s?-1:1)*n*pow(2,E-e)}function unpackI32(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function packI8(t){return[255&t]}function packI16(t){return[255&t,t>>8&255]}function packI32(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function packF64(t){return packIEEE754(t,52,8)}function packF32(t){return packIEEE754(t,23,4)}function addGetter(t,e,r){dP(t[PROTOTYPE],e,{get:function(){return this[r]}})}function get(t,e,r,n){var a=toIndex(+r);if(a+e>t[$LENGTH])throw RangeError(WRONG_INDEX);var i=t[$BUFFER]._b,f=a+t[$OFFSET],o=i.slice(f,f+e);return n?o:o.reverse()}function set(t,e,r,n,a,i){var f=toIndex(+r);if(f+e>t[$LENGTH])throw RangeError(WRONG_INDEX);for(var o=t[$BUFFER]._b,u=f+t[$OFFSET],s=n(+a),E=0;E<e;E++)o[u+E]=s[i?E:e-E-1]}if($typed.ABV){if(!fails(function(){$ArrayBuffer(1)})||!fails(function(){new $ArrayBuffer(-1)})||fails(function(){return new $ArrayBuffer,new $ArrayBuffer(1.5),new $ArrayBuffer(NaN),$ArrayBuffer.name!=ARRAY_BUFFER})){for(var key,ArrayBufferProto=($ArrayBuffer=function(t){return anInstance(this,$ArrayBuffer),new BaseBuffer(toIndex(t))})[PROTOTYPE]=BaseBuffer[PROTOTYPE],keys=gOPN(BaseBuffer),j=0;keys.length>j;)(key=keys[j++])in $ArrayBuffer||hide($ArrayBuffer,key,BaseBuffer[key]);LIBRARY||(ArrayBufferProto.constructor=$ArrayBuffer)}var view=new $DataView(new $ArrayBuffer(2)),$setInt8=$DataView[PROTOTYPE].setInt8;view.setInt8(0,2147483648),view.setInt8(1,2147483649),!view.getInt8(0)&&view.getInt8(1)||redefineAll($DataView[PROTOTYPE],{setInt8:function(t,e){$setInt8.call(this,t,e<<24>>24)},setUint8:function(t,e){$setInt8.call(this,t,e<<24>>24)}},!0)}else $ArrayBuffer=function(t){anInstance(this,$ArrayBuffer,ARRAY_BUFFER);var e=toIndex(t);this._b=arrayFill.call(new Array(e),0),this[$LENGTH]=e},$DataView=function(t,e,r){anInstance(this,$DataView,DATA_VIEW),anInstance(t,$ArrayBuffer,DATA_VIEW);var n=t[$LENGTH],a=toInteger(e);if(a<0||a>n)throw RangeError("Wrong offset!");if(a+(r=void 0===r?n-a:toLength(r))>n)throw RangeError(WRONG_LENGTH);this[$BUFFER]=t,this[$OFFSET]=a,this[$LENGTH]=r},DESCRIPTORS&&(addGetter($ArrayBuffer,BYTE_LENGTH,"_l"),addGetter($DataView,BUFFER,"_b"),addGetter($DataView,BYTE_LENGTH,"_l"),addGetter($DataView,BYTE_OFFSET,"_o")),redefineAll($DataView[PROTOTYPE],{getInt8:function(t){return get(this,1,t)[0]<<24>>24},getUint8:function(t){return get(this,1,t)[0]},getInt16:function(t){var e=get(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=get(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return unpackI32(get(this,4,t,arguments[1]))},getUint32:function(t){return unpackI32(get(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return unpackIEEE754(get(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return unpackIEEE754(get(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){set(this,1,t,packI8,e)},setUint8:function(t,e){set(this,1,t,packI8,e)},setInt16:function(t,e){set(this,2,t,packI16,e,arguments[2])},setUint16:function(t,e){set(this,2,t,packI16,e,arguments[2])},setInt32:function(t,e){set(this,4,t,packI32,e,arguments[2])},setUint32:function(t,e){set(this,4,t,packI32,e,arguments[2])},setFloat32:function(t,e){set(this,4,t,packF32,e,arguments[2])},setFloat64:function(t,e){set(this,8,t,packF64,e,arguments[2])}});setToStringTag($ArrayBuffer,ARRAY_BUFFER),setToStringTag($DataView,DATA_VIEW),hide($DataView[PROTOTYPE],$typed.VIEW,!0),exports[ARRAY_BUFFER]=$ArrayBuffer,exports[DATA_VIEW]=$DataView;

},{"./_an-instance":41,"./_array-fill":44,"./_descriptors":62,"./_fails":68,"./_global":74,"./_hide":76,"./_library":93,"./_object-dp":103,"./_object-gopn":107,"./_redefine-all":121,"./_set-to-string-tag":128,"./_to-index":142,"./_to-integer":143,"./_to-length":145,"./_typed":150}],150:[function(require,module,exports){
for(var Typed,global=require("./_global"),hide=require("./_hide"),uid=require("./_uid"),TYPED=uid("typed_array"),VIEW=uid("view"),ABV=!(!global.ArrayBuffer||!global.DataView),CONSTR=ABV,i=0,l=9,TypedArrayConstructors="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");i<l;)(Typed=global[TypedArrayConstructors[i++]])?(hide(Typed.prototype,TYPED,!0),hide(Typed.prototype,VIEW,!0)):CONSTR=!1;module.exports={ABV:ABV,CONSTR:CONSTR,TYPED:TYPED,VIEW:VIEW};

},{"./_global":74,"./_hide":76,"./_uid":151}],151:[function(require,module,exports){
var id=0,px=Math.random();module.exports=function(o){return"Symbol(".concat(void 0===o?"":o,")_",(++id+px).toString(36))};

},{}],152:[function(require,module,exports){
var global=require("./_global"),navigator=global.navigator;module.exports=navigator&&navigator.userAgent||"";

},{"./_global":74}],153:[function(require,module,exports){
var isObject=require("./_is-object");module.exports=function(e,r){if(!isObject(e)||e._t!==r)throw TypeError("Incompatible receiver, "+r+" required!");return e};

},{"./_is-object":85}],154:[function(require,module,exports){
var global=require("./_global"),core=require("./_core"),LIBRARY=require("./_library"),wksExt=require("./_wks-ext"),defineProperty=require("./_object-dp").f;module.exports=function(e){var r=core.Symbol||(core.Symbol=LIBRARY?{}:global.Symbol||{});"_"==e.charAt(0)||e in r||defineProperty(r,e,{value:wksExt.f(e)})};

},{"./_core":56,"./_global":74,"./_library":93,"./_object-dp":103,"./_wks-ext":155}],155:[function(require,module,exports){
exports.f=require("./_wks");

},{"./_wks":156}],156:[function(require,module,exports){
var store=require("./_shared")("wks"),uid=require("./_uid"),Symbol=require("./_global").Symbol,USE_SYMBOL="function"==typeof Symbol,$exports=module.exports=function(o){return store[o]||(store[o]=USE_SYMBOL&&Symbol[o]||(USE_SYMBOL?Symbol:uid)("Symbol."+o))};$exports.store=store;

},{"./_global":74,"./_shared":130,"./_uid":151}],157:[function(require,module,exports){
var classof=require("./_classof"),ITERATOR=require("./_wks")("iterator"),Iterators=require("./_iterators");module.exports=require("./_core").getIteratorMethod=function(r){if(null!=r)return r[ITERATOR]||r["@@iterator"]||Iterators[classof(r)]};

},{"./_classof":51,"./_core":56,"./_iterators":92,"./_wks":156}],158:[function(require,module,exports){
var $export=require("./_export");$export($export.P,"Array",{copyWithin:require("./_array-copy-within")}),require("./_add-to-unscopables")("copyWithin");

},{"./_add-to-unscopables":39,"./_array-copy-within":43,"./_export":66}],159:[function(require,module,exports){
"use strict";var $export=require("./_export"),$every=require("./_array-methods")(4);$export($export.P+$export.F*!require("./_strict-method")([].every,!0),"Array",{every:function(r){return $every(this,r,arguments[1])}});

},{"./_array-methods":46,"./_export":66,"./_strict-method":132}],160:[function(require,module,exports){
var $export=require("./_export");$export($export.P,"Array",{fill:require("./_array-fill")}),require("./_add-to-unscopables")("fill");

},{"./_add-to-unscopables":39,"./_array-fill":44,"./_export":66}],161:[function(require,module,exports){
"use strict";var $export=require("./_export"),$filter=require("./_array-methods")(2);$export($export.P+$export.F*!require("./_strict-method")([].filter,!0),"Array",{filter:function(r){return $filter(this,r,arguments[1])}});

},{"./_array-methods":46,"./_export":66,"./_strict-method":132}],162:[function(require,module,exports){
"use strict";var $export=require("./_export"),$find=require("./_array-methods")(6),KEY="findIndex",forced=!0;KEY in[]&&Array(1)[KEY](function(){forced=!1}),$export($export.P+$export.F*forced,"Array",{findIndex:function(r){return $find(this,r,arguments.length>1?arguments[1]:void 0)}}),require("./_add-to-unscopables")(KEY);

},{"./_add-to-unscopables":39,"./_array-methods":46,"./_export":66}],163:[function(require,module,exports){
"use strict";var $export=require("./_export"),$find=require("./_array-methods")(5),KEY="find",forced=!0;KEY in[]&&Array(1)[KEY](function(){forced=!1}),$export($export.P+$export.F*forced,"Array",{find:function(r){return $find(this,r,arguments.length>1?arguments[1]:void 0)}}),require("./_add-to-unscopables")(KEY);

},{"./_add-to-unscopables":39,"./_array-methods":46,"./_export":66}],164:[function(require,module,exports){
"use strict";var $export=require("./_export"),$forEach=require("./_array-methods")(0),STRICT=require("./_strict-method")([].forEach,!0);$export($export.P+$export.F*!STRICT,"Array",{forEach:function(r){return $forEach(this,r,arguments[1])}});

},{"./_array-methods":46,"./_export":66,"./_strict-method":132}],165:[function(require,module,exports){
"use strict";var ctx=require("./_ctx"),$export=require("./_export"),toObject=require("./_to-object"),call=require("./_iter-call"),isArrayIter=require("./_is-array-iter"),toLength=require("./_to-length"),createProperty=require("./_create-property"),getIterFn=require("./core.get-iterator-method");$export($export.S+$export.F*!require("./_iter-detect")(function(e){Array.from(e)}),"Array",{from:function(e){var r,t,o,i,a=toObject(e),c="function"==typeof this?this:Array,n=arguments.length,l=n>1?arguments[1]:void 0,u=void 0!==l,y=0,p=getIterFn(a);if(u&&(l=ctx(l,n>2?arguments[2]:void 0,2)),null==p||c==Array&&isArrayIter(p))for(t=new c(r=toLength(a.length));r>y;y++)createProperty(t,y,u?l(a[y],y):a[y]);else for(i=p.call(a),t=new c;!(o=i.next()).done;y++)createProperty(t,y,u?call(i,l,[o.value,y],!0):o.value);return t.length=y,t}});

},{"./_create-property":57,"./_ctx":58,"./_export":66,"./_is-array-iter":82,"./_iter-call":87,"./_iter-detect":90,"./_to-length":145,"./_to-object":146,"./core.get-iterator-method":157}],166:[function(require,module,exports){
"use strict";var $export=require("./_export"),$indexOf=require("./_array-includes")(!1),$native=[].indexOf,NEGATIVE_ZERO=!!$native&&1/[1].indexOf(1,-0)<0;$export($export.P+$export.F*(NEGATIVE_ZERO||!require("./_strict-method")($native)),"Array",{indexOf:function(e){return NEGATIVE_ZERO?$native.apply(this,arguments)||0:$indexOf(this,e,arguments[1])}});

},{"./_array-includes":45,"./_export":66,"./_strict-method":132}],167:[function(require,module,exports){
var $export=require("./_export");$export($export.S,"Array",{isArray:require("./_is-array")});

},{"./_export":66,"./_is-array":83}],168:[function(require,module,exports){
"use strict";var addToUnscopables=require("./_add-to-unscopables"),step=require("./_iter-step"),Iterators=require("./_iterators"),toIObject=require("./_to-iobject");module.exports=require("./_iter-define")(Array,"Array",function(e,t){this._t=toIObject(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,s=this._i++;return!e||s>=e.length?(this._t=void 0,step(1)):step(0,"keys"==t?s:"values"==t?e[s]:[s,e[s]])},"values"),Iterators.Arguments=Iterators.Array,addToUnscopables("keys"),addToUnscopables("values"),addToUnscopables("entries");

},{"./_add-to-unscopables":39,"./_iter-define":89,"./_iter-step":91,"./_iterators":92,"./_to-iobject":144}],169:[function(require,module,exports){
"use strict";var $export=require("./_export"),toIObject=require("./_to-iobject"),arrayJoin=[].join;$export($export.P+$export.F*(require("./_iobject")!=Object||!require("./_strict-method")(arrayJoin)),"Array",{join:function(r){return arrayJoin.call(toIObject(this),void 0===r?",":r)}});

},{"./_export":66,"./_iobject":81,"./_strict-method":132,"./_to-iobject":144}],170:[function(require,module,exports){
"use strict";var $export=require("./_export"),toIObject=require("./_to-iobject"),toInteger=require("./_to-integer"),toLength=require("./_to-length"),$native=[].lastIndexOf,NEGATIVE_ZERO=!!$native&&1/[1].lastIndexOf(1,-0)<0;$export($export.P+$export.F*(NEGATIVE_ZERO||!require("./_strict-method")($native)),"Array",{lastIndexOf:function(t){if(NEGATIVE_ZERO)return $native.apply(this,arguments)||0;var e=toIObject(this),r=toLength(e.length),n=r-1;for(arguments.length>1&&(n=Math.min(n,toInteger(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in e&&e[n]===t)return n||0;return-1}});

},{"./_export":66,"./_strict-method":132,"./_to-integer":143,"./_to-iobject":144,"./_to-length":145}],171:[function(require,module,exports){
"use strict";var $export=require("./_export"),$map=require("./_array-methods")(1);$export($export.P+$export.F*!require("./_strict-method")([].map,!0),"Array",{map:function(r){return $map(this,r,arguments[1])}});

},{"./_array-methods":46,"./_export":66,"./_strict-method":132}],172:[function(require,module,exports){
"use strict";var $export=require("./_export"),createProperty=require("./_create-property");$export($export.S+$export.F*require("./_fails")(function(){function r(){}return!(Array.of.call(r)instanceof r)}),"Array",{of:function(){for(var r=0,e=arguments.length,t=new("function"==typeof this?this:Array)(e);e>r;)createProperty(t,r,arguments[r++]);return t.length=e,t}});

},{"./_create-property":57,"./_export":66,"./_fails":68}],173:[function(require,module,exports){
"use strict";var $export=require("./_export"),$reduce=require("./_array-reduce");$export($export.P+$export.F*!require("./_strict-method")([].reduceRight,!0),"Array",{reduceRight:function(e){return $reduce(this,e,arguments.length,arguments[1],!0)}});

},{"./_array-reduce":47,"./_export":66,"./_strict-method":132}],174:[function(require,module,exports){
"use strict";var $export=require("./_export"),$reduce=require("./_array-reduce");$export($export.P+$export.F*!require("./_strict-method")([].reduce,!0),"Array",{reduce:function(e){return $reduce(this,e,arguments.length,arguments[1],!1)}});

},{"./_array-reduce":47,"./_export":66,"./_strict-method":132}],175:[function(require,module,exports){
"use strict";var $export=require("./_export"),html=require("./_html"),cof=require("./_cof"),toAbsoluteIndex=require("./_to-absolute-index"),toLength=require("./_to-length"),arraySlice=[].slice;$export($export.P+$export.F*require("./_fails")(function(){html&&arraySlice.call(html)}),"Array",{slice:function(r,e){var t=toLength(this.length),i=cof(this);if(e=void 0===e?t:e,"Array"==i)return arraySlice.call(this,r,e);for(var o=toAbsoluteIndex(r,t),l=toAbsoluteIndex(e,t),a=toLength(l-o),n=new Array(a),h=0;h<a;h++)n[h]="String"==i?this.charAt(o+h):this[o+h];return n}});

},{"./_cof":52,"./_export":66,"./_fails":68,"./_html":77,"./_to-absolute-index":141,"./_to-length":145}],176:[function(require,module,exports){
"use strict";var $export=require("./_export"),$some=require("./_array-methods")(3);$export($export.P+$export.F*!require("./_strict-method")([].some,!0),"Array",{some:function(r){return $some(this,r,arguments[1])}});

},{"./_array-methods":46,"./_export":66,"./_strict-method":132}],177:[function(require,module,exports){
"use strict";var $export=require("./_export"),aFunction=require("./_a-function"),toObject=require("./_to-object"),fails=require("./_fails"),$sort=[].sort,test=[1,2,3];$export($export.P+$export.F*(fails(function(){test.sort(void 0)})||!fails(function(){test.sort(null)})||!require("./_strict-method")($sort)),"Array",{sort:function(t){return void 0===t?$sort.call(toObject(this)):$sort.call(toObject(this),aFunction(t))}});

},{"./_a-function":37,"./_export":66,"./_fails":68,"./_strict-method":132,"./_to-object":146}],178:[function(require,module,exports){
require("./_set-species")("Array");

},{"./_set-species":127}],179:[function(require,module,exports){
var $export=require("./_export");$export($export.S,"Date",{now:function(){return(new Date).getTime()}});

},{"./_export":66}],180:[function(require,module,exports){
var $export=require("./_export"),toISOString=require("./_date-to-iso-string");$export($export.P+$export.F*(Date.prototype.toISOString!==toISOString),"Date",{toISOString:toISOString});

},{"./_date-to-iso-string":59,"./_export":66}],181:[function(require,module,exports){
"use strict";var $export=require("./_export"),toObject=require("./_to-object"),toPrimitive=require("./_to-primitive");$export($export.P+$export.F*require("./_fails")(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(t){var e=toObject(this),r=toPrimitive(e);return"number"!=typeof r||isFinite(r)?e.toISOString():null}});

},{"./_export":66,"./_fails":68,"./_to-object":146,"./_to-primitive":147}],182:[function(require,module,exports){
var TO_PRIMITIVE=require("./_wks")("toPrimitive"),proto=Date.prototype;TO_PRIMITIVE in proto||require("./_hide")(proto,TO_PRIMITIVE,require("./_date-to-primitive"));

},{"./_date-to-primitive":60,"./_hide":76,"./_wks":156}],183:[function(require,module,exports){
var DateProto=Date.prototype,INVALID_DATE="Invalid Date",TO_STRING="toString",$toString=DateProto[TO_STRING],getTime=DateProto.getTime;new Date(NaN)+""!=INVALID_DATE&&require("./_redefine")(DateProto,TO_STRING,function(){var t=getTime.call(this);return t==t?$toString.call(this):INVALID_DATE});

},{"./_redefine":122}],184:[function(require,module,exports){
var $export=require("./_export");$export($export.P,"Function",{bind:require("./_bind")});

},{"./_bind":50,"./_export":66}],185:[function(require,module,exports){
"use strict";var isObject=require("./_is-object"),getPrototypeOf=require("./_object-gpo"),HAS_INSTANCE=require("./_wks")("hasInstance"),FunctionProto=Function.prototype;HAS_INSTANCE in FunctionProto||require("./_object-dp").f(FunctionProto,HAS_INSTANCE,{value:function(t){if("function"!=typeof this||!isObject(t))return!1;if(!isObject(this.prototype))return t instanceof this;for(;t=getPrototypeOf(t);)if(this.prototype===t)return!0;return!1}});

},{"./_is-object":85,"./_object-dp":103,"./_object-gpo":109,"./_wks":156}],186:[function(require,module,exports){
var dP=require("./_object-dp").f,FProto=Function.prototype,nameRE=/^\s*function ([^ (]*)/,NAME="name";NAME in FProto||require("./_descriptors")&&dP(FProto,NAME,{configurable:!0,get:function(){try{return(""+this).match(nameRE)[1]}catch(r){return""}}});

},{"./_descriptors":62,"./_object-dp":103}],187:[function(require,module,exports){
"use strict";var strong=require("./_collection-strong"),validate=require("./_validate-collection"),MAP="Map";module.exports=require("./_collection")(MAP,function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=strong.getEntry(validate(this,MAP),t);return e&&e.v},set:function(t,e){return strong.def(validate(this,MAP),0===t?0:t,e)}},strong,!0);

},{"./_collection":55,"./_collection-strong":53,"./_validate-collection":153}],188:[function(require,module,exports){
var $export=require("./_export"),log1p=require("./_math-log1p"),sqrt=Math.sqrt,$acosh=Math.acosh;$export($export.S+$export.F*!($acosh&&710==Math.floor($acosh(Number.MAX_VALUE))&&$acosh(1/0)==1/0),"Math",{acosh:function(o){return(o=+o)<1?NaN:o>94906265.62425156?Math.log(o)+Math.LN2:log1p(o-1+sqrt(o-1)*sqrt(o+1))}});

},{"./_export":66,"./_math-log1p":96}],189:[function(require,module,exports){
var $export=require("./_export"),$asinh=Math.asinh;function asinh(a){return isFinite(a=+a)&&0!=a?a<0?-asinh(-a):Math.log(a+Math.sqrt(a*a+1)):a}$export($export.S+$export.F*!($asinh&&1/$asinh(0)>0),"Math",{asinh:asinh});

},{"./_export":66}],190:[function(require,module,exports){
var $export=require("./_export"),$atanh=Math.atanh;$export($export.S+$export.F*!($atanh&&1/$atanh(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}});

},{"./_export":66}],191:[function(require,module,exports){
var $export=require("./_export"),sign=require("./_math-sign");$export($export.S,"Math",{cbrt:function(r){return sign(r=+r)*Math.pow(Math.abs(r),1/3)}});

},{"./_export":66,"./_math-sign":97}],192:[function(require,module,exports){
var $export=require("./_export");$export($export.S,"Math",{clz32:function(r){return(r>>>=0)?31-Math.floor(Math.log(r+.5)*Math.LOG2E):32}});

},{"./_export":66}],193:[function(require,module,exports){
var $export=require("./_export"),exp=Math.exp;$export($export.S,"Math",{cosh:function(e){return(exp(e=+e)+exp(-e))/2}});

},{"./_export":66}],194:[function(require,module,exports){
var $export=require("./_export"),$expm1=require("./_math-expm1");$export($export.S+$export.F*($expm1!=Math.expm1),"Math",{expm1:$expm1});

},{"./_export":66,"./_math-expm1":94}],195:[function(require,module,exports){
var $export=require("./_export");$export($export.S,"Math",{fround:require("./_math-fround")});

},{"./_export":66,"./_math-fround":95}],196:[function(require,module,exports){
var $export=require("./_export"),abs=Math.abs;$export($export.S,"Math",{hypot:function(r,t){for(var a,e,o=0,h=0,p=arguments.length,n=0;h<p;)n<(a=abs(arguments[h++]))?(o=o*(e=n/a)*e+1,n=a):o+=a>0?(e=a/n)*e:a;return n===1/0?1/0:n*Math.sqrt(o)}});

},{"./_export":66}],197:[function(require,module,exports){
var $export=require("./_export"),$imul=Math.imul;$export($export.S+$export.F*require("./_fails")(function(){return-5!=$imul(4294967295,5)||2!=$imul.length}),"Math",{imul:function(r,e){var t=+r,u=+e,i=65535&t,l=65535&u;return 0|i*l+((65535&t>>>16)*l+i*(65535&u>>>16)<<16>>>0)}});

},{"./_export":66,"./_fails":68}],198:[function(require,module,exports){
var $export=require("./_export");$export($export.S,"Math",{log10:function(r){return Math.log(r)*Math.LOG10E}});

},{"./_export":66}],199:[function(require,module,exports){
var $export=require("./_export");$export($export.S,"Math",{log1p:require("./_math-log1p")});

},{"./_export":66,"./_math-log1p":96}],200:[function(require,module,exports){
var $export=require("./_export");$export($export.S,"Math",{log2:function(r){return Math.log(r)/Math.LN2}});

},{"./_export":66}],201:[function(require,module,exports){
var $export=require("./_export");$export($export.S,"Math",{sign:require("./_math-sign")});

},{"./_export":66,"./_math-sign":97}],202:[function(require,module,exports){
var $export=require("./_export"),expm1=require("./_math-expm1"),exp=Math.exp;$export($export.S+$export.F*require("./_fails")(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(e){return Math.abs(e=+e)<1?(expm1(e)-expm1(-e))/2:(exp(e-1)-exp(-e-1))*(Math.E/2)}});

},{"./_export":66,"./_fails":68,"./_math-expm1":94}],203:[function(require,module,exports){
var $export=require("./_export"),expm1=require("./_math-expm1"),exp=Math.exp;$export($export.S,"Math",{tanh:function(e){var p=expm1(e=+e),r=expm1(-e);return p==1/0?1:r==1/0?-1:(p-r)/(exp(e)+exp(-e))}});

},{"./_export":66,"./_math-expm1":94}],204:[function(require,module,exports){
var $export=require("./_export");$export($export.S,"Math",{trunc:function(r){return(r>0?Math.floor:Math.ceil)(r)}});

},{"./_export":66}],205:[function(require,module,exports){
"use strict";var global=require("./_global"),has=require("./_has"),cof=require("./_cof"),inheritIfRequired=require("./_inherit-if-required"),toPrimitive=require("./_to-primitive"),fails=require("./_fails"),gOPN=require("./_object-gopn").f,gOPD=require("./_object-gopd").f,dP=require("./_object-dp").f,$trim=require("./_string-trim").trim,NUMBER="Number",$Number=global[NUMBER],Base=$Number,proto=$Number.prototype,BROKEN_COF=cof(require("./_object-create")(proto))==NUMBER,TRIM="trim"in String.prototype,toNumber=function(e){var r=toPrimitive(e,!1);if("string"==typeof r&&r.length>2){var t,i,o,u=(r=TRIM?r.trim():$trim(r,3)).charCodeAt(0);if(43===u||45===u){if(88===(t=r.charCodeAt(2))||120===t)return NaN}else if(48===u){switch(r.charCodeAt(1)){case 66:case 98:i=2,o=49;break;case 79:case 111:i=8,o=55;break;default:return+r}for(var a,N=r.slice(2),s=0,n=N.length;s<n;s++)if((a=N.charCodeAt(s))<48||a>o)return NaN;return parseInt(N,i)}}return+r};if(!$Number(" 0o1")||!$Number("0b1")||$Number("+0x1")){$Number=function(e){var r=arguments.length<1?0:e,t=this;return t instanceof $Number&&(BROKEN_COF?fails(function(){proto.valueOf.call(t)}):cof(t)!=NUMBER)?inheritIfRequired(new Base(toNumber(r)),t,$Number):toNumber(r)};for(var key,keys=require("./_descriptors")?gOPN(Base):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),j=0;keys.length>j;j++)has(Base,key=keys[j])&&!has($Number,key)&&dP($Number,key,gOPD(Base,key));$Number.prototype=proto,proto.constructor=$Number,require("./_redefine")(global,NUMBER,$Number)}

},{"./_cof":52,"./_descriptors":62,"./_fails":68,"./_global":74,"./_has":75,"./_inherit-if-required":79,"./_object-create":102,"./_object-dp":103,"./_object-gopd":105,"./_object-gopn":107,"./_redefine":122,"./_string-trim":138,"./_to-primitive":147}],206:[function(require,module,exports){
var $export=require("./_export");$export($export.S,"Number",{EPSILON:Math.pow(2,-52)});

},{"./_export":66}],207:[function(require,module,exports){
var $export=require("./_export"),_isFinite=require("./_global").isFinite;$export($export.S,"Number",{isFinite:function(e){return"number"==typeof e&&_isFinite(e)}});

},{"./_export":66,"./_global":74}],208:[function(require,module,exports){
var $export=require("./_export");$export($export.S,"Number",{isInteger:require("./_is-integer")});

},{"./_export":66,"./_is-integer":84}],209:[function(require,module,exports){
var $export=require("./_export");$export($export.S,"Number",{isNaN:function(r){return r!=r}});

},{"./_export":66}],210:[function(require,module,exports){
var $export=require("./_export"),isInteger=require("./_is-integer"),abs=Math.abs;$export($export.S,"Number",{isSafeInteger:function(e){return isInteger(e)&&abs(e)<=9007199254740991}});

},{"./_export":66,"./_is-integer":84}],211:[function(require,module,exports){
var $export=require("./_export");$export($export.S,"Number",{MAX_SAFE_INTEGER:9007199254740991});

},{"./_export":66}],212:[function(require,module,exports){
var $export=require("./_export");$export($export.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991});

},{"./_export":66}],213:[function(require,module,exports){
var $export=require("./_export"),$parseFloat=require("./_parse-float");$export($export.S+$export.F*(Number.parseFloat!=$parseFloat),"Number",{parseFloat:$parseFloat});

},{"./_export":66,"./_parse-float":116}],214:[function(require,module,exports){
var $export=require("./_export"),$parseInt=require("./_parse-int");$export($export.S+$export.F*(Number.parseInt!=$parseInt),"Number",{parseInt:$parseInt});

},{"./_export":66,"./_parse-int":117}],215:[function(require,module,exports){
"use strict";var $export=require("./_export"),toInteger=require("./_to-integer"),aNumberValue=require("./_a-number-value"),repeat=require("./_string-repeat"),$toFixed=1..toFixed,floor=Math.floor,data=[0,0,0,0,0,0],ERROR="Number.toFixed: incorrect invocation!",ZERO="0",multiply=function(e,r){for(var t=-1,i=r;++t<6;)i+=e*data[t],data[t]=i%1e7,i=floor(i/1e7)},divide=function(e){for(var r=6,t=0;--r>=0;)t+=data[r],data[r]=floor(t/e),t=t%e*1e7},numToString=function(){for(var e=6,r="";--e>=0;)if(""!==r||0===e||0!==data[e]){var t=String(data[e]);r=""===r?t:r+repeat.call(ZERO,7-t.length)+t}return r},pow=function(e,r,t){return 0===r?t:r%2==1?pow(e,r-1,t*e):pow(e*e,r/2,t)},log=function(e){for(var r=0,t=e;t>=4096;)r+=12,t/=4096;for(;t>=2;)r+=1,t/=2;return r};$export($export.P+$export.F*(!!$toFixed&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!require("./_fails")(function(){$toFixed.call({})})),"Number",{toFixed:function(e){var r,t,i,o,a=aNumberValue(this,ERROR),n=toInteger(e),l="",u=ZERO;if(n<0||n>20)throw RangeError(ERROR);if(a!=a)return"NaN";if(a<=-1e21||a>=1e21)return String(a);if(a<0&&(l="-",a=-a),a>1e-21)if(t=(r=log(a*pow(2,69,1))-69)<0?a*pow(2,-r,1):a/pow(2,r,1),t*=4503599627370496,(r=52-r)>0){for(multiply(0,t),i=n;i>=7;)multiply(1e7,0),i-=7;for(multiply(pow(10,i,1),0),i=r-1;i>=23;)divide(1<<23),i-=23;divide(1<<i),multiply(1,1),divide(2),u=numToString()}else multiply(0,t),multiply(1<<-r,0),u=numToString()+repeat.call(ZERO,n);return u=n>0?l+((o=u.length)<=n?"0."+repeat.call(ZERO,n-o)+u:u.slice(0,o-n)+"."+u.slice(o-n)):l+u}});

},{"./_a-number-value":38,"./_export":66,"./_fails":68,"./_string-repeat":137,"./_to-integer":143}],216:[function(require,module,exports){
"use strict";var $export=require("./_export"),$fails=require("./_fails"),aNumberValue=require("./_a-number-value"),$toPrecision=1..toPrecision;$export($export.P+$export.F*($fails(function(){return"1"!==$toPrecision.call(1,void 0)})||!$fails(function(){$toPrecision.call({})})),"Number",{toPrecision:function(i){var r=aNumberValue(this,"Number#toPrecision: incorrect invocation!");return void 0===i?$toPrecision.call(r):$toPrecision.call(r,i)}});

},{"./_a-number-value":38,"./_export":66,"./_fails":68}],217:[function(require,module,exports){
var $export=require("./_export");$export($export.S+$export.F,"Object",{assign:require("./_object-assign")});

},{"./_export":66,"./_object-assign":101}],218:[function(require,module,exports){
var $export=require("./_export");$export($export.S,"Object",{create:require("./_object-create")});

},{"./_export":66,"./_object-create":102}],219:[function(require,module,exports){
var $export=require("./_export");$export($export.S+$export.F*!require("./_descriptors"),"Object",{defineProperties:require("./_object-dps")});

},{"./_descriptors":62,"./_export":66,"./_object-dps":104}],220:[function(require,module,exports){
var $export=require("./_export");$export($export.S+$export.F*!require("./_descriptors"),"Object",{defineProperty:require("./_object-dp").f});

},{"./_descriptors":62,"./_export":66,"./_object-dp":103}],221:[function(require,module,exports){
var isObject=require("./_is-object"),meta=require("./_meta").onFreeze;require("./_object-sap")("freeze",function(e){return function(r){return e&&isObject(r)?e(meta(r)):r}});

},{"./_is-object":85,"./_meta":98,"./_object-sap":113}],222:[function(require,module,exports){
var toIObject=require("./_to-iobject"),$getOwnPropertyDescriptor=require("./_object-gopd").f;require("./_object-sap")("getOwnPropertyDescriptor",function(){return function(r,e){return $getOwnPropertyDescriptor(toIObject(r),e)}});

},{"./_object-gopd":105,"./_object-sap":113,"./_to-iobject":144}],223:[function(require,module,exports){
require("./_object-sap")("getOwnPropertyNames",function(){return require("./_object-gopn-ext").f});

},{"./_object-gopn-ext":106,"./_object-sap":113}],224:[function(require,module,exports){
var toObject=require("./_to-object"),$getPrototypeOf=require("./_object-gpo");require("./_object-sap")("getPrototypeOf",function(){return function(t){return $getPrototypeOf(toObject(t))}});

},{"./_object-gpo":109,"./_object-sap":113,"./_to-object":146}],225:[function(require,module,exports){
var isObject=require("./_is-object");require("./_object-sap")("isExtensible",function(e){return function(i){return!!isObject(i)&&(!e||e(i))}});

},{"./_is-object":85,"./_object-sap":113}],226:[function(require,module,exports){
var isObject=require("./_is-object");require("./_object-sap")("isFrozen",function(e){return function(r){return!isObject(r)||!!e&&e(r)}});

},{"./_is-object":85,"./_object-sap":113}],227:[function(require,module,exports){
var isObject=require("./_is-object");require("./_object-sap")("isSealed",function(e){return function(r){return!isObject(r)||!!e&&e(r)}});

},{"./_is-object":85,"./_object-sap":113}],228:[function(require,module,exports){
var $export=require("./_export");$export($export.S,"Object",{is:require("./_same-value")});

},{"./_export":66,"./_same-value":125}],229:[function(require,module,exports){
var toObject=require("./_to-object"),$keys=require("./_object-keys");require("./_object-sap")("keys",function(){return function(e){return $keys(toObject(e))}});

},{"./_object-keys":111,"./_object-sap":113,"./_to-object":146}],230:[function(require,module,exports){
var isObject=require("./_is-object"),meta=require("./_meta").onFreeze;require("./_object-sap")("preventExtensions",function(e){return function(r){return e&&isObject(r)?e(meta(r)):r}});

},{"./_is-object":85,"./_meta":98,"./_object-sap":113}],231:[function(require,module,exports){
var isObject=require("./_is-object"),meta=require("./_meta").onFreeze;require("./_object-sap")("seal",function(e){return function(r){return e&&isObject(r)?e(meta(r)):r}});

},{"./_is-object":85,"./_meta":98,"./_object-sap":113}],232:[function(require,module,exports){
var $export=require("./_export");$export($export.S,"Object",{setPrototypeOf:require("./_set-proto").set});

},{"./_export":66,"./_set-proto":126}],233:[function(require,module,exports){
"use strict";var classof=require("./_classof"),test={};test[require("./_wks")("toStringTag")]="z",test+""!="[object z]"&&require("./_redefine")(Object.prototype,"toString",function(){return"[object "+classof(this)+"]"},!0);

},{"./_classof":51,"./_redefine":122,"./_wks":156}],234:[function(require,module,exports){
var $export=require("./_export"),$parseFloat=require("./_parse-float");$export($export.G+$export.F*(parseFloat!=$parseFloat),{parseFloat:$parseFloat});

},{"./_export":66,"./_parse-float":116}],235:[function(require,module,exports){
var $export=require("./_export"),$parseInt=require("./_parse-int");$export($export.G+$export.F*(parseInt!=$parseInt),{parseInt:$parseInt});

},{"./_export":66,"./_parse-int":117}],236:[function(require,module,exports){
"use strict";var Internal,newGenericPromiseCapability,OwnPromiseCapability,Wrapper,LIBRARY=require("./_library"),global=require("./_global"),ctx=require("./_ctx"),classof=require("./_classof"),$export=require("./_export"),isObject=require("./_is-object"),aFunction=require("./_a-function"),anInstance=require("./_an-instance"),forOf=require("./_for-of"),speciesConstructor=require("./_species-constructor"),task=require("./_task").set,microtask=require("./_microtask")(),newPromiseCapabilityModule=require("./_new-promise-capability"),perform=require("./_perform"),userAgent=require("./_user-agent"),promiseResolve=require("./_promise-resolve"),PROMISE="Promise",TypeError=global.TypeError,process=global.process,versions=process&&process.versions,v8=versions&&versions.v8||"",$Promise=global[PROMISE],isNode="process"==classof(process),empty=function(){},newPromiseCapability=newGenericPromiseCapability=newPromiseCapabilityModule.f,USE_NATIVE=!!function(){try{var e=$Promise.resolve(1),r=(e.constructor={})[require("./_wks")("species")]=function(e){e(empty,empty)};return(isNode||"function"==typeof PromiseRejectionEvent)&&e.then(empty)instanceof r&&0!==v8.indexOf("6.6")&&-1===userAgent.indexOf("Chrome/66")}catch(e){}}(),isThenable=function(e){var r;return!(!isObject(e)||"function"!=typeof(r=e.then))&&r},notify=function(e,r){if(!e._n){e._n=!0;var i=e._c;microtask(function(){for(var o=e._v,t=1==e._s,n=0,s=function(r){var i,n,s,a=t?r.ok:r.fail,c=r.resolve,l=r.reject,p=r.domain;try{a?(t||(2==e._h&&onHandleUnhandled(e),e._h=1),!0===a?i=o:(p&&p.enter(),i=a(o),p&&(p.exit(),s=!0)),i===r.promise?l(TypeError("Promise-chain cycle")):(n=isThenable(i))?n.call(i,c,l):c(i)):l(o)}catch(e){p&&!s&&p.exit(),l(e)}};i.length>n;)s(i[n++]);e._c=[],e._n=!1,r&&!e._h&&onUnhandled(e)})}},onUnhandled=function(e){task.call(global,function(){var r,i,o,t=e._v,n=isUnhandled(e);if(n&&(r=perform(function(){isNode?process.emit("unhandledRejection",t,e):(i=global.onunhandledrejection)?i({promise:e,reason:t}):(o=global.console)&&o.error&&o.error("Unhandled promise rejection",t)}),e._h=isNode||isUnhandled(e)?2:1),e._a=void 0,n&&r.e)throw r.v})},isUnhandled=function(e){return 1!==e._h&&0===(e._a||e._c).length},onHandleUnhandled=function(e){task.call(global,function(){var r;isNode?process.emit("rejectionHandled",e):(r=global.onrejectionhandled)&&r({promise:e,reason:e._v})})},$reject=function(e){var r=this;r._d||(r._d=!0,(r=r._w||r)._v=e,r._s=2,r._a||(r._a=r._c.slice()),notify(r,!0))},$resolve=function(e){var r,i=this;if(!i._d){i._d=!0,i=i._w||i;try{if(i===e)throw TypeError("Promise can't be resolved itself");(r=isThenable(e))?microtask(function(){var o={_w:i,_d:!1};try{r.call(e,ctx($resolve,o,1),ctx($reject,o,1))}catch(e){$reject.call(o,e)}}):(i._v=e,i._s=1,notify(i,!1))}catch(e){$reject.call({_w:i,_d:!1},e)}}};USE_NATIVE||($Promise=function(e){anInstance(this,$Promise,PROMISE,"_h"),aFunction(e),Internal.call(this);try{e(ctx($resolve,this,1),ctx($reject,this,1))}catch(e){$reject.call(this,e)}},(Internal=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=require("./_redefine-all")($Promise.prototype,{then:function(e,r){var i=newPromiseCapability(speciesConstructor(this,$Promise));return i.ok="function"!=typeof e||e,i.fail="function"==typeof r&&r,i.domain=isNode?process.domain:void 0,this._c.push(i),this._a&&this._a.push(i),this._s&&notify(this,!1),i.promise},catch:function(e){return this.then(void 0,e)}}),OwnPromiseCapability=function(){var e=new Internal;this.promise=e,this.resolve=ctx($resolve,e,1),this.reject=ctx($reject,e,1)},newPromiseCapabilityModule.f=newPromiseCapability=function(e){return e===$Promise||e===Wrapper?new OwnPromiseCapability(e):newGenericPromiseCapability(e)}),$export($export.G+$export.W+$export.F*!USE_NATIVE,{Promise:$Promise}),require("./_set-to-string-tag")($Promise,PROMISE),require("./_set-species")(PROMISE),Wrapper=require("./_core")[PROMISE],$export($export.S+$export.F*!USE_NATIVE,PROMISE,{reject:function(e){var r=newPromiseCapability(this);return(0,r.reject)(e),r.promise}}),$export($export.S+$export.F*(LIBRARY||!USE_NATIVE),PROMISE,{resolve:function(e){return promiseResolve(LIBRARY&&this===Wrapper?$Promise:this,e)}}),$export($export.S+$export.F*!(USE_NATIVE&&require("./_iter-detect")(function(e){$Promise.all(e).catch(empty)})),PROMISE,{all:function(e){var r=this,i=newPromiseCapability(r),o=i.resolve,t=i.reject,n=perform(function(){var i=[],n=0,s=1;forOf(e,!1,function(e){var a=n++,c=!1;i.push(void 0),s++,r.resolve(e).then(function(e){c||(c=!0,i[a]=e,--s||o(i))},t)}),--s||o(i)});return n.e&&t(n.v),i.promise},race:function(e){var r=this,i=newPromiseCapability(r),o=i.reject,t=perform(function(){forOf(e,!1,function(e){r.resolve(e).then(i.resolve,o)})});return t.e&&o(t.v),i.promise}});

},{"./_a-function":37,"./_an-instance":41,"./_classof":51,"./_core":56,"./_ctx":58,"./_export":66,"./_for-of":72,"./_global":74,"./_is-object":85,"./_iter-detect":90,"./_library":93,"./_microtask":99,"./_new-promise-capability":100,"./_perform":118,"./_promise-resolve":119,"./_redefine-all":121,"./_set-species":127,"./_set-to-string-tag":128,"./_species-constructor":131,"./_task":140,"./_user-agent":152,"./_wks":156}],237:[function(require,module,exports){
var $export=require("./_export"),aFunction=require("./_a-function"),anObject=require("./_an-object"),rApply=(require("./_global").Reflect||{}).apply,fApply=Function.apply;$export($export.S+$export.F*!require("./_fails")(function(){rApply(function(){})}),"Reflect",{apply:function(e,p,r){var n=aFunction(e),t=anObject(r);return rApply?rApply(n,p,t):fApply.call(n,p,t)}});

},{"./_a-function":37,"./_an-object":42,"./_export":66,"./_fails":68,"./_global":74}],238:[function(require,module,exports){
var $export=require("./_export"),create=require("./_object-create"),aFunction=require("./_a-function"),anObject=require("./_an-object"),isObject=require("./_is-object"),fails=require("./_fails"),bind=require("./_bind"),rConstruct=(require("./_global").Reflect||{}).construct,NEW_TARGET_BUG=fails(function(){function e(){}return!(rConstruct(function(){},[],e)instanceof e)}),ARGS_BUG=!fails(function(){rConstruct(function(){})});$export($export.S+$export.F*(NEW_TARGET_BUG||ARGS_BUG),"Reflect",{construct:function(e,t){aFunction(e),anObject(t);var r=arguments.length<3?e:aFunction(arguments[2]);if(ARGS_BUG&&!NEW_TARGET_BUG)return rConstruct(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return n.push.apply(n,t),new(bind.apply(e,n))}var c=r.prototype,u=create(isObject(c)?c:Object.prototype),i=Function.apply.call(e,u,t);return isObject(i)?i:u}});

},{"./_a-function":37,"./_an-object":42,"./_bind":50,"./_export":66,"./_fails":68,"./_global":74,"./_is-object":85,"./_object-create":102}],239:[function(require,module,exports){
var dP=require("./_object-dp"),$export=require("./_export"),anObject=require("./_an-object"),toPrimitive=require("./_to-primitive");$export($export.S+$export.F*require("./_fails")(function(){Reflect.defineProperty(dP.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(e,r,t){anObject(e),r=toPrimitive(r,!0),anObject(t);try{return dP.f(e,r,t),!0}catch(e){return!1}}});

},{"./_an-object":42,"./_export":66,"./_fails":68,"./_object-dp":103,"./_to-primitive":147}],240:[function(require,module,exports){
var $export=require("./_export"),gOPD=require("./_object-gopd").f,anObject=require("./_an-object");$export($export.S,"Reflect",{deleteProperty:function(e,r){var t=gOPD(anObject(e),r);return!(t&&!t.configurable)&&delete e[r]}});

},{"./_an-object":42,"./_export":66,"./_object-gopd":105}],241:[function(require,module,exports){
"use strict";var $export=require("./_export"),anObject=require("./_an-object"),Enumerate=function(e){this._t=anObject(e),this._i=0;var t,r=this._k=[];for(t in e)r.push(t)};require("./_iter-create")(Enumerate,"Object",function(){var e,t=this._k;do{if(this._i>=t.length)return{value:void 0,done:!0}}while(!((e=t[this._i++])in this._t));return{value:e,done:!1}}),$export($export.S,"Reflect",{enumerate:function(e){return new Enumerate(e)}});

},{"./_an-object":42,"./_export":66,"./_iter-create":88}],242:[function(require,module,exports){
var gOPD=require("./_object-gopd"),$export=require("./_export"),anObject=require("./_an-object");$export($export.S,"Reflect",{getOwnPropertyDescriptor:function(e,r){return gOPD.f(anObject(e),r)}});

},{"./_an-object":42,"./_export":66,"./_object-gopd":105}],243:[function(require,module,exports){
var $export=require("./_export"),getProto=require("./_object-gpo"),anObject=require("./_an-object");$export($export.S,"Reflect",{getPrototypeOf:function(e){return getProto(anObject(e))}});

},{"./_an-object":42,"./_export":66,"./_object-gpo":109}],244:[function(require,module,exports){
var gOPD=require("./_object-gopd"),getPrototypeOf=require("./_object-gpo"),has=require("./_has"),$export=require("./_export"),isObject=require("./_is-object"),anObject=require("./_an-object");function get(e,t){var r,o,g=arguments.length<3?e:arguments[2];return anObject(e)===g?e[t]:(r=gOPD.f(e,t))?has(r,"value")?r.value:void 0!==r.get?r.get.call(g):void 0:isObject(o=getPrototypeOf(e))?get(o,t,g):void 0}$export($export.S,"Reflect",{get:get});

},{"./_an-object":42,"./_export":66,"./_has":75,"./_is-object":85,"./_object-gopd":105,"./_object-gpo":109}],245:[function(require,module,exports){
var $export=require("./_export");$export($export.S,"Reflect",{has:function(e,r){return r in e}});

},{"./_export":66}],246:[function(require,module,exports){
var $export=require("./_export"),anObject=require("./_an-object"),$isExtensible=Object.isExtensible;$export($export.S,"Reflect",{isExtensible:function(e){return anObject(e),!$isExtensible||$isExtensible(e)}});

},{"./_an-object":42,"./_export":66}],247:[function(require,module,exports){
var $export=require("./_export");$export($export.S,"Reflect",{ownKeys:require("./_own-keys")});

},{"./_export":66,"./_own-keys":115}],248:[function(require,module,exports){
var $export=require("./_export"),anObject=require("./_an-object"),$preventExtensions=Object.preventExtensions;$export($export.S,"Reflect",{preventExtensions:function(e){anObject(e);try{return $preventExtensions&&$preventExtensions(e),!0}catch(e){return!1}}});

},{"./_an-object":42,"./_export":66}],249:[function(require,module,exports){
var $export=require("./_export"),setProto=require("./_set-proto");setProto&&$export($export.S,"Reflect",{setPrototypeOf:function(t,e){setProto.check(t,e);try{return setProto.set(t,e),!0}catch(t){return!1}}});

},{"./_export":66,"./_set-proto":126}],250:[function(require,module,exports){
var dP=require("./_object-dp"),gOPD=require("./_object-gopd"),getPrototypeOf=require("./_object-gpo"),has=require("./_has"),$export=require("./_export"),createDesc=require("./_property-desc"),anObject=require("./_an-object"),isObject=require("./_is-object");function set(e,t,r){var i,c,s=arguments.length<4?e:arguments[3],o=gOPD.f(anObject(e),t);if(!o){if(isObject(c=getPrototypeOf(e)))return set(c,t,r,s);o=createDesc(0)}if(has(o,"value")){if(!1===o.writable||!isObject(s))return!1;if(i=gOPD.f(s,t)){if(i.get||i.set||!1===i.writable)return!1;i.value=r,dP.f(s,t,i)}else dP.f(s,t,createDesc(0,r));return!0}return void 0!==o.set&&(o.set.call(s,r),!0)}$export($export.S,"Reflect",{set:set});

},{"./_an-object":42,"./_export":66,"./_has":75,"./_is-object":85,"./_object-dp":103,"./_object-gopd":105,"./_object-gpo":109,"./_property-desc":120}],251:[function(require,module,exports){
var global=require("./_global"),inheritIfRequired=require("./_inherit-if-required"),dP=require("./_object-dp").f,gOPN=require("./_object-gopn").f,isRegExp=require("./_is-regexp"),$flags=require("./_flags"),$RegExp=global.RegExp,Base=$RegExp,proto=$RegExp.prototype,re1=/a/g,re2=/a/g,CORRECT_NEW=new $RegExp(re1)!==re1;if(require("./_descriptors")&&(!CORRECT_NEW||require("./_fails")(function(){return re2[require("./_wks")("match")]=!1,$RegExp(re1)!=re1||$RegExp(re2)==re2||"/a/i"!=$RegExp(re1,"i")}))){$RegExp=function(e,r){var i=this instanceof $RegExp,g=isRegExp(e),o=void 0===r;return!i&&g&&e.constructor===$RegExp&&o?e:inheritIfRequired(CORRECT_NEW?new Base(g&&!o?e.source:e,r):Base((g=e instanceof $RegExp)?e.source:e,g&&o?$flags.call(e):r),i?this:proto,$RegExp)};for(var proxy=function(e){e in $RegExp||dP($RegExp,e,{configurable:!0,get:function(){return Base[e]},set:function(r){Base[e]=r}})},keys=gOPN(Base),i=0;keys.length>i;)proxy(keys[i++]);proto.constructor=$RegExp,$RegExp.prototype=proto,require("./_redefine")(global,"RegExp",$RegExp)}require("./_set-species")("RegExp");

},{"./_descriptors":62,"./_fails":68,"./_flags":70,"./_global":74,"./_inherit-if-required":79,"./_is-regexp":86,"./_object-dp":103,"./_object-gopn":107,"./_redefine":122,"./_set-species":127,"./_wks":156}],252:[function(require,module,exports){
"use strict";var regexpExec=require("./_regexp-exec");require("./_export")({target:"RegExp",proto:!0,forced:regexpExec!==/./.exec},{exec:regexpExec});

},{"./_export":66,"./_regexp-exec":124}],253:[function(require,module,exports){
require("./_descriptors")&&"g"!=/./g.flags&&require("./_object-dp").f(RegExp.prototype,"flags",{configurable:!0,get:require("./_flags")});

},{"./_descriptors":62,"./_flags":70,"./_object-dp":103}],254:[function(require,module,exports){
"use strict";var anObject=require("./_an-object"),toLength=require("./_to-length"),advanceStringIndex=require("./_advance-string-index"),regExpExec=require("./_regexp-exec-abstract");require("./_fix-re-wks")("match",1,function(e,r,n,t){return[function(n){var t=e(this),a=null==n?void 0:n[r];return void 0!==a?a.call(n,t):new RegExp(n)[r](String(t))},function(e){var r=t(n,e,this);if(r.done)return r.value;var a=anObject(e),i=String(this);if(!a.global)return regExpExec(a,i);var u=a.unicode;a.lastIndex=0;for(var c,x=[],g=0;null!==(c=regExpExec(a,i));){var l=String(c[0]);x[g]=l,""===l&&(a.lastIndex=advanceStringIndex(i,toLength(a.lastIndex),u)),g++}return 0===g?null:x}]});

},{"./_advance-string-index":40,"./_an-object":42,"./_fix-re-wks":69,"./_regexp-exec-abstract":123,"./_to-length":145}],255:[function(require,module,exports){
"use strict";var anObject=require("./_an-object"),toObject=require("./_to-object"),toLength=require("./_to-length"),toInteger=require("./_to-integer"),advanceStringIndex=require("./_advance-string-index"),regExpExec=require("./_regexp-exec-abstract"),max=Math.max,min=Math.min,floor=Math.floor,SUBSTITUTION_SYMBOLS=/\$([$&`']|\d\d?|<[^>]*>)/g,SUBSTITUTION_SYMBOLS_NO_NAMED=/\$([$&`']|\d\d?)/g,maybeToString=function(e){return void 0===e?e:String(e)};require("./_fix-re-wks")("replace",2,function(e,r,t,n){return[function(n,a){var i=e(this),o=null==n?void 0:n[r];return void 0!==o?o.call(n,i,a):t.call(String(i),n,a)},function(e,r){var i=n(t,e,this,r);if(i.done)return i.value;var o=anObject(e),c=String(this),u="function"==typeof r;u||(r=String(r));var l=o.global;if(l){var g=o.unicode;o.lastIndex=0}for(var v=[];;){var s=regExpExec(o,c);if(null===s)break;if(v.push(s),!l)break;""===String(s[0])&&(o.lastIndex=advanceStringIndex(c,toLength(o.lastIndex),g))}for(var S="",d=0,f=0;f<v.length;f++){s=v[f];for(var h=String(s[0]),x=max(min(toInteger(s.index),c.length),0),I=[],_=1;_<s.length;_++)I.push(maybeToString(s[_]));var O=s.groups;if(u){var T=[h].concat(I,x,c);void 0!==O&&T.push(O);var b=String(r.apply(void 0,T))}else b=a(h,c,x,I,O,r);x>=d&&(S+=c.slice(d,x)+b,d=x+h.length)}return S+c.slice(d)}];function a(e,r,n,a,i,o){var c=n+e.length,u=a.length,l=SUBSTITUTION_SYMBOLS_NO_NAMED;return void 0!==i&&(i=toObject(i),l=SUBSTITUTION_SYMBOLS),t.call(o,l,function(t,o){var l;switch(o.charAt(0)){case"$":return"$";case"&":return e;case"`":return r.slice(0,n);case"'":return r.slice(c);case"<":l=i[o.slice(1,-1)];break;default:var g=+o;if(0===g)return t;if(g>u){var v=floor(g/10);return 0===v?t:v<=u?void 0===a[v-1]?o.charAt(1):a[v-1]+o.charAt(1):t}l=a[g-1]}return void 0===l?"":l})}});

},{"./_advance-string-index":40,"./_an-object":42,"./_fix-re-wks":69,"./_regexp-exec-abstract":123,"./_to-integer":143,"./_to-length":145,"./_to-object":146}],256:[function(require,module,exports){
"use strict";var anObject=require("./_an-object"),sameValue=require("./_same-value"),regExpExec=require("./_regexp-exec-abstract");require("./_fix-re-wks")("search",1,function(e,r,a,n){return[function(a){var n=e(this),t=null==a?void 0:a[r];return void 0!==t?t.call(a,n):new RegExp(a)[r](String(n))},function(e){var r=n(a,e,this);if(r.done)return r.value;var t=anObject(e),u=String(this),i=t.lastIndex;sameValue(i,0)||(t.lastIndex=0);var s=regExpExec(t,u);return sameValue(t.lastIndex,i)||(t.lastIndex=i),null===s?-1:s.index}]});

},{"./_an-object":42,"./_fix-re-wks":69,"./_regexp-exec-abstract":123,"./_same-value":125}],257:[function(require,module,exports){
"use strict";var isRegExp=require("./_is-regexp"),anObject=require("./_an-object"),speciesConstructor=require("./_species-constructor"),advanceStringIndex=require("./_advance-string-index"),toLength=require("./_to-length"),callRegExpExec=require("./_regexp-exec-abstract"),regexpExec=require("./_regexp-exec"),fails=require("./_fails"),$min=Math.min,$push=[].push,$SPLIT="split",LENGTH="length",LAST_INDEX="lastIndex",MAX_UINT32=4294967295,SUPPORTS_Y=!fails(function(){RegExp(MAX_UINT32,"y")});require("./_fix-re-wks")("split",2,function(e,i,r,n){var t;return t="c"=="abbc"[$SPLIT](/(b)*/)[1]||4!="test"[$SPLIT](/(?:)/,-1)[LENGTH]||2!="ab"[$SPLIT](/(?:ab)*/)[LENGTH]||4!="."[$SPLIT](/(.?)(.?)/)[LENGTH]||"."[$SPLIT](/()()/)[LENGTH]>1||""[$SPLIT](/.?/)[LENGTH]?function(e,i){var n=String(this);if(void 0===e&&0===i)return[];if(!isRegExp(e))return r.call(n,e,i);for(var t,s,u,l=[],c=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),a=0,T=void 0===i?MAX_UINT32:i>>>0,o=new RegExp(e.source,c+"g");(t=regexpExec.call(o,n))&&!((s=o[LAST_INDEX])>a&&(l.push(n.slice(a,t.index)),t[LENGTH]>1&&t.index<n[LENGTH]&&$push.apply(l,t.slice(1)),u=t[0][LENGTH],a=s,l[LENGTH]>=T));)o[LAST_INDEX]===t.index&&o[LAST_INDEX]++;return a===n[LENGTH]?!u&&o.test("")||l.push(""):l.push(n.slice(a)),l[LENGTH]>T?l.slice(0,T):l}:"0"[$SPLIT](void 0,0)[LENGTH]?function(e,i){return void 0===e&&0===i?[]:r.call(this,e,i)}:r,[function(r,n){var s=e(this),u=null==r?void 0:r[i];return void 0!==u?u.call(r,s,n):t.call(String(s),r,n)},function(e,i){var s=n(t,e,this,i,t!==r);if(s.done)return s.value;var u=anObject(e),l=String(this),c=speciesConstructor(u,RegExp),a=u.unicode,T=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(SUPPORTS_Y?"y":"g"),o=new c(SUPPORTS_Y?u:"^(?:"+u.source+")",T),g=void 0===i?MAX_UINT32:i>>>0;if(0===g)return[];if(0===l.length)return null===callRegExpExec(o,l)?[l]:[];for(var x=0,E=0,p=[];E<l.length;){o.lastIndex=SUPPORTS_Y?E:0;var S,L=callRegExpExec(o,SUPPORTS_Y?l:l.slice(E));if(null===L||(S=$min(toLength(o.lastIndex+(SUPPORTS_Y?0:E)),l.length))===x)E=advanceStringIndex(l,E,a);else{if(p.push(l.slice(x,E)),p.length===g)return p;for(var h=1;h<=L.length-1;h++)if(p.push(L[h]),p.length===g)return p;E=x=S}}return p.push(l.slice(x)),p}]});

},{"./_advance-string-index":40,"./_an-object":42,"./_fails":68,"./_fix-re-wks":69,"./_is-regexp":86,"./_regexp-exec":124,"./_regexp-exec-abstract":123,"./_species-constructor":131,"./_to-length":145}],258:[function(require,module,exports){
"use strict";require("./es6.regexp.flags");var anObject=require("./_an-object"),$flags=require("./_flags"),DESCRIPTORS=require("./_descriptors"),TO_STRING="toString",$toString=/./[TO_STRING],define=function(e){require("./_redefine")(RegExp.prototype,TO_STRING,e,!0)};require("./_fails")(function(){return"/a/b"!=$toString.call({source:"a",flags:"b"})})?define(function(){var e=anObject(this);return"/".concat(e.source,"/","flags"in e?e.flags:!DESCRIPTORS&&e instanceof RegExp?$flags.call(e):void 0)}):$toString.name!=TO_STRING&&define(function(){return $toString.call(this)});

},{"./_an-object":42,"./_descriptors":62,"./_fails":68,"./_flags":70,"./_redefine":122,"./es6.regexp.flags":253}],259:[function(require,module,exports){
"use strict";var strong=require("./_collection-strong"),validate=require("./_validate-collection"),SET="Set";module.exports=require("./_collection")(SET,function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return strong.def(validate(this,SET),t=0===t?0:t,t)}},strong);

},{"./_collection":55,"./_collection-strong":53,"./_validate-collection":153}],260:[function(require,module,exports){
"use strict";require("./_string-html")("anchor",function(n){return function(r){return n(this,"a","name",r)}});

},{"./_string-html":135}],261:[function(require,module,exports){
"use strict";require("./_string-html")("big",function(t){return function(){return t(this,"big","","")}});

},{"./_string-html":135}],262:[function(require,module,exports){
"use strict";require("./_string-html")("blink",function(n){return function(){return n(this,"blink","","")}});

},{"./_string-html":135}],263:[function(require,module,exports){
"use strict";require("./_string-html")("bold",function(t){return function(){return t(this,"b","","")}});

},{"./_string-html":135}],264:[function(require,module,exports){
"use strict";var $export=require("./_export"),$at=require("./_string-at")(!1);$export($export.P,"String",{codePointAt:function(t){return $at(this,t)}});

},{"./_export":66,"./_string-at":133}],265:[function(require,module,exports){
"use strict";var $export=require("./_export"),toLength=require("./_to-length"),context=require("./_string-context"),ENDS_WITH="endsWith",$endsWith=""[ENDS_WITH];$export($export.P+$export.F*require("./_fails-is-regexp")(ENDS_WITH),"String",{endsWith:function(t){var e=context(this,t,ENDS_WITH),n=arguments.length>1?arguments[1]:void 0,r=toLength(e.length),i=void 0===n?r:Math.min(toLength(n),r),o=String(t);return $endsWith?$endsWith.call(e,o,i):e.slice(i-o.length,i)===o}});

},{"./_export":66,"./_fails-is-regexp":67,"./_string-context":134,"./_to-length":145}],266:[function(require,module,exports){
"use strict";require("./_string-html")("fixed",function(t){return function(){return t(this,"tt","","")}});

},{"./_string-html":135}],267:[function(require,module,exports){
"use strict";require("./_string-html")("fontcolor",function(t){return function(r){return t(this,"font","color",r)}});

},{"./_string-html":135}],268:[function(require,module,exports){
"use strict";require("./_string-html")("fontsize",function(t){return function(n){return t(this,"font","size",n)}});

},{"./_string-html":135}],269:[function(require,module,exports){
var $export=require("./_export"),toAbsoluteIndex=require("./_to-absolute-index"),fromCharCode=String.fromCharCode,$fromCodePoint=String.fromCodePoint;$export($export.S+$export.F*(!!$fromCodePoint&&1!=$fromCodePoint.length),"String",{fromCodePoint:function(o){for(var r,e=[],t=arguments.length,n=0;t>n;){if(r=+arguments[n++],toAbsoluteIndex(r,1114111)!==r)throw RangeError(r+" is not a valid code point");e.push(r<65536?fromCharCode(r):fromCharCode(55296+((r-=65536)>>10),r%1024+56320))}return e.join("")}});

},{"./_export":66,"./_to-absolute-index":141}],270:[function(require,module,exports){
"use strict";var $export=require("./_export"),context=require("./_string-context"),INCLUDES="includes";$export($export.P+$export.F*require("./_fails-is-regexp")(INCLUDES),"String",{includes:function(e){return!!~context(this,e,INCLUDES).indexOf(e,arguments.length>1?arguments[1]:void 0)}});

},{"./_export":66,"./_fails-is-regexp":67,"./_string-context":134}],271:[function(require,module,exports){
"use strict";require("./_string-html")("italics",function(t){return function(){return t(this,"i","","")}});

},{"./_string-html":135}],272:[function(require,module,exports){
"use strict";var $at=require("./_string-at")(!0);require("./_iter-define")(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,i=this._t,e=this._i;return e>=i.length?{value:void 0,done:!0}:(t=$at(i,e),this._i+=t.length,{value:t,done:!1})});

},{"./_iter-define":89,"./_string-at":133}],273:[function(require,module,exports){
"use strict";require("./_string-html")("link",function(r){return function(t){return r(this,"a","href",t)}});

},{"./_string-html":135}],274:[function(require,module,exports){
var $export=require("./_export"),toIObject=require("./_to-iobject"),toLength=require("./_to-length");$export($export.S,"String",{raw:function(t){for(var r=toIObject(t.raw),e=toLength(r.length),o=arguments.length,n=[],i=0;e>i;)n.push(String(r[i++])),i<o&&n.push(String(arguments[i]));return n.join("")}});

},{"./_export":66,"./_to-iobject":144,"./_to-length":145}],275:[function(require,module,exports){
var $export=require("./_export");$export($export.P,"String",{repeat:require("./_string-repeat")});

},{"./_export":66,"./_string-repeat":137}],276:[function(require,module,exports){
"use strict";require("./_string-html")("small",function(t){return function(){return t(this,"small","","")}});

},{"./_string-html":135}],277:[function(require,module,exports){
"use strict";var $export=require("./_export"),toLength=require("./_to-length"),context=require("./_string-context"),STARTS_WITH="startsWith",$startsWith=""[STARTS_WITH];$export($export.P+$export.F*require("./_fails-is-regexp")(STARTS_WITH),"String",{startsWith:function(t){var e=context(this,t,STARTS_WITH),r=toLength(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),i=String(t);return $startsWith?$startsWith.call(e,i,r):e.slice(r,r+i.length)===i}});

},{"./_export":66,"./_fails-is-regexp":67,"./_string-context":134,"./_to-length":145}],278:[function(require,module,exports){
"use strict";require("./_string-html")("strike",function(t){return function(){return t(this,"strike","","")}});

},{"./_string-html":135}],279:[function(require,module,exports){
"use strict";require("./_string-html")("sub",function(t){return function(){return t(this,"sub","","")}});

},{"./_string-html":135}],280:[function(require,module,exports){
"use strict";require("./_string-html")("sup",function(t){return function(){return t(this,"sup","","")}});

},{"./_string-html":135}],281:[function(require,module,exports){
"use strict";require("./_string-trim")("trim",function(r){return function(){return r(this,3)}});

},{"./_string-trim":138}],282:[function(require,module,exports){
"use strict";var global=require("./_global"),has=require("./_has"),DESCRIPTORS=require("./_descriptors"),$export=require("./_export"),redefine=require("./_redefine"),META=require("./_meta").KEY,$fails=require("./_fails"),shared=require("./_shared"),setToStringTag=require("./_set-to-string-tag"),uid=require("./_uid"),wks=require("./_wks"),wksExt=require("./_wks-ext"),wksDefine=require("./_wks-define"),enumKeys=require("./_enum-keys"),isArray=require("./_is-array"),anObject=require("./_an-object"),isObject=require("./_is-object"),toObject=require("./_to-object"),toIObject=require("./_to-iobject"),toPrimitive=require("./_to-primitive"),createDesc=require("./_property-desc"),_create=require("./_object-create"),gOPNExt=require("./_object-gopn-ext"),$GOPD=require("./_object-gopd"),$GOPS=require("./_object-gops"),$DP=require("./_object-dp"),$keys=require("./_object-keys"),gOPD=$GOPD.f,dP=$DP.f,gOPN=gOPNExt.f,$Symbol=global.Symbol,$JSON=global.JSON,_stringify=$JSON&&$JSON.stringify,PROTOTYPE="prototype",HIDDEN=wks("_hidden"),TO_PRIMITIVE=wks("toPrimitive"),isEnum={}.propertyIsEnumerable,SymbolRegistry=shared("symbol-registry"),AllSymbols=shared("symbols"),OPSymbols=shared("op-symbols"),ObjectProto=Object[PROTOTYPE],USE_NATIVE="function"==typeof $Symbol&&!!$GOPS.f,QObject=global.QObject,setter=!QObject||!QObject[PROTOTYPE]||!QObject[PROTOTYPE].findChild,setSymbolDesc=DESCRIPTORS&&$fails(function(){return 7!=_create(dP({},"a",{get:function(){return dP(this,"a",{value:7}).a}})).a})?function(e,r,t){var o=gOPD(ObjectProto,r);o&&delete ObjectProto[r],dP(e,r,t),o&&e!==ObjectProto&&dP(ObjectProto,r,o)}:dP,wrap=function(e){var r=AllSymbols[e]=_create($Symbol[PROTOTYPE]);return r._k=e,r},isSymbol=USE_NATIVE&&"symbol"==typeof $Symbol.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof $Symbol},$defineProperty=function(e,r,t){return e===ObjectProto&&$defineProperty(OPSymbols,r,t),anObject(e),r=toPrimitive(r,!0),anObject(t),has(AllSymbols,r)?(t.enumerable?(has(e,HIDDEN)&&e[HIDDEN][r]&&(e[HIDDEN][r]=!1),t=_create(t,{enumerable:createDesc(0,!1)})):(has(e,HIDDEN)||dP(e,HIDDEN,createDesc(1,{})),e[HIDDEN][r]=!0),setSymbolDesc(e,r,t)):dP(e,r,t)},$defineProperties=function(e,r){anObject(e);for(var t,o=enumKeys(r=toIObject(r)),i=0,s=o.length;s>i;)$defineProperty(e,t=o[i++],r[t]);return e},$create=function(e,r){return void 0===r?_create(e):$defineProperties(_create(e),r)},$propertyIsEnumerable=function(e){var r=isEnum.call(this,e=toPrimitive(e,!0));return!(this===ObjectProto&&has(AllSymbols,e)&&!has(OPSymbols,e))&&(!(r||!has(this,e)||!has(AllSymbols,e)||has(this,HIDDEN)&&this[HIDDEN][e])||r)},$getOwnPropertyDescriptor=function(e,r){if(e=toIObject(e),r=toPrimitive(r,!0),e!==ObjectProto||!has(AllSymbols,r)||has(OPSymbols,r)){var t=gOPD(e,r);return!t||!has(AllSymbols,r)||has(e,HIDDEN)&&e[HIDDEN][r]||(t.enumerable=!0),t}},$getOwnPropertyNames=function(e){for(var r,t=gOPN(toIObject(e)),o=[],i=0;t.length>i;)has(AllSymbols,r=t[i++])||r==HIDDEN||r==META||o.push(r);return o},$getOwnPropertySymbols=function(e){for(var r,t=e===ObjectProto,o=gOPN(t?OPSymbols:toIObject(e)),i=[],s=0;o.length>s;)!has(AllSymbols,r=o[s++])||t&&!has(ObjectProto,r)||i.push(AllSymbols[r]);return i};USE_NATIVE||(redefine(($Symbol=function(){if(this instanceof $Symbol)throw TypeError("Symbol is not a constructor!");var e=uid(arguments.length>0?arguments[0]:void 0),r=function(t){this===ObjectProto&&r.call(OPSymbols,t),has(this,HIDDEN)&&has(this[HIDDEN],e)&&(this[HIDDEN][e]=!1),setSymbolDesc(this,e,createDesc(1,t))};return DESCRIPTORS&&setter&&setSymbolDesc(ObjectProto,e,{configurable:!0,set:r}),wrap(e)})[PROTOTYPE],"toString",function(){return this._k}),$GOPD.f=$getOwnPropertyDescriptor,$DP.f=$defineProperty,require("./_object-gopn").f=gOPNExt.f=$getOwnPropertyNames,require("./_object-pie").f=$propertyIsEnumerable,$GOPS.f=$getOwnPropertySymbols,DESCRIPTORS&&!require("./_library")&&redefine(ObjectProto,"propertyIsEnumerable",$propertyIsEnumerable,!0),wksExt.f=function(e){return wrap(wks(e))}),$export($export.G+$export.W+$export.F*!USE_NATIVE,{Symbol:$Symbol});for(var es6Symbols="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),j=0;es6Symbols.length>j;)wks(es6Symbols[j++]);for(var wellKnownSymbols=$keys(wks.store),k=0;wellKnownSymbols.length>k;)wksDefine(wellKnownSymbols[k++]);$export($export.S+$export.F*!USE_NATIVE,"Symbol",{for:function(e){return has(SymbolRegistry,e+="")?SymbolRegistry[e]:SymbolRegistry[e]=$Symbol(e)},keyFor:function(e){if(!isSymbol(e))throw TypeError(e+" is not a symbol!");for(var r in SymbolRegistry)if(SymbolRegistry[r]===e)return r},useSetter:function(){setter=!0},useSimple:function(){setter=!1}}),$export($export.S+$export.F*!USE_NATIVE,"Object",{create:$create,defineProperty:$defineProperty,defineProperties:$defineProperties,getOwnPropertyDescriptor:$getOwnPropertyDescriptor,getOwnPropertyNames:$getOwnPropertyNames,getOwnPropertySymbols:$getOwnPropertySymbols});var FAILS_ON_PRIMITIVES=$fails(function(){$GOPS.f(1)});$export($export.S+$export.F*FAILS_ON_PRIMITIVES,"Object",{getOwnPropertySymbols:function(e){return $GOPS.f(toObject(e))}}),$JSON&&$export($export.S+$export.F*(!USE_NATIVE||$fails(function(){var e=$Symbol();return"[null]"!=_stringify([e])||"{}"!=_stringify({a:e})||"{}"!=_stringify(Object(e))})),"JSON",{stringify:function(e){for(var r,t,o=[e],i=1;arguments.length>i;)o.push(arguments[i++]);if(t=r=o[1],(isObject(r)||void 0!==e)&&!isSymbol(e))return isArray(r)||(r=function(e,r){if("function"==typeof t&&(r=t.call(this,e,r)),!isSymbol(r))return r}),o[1]=r,_stringify.apply($JSON,o)}}),$Symbol[PROTOTYPE][TO_PRIMITIVE]||require("./_hide")($Symbol[PROTOTYPE],TO_PRIMITIVE,$Symbol[PROTOTYPE].valueOf),setToStringTag($Symbol,"Symbol"),setToStringTag(Math,"Math",!0),setToStringTag(global.JSON,"JSON",!0);

},{"./_an-object":42,"./_descriptors":62,"./_enum-keys":65,"./_export":66,"./_fails":68,"./_global":74,"./_has":75,"./_hide":76,"./_is-array":83,"./_is-object":85,"./_library":93,"./_meta":98,"./_object-create":102,"./_object-dp":103,"./_object-gopd":105,"./_object-gopn":107,"./_object-gopn-ext":106,"./_object-gops":108,"./_object-keys":111,"./_object-pie":112,"./_property-desc":120,"./_redefine":122,"./_set-to-string-tag":128,"./_shared":130,"./_to-iobject":144,"./_to-object":146,"./_to-primitive":147,"./_uid":151,"./_wks":156,"./_wks-define":154,"./_wks-ext":155}],283:[function(require,module,exports){
"use strict";var $export=require("./_export"),$typed=require("./_typed"),buffer=require("./_typed-buffer"),anObject=require("./_an-object"),toAbsoluteIndex=require("./_to-absolute-index"),toLength=require("./_to-length"),isObject=require("./_is-object"),ArrayBuffer=require("./_global").ArrayBuffer,speciesConstructor=require("./_species-constructor"),$ArrayBuffer=buffer.ArrayBuffer,$DataView=buffer.DataView,$isView=$typed.ABV&&ArrayBuffer.isView,$slice=$ArrayBuffer.prototype.slice,VIEW=$typed.VIEW,ARRAY_BUFFER="ArrayBuffer";$export($export.G+$export.W+$export.F*(ArrayBuffer!==$ArrayBuffer),{ArrayBuffer:$ArrayBuffer}),$export($export.S+$export.F*!$typed.CONSTR,ARRAY_BUFFER,{isView:function(e){return $isView&&$isView(e)||isObject(e)&&VIEW in e}}),$export($export.P+$export.U+$export.F*require("./_fails")(function(){return!new $ArrayBuffer(2).slice(1,void 0).byteLength}),ARRAY_BUFFER,{slice:function(e,r){if(void 0!==$slice&&void 0===r)return $slice.call(anObject(this),e);for(var t=anObject(this).byteLength,i=toAbsoluteIndex(e,t),o=toAbsoluteIndex(void 0===r?t:r,t),u=new(speciesConstructor(this,$ArrayBuffer))(toLength(o-i)),f=new $DataView(this),s=new $DataView(u),n=0;i<o;)s.setUint8(n++,f.getUint8(i++));return u}}),require("./_set-species")(ARRAY_BUFFER);

},{"./_an-object":42,"./_export":66,"./_fails":68,"./_global":74,"./_is-object":85,"./_set-species":127,"./_species-constructor":131,"./_to-absolute-index":141,"./_to-length":145,"./_typed":150,"./_typed-buffer":149}],284:[function(require,module,exports){
var $export=require("./_export");$export($export.G+$export.W+$export.F*!require("./_typed").ABV,{DataView:require("./_typed-buffer").DataView});

},{"./_export":66,"./_typed":150,"./_typed-buffer":149}],285:[function(require,module,exports){
require("./_typed-array")("Float32",4,function(r){return function(t,n,e){return r(this,t,n,e)}});

},{"./_typed-array":148}],286:[function(require,module,exports){
require("./_typed-array")("Float64",8,function(r){return function(t,n,e){return r(this,t,n,e)}});

},{"./_typed-array":148}],287:[function(require,module,exports){
require("./_typed-array")("Int16",2,function(r){return function(n,t,e){return r(this,n,t,e)}});

},{"./_typed-array":148}],288:[function(require,module,exports){
require("./_typed-array")("Int32",4,function(r){return function(n,t,e){return r(this,n,t,e)}});

},{"./_typed-array":148}],289:[function(require,module,exports){
require("./_typed-array")("Int8",1,function(r){return function(n,t,e){return r(this,n,t,e)}});

},{"./_typed-array":148}],290:[function(require,module,exports){
require("./_typed-array")("Uint16",2,function(r){return function(n,t,e){return r(this,n,t,e)}});

},{"./_typed-array":148}],291:[function(require,module,exports){
require("./_typed-array")("Uint32",4,function(r){return function(n,t,e){return r(this,n,t,e)}});

},{"./_typed-array":148}],292:[function(require,module,exports){
require("./_typed-array")("Uint8",1,function(r){return function(n,t,e){return r(this,n,t,e)}});

},{"./_typed-array":148}],293:[function(require,module,exports){
require("./_typed-array")("Uint8",1,function(r){return function(n,t,e){return r(this,n,t,e)}},!0);

},{"./_typed-array":148}],294:[function(require,module,exports){
"use strict";var InternalMap,global=require("./_global"),each=require("./_array-methods")(0),redefine=require("./_redefine"),meta=require("./_meta"),assign=require("./_object-assign"),weak=require("./_collection-weak"),isObject=require("./_is-object"),validate=require("./_validate-collection"),NATIVE_WEAK_MAP=require("./_validate-collection"),IS_IE11=!global.ActiveXObject&&"ActiveXObject"in global,WEAK_MAP="WeakMap",getWeak=meta.getWeak,isExtensible=Object.isExtensible,uncaughtFrozenStore=weak.ufstore,wrapper=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},methods={get:function(e){if(isObject(e)){var t=getWeak(e);return!0===t?uncaughtFrozenStore(validate(this,WEAK_MAP)).get(e):t?t[this._i]:void 0}},set:function(e,t){return weak.def(validate(this,WEAK_MAP),e,t)}},$WeakMap=module.exports=require("./_collection")(WEAK_MAP,wrapper,methods,weak,!0,!0);NATIVE_WEAK_MAP&&IS_IE11&&(assign((InternalMap=weak.getConstructor(wrapper,WEAK_MAP)).prototype,methods),meta.NEED=!0,each(["delete","has","get","set"],function(e){var t=$WeakMap.prototype,r=t[e];redefine(t,e,function(t,i){if(isObject(t)&&!isExtensible(t)){this._f||(this._f=new InternalMap);var a=this._f[e](t,i);return"set"==e?this:a}return r.call(this,t,i)})}));

},{"./_array-methods":46,"./_collection":55,"./_collection-weak":54,"./_global":74,"./_is-object":85,"./_meta":98,"./_object-assign":101,"./_redefine":122,"./_validate-collection":153}],295:[function(require,module,exports){
"use strict";var weak=require("./_collection-weak"),validate=require("./_validate-collection"),WEAK_SET="WeakSet";require("./_collection")(WEAK_SET,function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return weak.def(validate(this,WEAK_SET),e,!0)}},weak,!1,!0);

},{"./_collection":55,"./_collection-weak":54,"./_validate-collection":153}],296:[function(require,module,exports){
"use strict";var $export=require("./_export"),flattenIntoArray=require("./_flatten-into-array"),toObject=require("./_to-object"),toLength=require("./_to-length"),aFunction=require("./_a-function"),arraySpeciesCreate=require("./_array-species-create");$export($export.P,"Array",{flatMap:function(e){var r,t,a=toObject(this);return aFunction(e),r=toLength(a.length),t=arraySpeciesCreate(a,0),flattenIntoArray(t,a,a,r,0,1,e,arguments[1]),t}}),require("./_add-to-unscopables")("flatMap");

},{"./_a-function":37,"./_add-to-unscopables":39,"./_array-species-create":49,"./_export":66,"./_flatten-into-array":71,"./_to-length":145,"./_to-object":146}],297:[function(require,module,exports){
"use strict";var $export=require("./_export"),$includes=require("./_array-includes")(!0);$export($export.P,"Array",{includes:function(e){return $includes(this,e,arguments.length>1?arguments[1]:void 0)}}),require("./_add-to-unscopables")("includes");

},{"./_add-to-unscopables":39,"./_array-includes":45,"./_export":66}],298:[function(require,module,exports){
var $export=require("./_export"),$entries=require("./_object-to-array")(!0);$export($export.S,"Object",{entries:function(e){return $entries(e)}});

},{"./_export":66,"./_object-to-array":114}],299:[function(require,module,exports){
var $export=require("./_export"),ownKeys=require("./_own-keys"),toIObject=require("./_to-iobject"),gOPD=require("./_object-gopd"),createProperty=require("./_create-property");$export($export.S,"Object",{getOwnPropertyDescriptors:function(e){for(var r,t,o=toIObject(e),p=gOPD.f,c=ownKeys(o),i={},n=0;c.length>n;)void 0!==(t=p(o,r=c[n++]))&&createProperty(i,r,t);return i}});

},{"./_create-property":57,"./_export":66,"./_object-gopd":105,"./_own-keys":115,"./_to-iobject":144}],300:[function(require,module,exports){
var $export=require("./_export"),$values=require("./_object-to-array")(!1);$export($export.S,"Object",{values:function(e){return $values(e)}});

},{"./_export":66,"./_object-to-array":114}],301:[function(require,module,exports){
"use strict";var $export=require("./_export"),core=require("./_core"),global=require("./_global"),speciesConstructor=require("./_species-constructor"),promiseResolve=require("./_promise-resolve");$export($export.P+$export.R,"Promise",{finally:function(e){var r=speciesConstructor(this,core.Promise||global.Promise),o="function"==typeof e;return this.then(o?function(o){return promiseResolve(r,e()).then(function(){return o})}:e,o?function(o){return promiseResolve(r,e()).then(function(){throw o})}:e)}});

},{"./_core":56,"./_export":66,"./_global":74,"./_promise-resolve":119,"./_species-constructor":131}],302:[function(require,module,exports){
"use strict";var $export=require("./_export"),$pad=require("./_string-pad"),userAgent=require("./_user-agent"),WEBKIT_BUG=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(userAgent);$export($export.P+$export.F*WEBKIT_BUG,"String",{padEnd:function(e){return $pad(this,e,arguments.length>1?arguments[1]:void 0,!1)}});

},{"./_export":66,"./_string-pad":136,"./_user-agent":152}],303:[function(require,module,exports){
"use strict";var $export=require("./_export"),$pad=require("./_string-pad"),userAgent=require("./_user-agent"),WEBKIT_BUG=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(userAgent);$export($export.P+$export.F*WEBKIT_BUG,"String",{padStart:function(e){return $pad(this,e,arguments.length>1?arguments[1]:void 0,!0)}});

},{"./_export":66,"./_string-pad":136,"./_user-agent":152}],304:[function(require,module,exports){
"use strict";require("./_string-trim")("trimLeft",function(t){return function(){return t(this,1)}},"trimStart");

},{"./_string-trim":138}],305:[function(require,module,exports){
"use strict";require("./_string-trim")("trimRight",function(t){return function(){return t(this,2)}},"trimEnd");

},{"./_string-trim":138}],306:[function(require,module,exports){
require("./_wks-define")("asyncIterator");

},{"./_wks-define":154}],307:[function(require,module,exports){
for(var $iterators=require("./es6.array.iterator"),getKeys=require("./_object-keys"),redefine=require("./_redefine"),global=require("./_global"),hide=require("./_hide"),Iterators=require("./_iterators"),wks=require("./_wks"),ITERATOR=wks("iterator"),TO_STRING_TAG=wks("toStringTag"),ArrayValues=Iterators.Array,DOMIterables={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},collections=getKeys(DOMIterables),i=0;i<collections.length;i++){var key,NAME=collections[i],explicit=DOMIterables[NAME],Collection=global[NAME],proto=Collection&&Collection.prototype;if(proto&&(proto[ITERATOR]||hide(proto,ITERATOR,ArrayValues),proto[TO_STRING_TAG]||hide(proto,TO_STRING_TAG,NAME),Iterators[NAME]=ArrayValues,explicit))for(key in $iterators)proto[key]||redefine(proto,key,$iterators[key],!0)}

},{"./_global":74,"./_hide":76,"./_iterators":92,"./_object-keys":111,"./_redefine":122,"./_wks":156,"./es6.array.iterator":168}],308:[function(require,module,exports){
var $export=require("./_export"),$task=require("./_task");$export($export.G+$export.B,{setImmediate:$task.set,clearImmediate:$task.clear});

},{"./_export":66,"./_task":140}],309:[function(require,module,exports){
var global=require("./_global"),$export=require("./_export"),userAgent=require("./_user-agent"),slice=[].slice,MSIE=/MSIE .\./.test(userAgent),wrap=function(e){return function(t,r){var n=arguments.length>2,o=!!n&&slice.call(arguments,2);return e(n?function(){("function"==typeof t?t:Function(t)).apply(this,o)}:t,r)}};$export($export.G+$export.B+$export.F*MSIE,{setTimeout:wrap(global.setTimeout),setInterval:wrap(global.setInterval)});

},{"./_export":66,"./_global":74,"./_user-agent":152}],310:[function(require,module,exports){
require("../modules/web.timers"),require("../modules/web.immediate"),require("../modules/web.dom.iterable"),module.exports=require("../modules/_core");

},{"../modules/_core":56,"../modules/web.dom.iterable":307,"../modules/web.immediate":308,"../modules/web.timers":309}],311:[function(require,module,exports){
!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){"use strict";var n=[],r=Object.getPrototypeOf,i=n.slice,o=n.flat?function(e){return n.flat.call(e)}:function(e){return n.concat.apply([],e)},a=n.push,s=n.indexOf,u={},l=u.toString,c=u.hasOwnProperty,f=c.toString,p=f.call(Object),d={},h=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},g=function(e){return null!=e&&e===e.window},v=e.document,y={type:!0,src:!0,nonce:!0,noModule:!0};function m(e,t,n){var r,i,o=(n=n||v).createElement("script");if(o.text=e,t)for(r in y)(i=t[r]||t.getAttribute&&t.getAttribute(r))&&o.setAttribute(r,i);n.head.appendChild(o).parentNode.removeChild(o)}function x(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?u[l.call(e)]||"object":typeof e}var b=function(e,t){return new b.fn.init(e,t)};function w(e){var t=!!e&&"length"in e&&e.length,n=x(e);return!h(e)&&!g(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}b.fn=b.prototype={jquery:"3.5.1",constructor:b,length:0,toArray:function(){return i.call(this)},get:function(e){return null==e?i.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=b.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return b.each(this,e)},map:function(e){return this.pushStack(b.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(i.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(b.grep(this,function(e,t){return(t+1)%2}))},odd:function(){return this.pushStack(b.grep(this,function(e,t){return t%2}))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:a,sort:n.sort,splice:n.splice},b.extend=b.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||h(a)||(a={}),s===u&&(a=this,s--);s<u;s++)if(null!=(e=arguments[s]))for(t in e)r=e[t],"__proto__"!==t&&a!==r&&(l&&r&&(b.isPlainObject(r)||(i=Array.isArray(r)))?(n=a[t],o=i&&!Array.isArray(n)?[]:i||b.isPlainObject(n)?n:{},i=!1,a[t]=b.extend(l,o,r)):void 0!==r&&(a[t]=r));return a},b.extend({expando:"jQuery"+("3.5.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==l.call(e))&&(!(t=r(e))||"function"==typeof(n=c.call(t,"constructor")&&t.constructor)&&f.call(n)===p)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){m(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,r=0;if(w(e))for(n=e.length;r<n&&!1!==t.call(e[r],r,e[r]);r++);else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},makeArray:function(e,t){var n=t||[];return null!=e&&(w(Object(e))?b.merge(n,"string"==typeof e?[e]:e):a.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:s.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,a=!n;i<o;i++)!t(e[i],i)!==a&&r.push(e[i]);return r},map:function(e,t,n){var r,i,a=0,s=[];if(w(e))for(r=e.length;a<r;a++)null!=(i=t(e[a],a,n))&&s.push(i);else for(a in e)null!=(i=t(e[a],a,n))&&s.push(i);return o(s)},guid:1,support:d}),"function"==typeof Symbol&&(b.fn[Symbol.iterator]=n[Symbol.iterator]),b.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){u["[object "+t+"]"]=t.toLowerCase()});var T=function(e){var t,n,r,i,o,a,s,u,l,c,f,p,d,h,g,v,y,m,x,b="sizzle"+1*new Date,w=e.document,T=0,C=0,E=ue(),S=ue(),k=ue(),A=ue(),N=function(e,t){return e===t&&(f=!0),0},D={}.hasOwnProperty,j=[],q=j.pop,L=j.push,H=j.push,O=j.slice,P=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},R="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",I="(?:\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",W="\\["+M+"*("+I+")(?:"+M+"*([*^$|!~]?=)"+M+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+I+"))|)"+M+"*\\]",F=":("+I+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+W+")*)|.*)\\)|)",B=new RegExp(M+"+","g"),$=new RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),_=new RegExp("^"+M+"*,"+M+"*"),z=new RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),U=new RegExp(M+"|>"),X=new RegExp(F),V=new RegExp("^"+I+"$"),G={ID:new RegExp("^#("+I+")"),CLASS:new RegExp("^\\.("+I+")"),TAG:new RegExp("^("+I+"|[*])"),ATTR:new RegExp("^"+W),PSEUDO:new RegExp("^"+F),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:new RegExp("^(?:"+R+")$","i"),needsContext:new RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},Y=/HTML$/i,Q=/^(?:input|select|textarea|button)$/i,J=/^h\d$/i,K=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=new RegExp("\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\([^\\r\\n\\f])","g"),ne=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},re=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ie=function(e,t){return t?"\0"===e?"�":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},oe=function(){p()},ae=be(function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{H.apply(j=O.call(w.childNodes),w.childNodes),j[w.childNodes.length].nodeType}catch(e){H={apply:j.length?function(e,t){L.apply(e,O.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}function se(e,t,r,i){var o,s,l,c,f,h,y,m=t&&t.ownerDocument,w=t?t.nodeType:9;if(r=r||[],"string"!=typeof e||!e||1!==w&&9!==w&&11!==w)return r;if(!i&&(p(t),t=t||d,g)){if(11!==w&&(f=Z.exec(e)))if(o=f[1]){if(9===w){if(!(l=t.getElementById(o)))return r;if(l.id===o)return r.push(l),r}else if(m&&(l=m.getElementById(o))&&x(t,l)&&l.id===o)return r.push(l),r}else{if(f[2])return H.apply(r,t.getElementsByTagName(e)),r;if((o=f[3])&&n.getElementsByClassName&&t.getElementsByClassName)return H.apply(r,t.getElementsByClassName(o)),r}if(n.qsa&&!A[e+" "]&&(!v||!v.test(e))&&(1!==w||"object"!==t.nodeName.toLowerCase())){if(y=e,m=t,1===w&&(U.test(e)||z.test(e))){for((m=ee.test(e)&&ye(t.parentNode)||t)===t&&n.scope||((c=t.getAttribute("id"))?c=c.replace(re,ie):t.setAttribute("id",c=b)),s=(h=a(e)).length;s--;)h[s]=(c?"#"+c:":scope")+" "+xe(h[s]);y=h.join(",")}try{return H.apply(r,m.querySelectorAll(y)),r}catch(t){A(e,!0)}finally{c===b&&t.removeAttribute("id")}}}return u(e.replace($,"$1"),t,r,i)}function ue(){var e=[];return function t(n,i){return e.push(n+" ")>r.cacheLength&&delete t[e.shift()],t[n+" "]=i}}function le(e){return e[b]=!0,e}function ce(e){var t=d.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function fe(e,t){for(var n=e.split("|"),i=n.length;i--;)r.attrHandle[n[i]]=t}function pe(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function de(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function he(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function ge(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&ae(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function ve(e){return le(function(t){return t=+t,le(function(n,r){for(var i,o=e([],n.length,t),a=o.length;a--;)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))})})}function ye(e){return e&&void 0!==e.getElementsByTagName&&e}for(t in n=se.support={},o=se.isXML=function(e){var t=e.namespaceURI,n=(e.ownerDocument||e).documentElement;return!Y.test(t||n&&n.nodeName||"HTML")},p=se.setDocument=function(e){var t,i,a=e?e.ownerDocument||e:w;return a!=d&&9===a.nodeType&&a.documentElement?(h=(d=a).documentElement,g=!o(d),w!=d&&(i=d.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",oe,!1):i.attachEvent&&i.attachEvent("onunload",oe)),n.scope=ce(function(e){return h.appendChild(e).appendChild(d.createElement("div")),void 0!==e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length}),n.attributes=ce(function(e){return e.className="i",!e.getAttribute("className")}),n.getElementsByTagName=ce(function(e){return e.appendChild(d.createComment("")),!e.getElementsByTagName("*").length}),n.getElementsByClassName=K.test(d.getElementsByClassName),n.getById=ce(function(e){return h.appendChild(e).id=b,!d.getElementsByName||!d.getElementsByName(b).length}),n.getById?(r.filter.ID=function(e){var t=e.replace(te,ne);return function(e){return e.getAttribute("id")===t}},r.find.ID=function(e,t){if(void 0!==t.getElementById&&g){var n=t.getElementById(e);return n?[n]:[]}}):(r.filter.ID=function(e){var t=e.replace(te,ne);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},r.find.ID=function(e,t){if(void 0!==t.getElementById&&g){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];for(i=t.getElementsByName(e),r=0;o=i[r++];)if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),r.find.TAG=n.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):n.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[i++];)1===n.nodeType&&r.push(n);return r}return o},r.find.CLASS=n.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&g)return t.getElementsByClassName(e)},y=[],v=[],(n.qsa=K.test(d.querySelectorAll))&&(ce(function(e){var t;h.appendChild(e).innerHTML="<a id='"+b+"'></a><select id='"+b+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&v.push("[*^$]="+M+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||v.push("\\["+M+"*(?:value|"+R+")"),e.querySelectorAll("[id~="+b+"-]").length||v.push("~="),(t=d.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||v.push("\\["+M+"*name"+M+"*="+M+"*(?:''|\"\")"),e.querySelectorAll(":checked").length||v.push(":checked"),e.querySelectorAll("a#"+b+"+*").length||v.push(".#.+[+~]"),e.querySelectorAll("\\\f"),v.push("[\\r\\n\\f]")}),ce(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=d.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&v.push("name"+M+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&v.push(":enabled",":disabled"),h.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&v.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),v.push(",.*:")})),(n.matchesSelector=K.test(m=h.matches||h.webkitMatchesSelector||h.mozMatchesSelector||h.oMatchesSelector||h.msMatchesSelector))&&ce(function(e){n.disconnectedMatch=m.call(e,"*"),m.call(e,"[s!='']:x"),y.push("!=",F)}),v=v.length&&new RegExp(v.join("|")),y=y.length&&new RegExp(y.join("|")),t=K.test(h.compareDocumentPosition),x=t||K.test(h.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},N=t?function(e,t){if(e===t)return f=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r||(1&(r=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!n.sortDetached&&t.compareDocumentPosition(e)===r?e==d||e.ownerDocument==w&&x(w,e)?-1:t==d||t.ownerDocument==w&&x(w,t)?1:c?P(c,e)-P(c,t):0:4&r?-1:1)}:function(e,t){if(e===t)return f=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,a=[e],s=[t];if(!i||!o)return e==d?-1:t==d?1:i?-1:o?1:c?P(c,e)-P(c,t):0;if(i===o)return pe(e,t);for(n=e;n=n.parentNode;)a.unshift(n);for(n=t;n=n.parentNode;)s.unshift(n);for(;a[r]===s[r];)r++;return r?pe(a[r],s[r]):a[r]==w?-1:s[r]==w?1:0},d):d},se.matches=function(e,t){return se(e,null,null,t)},se.matchesSelector=function(e,t){if(p(e),n.matchesSelector&&g&&!A[t+" "]&&(!y||!y.test(t))&&(!v||!v.test(t)))try{var r=m.call(e,t);if(r||n.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(e){A(t,!0)}return se(t,d,null,[e]).length>0},se.contains=function(e,t){return(e.ownerDocument||e)!=d&&p(e),x(e,t)},se.attr=function(e,t){(e.ownerDocument||e)!=d&&p(e);var i=r.attrHandle[t.toLowerCase()],o=i&&D.call(r.attrHandle,t.toLowerCase())?i(e,t,!g):void 0;return void 0!==o?o:n.attributes||!g?e.getAttribute(t):(o=e.getAttributeNode(t))&&o.specified?o.value:null},se.escape=function(e){return(e+"").replace(re,ie)},se.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},se.uniqueSort=function(e){var t,r=[],i=0,o=0;if(f=!n.detectDuplicates,c=!n.sortStable&&e.slice(0),e.sort(N),f){for(;t=e[o++];)t===e[o]&&(i=r.push(o));for(;i--;)e.splice(r[i],1)}return c=null,e},i=se.getText=function(e){var t,n="",r=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=i(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[r++];)n+=i(t);return n},(r=se.selectors={cacheLength:50,createPseudo:le,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,ne),e[3]=(e[3]||e[4]||e[5]||"").replace(te,ne),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||se.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&se.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return G.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&X.test(n)&&(t=a(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,ne).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=E[e+" "];return t||(t=new RegExp("(^|"+M+")"+e+"("+M+"|$)"))&&E(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=se.attr(r,e);return null==i?"!="===t:!t||(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i.replace(B," ")+" ").indexOf(n)>-1:"|="===t&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,u){var l,c,f,p,d,h,g=o!==a?"nextSibling":"previousSibling",v=t.parentNode,y=s&&t.nodeName.toLowerCase(),m=!u&&!s,x=!1;if(v){if(o){for(;g;){for(p=t;p=p[g];)if(s?p.nodeName.toLowerCase()===y:1===p.nodeType)return!1;h=g="only"===e&&!h&&"nextSibling"}return!0}if(h=[a?v.firstChild:v.lastChild],a&&m){for(x=(d=(l=(c=(f=(p=v)[b]||(p[b]={}))[p.uniqueID]||(f[p.uniqueID]={}))[e]||[])[0]===T&&l[1])&&l[2],p=d&&v.childNodes[d];p=++d&&p&&p[g]||(x=d=0)||h.pop();)if(1===p.nodeType&&++x&&p===t){c[e]=[T,d,x];break}}else if(m&&(x=d=(l=(c=(f=(p=t)[b]||(p[b]={}))[p.uniqueID]||(f[p.uniqueID]={}))[e]||[])[0]===T&&l[1]),!1===x)for(;(p=++d&&p&&p[g]||(x=d=0)||h.pop())&&((s?p.nodeName.toLowerCase()!==y:1!==p.nodeType)||!++x||(m&&((c=(f=p[b]||(p[b]={}))[p.uniqueID]||(f[p.uniqueID]={}))[e]=[T,x]),p!==t)););return(x-=i)===r||x%r==0&&x/r>=0}}},PSEUDO:function(e,t){var n,i=r.pseudos[e]||r.setFilters[e.toLowerCase()]||se.error("unsupported pseudo: "+e);return i[b]?i(t):i.length>1?(n=[e,e,"",t],r.setFilters.hasOwnProperty(e.toLowerCase())?le(function(e,n){for(var r,o=i(e,t),a=o.length;a--;)e[r=P(e,o[a])]=!(n[r]=o[a])}):function(e){return i(e,0,n)}):i}},pseudos:{not:le(function(e){var t=[],n=[],r=s(e.replace($,"$1"));return r[b]?le(function(e,t,n,i){for(var o,a=r(e,null,i,[]),s=e.length;s--;)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),t[0]=null,!n.pop()}}),has:le(function(e){return function(t){return se(e,t).length>0}}),contains:le(function(e){return e=e.replace(te,ne),function(t){return(t.textContent||i(t)).indexOf(e)>-1}}),lang:le(function(e){return V.test(e||"")||se.error("unsupported lang: "+e),e=e.replace(te,ne).toLowerCase(),function(t){var n;do{if(n=g?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===h},focus:function(e){return e===d.activeElement&&(!d.hasFocus||d.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ge(!1),disabled:ge(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!r.pseudos.empty(e)},header:function(e){return J.test(e.nodeName)},input:function(e){return Q.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:ve(function(){return[0]}),last:ve(function(e,t){return[t-1]}),eq:ve(function(e,t,n){return[n<0?n+t:n]}),even:ve(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:ve(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:ve(function(e,t,n){for(var r=n<0?n+t:n>t?t:n;--r>=0;)e.push(r);return e}),gt:ve(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=r.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})r.pseudos[t]=de(t);for(t in{submit:!0,reset:!0})r.pseudos[t]=he(t);function me(){}function xe(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function be(e,t,n){var r=t.dir,i=t.next,o=i||r,a=n&&"parentNode"===o,s=C++;return t.first?function(t,n,i){for(;t=t[r];)if(1===t.nodeType||a)return e(t,n,i);return!1}:function(t,n,u){var l,c,f,p=[T,s];if(u){for(;t=t[r];)if((1===t.nodeType||a)&&e(t,n,u))return!0}else for(;t=t[r];)if(1===t.nodeType||a)if(c=(f=t[b]||(t[b]={}))[t.uniqueID]||(f[t.uniqueID]={}),i&&i===t.nodeName.toLowerCase())t=t[r]||t;else{if((l=c[o])&&l[0]===T&&l[1]===s)return p[2]=l[2];if(c[o]=p,p[2]=e(t,n,u))return!0}return!1}}function we(e){return e.length>1?function(t,n,r){for(var i=e.length;i--;)if(!e[i](t,n,r))return!1;return!0}:e[0]}function Te(e,t,n,r,i){for(var o,a=[],s=0,u=e.length,l=null!=t;s<u;s++)(o=e[s])&&(n&&!n(o,r,i)||(a.push(o),l&&t.push(s)));return a}function Ce(e,t,n,r,i,o){return r&&!r[b]&&(r=Ce(r)),i&&!i[b]&&(i=Ce(i,o)),le(function(o,a,s,u){var l,c,f,p=[],d=[],h=a.length,g=o||function(e,t,n){for(var r=0,i=t.length;r<i;r++)se(e,t[r],n);return n}(t||"*",s.nodeType?[s]:s,[]),v=!e||!o&&t?g:Te(g,p,e,s,u),y=n?i||(o?e:h||r)?[]:a:v;if(n&&n(v,y,s,u),r)for(l=Te(y,d),r(l,[],s,u),c=l.length;c--;)(f=l[c])&&(y[d[c]]=!(v[d[c]]=f));if(o){if(i||e){if(i){for(l=[],c=y.length;c--;)(f=y[c])&&l.push(v[c]=f);i(null,y=[],l,u)}for(c=y.length;c--;)(f=y[c])&&(l=i?P(o,f):p[c])>-1&&(o[l]=!(a[l]=f))}}else y=Te(y===a?y.splice(h,y.length):y),i?i(null,a,y,u):H.apply(a,y)})}function Ee(e){for(var t,n,i,o=e.length,a=r.relative[e[0].type],s=a||r.relative[" "],u=a?1:0,c=be(function(e){return e===t},s,!0),f=be(function(e){return P(t,e)>-1},s,!0),p=[function(e,n,r){var i=!a&&(r||n!==l)||((t=n).nodeType?c(e,n,r):f(e,n,r));return t=null,i}];u<o;u++)if(n=r.relative[e[u].type])p=[be(we(p),n)];else{if((n=r.filter[e[u].type].apply(null,e[u].matches))[b]){for(i=++u;i<o&&!r.relative[e[i].type];i++);return Ce(u>1&&we(p),u>1&&xe(e.slice(0,u-1).concat({value:" "===e[u-2].type?"*":""})).replace($,"$1"),n,u<i&&Ee(e.slice(u,i)),i<o&&Ee(e=e.slice(i)),i<o&&xe(e))}p.push(n)}return we(p)}return me.prototype=r.filters=r.pseudos,r.setFilters=new me,a=se.tokenize=function(e,t){var n,i,o,a,s,u,l,c=S[e+" "];if(c)return t?0:c.slice(0);for(s=e,u=[],l=r.preFilter;s;){for(a in n&&!(i=_.exec(s))||(i&&(s=s.slice(i[0].length)||s),u.push(o=[])),n=!1,(i=z.exec(s))&&(n=i.shift(),o.push({value:n,type:i[0].replace($," ")}),s=s.slice(n.length)),r.filter)!(i=G[a].exec(s))||l[a]&&!(i=l[a](i))||(n=i.shift(),o.push({value:n,type:a,matches:i}),s=s.slice(n.length));if(!n)break}return t?s.length:s?se.error(e):S(e,u).slice(0)},s=se.compile=function(e,t){var n,i=[],o=[],s=k[e+" "];if(!s){for(t||(t=a(e)),n=t.length;n--;)(s=Ee(t[n]))[b]?i.push(s):o.push(s);(s=k(e,function(e,t){var n=t.length>0,i=e.length>0,o=function(o,a,s,u,c){var f,h,v,y=0,m="0",x=o&&[],b=[],w=l,C=o||i&&r.find.TAG("*",c),E=T+=null==w?1:Math.random()||.1,S=C.length;for(c&&(l=a==d||a||c);m!==S&&null!=(f=C[m]);m++){if(i&&f){for(h=0,a||f.ownerDocument==d||(p(f),s=!g);v=e[h++];)if(v(f,a||d,s)){u.push(f);break}c&&(T=E)}n&&((f=!v&&f)&&y--,o&&x.push(f))}if(y+=m,n&&m!==y){for(h=0;v=t[h++];)v(x,b,a,s);if(o){if(y>0)for(;m--;)x[m]||b[m]||(b[m]=q.call(u));b=Te(b)}H.apply(u,b),c&&!o&&b.length>0&&y+t.length>1&&se.uniqueSort(u)}return c&&(T=E,l=w),x};return n?le(o):o}(o,i))).selector=e}return s},u=se.select=function(e,t,n,i){var o,u,l,c,f,p="function"==typeof e&&e,d=!i&&a(e=p.selector||e);if(n=n||[],1===d.length){if((u=d[0]=d[0].slice(0)).length>2&&"ID"===(l=u[0]).type&&9===t.nodeType&&g&&r.relative[u[1].type]){if(!(t=(r.find.ID(l.matches[0].replace(te,ne),t)||[])[0]))return n;p&&(t=t.parentNode),e=e.slice(u.shift().value.length)}for(o=G.needsContext.test(e)?0:u.length;o--&&(l=u[o],!r.relative[c=l.type]);)if((f=r.find[c])&&(i=f(l.matches[0].replace(te,ne),ee.test(u[0].type)&&ye(t.parentNode)||t))){if(u.splice(o,1),!(e=i.length&&xe(u)))return H.apply(n,i),n;break}}return(p||s(e,d))(i,t,!g,n,!t||ee.test(e)&&ye(t.parentNode)||t),n},n.sortStable=b.split("").sort(N).join("")===b,n.detectDuplicates=!!f,p(),n.sortDetached=ce(function(e){return 1&e.compareDocumentPosition(d.createElement("fieldset"))}),ce(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||fe("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),n.attributes&&ce(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||fe("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),ce(function(e){return null==e.getAttribute("disabled")})||fe(R,function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),se}(e);b.find=T,b.expr=T.selectors,b.expr[":"]=b.expr.pseudos,b.uniqueSort=b.unique=T.uniqueSort,b.text=T.getText,b.isXMLDoc=T.isXML,b.contains=T.contains,b.escapeSelector=T.escape;var C=function(e,t,n){for(var r=[],i=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(i&&b(e).is(n))break;r.push(e)}return r},E=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},S=b.expr.match.needsContext;function k(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var A=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function N(e,t,n){return h(t)?b.grep(e,function(e,r){return!!t.call(e,r,e)!==n}):t.nodeType?b.grep(e,function(e){return e===t!==n}):"string"!=typeof t?b.grep(e,function(e){return s.call(t,e)>-1!==n}):b.filter(t,e,n)}b.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?b.find.matchesSelector(r,e)?[r]:[]:b.find.matches(e,b.grep(t,function(e){return 1===e.nodeType}))},b.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(b(e).filter(function(){for(t=0;t<r;t++)if(b.contains(i[t],this))return!0}));for(n=this.pushStack([]),t=0;t<r;t++)b.find(e,i[t],n);return r>1?b.uniqueSort(n):n},filter:function(e){return this.pushStack(N(this,e||[],!1))},not:function(e){return this.pushStack(N(this,e||[],!0))},is:function(e){return!!N(this,"string"==typeof e&&S.test(e)?b(e):e||[],!1).length}});var D,j=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(b.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||D,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:j.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof b?t[0]:t,b.merge(this,b.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:v,!0)),A.test(r[1])&&b.isPlainObject(t))for(r in t)h(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(i=v.getElementById(r[2]))&&(this[0]=i,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):h(e)?void 0!==n.ready?n.ready(e):e(b):b.makeArray(e,this)}).prototype=b.fn,D=b(v);var q=/^(?:parents|prev(?:Until|All))/,L={children:!0,contents:!0,next:!0,prev:!0};function H(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}b.fn.extend({has:function(e){var t=b(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(b.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,i=this.length,o=[],a="string"!=typeof e&&b(e);if(!S.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&b.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(o.length>1?b.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?s.call(b(e),this[0]):s.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(b.uniqueSort(b.merge(this.get(),b(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),b.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return C(e,"parentNode")},parentsUntil:function(e,t,n){return C(e,"parentNode",n)},next:function(e){return H(e,"nextSibling")},prev:function(e){return H(e,"previousSibling")},nextAll:function(e){return C(e,"nextSibling")},prevAll:function(e){return C(e,"previousSibling")},nextUntil:function(e,t,n){return C(e,"nextSibling",n)},prevUntil:function(e,t,n){return C(e,"previousSibling",n)},siblings:function(e){return E((e.parentNode||{}).firstChild,e)},children:function(e){return E(e.firstChild)},contents:function(e){return null!=e.contentDocument&&r(e.contentDocument)?e.contentDocument:(k(e,"template")&&(e=e.content||e),b.merge([],e.childNodes))}},function(e,t){b.fn[e]=function(n,r){var i=b.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=b.filter(r,i)),this.length>1&&(L[e]||b.uniqueSort(i),q.test(e)&&i.reverse()),this.pushStack(i)}});var O=/[^\x20\t\r\n\f]+/g;function P(e){return e}function R(e){throw e}function M(e,t,n,r){var i;try{e&&h(i=e.promise)?i.call(e).done(t).fail(n):e&&h(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}b.Callbacks=function(e){e="string"==typeof e?function(e){var t={};return b.each(e.match(O)||[],function(e,n){t[n]=!0}),t}(e):b.extend({},e);var t,n,r,i,o=[],a=[],s=-1,u=function(){for(i=i||e.once,r=t=!0;a.length;s=-1)for(n=a.shift();++s<o.length;)!1===o[s].apply(n[0],n[1])&&e.stopOnFalse&&(s=o.length,n=!1);e.memory||(n=!1),t=!1,i&&(o=n?[]:"")},l={add:function(){return o&&(n&&!t&&(s=o.length-1,a.push(n)),function t(n){b.each(n,function(n,r){h(r)?e.unique&&l.has(r)||o.push(r):r&&r.length&&"string"!==x(r)&&t(r)})}(arguments),n&&!t&&u()),this},remove:function(){return b.each(arguments,function(e,t){for(var n;(n=b.inArray(t,o,n))>-1;)o.splice(n,1),n<=s&&s--}),this},has:function(e){return e?b.inArray(e,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return i=a=[],o=n="",this},disabled:function(){return!o},lock:function(){return i=a=[],n||t||(o=n=""),this},locked:function(){return!!i},fireWith:function(e,n){return i||(n=[e,(n=n||[]).slice?n.slice():n],a.push(n),t||u()),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!r}};return l},b.extend({Deferred:function(t){var n=[["notify","progress",b.Callbacks("memory"),b.Callbacks("memory"),2],["resolve","done",b.Callbacks("once memory"),b.Callbacks("once memory"),0,"resolved"],["reject","fail",b.Callbacks("once memory"),b.Callbacks("once memory"),1,"rejected"]],r="pending",i={state:function(){return r},always:function(){return o.done(arguments).fail(arguments),this},catch:function(e){return i.then(null,e)},pipe:function(){var e=arguments;return b.Deferred(function(t){b.each(n,function(n,r){var i=h(e[r[4]])&&e[r[4]];o[r[1]](function(){var e=i&&i.apply(this,arguments);e&&h(e.promise)?e.promise().progress(t.notify).done(t.resolve).fail(t.reject):t[r[0]+"With"](this,i?[e]:arguments)})}),e=null}).promise()},then:function(t,r,i){var o=0;function a(t,n,r,i){return function(){var s=this,u=arguments,l=function(){var e,l;if(!(t<o)){if((e=r.apply(s,u))===n.promise())throw new TypeError("Thenable self-resolution");l=e&&("object"==typeof e||"function"==typeof e)&&e.then,h(l)?i?l.call(e,a(o,n,P,i),a(o,n,R,i)):(o++,l.call(e,a(o,n,P,i),a(o,n,R,i),a(o,n,P,n.notifyWith))):(r!==P&&(s=void 0,u=[e]),(i||n.resolveWith)(s,u))}},c=i?l:function(){try{l()}catch(e){b.Deferred.exceptionHook&&b.Deferred.exceptionHook(e,c.stackTrace),t+1>=o&&(r!==R&&(s=void 0,u=[e]),n.rejectWith(s,u))}};t?c():(b.Deferred.getStackHook&&(c.stackTrace=b.Deferred.getStackHook()),e.setTimeout(c))}}return b.Deferred(function(e){n[0][3].add(a(0,e,h(i)?i:P,e.notifyWith)),n[1][3].add(a(0,e,h(t)?t:P)),n[2][3].add(a(0,e,h(r)?r:R))}).promise()},promise:function(e){return null!=e?b.extend(e,i):i}},o={};return b.each(n,function(e,t){var a=t[2],s=t[5];i[t[1]]=a.add,s&&a.add(function(){r=s},n[3-e][2].disable,n[3-e][3].disable,n[0][2].lock,n[0][3].lock),a.add(t[3].fire),o[t[0]]=function(){return o[t[0]+"With"](this===o?void 0:this,arguments),this},o[t[0]+"With"]=a.fireWith}),i.promise(o),t&&t.call(o,o),o},when:function(e){var t=arguments.length,n=t,r=Array(n),o=i.call(arguments),a=b.Deferred(),s=function(e){return function(n){r[e]=this,o[e]=arguments.length>1?i.call(arguments):n,--t||a.resolveWith(r,o)}};if(t<=1&&(M(e,a.done(s(n)).resolve,a.reject,!t),"pending"===a.state()||h(o[n]&&o[n].then)))return a.then();for(;n--;)M(o[n],s(n),a.reject);return a.promise()}});var I=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;b.Deferred.exceptionHook=function(t,n){e.console&&e.console.warn&&t&&I.test(t.name)&&e.console.warn("jQuery.Deferred exception: "+t.message,t.stack,n)},b.readyException=function(t){e.setTimeout(function(){throw t})};var W=b.Deferred();function F(){v.removeEventListener("DOMContentLoaded",F),e.removeEventListener("load",F),b.ready()}b.fn.ready=function(e){return W.then(e).catch(function(e){b.readyException(e)}),this},b.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--b.readyWait:b.isReady)||(b.isReady=!0,!0!==e&&--b.readyWait>0||W.resolveWith(v,[b]))}}),b.ready.then=W.then,"complete"===v.readyState||"loading"!==v.readyState&&!v.documentElement.doScroll?e.setTimeout(b.ready):(v.addEventListener("DOMContentLoaded",F),e.addEventListener("load",F));var B=function(e,t,n,r,i,o,a){var s=0,u=e.length,l=null==n;if("object"===x(n))for(s in i=!0,n)B(e,t,s,n[s],!0,o,a);else if(void 0!==r&&(i=!0,h(r)||(a=!0),l&&(a?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(b(e),n)})),t))for(;s<u;s++)t(e[s],n,a?r:r.call(e[s],s,t(e[s],n)));return i?e:l?t.call(e):u?t(e[0],n):o},$=/^-ms-/,_=/-([a-z])/g;function z(e,t){return t.toUpperCase()}function U(e){return e.replace($,"ms-").replace(_,z)}var X=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function V(){this.expando=b.expando+V.uid++}V.uid=1,V.prototype={cache:function(e){var t=e[this.expando];return t||(t={},X(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[U(t)]=n;else for(r in t)i[U(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][U(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(U):(t=U(t))in r?[t]:t.match(O)||[]).length;for(;n--;)delete r[t[n]]}(void 0===t||b.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!b.isEmptyObject(t)}};var G=new V,Y=new V,Q=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,J=/[A-Z]/g;function K(e,t,n){var r;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(J,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n=function(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:Q.test(e)?JSON.parse(e):e)}(n)}catch(e){}Y.set(e,t,n)}else n=void 0;return n}b.extend({hasData:function(e){return Y.hasData(e)||G.hasData(e)},data:function(e,t,n){return Y.access(e,t,n)},removeData:function(e,t){Y.remove(e,t)},_data:function(e,t,n){return G.access(e,t,n)},_removeData:function(e,t){G.remove(e,t)}}),b.fn.extend({data:function(e,t){var n,r,i,o=this[0],a=o&&o.attributes;if(void 0===e){if(this.length&&(i=Y.get(o),1===o.nodeType&&!G.get(o,"hasDataAttrs"))){for(n=a.length;n--;)a[n]&&0===(r=a[n].name).indexOf("data-")&&(r=U(r.slice(5)),K(o,r,i[r]));G.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof e?this.each(function(){Y.set(this,e)}):B(this,function(t){var n;if(o&&void 0===t)return void 0!==(n=Y.get(o,e))?n:void 0!==(n=K(o,e))?n:void 0;this.each(function(){Y.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){Y.remove(this,e)})}}),b.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=G.get(e,t),n&&(!r||Array.isArray(n)?r=G.access(e,t,b.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=b.queue(e,t),r=n.length,i=n.shift(),o=b._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,function(){b.dequeue(e,t)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return G.get(e,n)||G.access(e,n,{empty:b.Callbacks("once memory").add(function(){G.remove(e,[t+"queue",n])})})}}),b.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?b.queue(this[0],e):void 0===t?this:this.each(function(){var n=b.queue(this,e,t);b._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&b.dequeue(this,e)})},dequeue:function(e){return this.each(function(){b.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=b.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)(n=G.get(o[a],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(t)}});var Z=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ee=new RegExp("^(?:([+-])=|)("+Z+")([a-z%]*)$","i"),te=["Top","Right","Bottom","Left"],ne=v.documentElement,re=function(e){return b.contains(e.ownerDocument,e)},ie={composed:!0};ne.getRootNode&&(re=function(e){return b.contains(e.ownerDocument,e)||e.getRootNode(ie)===e.ownerDocument});var oe=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&re(e)&&"none"===b.css(e,"display")};function ae(e,t,n,r){var i,o,a=20,s=r?function(){return r.cur()}:function(){return b.css(e,t,"")},u=s(),l=n&&n[3]||(b.cssNumber[t]?"":"px"),c=e.nodeType&&(b.cssNumber[t]||"px"!==l&&+u)&&ee.exec(b.css(e,t));if(c&&c[3]!==l){for(u/=2,l=l||c[3],c=+u||1;a--;)b.style(e,t,c+l),(1-o)*(1-(o=s()/u||.5))<=0&&(a=0),c/=o;c*=2,b.style(e,t,c+l),n=n||[]}return n&&(c=+c||+u||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=l,r.start=c,r.end=i)),i}var se={};function ue(e){var t,n=e.ownerDocument,r=e.nodeName,i=se[r];return i||(t=n.body.appendChild(n.createElement(r)),i=b.css(t,"display"),t.parentNode.removeChild(t),"none"===i&&(i="block"),se[r]=i,i)}function le(e,t){for(var n,r,i=[],o=0,a=e.length;o<a;o++)(r=e[o]).style&&(n=r.style.display,t?("none"===n&&(i[o]=G.get(r,"display")||null,i[o]||(r.style.display="")),""===r.style.display&&oe(r)&&(i[o]=ue(r))):"none"!==n&&(i[o]="none",G.set(r,"display",n)));for(o=0;o<a;o++)null!=i[o]&&(e[o].style.display=i[o]);return e}b.fn.extend({show:function(){return le(this,!0)},hide:function(){return le(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){oe(this)?b(this).show():b(this).hide()})}});var ce,fe,pe=/^(?:checkbox|radio)$/i,de=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,he=/^$|^module$|\/(?:java|ecma)script/i;ce=v.createDocumentFragment().appendChild(v.createElement("div")),(fe=v.createElement("input")).setAttribute("type","radio"),fe.setAttribute("checked","checked"),fe.setAttribute("name","t"),ce.appendChild(fe),d.checkClone=ce.cloneNode(!0).cloneNode(!0).lastChild.checked,ce.innerHTML="<textarea>x</textarea>",d.noCloneChecked=!!ce.cloneNode(!0).lastChild.defaultValue,ce.innerHTML="<option></option>",d.option=!!ce.lastChild;var ge={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ve(e,t){var n;return n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&k(e,t)?b.merge([e],n):n}function ye(e,t){for(var n=0,r=e.length;n<r;n++)G.set(e[n],"globalEval",!t||G.get(t[n],"globalEval"))}ge.tbody=ge.tfoot=ge.colgroup=ge.caption=ge.thead,ge.th=ge.td,d.option||(ge.optgroup=ge.option=[1,"<select multiple='multiple'>","</select>"]);var me=/<|&#?\w+;/;function xe(e,t,n,r,i){for(var o,a,s,u,l,c,f=t.createDocumentFragment(),p=[],d=0,h=e.length;d<h;d++)if((o=e[d])||0===o)if("object"===x(o))b.merge(p,o.nodeType?[o]:o);else if(me.test(o)){for(a=a||f.appendChild(t.createElement("div")),s=(de.exec(o)||["",""])[1].toLowerCase(),u=ge[s]||ge._default,a.innerHTML=u[1]+b.htmlPrefilter(o)+u[2],c=u[0];c--;)a=a.lastChild;b.merge(p,a.childNodes),(a=f.firstChild).textContent=""}else p.push(t.createTextNode(o));for(f.textContent="",d=0;o=p[d++];)if(r&&b.inArray(o,r)>-1)i&&i.push(o);else if(l=re(o),a=ve(f.appendChild(o),"script"),l&&ye(a),n)for(c=0;o=a[c++];)he.test(o.type||"")&&n.push(o);return f}var be=/^key/,we=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Te=/^([^.]*)(?:\.(.+)|)/;function Ce(){return!0}function Ee(){return!1}function Se(e,t){return e===function(){try{return v.activeElement}catch(e){}}()==("focus"===t)}function ke(e,t,n,r,i,o){var a,s;if("object"==typeof t){for(s in"string"!=typeof n&&(r=r||n,n=void 0),t)ke(e,s,n,r,t[s],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=Ee;else if(!i)return e;return 1===o&&(a=i,(i=function(e){return b().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=b.guid++)),e.each(function(){b.event.add(this,t,i,r,n)})}function Ae(e,t,n){n?(G.set(e,t,!1),b.event.add(e,t,{namespace:!1,handler:function(e){var r,o,a=G.get(this,t);if(1&e.isTrigger&&this[t]){if(a.length)(b.event.special[t]||{}).delegateType&&e.stopPropagation();else if(a=i.call(arguments),G.set(this,t,a),r=n(this,t),this[t](),a!==(o=G.get(this,t))||r?G.set(this,t,!1):o={},a!==o)return e.stopImmediatePropagation(),e.preventDefault(),o.value}else a.length&&(G.set(this,t,{value:b.event.trigger(b.extend(a[0],b.Event.prototype),a.slice(1),this)}),e.stopImmediatePropagation())}})):void 0===G.get(e,t)&&b.event.add(e,t,Ce)}b.event={global:{},add:function(e,t,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=G.get(e);if(X(e))for(n.handler&&(n=(o=n).handler,i=o.selector),i&&b.find.matchesSelector(ne,i),n.guid||(n.guid=b.guid++),(u=v.events)||(u=v.events=Object.create(null)),(a=v.handle)||(a=v.handle=function(t){return void 0!==b&&b.event.triggered!==t.type?b.event.dispatch.apply(e,arguments):void 0}),l=(t=(t||"").match(O)||[""]).length;l--;)d=g=(s=Te.exec(t[l])||[])[1],h=(s[2]||"").split(".").sort(),d&&(f=b.event.special[d]||{},d=(i?f.delegateType:f.bindType)||d,f=b.event.special[d]||{},c=b.extend({type:d,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&b.expr.match.needsContext.test(i),namespace:h.join(".")},o),(p=u[d])||((p=u[d]=[]).delegateCount=0,f.setup&&!1!==f.setup.call(e,r,h,a)||e.addEventListener&&e.addEventListener(d,a)),f.add&&(f.add.call(e,c),c.handler.guid||(c.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,c):p.push(c),b.event.global[d]=!0)},remove:function(e,t,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=G.hasData(e)&&G.get(e);if(v&&(u=v.events)){for(l=(t=(t||"").match(O)||[""]).length;l--;)if(d=g=(s=Te.exec(t[l])||[])[1],h=(s[2]||"").split(".").sort(),d){for(f=b.event.special[d]||{},p=u[d=(r?f.delegateType:f.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=p.length;o--;)c=p[o],!i&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,f.remove&&f.remove.call(e,c));a&&!p.length&&(f.teardown&&!1!==f.teardown.call(e,h,v.handle)||b.removeEvent(e,d,v.handle),delete u[d])}else for(d in u)b.event.remove(e,d+t[l],n,r,!0);b.isEmptyObject(u)&&G.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,o,a,s=new Array(arguments.length),u=b.event.fix(e),l=(G.get(this,"events")||Object.create(null))[u.type]||[],c=b.event.special[u.type]||{};for(s[0]=u,t=1;t<arguments.length;t++)s[t]=arguments[t];if(u.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,u)){for(a=b.event.handlers.call(this,u,l),t=0;(i=a[t++])&&!u.isPropagationStopped();)for(u.currentTarget=i.elem,n=0;(o=i.handlers[n++])&&!u.isImmediatePropagationStopped();)u.rnamespace&&!1!==o.namespace&&!u.rnamespace.test(o.namespace)||(u.handleObj=o,u.data=o.data,void 0!==(r=((b.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,s))&&!1===(u.result=r)&&(u.preventDefault(),u.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,u),u.result}},handlers:function(e,t){var n,r,i,o,a,s=[],u=t.delegateCount,l=e.target;if(u&&l.nodeType&&!("click"===e.type&&e.button>=1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==e.type||!0!==l.disabled)){for(o=[],a={},n=0;n<u;n++)void 0===a[i=(r=t[n]).selector+" "]&&(a[i]=r.needsContext?b(i,this).index(l)>-1:b.find(i,this,null,[l]).length),a[i]&&o.push(r);o.length&&s.push({elem:l,handlers:o})}return l=this,u<t.length&&s.push({elem:l,handlers:t.slice(u)}),s},addProp:function(e,t){Object.defineProperty(b.Event.prototype,e,{enumerable:!0,configurable:!0,get:h(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[b.expando]?e:new b.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return pe.test(t.type)&&t.click&&k(t,"input")&&Ae(t,"click",Ce),!1},trigger:function(e){var t=this||e;return pe.test(t.type)&&t.click&&k(t,"input")&&Ae(t,"click"),!0},_default:function(e){var t=e.target;return pe.test(t.type)&&t.click&&k(t,"input")&&G.get(t,"click")||k(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},b.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},b.Event=function(e,t){if(!(this instanceof b.Event))return new b.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Ce:Ee,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&b.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[b.expando]=!0},b.Event.prototype={constructor:b.Event,isDefaultPrevented:Ee,isPropagationStopped:Ee,isImmediatePropagationStopped:Ee,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Ce,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Ce,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Ce,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},b.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(e){var t=e.button;return null==e.which&&be.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&we.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},b.event.addProp),b.each({focus:"focusin",blur:"focusout"},function(e,t){b.event.special[e]={setup:function(){return Ae(this,e,Se),!1},trigger:function(){return Ae(this,e),!0},delegateType:t}}),b.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){b.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=e.relatedTarget,i=e.handleObj;return r&&(r===this||b.contains(this,r))||(e.type=i.origType,n=i.handler.apply(this,arguments),e.type=t),n}}}),b.fn.extend({on:function(e,t,n,r){return ke(this,e,t,n,r)},one:function(e,t,n,r){return ke(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,b(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=Ee),this.each(function(){b.event.remove(this,e,n,t)})}});var Ne=/<script|<style|<link/i,De=/checked\s*(?:[^=]|=\s*.checked.)/i,je=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function qe(e,t){return k(e,"table")&&k(11!==t.nodeType?t:t.firstChild,"tr")&&b(e).children("tbody")[0]||e}function Le(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function He(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Oe(e,t){var n,r,i,o,a,s;if(1===t.nodeType){if(G.hasData(e)&&(s=G.get(e).events))for(i in G.remove(t,"handle events"),s)for(n=0,r=s[i].length;n<r;n++)b.event.add(t,i,s[i][n]);Y.hasData(e)&&(o=Y.access(e),a=b.extend({},o),Y.set(t,a))}}function Pe(e,t,n,r){t=o(t);var i,a,s,u,l,c,f=0,p=e.length,g=p-1,v=t[0],y=h(v);if(y||p>1&&"string"==typeof v&&!d.checkClone&&De.test(v))return e.each(function(i){var o=e.eq(i);y&&(t[0]=v.call(this,i,o.html())),Pe(o,t,n,r)});if(p&&(a=(i=xe(t,e[0].ownerDocument,!1,e,r)).firstChild,1===i.childNodes.length&&(i=a),a||r)){for(u=(s=b.map(ve(i,"script"),Le)).length;f<p;f++)l=i,f!==g&&(l=b.clone(l,!0,!0),u&&b.merge(s,ve(l,"script"))),n.call(e[f],l,f);if(u)for(c=s[s.length-1].ownerDocument,b.map(s,He),f=0;f<u;f++)l=s[f],he.test(l.type||"")&&!G.access(l,"globalEval")&&b.contains(c,l)&&(l.src&&"module"!==(l.type||"").toLowerCase()?b._evalUrl&&!l.noModule&&b._evalUrl(l.src,{nonce:l.nonce||l.getAttribute("nonce")},c):m(l.textContent.replace(je,""),l,c))}return e}function Re(e,t,n){for(var r,i=t?b.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||b.cleanData(ve(r)),r.parentNode&&(n&&re(r)&&ye(ve(r,"script")),r.parentNode.removeChild(r));return e}b.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var r,i,o,a,s,u,l,c=e.cloneNode(!0),f=re(e);if(!(d.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||b.isXMLDoc(e)))for(a=ve(c),r=0,i=(o=ve(e)).length;r<i;r++)s=o[r],u=a[r],l=void 0,"input"===(l=u.nodeName.toLowerCase())&&pe.test(s.type)?u.checked=s.checked:"input"!==l&&"textarea"!==l||(u.defaultValue=s.defaultValue);if(t)if(n)for(o=o||ve(e),a=a||ve(c),r=0,i=o.length;r<i;r++)Oe(o[r],a[r]);else Oe(e,c);return(a=ve(c,"script")).length>0&&ye(a,!f&&ve(e,"script")),c},cleanData:function(e){for(var t,n,r,i=b.event.special,o=0;void 0!==(n=e[o]);o++)if(X(n)){if(t=n[G.expando]){if(t.events)for(r in t.events)i[r]?b.event.remove(n,r):b.removeEvent(n,r,t.handle);n[G.expando]=void 0}n[Y.expando]&&(n[Y.expando]=void 0)}}}),b.fn.extend({detach:function(e){return Re(this,e,!0)},remove:function(e){return Re(this,e)},text:function(e){return B(this,function(e){return void 0===e?b.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return Pe(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||qe(this,e).appendChild(e)})},prepend:function(){return Pe(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=qe(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return Pe(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return Pe(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(b.cleanData(ve(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return b.clone(this,e,t)})},html:function(e){return B(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Ne.test(e)&&!ge[(de.exec(e)||["",""])[1].toLowerCase()]){e=b.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(b.cleanData(ve(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return Pe(this,arguments,function(t){var n=this.parentNode;b.inArray(this,e)<0&&(b.cleanData(ve(this)),n&&n.replaceChild(t,this))},e)}}),b.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){b.fn[e]=function(e){for(var n,r=[],i=b(e),o=i.length-1,s=0;s<=o;s++)n=s===o?this:this.clone(!0),b(i[s])[t](n),a.apply(r,n.get());return this.pushStack(r)}});var Me=new RegExp("^("+Z+")(?!px)[a-z%]+$","i"),Ie=function(t){var n=t.ownerDocument.defaultView;return n&&n.opener||(n=e),n.getComputedStyle(t)},We=function(e,t,n){var r,i,o={};for(i in t)o[i]=e.style[i],e.style[i]=t[i];for(i in r=n.call(e),t)e.style[i]=o[i];return r},Fe=new RegExp(te.join("|"),"i");function Be(e,t,n){var r,i,o,a,s=e.style;return(n=n||Ie(e))&&(""!==(a=n.getPropertyValue(t)||n[t])||re(e)||(a=b.style(e,t)),!d.pixelBoxStyles()&&Me.test(a)&&Fe.test(t)&&(r=s.width,i=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=r,s.minWidth=i,s.maxWidth=o)),void 0!==a?a+"":a}function $e(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function t(){if(c){l.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",c.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",ne.appendChild(l).appendChild(c);var t=e.getComputedStyle(c);r="1%"!==t.top,u=12===n(t.marginLeft),c.style.right="60%",a=36===n(t.right),i=36===n(t.width),c.style.position="absolute",o=12===n(c.offsetWidth/3),ne.removeChild(l),c=null}}function n(e){return Math.round(parseFloat(e))}var r,i,o,a,s,u,l=v.createElement("div"),c=v.createElement("div");c.style&&(c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",d.clearCloneStyle="content-box"===c.style.backgroundClip,b.extend(d,{boxSizingReliable:function(){return t(),i},pixelBoxStyles:function(){return t(),a},pixelPosition:function(){return t(),r},reliableMarginLeft:function(){return t(),u},scrollboxSize:function(){return t(),o},reliableTrDimensions:function(){var t,n,r,i;return null==s&&(t=v.createElement("table"),n=v.createElement("tr"),r=v.createElement("div"),t.style.cssText="position:absolute;left:-11111px",n.style.height="1px",r.style.height="9px",ne.appendChild(t).appendChild(n).appendChild(r),i=e.getComputedStyle(n),s=parseInt(i.height)>3,ne.removeChild(t)),s}}))}();var _e=["Webkit","Moz","ms"],ze=v.createElement("div").style,Ue={};function Xe(e){var t=b.cssProps[e]||Ue[e];return t||(e in ze?e:Ue[e]=function(e){for(var t=e[0].toUpperCase()+e.slice(1),n=_e.length;n--;)if((e=_e[n]+t)in ze)return e}(e)||e)}var Ve=/^(none|table(?!-c[ea]).+)/,Ge=/^--/,Ye={position:"absolute",visibility:"hidden",display:"block"},Qe={letterSpacing:"0",fontWeight:"400"};function Je(e,t,n){var r=ee.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function Ke(e,t,n,r,i,o){var a="width"===t?1:0,s=0,u=0;if(n===(r?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(u+=b.css(e,n+te[a],!0,i)),r?("content"===n&&(u-=b.css(e,"padding"+te[a],!0,i)),"margin"!==n&&(u-=b.css(e,"border"+te[a]+"Width",!0,i))):(u+=b.css(e,"padding"+te[a],!0,i),"padding"!==n?u+=b.css(e,"border"+te[a]+"Width",!0,i):s+=b.css(e,"border"+te[a]+"Width",!0,i));return!r&&o>=0&&(u+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-u-s-.5))||0),u}function Ze(e,t,n){var r=Ie(e),i=(!d.boxSizingReliable()||n)&&"border-box"===b.css(e,"boxSizing",!1,r),o=i,a=Be(e,t,r),s="offset"+t[0].toUpperCase()+t.slice(1);if(Me.test(a)){if(!n)return a;a="auto"}return(!d.boxSizingReliable()&&i||!d.reliableTrDimensions()&&k(e,"tr")||"auto"===a||!parseFloat(a)&&"inline"===b.css(e,"display",!1,r))&&e.getClientRects().length&&(i="border-box"===b.css(e,"boxSizing",!1,r),(o=s in e)&&(a=e[s])),(a=parseFloat(a)||0)+Ke(e,t,n||(i?"border":"content"),o,r,a)+"px"}function et(e,t,n,r,i){return new et.prototype.init(e,t,n,r,i)}b.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Be(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=U(t),u=Ge.test(t),l=e.style;if(u||(t=Xe(s)),a=b.cssHooks[t]||b.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(i=a.get(e,!1,r))?i:l[t];"string"===(o=typeof n)&&(i=ee.exec(n))&&i[1]&&(n=ae(e,t,i),o="number"),null!=n&&n==n&&("number"!==o||u||(n+=i&&i[3]||(b.cssNumber[s]?"":"px")),d.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,r))||(u?l.setProperty(t,n):l[t]=n))}},css:function(e,t,n,r){var i,o,a,s=U(t);return Ge.test(t)||(t=Xe(s)),(a=b.cssHooks[t]||b.cssHooks[s])&&"get"in a&&(i=a.get(e,!0,n)),void 0===i&&(i=Be(e,t,r)),"normal"===i&&t in Qe&&(i=Qe[t]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),b.each(["height","width"],function(e,t){b.cssHooks[t]={get:function(e,n,r){if(n)return!Ve.test(b.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?Ze(e,t,r):We(e,Ye,function(){return Ze(e,t,r)})},set:function(e,n,r){var i,o=Ie(e),a=!d.scrollboxSize()&&"absolute"===o.position,s=(a||r)&&"border-box"===b.css(e,"boxSizing",!1,o),u=r?Ke(e,t,r,s,o):0;return s&&a&&(u-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(o[t])-Ke(e,t,"border",!1,o)-.5)),u&&(i=ee.exec(n))&&"px"!==(i[3]||"px")&&(e.style[t]=n,n=b.css(e,t)),Je(0,n,u)}}}),b.cssHooks.marginLeft=$e(d.reliableMarginLeft,function(e,t){if(t)return(parseFloat(Be(e,"marginLeft"))||e.getBoundingClientRect().left-We(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),b.each({margin:"",padding:"",border:"Width"},function(e,t){b.cssHooks[e+t]={expand:function(n){for(var r=0,i={},o="string"==typeof n?n.split(" "):[n];r<4;r++)i[e+te[r]+t]=o[r]||o[r-2]||o[0];return i}},"margin"!==e&&(b.cssHooks[e+t].set=Je)}),b.fn.extend({css:function(e,t){return B(this,function(e,t,n){var r,i,o={},a=0;if(Array.isArray(t)){for(r=Ie(e),i=t.length;a<i;a++)o[t[a]]=b.css(e,t[a],!1,r);return o}return void 0!==n?b.style(e,t,n):b.css(e,t)},e,t,arguments.length>1)}}),b.Tween=et,et.prototype={constructor:et,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||b.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(b.cssNumber[n]?"":"px")},cur:function(){var e=et.propHooks[this.prop];return e&&e.get?e.get(this):et.propHooks._default.get(this)},run:function(e){var t,n=et.propHooks[this.prop];return this.options.duration?this.pos=t=b.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):et.propHooks._default.set(this),this}},et.prototype.init.prototype=et.prototype,et.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=b.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){b.fx.step[e.prop]?b.fx.step[e.prop](e):1!==e.elem.nodeType||!b.cssHooks[e.prop]&&null==e.elem.style[Xe(e.prop)]?e.elem[e.prop]=e.now:b.style(e.elem,e.prop,e.now+e.unit)}}},et.propHooks.scrollTop=et.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},b.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},b.fx=et.prototype.init,b.fx.step={};var tt,nt,rt=/^(?:toggle|show|hide)$/,it=/queueHooks$/;function ot(){nt&&(!1===v.hidden&&e.requestAnimationFrame?e.requestAnimationFrame(ot):e.setTimeout(ot,b.fx.interval),b.fx.tick())}function at(){return e.setTimeout(function(){tt=void 0}),tt=Date.now()}function st(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=te[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function ut(e,t,n){for(var r,i=(lt.tweeners[t]||[]).concat(lt.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,t,e))return r}function lt(e,t,n){var r,i,o=0,a=lt.prefilters.length,s=b.Deferred().always(function(){delete u.elem}),u=function(){if(i)return!1;for(var t=tt||at(),n=Math.max(0,l.startTime+l.duration-t),r=1-(n/l.duration||0),o=0,a=l.tweens.length;o<a;o++)l.tweens[o].run(r);return s.notifyWith(e,[l,r,n]),r<1&&a?n:(a||s.notifyWith(e,[l,1,0]),s.resolveWith(e,[l]),!1)},l=s.promise({elem:e,props:b.extend({},t),opts:b.extend(!0,{specialEasing:{},easing:b.easing._default},n),originalProperties:t,originalOptions:n,startTime:tt||at(),duration:n.duration,tweens:[],createTween:function(t,n){var r=b.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(r),r},stop:function(t){var n=0,r=t?l.tweens.length:0;if(i)return this;for(i=!0;n<r;n++)l.tweens[n].run(1);return t?(s.notifyWith(e,[l,1,0]),s.resolveWith(e,[l,t])):s.rejectWith(e,[l,t]),this}}),c=l.props;for(!function(e,t){var n,r,i,o,a;for(n in e)if(i=t[r=U(n)],o=e[n],Array.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(a=b.cssHooks[r])&&"expand"in a)for(n in o=a.expand(o),delete e[r],o)n in e||(e[n]=o[n],t[n]=i);else t[r]=i}(c,l.opts.specialEasing);o<a;o++)if(r=lt.prefilters[o].call(l,e,c,l.opts))return h(r.stop)&&(b._queueHooks(l.elem,l.opts.queue).stop=r.stop.bind(r)),r;return b.map(c,ut,l),h(l.opts.start)&&l.opts.start.call(e,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),b.fx.timer(b.extend(u,{elem:e,anim:l,queue:l.opts.queue})),l}b.Animation=b.extend(lt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return ae(n.elem,e,ee.exec(t),n),n}]},tweener:function(e,t){h(e)?(t=e,e=["*"]):e=e.match(O);for(var n,r=0,i=e.length;r<i;r++)n=e[r],lt.tweeners[n]=lt.tweeners[n]||[],lt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,i,o,a,s,u,l,c,f="width"in t||"height"in t,p=this,d={},h=e.style,g=e.nodeType&&oe(e),v=G.get(e,"fxshow");for(r in n.queue||(null==(a=b._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,p.always(function(){p.always(function(){a.unqueued--,b.queue(e,"fx").length||a.empty.fire()})})),t)if(i=t[r],rt.test(i)){if(delete t[r],o=o||"toggle"===i,i===(g?"hide":"show")){if("show"!==i||!v||void 0===v[r])continue;g=!0}d[r]=v&&v[r]||b.style(e,r)}if((u=!b.isEmptyObject(t))||!b.isEmptyObject(d))for(r in f&&1===e.nodeType&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],null==(l=v&&v.display)&&(l=G.get(e,"display")),"none"===(c=b.css(e,"display"))&&(l?c=l:(le([e],!0),l=e.style.display||l,c=b.css(e,"display"),le([e]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===b.css(e,"float")&&(u||(p.done(function(){h.display=l}),null==l&&(c=h.display,l="none"===c?"":c)),h.display="inline-block")),n.overflow&&(h.overflow="hidden",p.always(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]})),u=!1,d)u||(v?"hidden"in v&&(g=v.hidden):v=G.access(e,"fxshow",{display:l}),o&&(v.hidden=!g),g&&le([e],!0),p.done(function(){for(r in g||le([e]),G.remove(e,"fxshow"),d)b.style(e,r,d[r])})),u=ut(g?v[r]:0,r,p),r in v||(v[r]=u.start,g&&(u.end=u.start,u.start=0))}],prefilter:function(e,t){t?lt.prefilters.unshift(e):lt.prefilters.push(e)}}),b.speed=function(e,t,n){var r=e&&"object"==typeof e?b.extend({},e):{complete:n||!n&&t||h(e)&&e,duration:e,easing:n&&t||t&&!h(t)&&t};return b.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in b.fx.speeds?r.duration=b.fx.speeds[r.duration]:r.duration=b.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){h(r.old)&&r.old.call(this),r.queue&&b.dequeue(this,r.queue)},r},b.fn.extend({fadeTo:function(e,t,n,r){return this.filter(oe).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=b.isEmptyObject(e),o=b.speed(t,n,r),a=function(){var t=lt(this,b.extend({},e),o);(i||G.get(this,"finish"))&&t.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",o=b.timers,a=G.get(this);if(i)a[i]&&a[i].stop&&r(a[i]);else for(i in a)a[i]&&a[i].stop&&it.test(i)&&r(a[i]);for(i=o.length;i--;)o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(n),t=!1,o.splice(i,1));!t&&n||b.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,n=G.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=b.timers,a=r?r.length:0;for(n.finish=!0,b.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<a;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),b.each(["toggle","show","hide"],function(e,t){var n=b.fn[t];b.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(st(t,!0),e,r,i)}}),b.each({slideDown:st("show"),slideUp:st("hide"),slideToggle:st("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){b.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),b.timers=[],b.fx.tick=function(){var e,t=0,n=b.timers;for(tt=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||b.fx.stop(),tt=void 0},b.fx.timer=function(e){b.timers.push(e),b.fx.start()},b.fx.interval=13,b.fx.start=function(){nt||(nt=!0,ot())},b.fx.stop=function(){nt=null},b.fx.speeds={slow:600,fast:200,_default:400},b.fn.delay=function(t,n){return t=b.fx&&b.fx.speeds[t]||t,n=n||"fx",this.queue(n,function(n,r){var i=e.setTimeout(n,t);r.stop=function(){e.clearTimeout(i)}})},function(){var e=v.createElement("input"),t=v.createElement("select").appendChild(v.createElement("option"));e.type="checkbox",d.checkOn=""!==e.value,d.optSelected=t.selected,(e=v.createElement("input")).value="t",e.type="radio",d.radioValue="t"===e.value}();var ct,ft=b.expr.attrHandle;b.fn.extend({attr:function(e,t){return B(this,b.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){b.removeAttr(this,e)})}}),b.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===e.getAttribute?b.prop(e,t,n):(1===o&&b.isXMLDoc(e)||(i=b.attrHooks[t.toLowerCase()]||(b.expr.match.bool.test(t)?ct:void 0)),void 0!==n?null===n?void b.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=b.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!d.radioValue&&"radio"===t&&k(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(O);if(i&&1===e.nodeType)for(;n=i[r++];)e.removeAttribute(n)}}),ct={set:function(e,t,n){return!1===t?b.removeAttr(e,n):e.setAttribute(n,n),n}},b.each(b.expr.match.bool.source.match(/\w+/g),function(e,t){var n=ft[t]||b.find.attr;ft[t]=function(e,t,r){var i,o,a=t.toLowerCase();return r||(o=ft[a],ft[a]=i,i=null!=n(e,t,r)?a:null,ft[a]=o),i}});var pt=/^(?:input|select|textarea|button)$/i,dt=/^(?:a|area)$/i;function ht(e){return(e.match(O)||[]).join(" ")}function gt(e){return e.getAttribute&&e.getAttribute("class")||""}function vt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(O)||[]}b.fn.extend({prop:function(e,t){return B(this,b.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[b.propFix[e]||e]})}}),b.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&b.isXMLDoc(e)||(t=b.propFix[t]||t,i=b.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=b.find.attr(e,"tabindex");return t?parseInt(t,10):pt.test(e.nodeName)||dt.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),d.optSelected||(b.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),b.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){b.propFix[this.toLowerCase()]=this}),b.fn.extend({addClass:function(e){var t,n,r,i,o,a,s,u=0;if(h(e))return this.each(function(t){b(this).addClass(e.call(this,t,gt(this)))});if((t=vt(e)).length)for(;n=this[u++];)if(i=gt(n),r=1===n.nodeType&&" "+ht(i)+" "){for(a=0;o=t[a++];)r.indexOf(" "+o+" ")<0&&(r+=o+" ");i!==(s=ht(r))&&n.setAttribute("class",s)}return this},removeClass:function(e){var t,n,r,i,o,a,s,u=0;if(h(e))return this.each(function(t){b(this).removeClass(e.call(this,t,gt(this)))});if(!arguments.length)return this.attr("class","");if((t=vt(e)).length)for(;n=this[u++];)if(i=gt(n),r=1===n.nodeType&&" "+ht(i)+" "){for(a=0;o=t[a++];)for(;r.indexOf(" "+o+" ")>-1;)r=r.replace(" "+o+" "," ");i!==(s=ht(r))&&n.setAttribute("class",s)}return this},toggleClass:function(e,t){var n=typeof e,r="string"===n||Array.isArray(e);return"boolean"==typeof t&&r?t?this.addClass(e):this.removeClass(e):h(e)?this.each(function(n){b(this).toggleClass(e.call(this,n,gt(this),t),t)}):this.each(function(){var t,i,o,a;if(r)for(i=0,o=b(this),a=vt(e);t=a[i++];)o.hasClass(t)?o.removeClass(t):o.addClass(t);else void 0!==e&&"boolean"!==n||((t=gt(this))&&G.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===e?"":G.get(this,"__className__")||""))})},hasClass:function(e){var t,n,r=0;for(t=" "+e+" ";n=this[r++];)if(1===n.nodeType&&(" "+ht(gt(n))+" ").indexOf(t)>-1)return!0;return!1}});var yt=/\r/g;b.fn.extend({val:function(e){var t,n,r,i=this[0];return arguments.length?(r=h(e),this.each(function(n){var i;1===this.nodeType&&(null==(i=r?e.call(this,n,b(this).val()):e)?i="":"number"==typeof i?i+="":Array.isArray(i)&&(i=b.map(i,function(e){return null==e?"":e+""})),(t=b.valHooks[this.type]||b.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,i,"value")||(this.value=i))})):i?(t=b.valHooks[i.type]||b.valHooks[i.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(i,"value"))?n:"string"==typeof(n=i.value)?n.replace(yt,""):null==n?"":n:void 0}}),b.extend({valHooks:{option:{get:function(e){var t=b.find.attr(e,"value");return null!=t?t:ht(b.text(e))}},select:{get:function(e){var t,n,r,i=e.options,o=e.selectedIndex,a="select-one"===e.type,s=a?null:[],u=a?o+1:i.length;for(r=o<0?u:a?o:0;r<u;r++)if(((n=i[r]).selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!k(n.parentNode,"optgroup"))){if(t=b(n).val(),a)return t;s.push(t)}return s},set:function(e,t){for(var n,r,i=e.options,o=b.makeArray(t),a=i.length;a--;)((r=i[a]).selected=b.inArray(b.valHooks.option.get(r),o)>-1)&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),b.each(["radio","checkbox"],function(){b.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=b.inArray(b(e).val(),t)>-1}},d.checkOn||(b.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),d.focusin="onfocusin"in e;var mt=/^(?:focusinfocus|focusoutblur)$/,xt=function(e){e.stopPropagation()};b.extend(b.event,{trigger:function(t,n,r,i){var o,a,s,u,l,f,p,d,y=[r||v],m=c.call(t,"type")?t.type:t,x=c.call(t,"namespace")?t.namespace.split("."):[];if(a=d=s=r=r||v,3!==r.nodeType&&8!==r.nodeType&&!mt.test(m+b.event.triggered)&&(m.indexOf(".")>-1&&(x=m.split("."),m=x.shift(),x.sort()),l=m.indexOf(":")<0&&"on"+m,(t=t[b.expando]?t:new b.Event(m,"object"==typeof t&&t)).isTrigger=i?2:3,t.namespace=x.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+x.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=r),n=null==n?[t]:b.makeArray(n,[t]),p=b.event.special[m]||{},i||!p.trigger||!1!==p.trigger.apply(r,n))){if(!i&&!p.noBubble&&!g(r)){for(u=p.delegateType||m,mt.test(u+m)||(a=a.parentNode);a;a=a.parentNode)y.push(a),s=a;s===(r.ownerDocument||v)&&y.push(s.defaultView||s.parentWindow||e)}for(o=0;(a=y[o++])&&!t.isPropagationStopped();)d=a,t.type=o>1?u:p.bindType||m,(f=(G.get(a,"events")||Object.create(null))[t.type]&&G.get(a,"handle"))&&f.apply(a,n),(f=l&&a[l])&&f.apply&&X(a)&&(t.result=f.apply(a,n),!1===t.result&&t.preventDefault());return t.type=m,i||t.isDefaultPrevented()||p._default&&!1!==p._default.apply(y.pop(),n)||!X(r)||l&&h(r[m])&&!g(r)&&((s=r[l])&&(r[l]=null),b.event.triggered=m,t.isPropagationStopped()&&d.addEventListener(m,xt),r[m](),t.isPropagationStopped()&&d.removeEventListener(m,xt),b.event.triggered=void 0,s&&(r[l]=s)),t.result}},simulate:function(e,t,n){var r=b.extend(new b.Event,n,{type:e,isSimulated:!0});b.event.trigger(r,null,t)}}),b.fn.extend({trigger:function(e,t){return this.each(function(){b.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return b.event.trigger(e,t,n,!0)}}),d.focusin||b.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){b.event.simulate(t,e.target,b.event.fix(e))};b.event.special[t]={setup:function(){var r=this.ownerDocument||this.document||this,i=G.access(r,t);i||r.addEventListener(e,n,!0),G.access(r,t,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this.document||this,i=G.access(r,t)-1;i?G.access(r,t,i):(r.removeEventListener(e,n,!0),G.remove(r,t))}}});var bt=e.location,wt={guid:Date.now()},Tt=/\?/;b.parseXML=function(t){var n;if(!t||"string"!=typeof t)return null;try{n=(new e.DOMParser).parseFromString(t,"text/xml")}catch(e){n=void 0}return n&&!n.getElementsByTagName("parsererror").length||b.error("Invalid XML: "+t),n};var Ct=/\[\]$/,Et=/\r?\n/g,St=/^(?:submit|button|image|reset|file)$/i,kt=/^(?:input|select|textarea|keygen)/i;function At(e,t,n,r){var i;if(Array.isArray(t))b.each(t,function(t,i){n||Ct.test(e)?r(e,i):At(e+"["+("object"==typeof i&&null!=i?t:"")+"]",i,n,r)});else if(n||"object"!==x(t))r(e,t);else for(i in t)At(e+"["+i+"]",t[i],n,r)}b.param=function(e,t){var n,r=[],i=function(e,t){var n=h(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!b.isPlainObject(e))b.each(e,function(){i(this.name,this.value)});else for(n in e)At(n,e[n],t,i);return r.join("&")},b.fn.extend({serialize:function(){return b.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=b.prop(this,"elements");return e?b.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!b(this).is(":disabled")&&kt.test(this.nodeName)&&!St.test(e)&&(this.checked||!pe.test(e))}).map(function(e,t){var n=b(this).val();return null==n?null:Array.isArray(n)?b.map(n,function(e){return{name:t.name,value:e.replace(Et,"\r\n")}}):{name:t.name,value:n.replace(Et,"\r\n")}}).get()}});var Nt=/%20/g,Dt=/#.*$/,jt=/([?&])_=[^&]*/,qt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Lt=/^(?:GET|HEAD)$/,Ht=/^\/\//,Ot={},Pt={},Rt="*/".concat("*"),Mt=v.createElement("a");function It(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(O)||[];if(h(n))for(;r=o[i++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function Wt(e,t,n,r){var i={},o=e===Pt;function a(s){var u;return i[s]=!0,b.each(e[s]||[],function(e,s){var l=s(t,n,r);return"string"!=typeof l||o||i[l]?o?!(u=l):void 0:(t.dataTypes.unshift(l),a(l),!1)}),u}return a(t.dataTypes[0])||!i["*"]&&a("*")}function Ft(e,t){var n,r,i=b.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&b.extend(!0,e,r),e}Mt.href=bt.href,b.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:bt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(bt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Rt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":b.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Ft(Ft(e,b.ajaxSettings),t):Ft(b.ajaxSettings,e)},ajaxPrefilter:It(Ot),ajaxTransport:It(Pt),ajax:function(t,n){"object"==typeof t&&(n=t,t=void 0),n=n||{};var r,i,o,a,s,u,l,c,f,p,d=b.ajaxSetup({},n),h=d.context||d,g=d.context&&(h.nodeType||h.jquery)?b(h):b.event,y=b.Deferred(),m=b.Callbacks("once memory"),x=d.statusCode||{},w={},T={},C="canceled",E={readyState:0,getResponseHeader:function(e){var t;if(l){if(!a)for(a={};t=qt.exec(o);)a[t[1].toLowerCase()+" "]=(a[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=a[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return l?o:null},setRequestHeader:function(e,t){return null==l&&(e=T[e.toLowerCase()]=T[e.toLowerCase()]||e,w[e]=t),this},overrideMimeType:function(e){return null==l&&(d.mimeType=e),this},statusCode:function(e){var t;if(e)if(l)E.always(e[E.status]);else for(t in e)x[t]=[x[t],e[t]];return this},abort:function(e){var t=e||C;return r&&r.abort(t),S(0,t),this}};if(y.promise(E),d.url=((t||d.url||bt.href)+"").replace(Ht,bt.protocol+"//"),d.type=n.method||n.type||d.method||d.type,d.dataTypes=(d.dataType||"*").toLowerCase().match(O)||[""],null==d.crossDomain){u=v.createElement("a");try{u.href=d.url,u.href=u.href,d.crossDomain=Mt.protocol+"//"+Mt.host!=u.protocol+"//"+u.host}catch(e){d.crossDomain=!0}}if(d.data&&d.processData&&"string"!=typeof d.data&&(d.data=b.param(d.data,d.traditional)),Wt(Ot,d,n,E),l)return E;for(f in(c=b.event&&d.global)&&0==b.active++&&b.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!Lt.test(d.type),i=d.url.replace(Dt,""),d.hasContent?d.data&&d.processData&&0===(d.contentType||"").indexOf("application/x-www-form-urlencoded")&&(d.data=d.data.replace(Nt,"+")):(p=d.url.slice(i.length),d.data&&(d.processData||"string"==typeof d.data)&&(i+=(Tt.test(i)?"&":"?")+d.data,delete d.data),!1===d.cache&&(i=i.replace(jt,"$1"),p=(Tt.test(i)?"&":"?")+"_="+wt.guid+++p),d.url=i+p),d.ifModified&&(b.lastModified[i]&&E.setRequestHeader("If-Modified-Since",b.lastModified[i]),b.etag[i]&&E.setRequestHeader("If-None-Match",b.etag[i])),(d.data&&d.hasContent&&!1!==d.contentType||n.contentType)&&E.setRequestHeader("Content-Type",d.contentType),E.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+Rt+"; q=0.01":""):d.accepts["*"]),d.headers)E.setRequestHeader(f,d.headers[f]);if(d.beforeSend&&(!1===d.beforeSend.call(h,E,d)||l))return E.abort();if(C="abort",m.add(d.complete),E.done(d.success),E.fail(d.error),r=Wt(Pt,d,n,E)){if(E.readyState=1,c&&g.trigger("ajaxSend",[E,d]),l)return E;d.async&&d.timeout>0&&(s=e.setTimeout(function(){E.abort("timeout")},d.timeout));try{l=!1,r.send(w,S)}catch(e){if(l)throw e;S(-1,e)}}else S(-1,"No Transport");function S(t,n,a,u){var f,p,v,w,T,C=n;l||(l=!0,s&&e.clearTimeout(s),r=void 0,o=u||"",E.readyState=t>0?4:0,f=t>=200&&t<300||304===t,a&&(w=function(e,t,n){for(var r,i,o,a,s=e.contents,u=e.dataTypes;"*"===u[0];)u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==u[0]&&u.unshift(o),n[o]}(d,E,a)),!f&&b.inArray("script",d.dataTypes)>-1&&(d.converters["text script"]=function(){}),w=function(e,t,n,r){var i,o,a,s,u,l={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)l[a.toLowerCase()]=e.converters[a];for(o=c.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(a=l[u+" "+o]||l["* "+o]))for(i in l)if((s=i.split(" "))[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){!0===a?a=l[i]:!0!==l[i]&&(o=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&e.throws)t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}(d,w,E,f),f?(d.ifModified&&((T=E.getResponseHeader("Last-Modified"))&&(b.lastModified[i]=T),(T=E.getResponseHeader("etag"))&&(b.etag[i]=T)),204===t||"HEAD"===d.type?C="nocontent":304===t?C="notmodified":(C=w.state,p=w.data,f=!(v=w.error))):(v=C,!t&&C||(C="error",t<0&&(t=0))),E.status=t,E.statusText=(n||C)+"",f?y.resolveWith(h,[p,C,E]):y.rejectWith(h,[E,C,v]),E.statusCode(x),x=void 0,c&&g.trigger(f?"ajaxSuccess":"ajaxError",[E,d,f?p:v]),m.fireWith(h,[E,C]),c&&(g.trigger("ajaxComplete",[E,d]),--b.active||b.event.trigger("ajaxStop")))}return E},getJSON:function(e,t,n){return b.get(e,t,n,"json")},getScript:function(e,t){return b.get(e,void 0,t,"script")}}),b.each(["get","post"],function(e,t){b[t]=function(e,n,r,i){return h(n)&&(i=i||r,r=n,n=void 0),b.ajax(b.extend({url:e,type:t,dataType:i,data:n,success:r},b.isPlainObject(e)&&e))}}),b.ajaxPrefilter(function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")}),b._evalUrl=function(e,t,n){return b.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){b.globalEval(e,t,n)}})},b.fn.extend({wrapAll:function(e){var t;return this[0]&&(h(e)&&(e=e.call(this[0])),t=b(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(e){return h(e)?this.each(function(t){b(this).wrapInner(e.call(this,t))}):this.each(function(){var t=b(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=h(e);return this.each(function(n){b(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(e){return this.parent(e).not("body").each(function(){b(this).replaceWith(this.childNodes)}),this}}),b.expr.pseudos.hidden=function(e){return!b.expr.pseudos.visible(e)},b.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},b.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(e){}};var Bt={0:200,1223:204},$t=b.ajaxSettings.xhr();d.cors=!!$t&&"withCredentials"in $t,d.ajax=$t=!!$t,b.ajaxTransport(function(t){var n,r;if(d.cors||$t&&!t.crossDomain)return{send:function(i,o){var a,s=t.xhr();if(s.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(a in t.xhrFields)s[a]=t.xhrFields[a];for(a in t.mimeType&&s.overrideMimeType&&s.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest"),i)s.setRequestHeader(a,i[a]);n=function(e){return function(){n&&(n=r=s.onload=s.onerror=s.onabort=s.ontimeout=s.onreadystatechange=null,"abort"===e?s.abort():"error"===e?"number"!=typeof s.status?o(0,"error"):o(s.status,s.statusText):o(Bt[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=n(),r=s.onerror=s.ontimeout=n("error"),void 0!==s.onabort?s.onabort=r:s.onreadystatechange=function(){4===s.readyState&&e.setTimeout(function(){n&&r()})},n=n("abort");try{s.send(t.hasContent&&t.data||null)}catch(e){if(n)throw e}},abort:function(){n&&n()}}}),b.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),b.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return b.globalEval(e),e}}}),b.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),b.ajaxTransport("script",function(e){var t,n;if(e.crossDomain||e.scriptAttrs)return{send:function(r,i){t=b("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i("error"===e.type?404:200,e.type)}),v.head.appendChild(t[0])},abort:function(){n&&n()}}});var _t,zt=[],Ut=/(=)\?(?=&|$)|\?\?/;b.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=zt.pop()||b.expando+"_"+wt.guid++;return this[e]=!0,e}}),b.ajaxPrefilter("json jsonp",function(t,n,r){var i,o,a,s=!1!==t.jsonp&&(Ut.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ut.test(t.data)&&"data");if(s||"jsonp"===t.dataTypes[0])return i=t.jsonpCallback=h(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(Ut,"$1"+i):!1!==t.jsonp&&(t.url+=(Tt.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return a||b.error(i+" was not called"),a[0]},t.dataTypes[0]="json",o=e[i],e[i]=function(){a=arguments},r.always(function(){void 0===o?b(e).removeProp(i):e[i]=o,t[i]&&(t.jsonpCallback=n.jsonpCallback,zt.push(i)),a&&h(o)&&o(a[0]),a=o=void 0}),"script"}),d.createHTMLDocument=((_t=v.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===_t.childNodes.length),b.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(d.createHTMLDocument?((r=(t=v.implementation.createHTMLDocument("")).createElement("base")).href=v.location.href,t.head.appendChild(r)):t=v),o=!n&&[],(i=A.exec(e))?[t.createElement(i[1])]:(i=xe([e],t,o),o&&o.length&&b(o).remove(),b.merge([],i.childNodes)));var r,i,o},b.fn.load=function(e,t,n){var r,i,o,a=this,s=e.indexOf(" ");return s>-1&&(r=ht(e.slice(s)),e=e.slice(0,s)),h(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),a.length>0&&b.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,a.html(r?b("<div>").append(b.parseHTML(e)).find(r):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},b.expr.pseudos.animated=function(e){return b.grep(b.timers,function(t){return e===t.elem}).length},b.offset={setOffset:function(e,t,n){var r,i,o,a,s,u,l=b.css(e,"position"),c=b(e),f={};"static"===l&&(e.style.position="relative"),s=c.offset(),o=b.css(e,"top"),u=b.css(e,"left"),("absolute"===l||"fixed"===l)&&(o+u).indexOf("auto")>-1?(a=(r=c.position()).top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(u)||0),h(t)&&(t=t.call(e,n,b.extend({},s))),null!=t.top&&(f.top=t.top-s.top+a),null!=t.left&&(f.left=t.left-s.left+i),"using"in t?t.using.call(e,f):("number"==typeof f.top&&(f.top+="px"),"number"==typeof f.left&&(f.left+="px"),c.css(f))}},b.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){b.offset.setOffset(this,e,t)});var t,n,r=this[0];return r?r.getClientRects().length?(t=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:t.top+n.pageYOffset,left:t.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===b.css(r,"position"))t=r.getBoundingClientRect();else{for(t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;e&&(e===n.body||e===n.documentElement)&&"static"===b.css(e,"position");)e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=b(e).offset()).top+=b.css(e,"borderTopWidth",!0),i.left+=b.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-b.css(r,"marginTop",!0),left:t.left-i.left-b.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===b.css(e,"position");)e=e.offsetParent;return e||ne})}}),b.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n="pageYOffset"===t;b.fn[e]=function(r){return B(this,function(e,r,i){var o;if(g(e)?o=e:9===e.nodeType&&(o=e.defaultView),void 0===i)return o?o[t]:e[r];o?o.scrollTo(n?o.pageXOffset:i,n?i:o.pageYOffset):e[r]=i},e,r,arguments.length)}}),b.each(["top","left"],function(e,t){b.cssHooks[t]=$e(d.pixelPosition,function(e,n){if(n)return n=Be(e,t),Me.test(n)?b(e).position()[t]+"px":n})}),b.each({Height:"height",Width:"width"},function(e,t){b.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){b.fn[r]=function(i,o){var a=arguments.length&&(n||"boolean"!=typeof i),s=n||(!0===i||!0===o?"margin":"border");return B(this,function(t,n,i){var o;return g(t)?0===r.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(o=t.documentElement,Math.max(t.body["scroll"+e],o["scroll"+e],t.body["offset"+e],o["offset"+e],o["client"+e])):void 0===i?b.css(t,n,s):b.style(t,n,i,s)},t,a?i:void 0,a)}})}),b.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){b.fn[t]=function(e){return this.on(t,e)}}),b.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),b.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,t){b.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}});var Xt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;b.proxy=function(e,t){var n,r,o;if("string"==typeof t&&(n=e[t],t=e,e=n),h(e))return r=i.call(arguments,2),(o=function(){return e.apply(t||this,r.concat(i.call(arguments)))}).guid=e.guid=e.guid||b.guid++,o},b.holdReady=function(e){e?b.readyWait++:b.ready(!0)},b.isArray=Array.isArray,b.parseJSON=JSON.parse,b.nodeName=k,b.isFunction=h,b.isWindow=g,b.camelCase=U,b.type=x,b.now=Date.now,b.isNumeric=function(e){var t=b.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},b.trim=function(e){return null==e?"":(e+"").replace(Xt,"")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return b});var Vt=e.jQuery,Gt=e.$;return b.noConflict=function(t){return e.$===b&&(e.$=Gt),t&&e.jQuery===b&&(e.jQuery=Vt),b},void 0===t&&(e.jQuery=e.$=b),b});

},{}],312:[function(require,module,exports){
var LZString=function(){var o=String.fromCharCode,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",e={};function t(o,r){if(!e[o]){e[o]={};for(var n=0;n<o.length;n++)e[o][o.charAt(n)]=n}return e[o][r]}var i={compressToBase64:function(o){if(null==o)return"";var n=i._compress(o,6,function(o){return r.charAt(o)});switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(o){return null==o?"":""==o?null:i._decompress(o.length,32,function(n){return t(r,o.charAt(n))})},compressToUTF16:function(r){return null==r?"":i._compress(r,15,function(r){return o(r+32)})+" "},decompressFromUTF16:function(o){return null==o?"":""==o?null:i._decompress(o.length,16384,function(r){return o.charCodeAt(r)-32})},compressToUint8Array:function(o){for(var r=i.compress(o),n=new Uint8Array(2*r.length),e=0,t=r.length;e<t;e++){var s=r.charCodeAt(e);n[2*e]=s>>>8,n[2*e+1]=s%256}return n},decompressFromUint8Array:function(r){if(null==r)return i.decompress(r);for(var n=new Array(r.length/2),e=0,t=n.length;e<t;e++)n[e]=256*r[2*e]+r[2*e+1];var s=[];return n.forEach(function(r){s.push(o(r))}),i.decompress(s.join(""))},compressToEncodedURIComponent:function(o){return null==o?"":i._compress(o,6,function(o){return n.charAt(o)})},decompressFromEncodedURIComponent:function(o){return null==o?"":""==o?null:(o=o.replace(/ /g,"+"),i._decompress(o.length,32,function(r){return t(n,o.charAt(r))}))},compress:function(r){return i._compress(r,16,function(r){return o(r)})},_compress:function(o,r,n){if(null==o)return"";var e,t,i,s={},p={},u="",c="",a="",l=2,f=3,h=2,d=[],m=0,v=0;for(i=0;i<o.length;i+=1)if(u=o.charAt(i),Object.prototype.hasOwnProperty.call(s,u)||(s[u]=f++,p[u]=!0),c=a+u,Object.prototype.hasOwnProperty.call(s,c))a=c;else{if(Object.prototype.hasOwnProperty.call(p,a)){if(a.charCodeAt(0)<256){for(e=0;e<h;e++)m<<=1,v==r-1?(v=0,d.push(n(m)),m=0):v++;for(t=a.charCodeAt(0),e=0;e<8;e++)m=m<<1|1&t,v==r-1?(v=0,d.push(n(m)),m=0):v++,t>>=1}else{for(t=1,e=0;e<h;e++)m=m<<1|t,v==r-1?(v=0,d.push(n(m)),m=0):v++,t=0;for(t=a.charCodeAt(0),e=0;e<16;e++)m=m<<1|1&t,v==r-1?(v=0,d.push(n(m)),m=0):v++,t>>=1}0==--l&&(l=Math.pow(2,h),h++),delete p[a]}else for(t=s[a],e=0;e<h;e++)m=m<<1|1&t,v==r-1?(v=0,d.push(n(m)),m=0):v++,t>>=1;0==--l&&(l=Math.pow(2,h),h++),s[c]=f++,a=String(u)}if(""!==a){if(Object.prototype.hasOwnProperty.call(p,a)){if(a.charCodeAt(0)<256){for(e=0;e<h;e++)m<<=1,v==r-1?(v=0,d.push(n(m)),m=0):v++;for(t=a.charCodeAt(0),e=0;e<8;e++)m=m<<1|1&t,v==r-1?(v=0,d.push(n(m)),m=0):v++,t>>=1}else{for(t=1,e=0;e<h;e++)m=m<<1|t,v==r-1?(v=0,d.push(n(m)),m=0):v++,t=0;for(t=a.charCodeAt(0),e=0;e<16;e++)m=m<<1|1&t,v==r-1?(v=0,d.push(n(m)),m=0):v++,t>>=1}0==--l&&(l=Math.pow(2,h),h++),delete p[a]}else for(t=s[a],e=0;e<h;e++)m=m<<1|1&t,v==r-1?(v=0,d.push(n(m)),m=0):v++,t>>=1;0==--l&&(l=Math.pow(2,h),h++)}for(t=2,e=0;e<h;e++)m=m<<1|1&t,v==r-1?(v=0,d.push(n(m)),m=0):v++,t>>=1;for(;;){if(m<<=1,v==r-1){d.push(n(m));break}v++}return d.join("")},decompress:function(o){return null==o?"":""==o?null:i._decompress(o.length,32768,function(r){return o.charCodeAt(r)})},_decompress:function(r,n,e){var t,i,s,p,u,c,a,l=[],f=4,h=4,d=3,m="",v=[],w={val:e(0),position:n,index:1};for(t=0;t<3;t+=1)l[t]=t;for(s=0,u=Math.pow(2,2),c=1;c!=u;)p=w.val&w.position,w.position>>=1,0==w.position&&(w.position=n,w.val=e(w.index++)),s|=(p>0?1:0)*c,c<<=1;switch(s){case 0:for(s=0,u=Math.pow(2,8),c=1;c!=u;)p=w.val&w.position,w.position>>=1,0==w.position&&(w.position=n,w.val=e(w.index++)),s|=(p>0?1:0)*c,c<<=1;a=o(s);break;case 1:for(s=0,u=Math.pow(2,16),c=1;c!=u;)p=w.val&w.position,w.position>>=1,0==w.position&&(w.position=n,w.val=e(w.index++)),s|=(p>0?1:0)*c,c<<=1;a=o(s);break;case 2:return""}for(l[3]=a,i=a,v.push(a);;){if(w.index>r)return"";for(s=0,u=Math.pow(2,d),c=1;c!=u;)p=w.val&w.position,w.position>>=1,0==w.position&&(w.position=n,w.val=e(w.index++)),s|=(p>0?1:0)*c,c<<=1;switch(a=s){case 0:for(s=0,u=Math.pow(2,8),c=1;c!=u;)p=w.val&w.position,w.position>>=1,0==w.position&&(w.position=n,w.val=e(w.index++)),s|=(p>0?1:0)*c,c<<=1;l[h++]=o(s),a=h-1,f--;break;case 1:for(s=0,u=Math.pow(2,16),c=1;c!=u;)p=w.val&w.position,w.position>>=1,0==w.position&&(w.position=n,w.val=e(w.index++)),s|=(p>0?1:0)*c,c<<=1;l[h++]=o(s),a=h-1,f--;break;case 2:return v.join("")}if(0==f&&(f=Math.pow(2,d),d++),l[a])m=l[a];else{if(a!==h)return null;m=i+i.charAt(0)}v.push(m),l[h++]=i+m.charAt(0),i=m,0==--f&&(f=Math.pow(2,d),d++)}}};return i}();"function"==typeof define&&define.amd?define(function(){return LZString}):"undefined"!=typeof module&&null!=module&&(module.exports=LZString);

},{}],313:[function(require,module,exports){
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).marked=t()}(this,function(){"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function n(e,n){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=e[Symbol.iterator]()).next.bind(r)}var r,i=(function(e){function t(){return{baseUrl:null,breaks:!1,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}e.exports={defaults:{baseUrl:null,breaks:!1,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1},getDefaults:t,changeDefaults:function(t){e.exports.defaults=t}}}(r={exports:{}},r.exports),r.exports),s=(i.defaults,i.getDefaults,i.changeDefaults,/[&<>"']/),l=/[&<>"']/g,a=/[<>"']|&(?!#?\w+;)/,o=/[<>"']|&(?!#?\w+;)/g,c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},u=function(e){return c[e]};var p=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function h(e){return e.replace(p,function(e,t){return"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""})}var g=/(^|[^\[])\^/g;var f=/[^\w:]/g,d=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;var k={},b=/^[^:]+:\/*[^/]*$/,m=/^([^:]+:)[\s\S]*$/,x=/^([^:]+:\/*[^/]*)[\s\S]*$/;function v(e,t){k[" "+e]||(b.test(e)?k[" "+e]=e+"/":k[" "+e]=w(e,"/",!0));var n=-1===(e=k[" "+e]).indexOf(":");return"//"===t.substring(0,2)?n?t:e.replace(m,"$1")+t:"/"===t.charAt(0)?n?t:e.replace(x,"$1")+t:e+t}function w(e,t,n){var r=e.length;if(0===r)return"";for(var i=0;i<r;){var s=e.charAt(r-i-1);if(s!==t||n){if(s===t||!n)break;i++}else i++}return e.substr(0,r-i)}var _=function(e,t){if(t){if(s.test(e))return e.replace(l,u)}else if(a.test(e))return e.replace(o,u);return e},y=h,z=function(e,t){e=e.source||e,t=t||"";var n={replace:function(t,r){return r=(r=r.source||r).replace(g,"$1"),e=e.replace(t,r),n},getRegex:function(){return new RegExp(e,t)}};return n},S=function(e,t,n){if(e){var r;try{r=decodeURIComponent(h(n)).replace(f,"").toLowerCase()}catch(e){return null}if(0===r.indexOf("javascript:")||0===r.indexOf("vbscript:")||0===r.indexOf("data:"))return null}t&&!d.test(n)&&(n=v(t,n));try{n=encodeURI(n).replace(/%25/g,"%")}catch(e){return null}return n},$={exec:function(){}},A=function(e){for(var t,n,r=1;r<arguments.length;r++)for(n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},R=function(e,t){var n=e.replace(/\|/g,function(e,t,n){for(var r=!1,i=t;--i>=0&&"\\"===n[i];)r=!r;return r?"|":" |"}).split(/ \|/),r=0;if(n.length>t)n.splice(t);else for(;n.length<t;)n.push("");for(;r<n.length;r++)n[r]=n[r].trim().replace(/\\\|/g,"|");return n},T=w,I=function(e,t){if(-1===e.indexOf(t[1]))return-1;for(var n=e.length,r=0,i=0;i<n;i++)if("\\"===e[i])i++;else if(e[i]===t[0])r++;else if(e[i]===t[1]&&--r<0)return i;return-1},Z=function(e){e&&e.sanitize&&!e.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")},q=i.defaults,O=T,U=R,C=_,j=I;function E(e,t,n){var r=t.href,i=t.title?C(t.title):null,s=e[1].replace(/\\([\[\]])/g,"$1");return"!"!==e[0].charAt(0)?{type:"link",raw:n,href:r,title:i,text:s}:{type:"image",raw:n,href:r,title:i,text:C(s)}}var P=function(){function e(e){this.options=e||q}var t=e.prototype;return t.space=function(e){var t=this.rules.block.newline.exec(e);if(t)return t[0].length>1?{type:"space",raw:t[0]}:{raw:"\n"}},t.code=function(e,t){var n=this.rules.block.code.exec(e);if(n){var r=t[t.length-1];if(r&&"paragraph"===r.type)return{raw:n[0],text:n[0].trimRight()};var i=n[0].replace(/^ {4}/gm,"");return{type:"code",raw:n[0],codeBlockStyle:"indented",text:this.options.pedantic?i:O(i,"\n")}}},t.fences=function(e){var t=this.rules.block.fences.exec(e);if(t){var n=t[0],r=function(e,t){var n=e.match(/^(\s+)(?:```)/);if(null===n)return t;var r=n[1];return t.split("\n").map(function(e){var t=e.match(/^\s+/);return null===t?e:t[0].length>=r.length?e.slice(r.length):e}).join("\n")}(n,t[3]||"");return{type:"code",raw:n,lang:t[2]?t[2].trim():t[2],text:r}}},t.heading=function(e){var t=this.rules.block.heading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[1].length,text:t[2]}},t.nptable=function(e){var t=this.rules.block.nptable.exec(e);if(t){var n={type:"table",header:U(t[1].replace(/^ *| *\| *$/g,"")),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:t[3]?t[3].replace(/\n$/,"").split("\n"):[],raw:t[0]};if(n.header.length===n.align.length){var r,i=n.align.length;for(r=0;r<i;r++)/^ *-+: *$/.test(n.align[r])?n.align[r]="right":/^ *:-+: *$/.test(n.align[r])?n.align[r]="center":/^ *:-+ *$/.test(n.align[r])?n.align[r]="left":n.align[r]=null;for(i=n.cells.length,r=0;r<i;r++)n.cells[r]=U(n.cells[r],n.header.length);return n}}},t.hr=function(e){var t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}},t.blockquote=function(e){var t=this.rules.block.blockquote.exec(e);if(t){var n=t[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:t[0],text:n}}},t.list=function(e){var t=this.rules.block.list.exec(e);if(t){for(var n,r,i,s,l,a,o,c=t[0],u=t[2],p=u.length>1,h=")"===u[u.length-1],g={type:"list",raw:c,ordered:p,start:p?+u.slice(0,-1):"",loose:!1,items:[]},f=t[0].match(this.rules.block.item),d=!1,k=f.length,b=0;b<k;b++)c=n=f[b],r=n.length,~(n=n.replace(/^ *([*+-]|\d+[.)]) */,"")).indexOf("\n ")&&(r-=n.length,n=this.options.pedantic?n.replace(/^ {1,4}/gm,""):n.replace(new RegExp("^ {1,"+r+"}","gm"),"")),b!==k-1&&(i=this.rules.block.bullet.exec(f[b+1])[0],(p?1===i.length||!h&&")"===i[i.length-1]:i.length>1||this.options.smartLists&&i!==u)&&(s=f.slice(b+1).join("\n"),g.raw=g.raw.substring(0,g.raw.length-s.length),b=k-1)),l=d||/\n\n(?!\s*$)/.test(n),b!==k-1&&(d="\n"===n.charAt(n.length-1),l||(l=d)),l&&(g.loose=!0),o=void 0,(a=/^\[[ xX]\] /.test(n))&&(o=" "!==n[1],n=n.replace(/^\[[ xX]\] +/,"")),g.items.push({type:"list_item",raw:c,task:a,checked:o,loose:l,text:n});return g}},t.html=function(e){var t=this.rules.block.html.exec(e);if(t)return{type:this.options.sanitize?"paragraph":"html",raw:t[0],pre:!this.options.sanitizer&&("pre"===t[1]||"script"===t[1]||"style"===t[1]),text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):C(t[0]):t[0]}},t.def=function(e){var t=this.rules.block.def.exec(e);if(t)return t[3]&&(t[3]=t[3].substring(1,t[3].length-1)),{tag:t[1].toLowerCase().replace(/\s+/g," "),raw:t[0],href:t[2],title:t[3]}},t.table=function(e){var t=this.rules.block.table.exec(e);if(t){var n={type:"table",header:U(t[1].replace(/^ *| *\| *$/g,"")),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:t[3]?t[3].replace(/\n$/,"").split("\n"):[]};if(n.header.length===n.align.length){n.raw=t[0];var r,i=n.align.length;for(r=0;r<i;r++)/^ *-+: *$/.test(n.align[r])?n.align[r]="right":/^ *:-+: *$/.test(n.align[r])?n.align[r]="center":/^ *:-+ *$/.test(n.align[r])?n.align[r]="left":n.align[r]=null;for(i=n.cells.length,r=0;r<i;r++)n.cells[r]=U(n.cells[r].replace(/^ *\| *| *\| *$/g,""),n.header.length);return n}}},t.lheading=function(e){var t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1]}},t.paragraph=function(e){var t=this.rules.block.paragraph.exec(e);if(t)return{type:"paragraph",raw:t[0],text:"\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1]}},t.text=function(e,t){var n=this.rules.block.text.exec(e);if(n){var r=t[t.length-1];return r&&"text"===r.type?{raw:n[0],text:n[0]}:{type:"text",raw:n[0],text:n[0]}}},t.escape=function(e){var t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:C(t[1])}},t.tag=function(e,t,n){var r=this.rules.inline.tag.exec(e);if(r)return!t&&/^<a /i.test(r[0])?t=!0:t&&/^<\/a>/i.test(r[0])&&(t=!1),!n&&/^<(pre|code|kbd|script)(\s|>)/i.test(r[0])?n=!0:n&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(r[0])&&(n=!1),{type:this.options.sanitize?"text":"html",raw:r[0],inLink:t,inRawBlock:n,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(r[0]):C(r[0]):r[0]}},t.link=function(e){var t=this.rules.inline.link.exec(e);if(t){var n=j(t[2],"()");if(n>-1){var r=(0===t[0].indexOf("!")?5:4)+t[1].length+n;t[2]=t[2].substring(0,n),t[0]=t[0].substring(0,r).trim(),t[3]=""}var i=t[2],s="";if(this.options.pedantic){var l=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(i);l?(i=l[1],s=l[3]):s=""}else s=t[3]?t[3].slice(1,-1):"";return E(t,{href:(i=i.trim().replace(/^<([\s\S]*)>$/,"$1"))?i.replace(this.rules.inline._escapes,"$1"):i,title:s?s.replace(this.rules.inline._escapes,"$1"):s},t[0])}},t.reflink=function(e,t){var n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){var r=(n[2]||n[1]).replace(/\s+/g," ");if(!(r=t[r.toLowerCase()])||!r.href){var i=n[0].charAt(0);return{type:"text",raw:i,text:i}}return E(n,r,n[0])}},t.strong=function(e,t,n){void 0===n&&(n="");var r=this.rules.inline.strong.start.exec(e);if(r&&(!r[1]||r[1]&&(""===n||this.rules.inline.punctuation.exec(n)))){t=t.slice(-1*e.length);var i,s="**"===r[0]?this.rules.inline.strong.endAst:this.rules.inline.strong.endUnd;for(s.lastIndex=0;null!=(r=s.exec(t));)if(i=this.rules.inline.strong.middle.exec(t.slice(0,r.index+3)))return{type:"strong",raw:e.slice(0,i[0].length),text:e.slice(2,i[0].length-2)}}},t.em=function(e,t,n){void 0===n&&(n="");var r=this.rules.inline.em.start.exec(e);if(r&&(!r[1]||r[1]&&(""===n||this.rules.inline.punctuation.exec(n)))){t=t.slice(-1*e.length);var i,s="*"===r[0]?this.rules.inline.em.endAst:this.rules.inline.em.endUnd;for(s.lastIndex=0;null!=(r=s.exec(t));)if(i=this.rules.inline.em.middle.exec(t.slice(0,r.index+2)))return{type:"em",raw:e.slice(0,i[0].length),text:e.slice(1,i[0].length-1)}}},t.codespan=function(e){var t=this.rules.inline.code.exec(e);if(t){var n=t[2].replace(/\n/g," "),r=/[^ ]/.test(n),i=n.startsWith(" ")&&n.endsWith(" ");return r&&i&&(n=n.substring(1,n.length-1)),n=C(n,!0),{type:"codespan",raw:t[0],text:n}}},t.br=function(e){var t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}},t.del=function(e){var t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[1]}},t.autolink=function(e,t){var n,r,i=this.rules.inline.autolink.exec(e);if(i)return r="@"===i[2]?"mailto:"+(n=C(this.options.mangle?t(i[1]):i[1])):n=C(i[1]),{type:"link",raw:i[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}},t.url=function(e,t){var n;if(n=this.rules.inline.url.exec(e)){var r,i;if("@"===n[2])i="mailto:"+(r=C(this.options.mangle?t(n[0]):n[0]));else{var s;do{s=n[0],n[0]=this.rules.inline._backpedal.exec(n[0])[0]}while(s!==n[0]);r=C(n[0]),i="www."===n[1]?"http://"+r:r}return{type:"link",raw:n[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}},t.inlineText=function(e,t,n){var r,i=this.rules.inline.text.exec(e);if(i)return r=t?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(i[0]):C(i[0]):i[0]:C(this.options.smartypants?n(i[0]):i[0]),{type:"text",raw:i[0],text:r}},e}(),D=$,L=z,B=A,F={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?:\n+|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6}) +([^\n]*?)(?: +#+)? *(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3})(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:"^ {0,3}(?:<(script|pre|style)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?\\?>\\n*|<![A-Z][\\s\\S]*?>\\n*|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>\\n*|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:\\n{2,}|$)|<(?!script|pre|style)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:\\n{2,}|$)|</(?!script|pre|style)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:\\n{2,}|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,nptable:D,table:D,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};F.def=L(F.def).replace("label",F._label).replace("title",F._title).getRegex(),F.bullet=/(?:[*+-]|\d{1,9}[.)])/,F.item=/^( *)(bull) ?[^\n]*(?:\n(?!\1bull ?)[^\n]*)*/,F.item=L(F.item,"gm").replace(/bull/g,F.bullet).getRegex(),F.list=L(F.list).replace(/bull/g,F.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+F.def.source+")").getRegex(),F._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",F._comment=/<!--(?!-?>)[\s\S]*?-->/,F.html=L(F.html,"i").replace("comment",F._comment).replace("tag",F._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),F.paragraph=L(F._paragraph).replace("hr",F.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|!--)").replace("tag",F._tag).getRegex(),F.blockquote=L(F.blockquote).replace("paragraph",F.paragraph).getRegex(),F.normal=B({},F),F.gfm=B({},F.normal,{nptable:"^ *([^|\\n ].*\\|.*)\\n *([-:]+ *\\|[-| :]*)(?:\\n((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)",table:"^ *\\|(.+)\\n *\\|?( *[-:]+[-| :]*)(?:\\n *((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),F.gfm.nptable=L(F.gfm.nptable).replace("hr",F.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|!--)").replace("tag",F._tag).getRegex(),F.gfm.table=L(F.gfm.table).replace("hr",F.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|!--)").replace("tag",F._tag).getRegex(),F.pedantic=B({},F.normal,{html:L("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",F._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *(?:#+ *)?(?:\n+|$)/,fences:D,paragraph:L(F.normal._paragraph).replace("hr",F.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",F.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var M={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:D,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",strong:{start:/^(?:(\*\*(?=[*punctuation]))|\*\*)(?![\s])|__/,middle:/^\*\*(?:(?:(?!overlapSkip)(?:[^*]|\\\*)|overlapSkip)|\*(?:(?!overlapSkip)(?:[^*]|\\\*)|overlapSkip)*?\*)+?\*\*$|^__(?![\s])((?:(?:(?!overlapSkip)(?:[^_]|\\_)|overlapSkip)|_(?:(?!overlapSkip)(?:[^_]|\\_)|overlapSkip)*?_)+?)__$/,endAst:/[^punctuation\s]\*\*(?!\*)|[punctuation]\*\*(?!\*)(?:(?=[punctuation\s]|$))/,endUnd:/[^\s]__(?!_)(?:(?=[punctuation\s])|$)/},em:{start:/^(?:(\*(?=[punctuation]))|\*)(?![*\s])|_/,middle:/^\*(?:(?:(?!overlapSkip)(?:[^*]|\\\*)|overlapSkip)|\*(?:(?!overlapSkip)(?:[^*]|\\\*)|overlapSkip)*?\*)+?\*$|^_(?![_\s])(?:(?:(?!overlapSkip)(?:[^_]|\\_)|overlapSkip)|_(?:(?!overlapSkip)(?:[^_]|\\_)|overlapSkip)*?_)+?_$/,endAst:/[^punctuation\s]\*(?!\*)|[punctuation]\*(?!\*)(?:(?=[punctuation\s]|$))/,endUnd:/[^\s]_(?!_)(?:(?=[punctuation\s])|$)/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:D,text:/^(`+|[^`])(?:[\s\S]*?(?:(?=[\\<!\[`*]|\b_|$)|[^ ](?= {2,}\n))|(?= {2,}\n))/,punctuation:/^([\s*punctuation])/,_punctuation:"!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~"};M.punctuation=L(M.punctuation).replace(/punctuation/g,M._punctuation).getRegex(),M._blockSkip="\\[[^\\]]*?\\]\\([^\\)]*?\\)|`[^`]*?`|<[^>]*?>",M._overlapSkip="__[^_]*?__|\\*\\*\\[^\\*\\]*?\\*\\*",M.em.start=L(M.em.start).replace(/punctuation/g,M._punctuation).getRegex(),M.em.middle=L(M.em.middle).replace(/punctuation/g,M._punctuation).replace(/overlapSkip/g,M._overlapSkip).getRegex(),M.em.endAst=L(M.em.endAst,"g").replace(/punctuation/g,M._punctuation).getRegex(),M.em.endUnd=L(M.em.endUnd,"g").replace(/punctuation/g,M._punctuation).getRegex(),M.strong.start=L(M.strong.start).replace(/punctuation/g,M._punctuation).getRegex(),M.strong.middle=L(M.strong.middle).replace(/punctuation/g,M._punctuation).replace(/blockSkip/g,M._blockSkip).getRegex(),M.strong.endAst=L(M.strong.endAst,"g").replace(/punctuation/g,M._punctuation).getRegex(),M.strong.endUnd=L(M.strong.endUnd,"g").replace(/punctuation/g,M._punctuation).getRegex(),M.blockSkip=L(M._blockSkip,"g").getRegex(),M.overlapSkip=L(M._overlapSkip,"g").getRegex(),M._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,M._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,M._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,M.autolink=L(M.autolink).replace("scheme",M._scheme).replace("email",M._email).getRegex(),M._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,M.tag=L(M.tag).replace("comment",F._comment).replace("attribute",M._attribute).getRegex(),M._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,M._href=/<(?:\\[<>]?|[^\s<>\\])*>|[^\s\x00-\x1f]*/,M._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,M.link=L(M.link).replace("label",M._label).replace("href",M._href).replace("title",M._title).getRegex(),M.reflink=L(M.reflink).replace("label",M._label).getRegex(),M.reflinkSearch=L(M.reflinkSearch,"g").replace("reflink",M.reflink).replace("nolink",M.nolink).getRegex(),M.normal=B({},M),M.pedantic=B({},M.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:L(/^!?\[(label)\]\((.*?)\)/).replace("label",M._label).getRegex(),reflink:L(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",M._label).getRegex()}),M.gfm=B({},M.normal,{escape:L(M.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^~+(?=\S)([\s\S]*?\S)~+/,text:/^(`+|[^`])(?:[\s\S]*?(?:(?=[\\<!\[`*~]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@))|(?= {2,}\n|[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@))/}),M.gfm.url=L(M.gfm.url,"i").replace("email",M.gfm._extended_email).getRegex(),M.breaks=B({},M.gfm,{br:L(M.br).replace("{2,}","*").getRegex(),text:L(M.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});var N={block:F,inline:M},W=i.defaults,X=N.block,G=N.inline;function V(e){return e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function H(e){var t,n,r="",i=e.length;for(t=0;t<i;t++)n=e.charCodeAt(t),Math.random()>.5&&(n="x"+n.toString(16)),r+="&#"+n+";";return r}var J=function(){function t(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||W,this.options.tokenizer=this.options.tokenizer||new P,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options;var t={block:X.normal,inline:G.normal};this.options.pedantic?(t.block=X.pedantic,t.inline=G.pedantic):this.options.gfm&&(t.block=X.gfm,this.options.breaks?t.inline=G.breaks:t.inline=G.gfm),this.tokenizer.rules=t}t.lex=function(e,n){return new t(n).lex(e)};var n,r,i,s=t.prototype;return s.lex=function(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    "),this.blockTokens(e,this.tokens,!0),this.inline(this.tokens),this.tokens},s.blockTokens=function(e,t,n){var r,i,s,l;for(void 0===t&&(t=[]),void 0===n&&(n=!0),e=e.replace(/^ +$/gm,"");e;)if(r=this.tokenizer.space(e))e=e.substring(r.raw.length),r.type&&t.push(r);else if(r=this.tokenizer.code(e,t))e=e.substring(r.raw.length),r.type?t.push(r):((l=t[t.length-1]).raw+="\n"+r.raw,l.text+="\n"+r.text);else if(r=this.tokenizer.fences(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.heading(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.nptable(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.hr(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.blockquote(e))e=e.substring(r.raw.length),r.tokens=this.blockTokens(r.text,[],n),t.push(r);else if(r=this.tokenizer.list(e)){for(e=e.substring(r.raw.length),s=r.items.length,i=0;i<s;i++)r.items[i].tokens=this.blockTokens(r.items[i].text,[],!1);t.push(r)}else if(r=this.tokenizer.html(e))e=e.substring(r.raw.length),t.push(r);else if(n&&(r=this.tokenizer.def(e)))e=e.substring(r.raw.length),this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});else if(r=this.tokenizer.table(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.lheading(e))e=e.substring(r.raw.length),t.push(r);else if(n&&(r=this.tokenizer.paragraph(e)))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.text(e,t))e=e.substring(r.raw.length),r.type?t.push(r):((l=t[t.length-1]).raw+="\n"+r.raw,l.text+="\n"+r.text);else if(e){var a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}throw new Error(a)}return t},s.inline=function(e){var t,n,r,i,s,l,a=e.length;for(t=0;t<a;t++)switch((l=e[t]).type){case"paragraph":case"text":case"heading":l.tokens=[],this.inlineTokens(l.text,l.tokens);break;case"table":for(l.tokens={header:[],cells:[]},i=l.header.length,n=0;n<i;n++)l.tokens.header[n]=[],this.inlineTokens(l.header[n],l.tokens.header[n]);for(i=l.cells.length,n=0;n<i;n++)for(s=l.cells[n],l.tokens.cells[n]=[],r=0;r<s.length;r++)l.tokens.cells[n][r]=[],this.inlineTokens(s[r],l.tokens.cells[n][r]);break;case"blockquote":this.inline(l.tokens);break;case"list":for(i=l.items.length,n=0;n<i;n++)this.inline(l.items[n].tokens)}return e},s.inlineTokens=function(e,t,n,r,i){var s;void 0===t&&(t=[]),void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===i&&(i="");var l,a=e;if(this.tokens.links){var o=Object.keys(this.tokens.links);if(o.length>0)for(;null!=(l=this.tokenizer.rules.inline.reflinkSearch.exec(a));)o.includes(l[0].slice(l[0].lastIndexOf("[")+1,-1))&&(a=a.slice(0,l.index)+"["+"a".repeat(l[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(l=this.tokenizer.rules.inline.blockSkip.exec(a));)a=a.slice(0,l.index)+"["+"a".repeat(l[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;e;)if(s=this.tokenizer.escape(e))e=e.substring(s.raw.length),t.push(s);else if(s=this.tokenizer.tag(e,n,r))e=e.substring(s.raw.length),n=s.inLink,r=s.inRawBlock,t.push(s);else if(s=this.tokenizer.link(e))e=e.substring(s.raw.length),"link"===s.type&&(s.tokens=this.inlineTokens(s.text,[],!0,r)),t.push(s);else if(s=this.tokenizer.reflink(e,this.tokens.links))e=e.substring(s.raw.length),"link"===s.type&&(s.tokens=this.inlineTokens(s.text,[],!0,r)),t.push(s);else if(s=this.tokenizer.strong(e,a,i))e=e.substring(s.raw.length),s.tokens=this.inlineTokens(s.text,[],n,r),t.push(s);else if(s=this.tokenizer.em(e,a,i))e=e.substring(s.raw.length),s.tokens=this.inlineTokens(s.text,[],n,r),t.push(s);else if(s=this.tokenizer.codespan(e))e=e.substring(s.raw.length),t.push(s);else if(s=this.tokenizer.br(e))e=e.substring(s.raw.length),t.push(s);else if(s=this.tokenizer.del(e))e=e.substring(s.raw.length),s.tokens=this.inlineTokens(s.text,[],n,r),t.push(s);else if(s=this.tokenizer.autolink(e,H))e=e.substring(s.raw.length),t.push(s);else if(n||!(s=this.tokenizer.url(e,H))){if(s=this.tokenizer.inlineText(e,r,V))e=e.substring(s.raw.length),i=s.raw.slice(-1),t.push(s);else if(e){var c="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(c);break}throw new Error(c)}}else e=e.substring(s.raw.length),t.push(s);return t},n=t,i=[{key:"rules",get:function(){return{block:X,inline:G}}}],(r=null)&&e(n.prototype,r),i&&e(n,i),t}(),K=i.defaults,Q=S,Y=_,ee=function(){function e(e){this.options=e||K}var t=e.prototype;return t.code=function(e,t,n){var r=(t||"").match(/\S*/)[0];if(this.options.highlight){var i=this.options.highlight(e,r);null!=i&&i!==e&&(n=!0,e=i)}return r?'<pre><code class="'+this.options.langPrefix+Y(r,!0)+'">'+(n?e:Y(e,!0))+"</code></pre>\n":"<pre><code>"+(n?e:Y(e,!0))+"</code></pre>\n"},t.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},t.html=function(e){return e},t.heading=function(e,t,n,r){return this.options.headerIds?"<h"+t+' id="'+this.options.headerPrefix+r.slug(n)+'">'+e+"</h"+t+">\n":"<h"+t+">"+e+"</h"+t+">\n"},t.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},t.list=function(e,t,n){var r=t?"ol":"ul";return"<"+r+(t&&1!==n?' start="'+n+'"':"")+">\n"+e+"</"+r+">\n"},t.listitem=function(e){return"<li>"+e+"</li>\n"},t.checkbox=function(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},t.paragraph=function(e){return"<p>"+e+"</p>\n"},t.table=function(e,t){return t&&(t="<tbody>"+t+"</tbody>"),"<table>\n<thead>\n"+e+"</thead>\n"+t+"</table>\n"},t.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},t.tablecell=function(e,t){var n=t.header?"th":"td";return(t.align?"<"+n+' align="'+t.align+'">':"<"+n+">")+e+"</"+n+">\n"},t.strong=function(e){return"<strong>"+e+"</strong>"},t.em=function(e){return"<em>"+e+"</em>"},t.codespan=function(e){return"<code>"+e+"</code>"},t.br=function(){return this.options.xhtml?"<br/>":"<br>"},t.del=function(e){return"<del>"+e+"</del>"},t.link=function(e,t,n){if(null===(e=Q(this.options.sanitize,this.options.baseUrl,e)))return n;var r='<a href="'+Y(e)+'"';return t&&(r+=' title="'+t+'"'),r+=">"+n+"</a>"},t.image=function(e,t,n){if(null===(e=Q(this.options.sanitize,this.options.baseUrl,e)))return n;var r='<img src="'+e+'" alt="'+n+'"';return t&&(r+=' title="'+t+'"'),r+=this.options.xhtml?"/>":">"},t.text=function(e){return e},e}(),te=function(){function e(){}var t=e.prototype;return t.strong=function(e){return e},t.em=function(e){return e},t.codespan=function(e){return e},t.del=function(e){return e},t.html=function(e){return e},t.text=function(e){return e},t.link=function(e,t,n){return""+n},t.image=function(e,t,n){return""+n},t.br=function(){return""},e}(),ne=function(){function e(){this.seen={}}return e.prototype.slug=function(e){var t=e.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-");if(this.seen.hasOwnProperty(t)){var n=t;do{this.seen[n]++,t=n+"-"+this.seen[n]}while(this.seen.hasOwnProperty(t))}return this.seen[t]=0,t},e}(),re=i.defaults,ie=y,se=function(){function e(e){this.options=e||re,this.options.renderer=this.options.renderer||new ee,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new te,this.slugger=new ne}e.parse=function(t,n){return new e(n).parse(t)};var t=e.prototype;return t.parse=function(e,t){void 0===t&&(t=!0);var n,r,i,s,l,a,o,c,u,p,h,g,f,d,k,b,m,x,v="",w=e.length;for(n=0;n<w;n++)switch((p=e[n]).type){case"space":continue;case"hr":v+=this.renderer.hr();continue;case"heading":v+=this.renderer.heading(this.parseInline(p.tokens),p.depth,ie(this.parseInline(p.tokens,this.textRenderer)),this.slugger);continue;case"code":v+=this.renderer.code(p.text,p.lang,p.escaped);continue;case"table":for(c="",o="",s=p.header.length,r=0;r<s;r++)o+=this.renderer.tablecell(this.parseInline(p.tokens.header[r]),{header:!0,align:p.align[r]});for(c+=this.renderer.tablerow(o),u="",s=p.cells.length,r=0;r<s;r++){for(o="",l=(a=p.tokens.cells[r]).length,i=0;i<l;i++)o+=this.renderer.tablecell(this.parseInline(a[i]),{header:!1,align:p.align[i]});u+=this.renderer.tablerow(o)}v+=this.renderer.table(c,u);continue;case"blockquote":u=this.parse(p.tokens),v+=this.renderer.blockquote(u);continue;case"list":for(h=p.ordered,g=p.start,f=p.loose,s=p.items.length,u="",r=0;r<s;r++)b=(k=p.items[r]).checked,m=k.task,d="",k.task&&(x=this.renderer.checkbox(b),f?k.tokens.length>0&&"text"===k.tokens[0].type?(k.tokens[0].text=x+" "+k.tokens[0].text,k.tokens[0].tokens&&k.tokens[0].tokens.length>0&&"text"===k.tokens[0].tokens[0].type&&(k.tokens[0].tokens[0].text=x+" "+k.tokens[0].tokens[0].text)):k.tokens.unshift({type:"text",text:x}):d+=x),d+=this.parse(k.tokens,f),u+=this.renderer.listitem(d,m,b);v+=this.renderer.list(u,h,g);continue;case"html":v+=this.renderer.html(p.text);continue;case"paragraph":v+=this.renderer.paragraph(this.parseInline(p.tokens));continue;case"text":for(u=p.tokens?this.parseInline(p.tokens):p.text;n+1<w&&"text"===e[n+1].type;)u+="\n"+((p=e[++n]).tokens?this.parseInline(p.tokens):p.text);v+=t?this.renderer.paragraph(u):u;continue;default:var _='Token with "'+p.type+'" type was not found.';if(this.options.silent)return void console.error(_);throw new Error(_)}return v},t.parseInline=function(e,t){t=t||this.renderer;var n,r,i="",s=e.length;for(n=0;n<s;n++)switch((r=e[n]).type){case"escape":i+=t.text(r.text);break;case"html":i+=t.html(r.text);break;case"link":i+=t.link(r.href,r.title,this.parseInline(r.tokens,t));break;case"image":i+=t.image(r.href,r.title,r.text);break;case"strong":i+=t.strong(this.parseInline(r.tokens,t));break;case"em":i+=t.em(this.parseInline(r.tokens,t));break;case"codespan":i+=t.codespan(r.text);break;case"br":i+=t.br();break;case"del":i+=t.del(this.parseInline(r.tokens,t));break;case"text":i+=t.text(r.text);break;default:var l='Token with "'+r.type+'" type was not found.';if(this.options.silent)return void console.error(l);throw new Error(l)}return i},e}(),le=A,ae=Z,oe=_,ce=i.getDefaults,ue=i.changeDefaults,pe=i.defaults;function he(e,t,n){if(null==e)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");if("function"==typeof t&&(n=t,t=null),t=le({},he.defaults,t||{}),ae(t),n){var r,i=t.highlight;try{r=J.lex(e,t)}catch(e){return n(e)}var s=function(e){var s;if(!e)try{s=se.parse(r,t)}catch(t){e=t}return t.highlight=i,e?n(e):n(null,s)};if(!i||i.length<3)return s();if(delete t.highlight,!r.length)return s();var l=0;return he.walkTokens(r,function(e){"code"===e.type&&(l++,setTimeout(function(){i(e.text,e.lang,function(t,n){if(t)return s(t);null!=n&&n!==e.text&&(e.text=n,e.escaped=!0),0===--l&&s()})},0))}),void(0===l&&s())}try{var a=J.lex(e,t);return t.walkTokens&&he.walkTokens(a,t.walkTokens),se.parse(a,t)}catch(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",t.silent)return"<p>An error occurred:</p><pre>"+oe(e.message+"",!0)+"</pre>";throw e}}return he.options=he.setOptions=function(e){return le(he.defaults,e),ue(he.defaults),he},he.getDefaults=ce,he.defaults=pe,he.use=function(e){var t=le({},e);if(e.renderer&&function(){var n=he.defaults.renderer||new ee,r=function(t){var r=n[t];n[t]=function(){for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];var a=e.renderer[t].apply(n,s);return!1===a&&(a=r.apply(n,s)),a}};for(var i in e.renderer)r(i);t.renderer=n}(),e.tokenizer&&function(){var n=he.defaults.tokenizer||new P,r=function(t){var r=n[t];n[t]=function(){for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];var a=e.tokenizer[t].apply(n,s);return!1===a&&(a=r.apply(n,s)),a}};for(var i in e.tokenizer)r(i);t.tokenizer=n}(),e.walkTokens){var n=he.defaults.walkTokens;t.walkTokens=function(t){e.walkTokens(t),n&&n(t)}}he.setOptions(t)},he.walkTokens=function(e,t){for(var r,i=n(e);!(r=i()).done;){var s=r.value;switch(t(s),s.type){case"table":for(var l,a=n(s.tokens.header);!(l=a()).done;){var o=l.value;he.walkTokens(o,t)}for(var c,u=n(s.tokens.cells);!(c=u()).done;)for(var p,h=n(c.value);!(p=h()).done;){var g=p.value;he.walkTokens(g,t)}break;case"list":he.walkTokens(s.items,t);break;default:s.tokens&&he.walkTokens(s.tokens,t)}}},he.Parser=se,he.parser=se.parse,he.Renderer=ee,he.TextRenderer=te,he.Lexer=J,he.lexer=J.lex,he.Tokenizer=P,he.Slugger=ne,he.parse=he,he});

},{}],314:[function(require,module,exports){
var runtime=function(t){"use strict";var r,e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,r,e,n){var o=r&&r.prototype instanceof v?r:v,i=Object.create(o.prototype),a=new k(n||[]);return i._invoke=function(t,r,e){var n=f;return function(o,i){if(n===l)throw new Error("Generator is already running");if(n===p){if("throw"===o)throw i;return N()}for(e.method=o,e.arg=i;;){var a=e.delegate;if(a){var c=_(a,e);if(c){if(c===y)continue;return c}}if("next"===e.method)e.sent=e._sent=e.arg;else if("throw"===e.method){if(n===f)throw n=p,e.arg;e.dispatchException(e.arg)}else"return"===e.method&&e.abrupt("return",e.arg);n=l;var u=h(t,r,e);if("normal"===u.type){if(n=e.done?p:s,u.arg===y)continue;return{value:u.arg,done:e.done}}"throw"===u.type&&(n=p,e.method="throw",e.arg=u.arg)}}}(t,e,a),i}function h(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var f="suspendedStart",s="suspendedYield",l="executing",p="completed",y={};function v(){}function d(){}function g(){}var m={};m[i]=function(){return this};var w=Object.getPrototypeOf,L=w&&w(w(G([])));L&&L!==e&&n.call(L,i)&&(m=L);var x=g.prototype=v.prototype=Object.create(m);function E(t){["next","throw","return"].forEach(function(r){t[r]=function(t){return this._invoke(r,t)}})}function b(t,r){var e;this._invoke=function(o,i){function a(){return new r(function(e,a){!function e(o,i,a,c){var u=h(t[o],t,i);if("throw"!==u.type){var f=u.arg,s=f.value;return s&&"object"==typeof s&&n.call(s,"__await")?r.resolve(s.__await).then(function(t){e("next",t,a,c)},function(t){e("throw",t,a,c)}):r.resolve(s).then(function(t){f.value=t,a(f)},function(t){return e("throw",t,a,c)})}c(u.arg)}(o,i,e,a)})}return e=e?e.then(a,a):a()}}function _(t,e){var n=t.iterator[e.method];if(n===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=r,_(t,e),"throw"===e.method))return y;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var o=h(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,y;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=r),e.delegate=null,y):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function j(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function O(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function G(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function e(){for(;++o<t.length;)if(n.call(t,o))return e.value=t[o],e.done=!1,e;return e.value=r,e.done=!0,e};return a.next=a}}return{next:N}}function N(){return{value:r,done:!0}}return d.prototype=x.constructor=g,g.constructor=d,g[c]=d.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===d||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c in t||(t[c]="GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},E(b.prototype),b.prototype[a]=function(){return this},t.AsyncIterator=b,t.async=function(r,e,n,o,i){void 0===i&&(i=Promise);var a=new b(u(r,e,n,o),i);return t.isGeneratorFunction(e)?a:a.next().then(function(t){return t.done?t.value:a.next()})},E(x),x[c]="Generator",x[i]=function(){return this},x.toString=function(){return"[object Generator]"},t.keys=function(t){var r=[];for(var e in t)r.push(e);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=G,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(O),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=r)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function o(n,o){return c.type="throw",c.arg=t,e.next=n,o&&(e.method="next",e.arg=r),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),h=n.call(a,"finallyLoc");if(u&&h){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),y},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),O(e),y}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;O(e)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:G(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=r),y}},t}("object"==typeof module?module.exports:{});try{regeneratorRuntime=runtime}catch(t){Function("r","regeneratorRuntime = r")(runtime)}

},{}],315:[function(require,module,exports){
(function (global){
!function(n,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define("underscore",r):function(){var t=n._,e=r();n._=e,e.noConflict=function(){return n._=t,e}}()}(this,function(){var n="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||Function("return this")()||{},r=Array.prototype,t=Object.prototype,e="undefined"!=typeof Symbol?Symbol.prototype:null,u=r.push,o=r.slice,i=t.toString,a=t.hasOwnProperty,f=Array.isArray,c=Object.keys,l=Object.create,p=n.isNaN,s=n.isFinite,v=function(){};function h(n){return n instanceof h?n:this instanceof h?void(this._wrapped=n):new h(n)}var y=h.VERSION="1.10.2";function g(n,r,t){if(void 0===r)return n;switch(null==t?3:t){case 1:return function(t){return n.call(r,t)};case 3:return function(t,e,u){return n.call(r,t,e,u)};case 4:return function(t,e,u,o){return n.call(r,t,e,u,o)}}return function(){return n.apply(r,arguments)}}function d(n,r,t){return null==n?ur:Cn(n)?g(n,r,t):Ln(n)&&!Kn(n)?ir(n):or(n)}function m(n,r){return d(n,r,1/0)}function b(n,r,t){return h.iteratee!==m?h.iteratee(n,r):d(n,r,t)}function j(n,r){return r=null==r?n.length-1:+r,function(){for(var t=Math.max(arguments.length-r,0),e=Array(t),u=0;u<t;u++)e[u]=arguments[u+r];switch(r){case 0:return n.call(this,e);case 1:return n.call(this,arguments[0],e);case 2:return n.call(this,arguments[0],arguments[1],e)}var o=Array(r+1);for(u=0;u<r;u++)o[u]=arguments[u];return o[r]=e,n.apply(this,o)}}function _(n){if(!Ln(n))return{};if(l)return l(n);v.prototype=n;var r=new v;return v.prototype=null,r}function w(n){return function(r){return null==r?void 0:r[n]}}function x(n,r){return null!=n&&a.call(n,r)}function S(n,r){for(var t=r.length,e=0;e<t;e++){if(null==n)return;n=n[r[e]]}return t?n:void 0}h.iteratee=m;var A=Math.pow(2,53)-1,O=w("length");function M(n){var r=O(n);return"number"==typeof r&&r>=0&&r<=A}function E(n,r,t){var e,u;if(r=g(r,t),M(n))for(e=0,u=n.length;e<u;e++)r(n[e],e,n);else{var o=Sn(n);for(e=0,u=o.length;e<u;e++)r(n[o[e]],o[e],n)}return n}function N(n,r,t){r=b(r,t);for(var e=!M(n)&&Sn(n),u=(e||n).length,o=Array(u),i=0;i<u;i++){var a=e?e[i]:i;o[i]=r(n[a],a,n)}return o}function k(n){return function(r,t,e,u){var o=arguments.length>=3;return function(r,t,e,u){var o=!M(r)&&Sn(r),i=(o||r).length,a=n>0?0:i-1;for(u||(e=r[o?o[a]:a],a+=n);a>=0&&a<i;a+=n){var f=o?o[a]:a;e=t(e,r[f],f,r)}return e}(r,g(t,u,4),e,o)}}var I=k(1),T=k(-1);function B(n,r,t){var e=(M(n)?on:Tn)(n,r,t);if(void 0!==e&&-1!==e)return n[e]}function R(n,r,t){var e=[];return r=b(r,t),E(n,function(n,t,u){r(n,t,u)&&e.push(n)}),e}function F(n,r,t){r=b(r,t);for(var e=!M(n)&&Sn(n),u=(e||n).length,o=0;o<u;o++){var i=e?e[o]:o;if(!r(n[i],i,n))return!1}return!0}function q(n,r,t){r=b(r,t);for(var e=!M(n)&&Sn(n),u=(e||n).length,o=0;o<u;o++){var i=e?e[o]:o;if(r(n[i],i,n))return!0}return!1}function D(n,r,t,e){return M(n)||(n=On(n)),("number"!=typeof t||e)&&(t=0),ln(n,r,t)>=0}var W=j(function(n,r,t){var e,u;return Cn(r)?u=r:Kn(r)&&(e=r.slice(0,-1),r=r[r.length-1]),N(n,function(n){var o=u;if(!o){if(e&&e.length&&(n=S(n,e)),null==n)return;o=n[r]}return null==o?o:o.apply(n,t)})});function z(n,r){return N(n,or(r))}function P(n,r,t){var e,u,o=-1/0,i=-1/0;if(null==r||"number"==typeof r&&"object"!=typeof n[0]&&null!=n)for(var a=0,f=(n=M(n)?n:On(n)).length;a<f;a++)null!=(e=n[a])&&e>o&&(o=e);else r=b(r,t),E(n,function(n,t,e){((u=r(n,t,e))>i||u===-1/0&&o===-1/0)&&(o=n,i=u)});return o}function K(n,r,t){if(null==r||t)return M(n)||(n=On(n)),n[ar(n.length-1)];var e=M(n)?Dn(n):On(n),u=O(e);r=Math.max(Math.min(r,u),0);for(var o=u-1,i=0;i<r;i++){var a=ar(i,o),f=e[i];e[i]=e[a],e[a]=f}return e.slice(0,r)}function L(n,r){return function(t,e,u){var o=r?[[],[]]:{};return e=b(e,u),E(t,function(r,u){var i=e(r,u,t);n(o,r,i)}),o}}var V=L(function(n,r,t){x(n,t)?n[t].push(r):n[t]=[r]}),C=L(function(n,r,t){n[t]=r}),J=L(function(n,r,t){x(n,t)?n[t]++:n[t]=1}),U=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;var $=L(function(n,r,t){n[t?0:1].push(r)},!0);function G(n,r,t){return null==n||n.length<1?null==r?void 0:[]:null==r||t?n[0]:H(n,n.length-r)}function H(n,r,t){return o.call(n,0,Math.max(0,n.length-(null==r||t?1:r)))}function Q(n,r,t){return o.call(n,null==r||t?1:r)}function X(n,r,t,e){for(var u=(e=e||[]).length,o=0,i=O(n);o<i;o++){var a=n[o];if(M(a)&&(Kn(a)||Vn(a)))if(r)for(var f=0,c=a.length;f<c;)e[u++]=a[f++];else X(a,r,t,e),u=e.length;else t||(e[u++]=a)}return e}var Y=j(function(n,r){return rn(n,r)});function Z(n,r,t,e){er(r)||(e=t,t=r,r=!1),null!=t&&(t=b(t,e));for(var u=[],o=[],i=0,a=O(n);i<a;i++){var f=n[i],c=t?t(f,i,n):f;r&&!t?(i&&o===c||u.push(f),o=c):t?D(o,c)||(o.push(c),u.push(f)):D(u,f)||u.push(f)}return u}var nn=j(function(n){return Z(X(n,!0,!0))});var rn=j(function(n,r){return r=X(r,!0,!0),R(n,function(n){return!D(r,n)})});function tn(n){for(var r=n&&P(n,O).length||0,t=Array(r),e=0;e<r;e++)t[e]=z(n,e);return t}var en=j(tn);function un(n){return function(r,t,e){t=b(t,e);for(var u=O(r),o=n>0?0:u-1;o>=0&&o<u;o+=n)if(t(r[o],o,r))return o;return-1}}var on=un(1),an=un(-1);function fn(n,r,t,e){for(var u=(t=b(t,e,1))(r),o=0,i=O(n);o<i;){var a=Math.floor((o+i)/2);t(n[a])<u?o=a+1:i=a}return o}function cn(n,r,t){return function(e,u,i){var a=0,f=O(e);if("number"==typeof i)n>0?a=i>=0?i:Math.max(i+f,a):f=i>=0?Math.min(i+1,f):i+f+1;else if(t&&i&&f)return e[i=t(e,u)]===u?i:-1;if(u!=u)return(i=r(o.call(e,a,f),tr))>=0?i+a:-1;for(i=n>0?a:f-1;i>=0&&i<f;i+=n)if(e[i]===u)return i;return-1}}var ln=cn(1,on,fn),pn=cn(-1,an);function sn(n,r,t,e,u){if(!(e instanceof r))return n.apply(t,u);var o=_(n.prototype),i=n.apply(o,u);return Ln(i)?i:o}var vn=j(function(n,r,t){if(!Cn(n))throw new TypeError("Bind must be called on a function");var e=j(function(u){return sn(n,e,r,this,t.concat(u))});return e}),hn=j(function(n,r){var t=hn.placeholder,e=function(){for(var u=0,o=r.length,i=Array(o),a=0;a<o;a++)i[a]=r[a]===t?arguments[u++]:r[a];for(;u<arguments.length;)i.push(arguments[u++]);return sn(n,e,this,this,i)};return e});hn.placeholder=h;var yn=j(function(n,r){var t=(r=X(r,!1,!1)).length;if(t<1)throw new Error("bindAll must be passed function names");for(;t--;){var e=r[t];n[e]=vn(n[e],n)}});var gn=j(function(n,r,t){return setTimeout(function(){return n.apply(null,t)},r)}),dn=hn(gn,h,1);function mn(n){return function(){return!n.apply(this,arguments)}}function bn(n,r){var t;return function(){return--n>0&&(t=r.apply(this,arguments)),n<=1&&(r=null),t}}var jn=hn(bn,2),_n=!{toString:null}.propertyIsEnumerable("toString"),wn=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];function xn(n,r){var e=wn.length,u=n.constructor,o=Cn(u)&&u.prototype||t,i="constructor";for(x(n,i)&&!D(r,i)&&r.push(i);e--;)(i=wn[e])in n&&n[i]!==o[i]&&!D(r,i)&&r.push(i)}function Sn(n){if(!Ln(n))return[];if(c)return c(n);var r=[];for(var t in n)x(n,t)&&r.push(t);return _n&&xn(n,r),r}function An(n){if(!Ln(n))return[];var r=[];for(var t in n)r.push(t);return _n&&xn(n,r),r}function On(n){for(var r=Sn(n),t=r.length,e=Array(t),u=0;u<t;u++)e[u]=n[r[u]];return e}function Mn(n){for(var r={},t=Sn(n),e=0,u=t.length;e<u;e++)r[n[t[e]]]=t[e];return r}function En(n){var r=[];for(var t in n)Cn(n[t])&&r.push(t);return r.sort()}function Nn(n,r){return function(t){var e=arguments.length;if(r&&(t=Object(t)),e<2||null==t)return t;for(var u=1;u<e;u++)for(var o=arguments[u],i=n(o),a=i.length,f=0;f<a;f++){var c=i[f];r&&void 0!==t[c]||(t[c]=o[c])}return t}}var kn=Nn(An),In=Nn(Sn);function Tn(n,r,t){r=b(r,t);for(var e,u=Sn(n),o=0,i=u.length;o<i;o++)if(r(n[e=u[o]],e,n))return e}function Bn(n,r,t){return r in t}var Rn=j(function(n,r){var t={},e=r[0];if(null==n)return t;Cn(e)?(r.length>1&&(e=g(e,r[1])),r=An(n)):(e=Bn,r=X(r,!1,!1),n=Object(n));for(var u=0,o=r.length;u<o;u++){var i=r[u],a=n[i];e(a,i,n)&&(t[i]=a)}return t}),Fn=j(function(n,r){var t,e=r[0];return Cn(e)?(e=mn(e),r.length>1&&(t=r[1])):(r=N(X(r,!1,!1),String),e=function(n,t){return!D(r,t)}),Rn(n,e,t)}),qn=Nn(An,!0);function Dn(n){return Ln(n)?Kn(n)?n.slice():kn({},n):n}function Wn(n,r){var t=Sn(r),e=t.length;if(null==n)return!e;for(var u=Object(n),o=0;o<e;o++){var i=t[o];if(r[i]!==u[i]||!(i in u))return!1}return!0}function zn(n,r,t,u){if(n===r)return 0!==n||1/n==1/r;if(null==n||null==r)return!1;if(n!=n)return r!=r;var o=typeof n;return("function"===o||"object"===o||"object"==typeof r)&&function(n,r,t,u){n instanceof h&&(n=n._wrapped);r instanceof h&&(r=r._wrapped);var o=i.call(n);if(o!==i.call(r))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+n==""+r;case"[object Number]":return+n!=+n?+r!=+r:0==+n?1/+n==1/r:+n==+r;case"[object Date]":case"[object Boolean]":return+n==+r;case"[object Symbol]":return e.valueOf.call(n)===e.valueOf.call(r)}var a="[object Array]"===o;if(!a){if("object"!=typeof n||"object"!=typeof r)return!1;var f=n.constructor,c=r.constructor;if(f!==c&&!(Cn(f)&&f instanceof f&&Cn(c)&&c instanceof c)&&"constructor"in n&&"constructor"in r)return!1}u=u||[];var l=(t=t||[]).length;for(;l--;)if(t[l]===n)return u[l]===r;if(t.push(n),u.push(r),a){if((l=n.length)!==r.length)return!1;for(;l--;)if(!zn(n[l],r[l],t,u))return!1}else{var p,s=Sn(n);if(l=s.length,Sn(r).length!==l)return!1;for(;l--;)if(p=s[l],!x(r,p)||!zn(n[p],r[p],t,u))return!1}return t.pop(),u.pop(),!0}(n,r,t,u)}function Pn(n){return function(r){return i.call(r)==="[object "+n+"]"}}var Kn=f||Pn("Array");function Ln(n){var r=typeof n;return"function"===r||"object"===r&&!!n}var Vn=Pn("Arguments"),Cn=Pn("Function"),Jn=Pn("String"),Un=Pn("Number"),$n=Pn("Date"),Gn=Pn("RegExp"),Hn=Pn("Error"),Qn=Pn("Symbol"),Xn=Pn("Map"),Yn=Pn("WeakMap"),Zn=Pn("Set"),nr=Pn("WeakSet");!function(){Vn(arguments)||(Vn=function(n){return x(n,"callee")})}();var rr=n.document&&n.document.childNodes;function tr(n){return Un(n)&&p(n)}function er(n){return!0===n||!1===n||"[object Boolean]"===i.call(n)}function ur(n){return n}function or(n){return Kn(n)?function(r){return S(r,n)}:w(n)}function ir(n){return n=In({},n),function(r){return Wn(r,n)}}function ar(n,r){return null==r&&(r=n,n=0),n+Math.floor(Math.random()*(r-n+1))}"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof rr&&(Cn=function(n){return"function"==typeof n||!1});var fr=Date.now||function(){return(new Date).getTime()},cr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},lr=Mn(cr);function pr(n){var r=function(r){return n[r]},t="(?:"+Sn(n).join("|")+")",e=RegExp(t),u=RegExp(t,"g");return function(n){return n=null==n?"":""+n,e.test(n)?n.replace(u,r):n}}var sr=pr(cr),vr=pr(lr);var hr=0;var yr=h.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},gr=/(.)^/,dr={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},mr=/\\|'|\r|\n|\u2028|\u2029/g,br=function(n){return"\\"+dr[n]};function jr(n,r){return n._chain?h(r).chain():r}function _r(n){return E(En(n),function(r){var t=h[r]=n[r];h.prototype[r]=function(){var n=[this._wrapped];return u.apply(n,arguments),jr(this,t.apply(h,n))}}),h}E(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=r[n];h.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!==n&&"splice"!==n||0!==r.length||delete r[0],jr(this,r)}}),E(["concat","join","slice"],function(n){var t=r[n];h.prototype[n]=function(){return jr(this,t.apply(this._wrapped,arguments))}}),h.prototype.value=function(){return this._wrapped},h.prototype.valueOf=h.prototype.toJSON=h.prototype.value,h.prototype.toString=function(){return String(this._wrapped)};var wr=_r({default:h,VERSION:y,iteratee:m,restArguments:j,each:E,forEach:E,map:N,collect:N,reduce:I,foldl:I,inject:I,reduceRight:T,foldr:T,find:B,detect:B,filter:R,select:R,reject:function(n,r,t){return R(n,mn(b(r)),t)},every:F,all:F,some:q,any:q,contains:D,includes:D,include:D,invoke:W,pluck:z,where:function(n,r){return R(n,ir(r))},findWhere:function(n,r){return B(n,ir(r))},max:P,min:function(n,r,t){var e,u,o=1/0,i=1/0;if(null==r||"number"==typeof r&&"object"!=typeof n[0]&&null!=n)for(var a=0,f=(n=M(n)?n:On(n)).length;a<f;a++)null!=(e=n[a])&&e<o&&(o=e);else r=b(r,t),E(n,function(n,t,e){((u=r(n,t,e))<i||u===1/0&&o===1/0)&&(o=n,i=u)});return o},shuffle:function(n){return K(n,1/0)},sample:K,sortBy:function(n,r,t){var e=0;return r=b(r,t),z(N(n,function(n,t,u){return{value:n,index:e++,criteria:r(n,t,u)}}).sort(function(n,r){var t=n.criteria,e=r.criteria;if(t!==e){if(t>e||void 0===t)return 1;if(t<e||void 0===e)return-1}return n.index-r.index}),"value")},groupBy:V,indexBy:C,countBy:J,toArray:function(n){return n?Kn(n)?o.call(n):Jn(n)?n.match(U):M(n)?N(n,ur):On(n):[]},size:function(n){return null==n?0:M(n)?n.length:Sn(n).length},partition:$,first:G,head:G,take:G,initial:H,last:function(n,r,t){return null==n||n.length<1?null==r?void 0:[]:null==r||t?n[n.length-1]:Q(n,Math.max(0,n.length-r))},rest:Q,tail:Q,drop:Q,compact:function(n){return R(n,Boolean)},flatten:function(n,r){return X(n,r,!1)},without:Y,uniq:Z,unique:Z,union:nn,intersection:function(n){for(var r=[],t=arguments.length,e=0,u=O(n);e<u;e++){var o=n[e];if(!D(r,o)){var i;for(i=1;i<t&&D(arguments[i],o);i++);i===t&&r.push(o)}}return r},difference:rn,unzip:tn,zip:en,object:function(n,r){for(var t={},e=0,u=O(n);e<u;e++)r?t[n[e]]=r[e]:t[n[e][0]]=n[e][1];return t},findIndex:on,findLastIndex:an,sortedIndex:fn,indexOf:ln,lastIndexOf:pn,range:function(n,r,t){null==r&&(r=n||0,n=0),t||(t=r<n?-1:1);for(var e=Math.max(Math.ceil((r-n)/t),0),u=Array(e),o=0;o<e;o++,n+=t)u[o]=n;return u},chunk:function(n,r){if(null==r||r<1)return[];for(var t=[],e=0,u=n.length;e<u;)t.push(o.call(n,e,e+=r));return t},bind:vn,partial:hn,bindAll:yn,memoize:function(n,r){var t=function(e){var u=t.cache,o=""+(r?r.apply(this,arguments):e);return x(u,o)||(u[o]=n.apply(this,arguments)),u[o]};return t.cache={},t},delay:gn,defer:dn,throttle:function(n,r,t){var e,u,o,i,a=0;t||(t={});var f=function(){a=!1===t.leading?0:fr(),e=null,i=n.apply(u,o),e||(u=o=null)},c=function(){var c=fr();a||!1!==t.leading||(a=c);var l=r-(c-a);return u=this,o=arguments,l<=0||l>r?(e&&(clearTimeout(e),e=null),a=c,i=n.apply(u,o),e||(u=o=null)):e||!1===t.trailing||(e=setTimeout(f,l)),i};return c.cancel=function(){clearTimeout(e),a=0,e=u=o=null},c},debounce:function(n,r,t){var e,u,o=function(r,t){e=null,t&&(u=n.apply(r,t))},i=j(function(i){if(e&&clearTimeout(e),t){var a=!e;e=setTimeout(o,r),a&&(u=n.apply(this,i))}else e=gn(o,r,this,i);return u});return i.cancel=function(){clearTimeout(e),e=null},i},wrap:function(n,r){return hn(r,n)},negate:mn,compose:function(){var n=arguments,r=n.length-1;return function(){for(var t=r,e=n[r].apply(this,arguments);t--;)e=n[t].call(this,e);return e}},after:function(n,r){return function(){if(--n<1)return r.apply(this,arguments)}},before:bn,once:jn,keys:Sn,allKeys:An,values:On,mapObject:function(n,r,t){r=b(r,t);for(var e=Sn(n),u=e.length,o={},i=0;i<u;i++){var a=e[i];o[a]=r(n[a],a,n)}return o},pairs:function(n){for(var r=Sn(n),t=r.length,e=Array(t),u=0;u<t;u++)e[u]=[r[u],n[r[u]]];return e},invert:Mn,functions:En,methods:En,extend:kn,extendOwn:In,assign:In,findKey:Tn,pick:Rn,omit:Fn,defaults:qn,create:function(n,r){var t=_(n);return r&&In(t,r),t},clone:Dn,tap:function(n,r){return r(n),n},isMatch:Wn,isEqual:function(n,r){return zn(n,r)},isEmpty:function(n){return null==n||(M(n)&&(Kn(n)||Jn(n)||Vn(n))?0===n.length:0===Sn(n).length)},isElement:function(n){return!(!n||1!==n.nodeType)},isArray:Kn,isObject:Ln,isArguments:Vn,isFunction:Cn,isString:Jn,isNumber:Un,isDate:$n,isRegExp:Gn,isError:Hn,isSymbol:Qn,isMap:Xn,isWeakMap:Yn,isSet:Zn,isWeakSet:nr,isFinite:function(n){return!Qn(n)&&s(n)&&!p(parseFloat(n))},isNaN:tr,isBoolean:er,isNull:function(n){return null===n},isUndefined:function(n){return void 0===n},has:function(n,r){if(!Kn(r))return x(n,r);for(var t=r.length,e=0;e<t;e++){var u=r[e];if(null==n||!a.call(n,u))return!1;n=n[u]}return!!t},identity:ur,constant:function(n){return function(){return n}},noop:function(){},property:or,propertyOf:function(n){return null==n?function(){}:function(r){return Kn(r)?S(n,r):n[r]}},matcher:ir,matches:ir,times:function(n,r,t){var e=Array(Math.max(0,n));r=g(r,t,1);for(var u=0;u<n;u++)e[u]=r(u);return e},random:ar,now:fr,escape:sr,unescape:vr,result:function(n,r,t){Kn(r)||(r=[r]);var e=r.length;if(!e)return Cn(t)?t.call(n):t;for(var u=0;u<e;u++){var o=null==n?void 0:n[r[u]];void 0===o&&(o=t,u=e),n=Cn(o)?o.call(n):o}return n},uniqueId:function(n){var r=++hr+"";return n?n+r:r},templateSettings:yr,template:function(n,r,t){!r&&t&&(r=t),r=qn({},r,h.templateSettings);var e,u=RegExp([(r.escape||gr).source,(r.interpolate||gr).source,(r.evaluate||gr).source].join("|")+"|$","g"),o=0,i="__p+='";n.replace(u,function(r,t,e,u,a){return i+=n.slice(o,a).replace(mr,br),o=a+r.length,t?i+="'+\n((__t=("+t+"))==null?'':_.escape(__t))+\n'":e?i+="'+\n((__t=("+e+"))==null?'':__t)+\n'":u&&(i+="';\n"+u+"\n__p+='"),r}),i+="';\n",r.variable||(i="with(obj||{}){\n"+i+"}\n"),i="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+i+"return __p;\n";try{e=new Function(r.variable||"obj","_",i)}catch(n){throw n.source=i,n}var a=function(n){return e.call(this,n,h)},f=r.variable||"obj";return a.source="function("+f+"){\n"+i+"}",a},chain:function(n){var r=h(n);return r._chain=!0,r},mixin:_r});return wr._=wr,wr});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}]},{},[4]);

		</script>
	</body>
</html>
